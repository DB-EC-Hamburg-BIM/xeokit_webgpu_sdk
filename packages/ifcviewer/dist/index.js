var e=require("@xeokit/viewer"),r=require("@xeokit/webglrenderer"),t=require("@xeokit/ktx2"),i=require("@xeokit/xkt"),o=require("@xeokit/cameracontrol"),n=require("@xeokit/bcf"),a=require("@xeokit/locale"),s=require("@xeokit/data"),c=require("@xeokit/scene"),d=require("@xeokit/core"),l=require("@xeokit/kdtree3"),u=0;function v(e){return"__private_"+u+++"_"+e}function h(e,r){if(!Object.prototype.hasOwnProperty.call(e,r))throw new TypeError("attempted to use private field on non-instance");return e}var f=/*#__PURE__*/v("objectsKdTree3"),w=/*#__PURE__*/function(){function u(i){var n=this;this.viewer=void 0,this.scene=void 0,this.data=void 0,this.cameraControl=void 0,this.view=void 0,this.localeService=void 0,this.modelsLayer=void 0,this.backgroundLayer=void 0,Object.defineProperty(this,f,{writable:!0,value:void 0}),this.localeService=new a.LocaleService({}),this.scene=new c.Scene,this.data=new s.Data,this.viewer=new e.Viewer({id:"myViewer",renderer:new r.WebGLRenderer({textureTranscoder:new t.KTX2TextureTranscoder({})}),scene:this.scene});var l=this.viewer.createView({canvasElement:i.canvasElement});if(l instanceof d.SDKError)throw l;this.view=l,this.modelsLayer=this.view.createLayer({id:"models"}),this.backgroundLayer=this.view.createLayer({id:"background"}),this.cameraControl=new o.CameraControl(this.view,{}),h(this,f)[f]=null,this.scene.onModelCreated.subscribe(function(){h(n,f)[f]=null}),this.scene.onModelDestroyed.subscribe(function(){h(n,f)[f]=null})}var v,w,y=u.prototype;return y.loadModel=function(e){var r=this;return new Promise(function(t,o){var n=e.id,a=e.src;r.scene.models[n]?o('Model with this ID is already loaded: "'+e.id+'"'):fetch(a).then(function(e){e.ok&&e.arrayBuffer().then(function(e){try{var a=r.data.createModel({id:n});if(a instanceof d.SDKError)return o(a.message),Promise.resolve();var s=r.scene.createModel({id:n,layerId:r.modelsLayer.id});return s instanceof d.SDKError?(a.destroy(),o(s.message),Promise.resolve()):Promise.resolve(i.loadXKT({data:e,sceneModel:s,dataModel:a})).then(function(){return Promise.resolve(s.build()).then(function(){a.build(),t()})})}catch(e){return Promise.reject(e)}})})})},y.unloadModel=function(e){var r=this.scene.models[e];r&&r.destroy();var t=this.data.models[e];t&&t.destroy()},y.saveModel=function(e){var r=this.scene.models[e];if(!r)throw new Error("Model not found: '$id'");return i.saveXKT({sceneModel:r,dataModel:this.data.models[e]})},y.clearModels=function(){this.data.clear(),this.scene.clear()},y.loadBCF=function(e){n.loadBCFViewpoint({bcfViewpoint:e,view:this.view,includeLayerIds:[this.modelsLayer.id]})},y.saveBCF=function(){return n.saveBCFViewpoint({view:this.view,includeLayerIds:[this.modelsLayer.id]})},v=u,(w=[{key:"objectsKdTree3",get:function(){return null===h(this,f)[f]&&(h(this,f)[f]=l.createSceneObjectsKdTree3(Object.values(this.scene.objects))),h(this,f)[f]}}])&&function(e,r){for(var t=0;t<r.length;t++){var i=r[t];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,"symbol"==typeof(o=function(e,r){if("object"!=typeof e||null===e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var i=t.call(e,"string");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(i.key))?o:String(o),i)}var o}(v.prototype,w),Object.defineProperty(v,"prototype",{writable:!1}),u}();exports.IFCViewer=w;
//# sourceMappingURL=index.js.map
