{"version":3,"file":"index.modern.mjs","sources":["../../utils/dist/utils.js","../../constants/dist/index.es","../../matrix/dist/index.es","../src/ViewObject.ts","../src/SectionPlane.ts","../src/Metriqs.ts","../src/SAO.ts","../src/LinesMaterial.ts","../src/ViewLayer.ts","../src/EmphasisMaterial.ts","../src/EdgeMaterial.ts","../src/PointsMaterial.ts","../src/PerspectiveProjection.ts","../src/OrthoProjection.ts","../src/CustomProjection.ts","../../boundaries/dist/index.es","../src/Camera.ts","../src/scheduler.ts","../src/CameraFlightAnimation.ts","../src/View.ts","../src/Viewer.ts","../src/FrustumProjection.ts","../src/AmbientLight.ts","../src/DirLight.ts","../src/PointLight.ts","../src/PickResult.ts"],"sourcesContent":["function t(e,r){return t=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},t(e,r)}var e=0;function r(t){return\"__private_\"+e+++\"_\"+t}function n(t,e){if(!Object.prototype.hasOwnProperty.call(t,e))throw new TypeError(\"attempted to use private field on non-instance\");return t}var i=/*#__PURE__*/r(\"items\"),o=/*#__PURE__*/r(\"lastUniqueId\"),s=/*#__PURE__*/function(){function t(t,e){Object.defineProperty(this,i,{writable:!0,value:void 0}),Object.defineProperty(this,o,{writable:!0,value:void 0}),n(this,i)[i]=t||[],n(this,o)[o]=(e||0)+1}var e=t.prototype;return e.addItem=function(){var t;if(2===arguments.length){var e=arguments[0];if(t=arguments[1],n(this,i)[i][e])throw\"ID clash: '\"+e+\"'\";return n(this,i)[i][e]=t,e}for(t=arguments[0]||{};;){var r=n(this,o)[o]++;if(!n(this,i)[i][r])return n(this,i)[i][r]=t,r}},e.removeItem=function(t){var e=n(this,i)[i][t];return delete n(this,i)[i][t],e},t}(),a=/*#__PURE__*/function(){function t(){this._head=void 0,this._headLength=void 0,this._tail=void 0,this._index=void 0,this._length=void 0,this._head=[],this._headLength=0,this._tail=[],this._index=0,this._length=0}var e,r,n=t.prototype;return n.shift=function(){if(this._index>=this._headLength){var t=this._head;if(t.length=0,this._head=this._tail,this._tail=t,this._index=0,this._headLength=this._head.length,!this._headLength)return}var e=this._head[this._index];return this._index<0?delete this._head[this._index++]:this._head[this._index++]=void 0,this._length--,e},n.push=function(t){return this._length++,this._tail.push(t),this},n.unshift=function(t){return this._head[--this._index]=t,this._length++,this},n.clear=function(){this._head=[],this._headLength=0,this._tail=[],this._index=0,this._length=0},e=t,(r=[{key:\"length\",get:function(){return this._length}}])&&function(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,\"value\"in n&&(n.writable=!0),Object.defineProperty(t,\"symbol\"==typeof(i=function(t,e){if(\"object\"!=typeof t||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,\"string\");if(\"object\"!=typeof n)return n;throw new TypeError(\"@@toPrimitive must return a primitive value.\")}return String(t)}(n.key))?i:String(i),n)}var i}(e.prototype,r),Object.defineProperty(e,\"prototype\",{writable:!1}),t}(),h=/*#__PURE__*/function(){function t(t,e,r){this.isLoading=void 0,this.itemsLoaded=void 0,this.itemsTotal=void 0,this.urlModifier=void 0,this.handlers=void 0,this.onStart=void 0,this.onLoad=void 0,this.onProgress=void 0,this.onError=void 0,this.isLoading=!1,this.itemsLoaded=0,this.itemsTotal=0,this.urlModifier=void 0,this.handlers=[],this.onStart=void 0,this.onLoad=t,this.onProgress=e,this.onError=r}var e=t.prototype;return e.itemStart=function(t){this.itemsTotal++,this.isLoading||void 0!==this.onStart&&this.onStart(t,this.itemsLoaded,this.itemsTotal),this.isLoading=!0},e.itemEnd=function(t){this.itemsLoaded++,void 0!==this.onProgress&&this.onProgress(t,this.itemsLoaded,this.itemsTotal),this.itemsLoaded===this.itemsTotal&&(this.isLoading=!1,void 0!==this.onLoad&&this.onLoad())},e.itemError=function(t){void 0!==this.onError&&this.onError(t)},e.resolveURL=function(t){return this.urlModifier?this.urlModifier(t):t},e.setURLModifier=function(t){return this.urlModifier=t,this},e.addHandler=function(t,e){return this.handlers.push(t,e),this},e.removeHandler=function(t){var e=this.handlers.indexOf(t);return-1!==e&&this.handlers.splice(e,2),this},e.getHandler=function(t){for(var e=0,r=this.handlers.length;e<r;e+=2){var n=this.handlers[e],i=this.handlers[e+1];if(n.global&&(n.lastIndex=0),n.test(t))return i}return null},t}(),u=new h,d=/*#__PURE__*/function(){function t(t){this.manager=void 0,this.crossOrigin=void 0,this.withCredentials=void 0,this.path=void 0,this.resourcePath=void 0,this.requestHeader=void 0,this.manager=void 0!==t?t:u,this.crossOrigin=\"anonymous\",this.withCredentials=!1,this.path=\"\",this.resourcePath=\"\",this.requestHeader={}}var e=t.prototype;return e.load=function(t,e,r,n){},e.loadAsync=function(t,e){var r=this;return new Promise(function(n,i){r.load(t,n,e,i)})},e.parse=function(){},e.setCrossOrigin=function(t){return this.crossOrigin=t,this},e.setWithCredentials=function(t){return this.withCredentials=t,this},e.setPath=function(t){return this.path=t,this},e.setResourcePath=function(t){return this.resourcePath=t,this},e.setRequestHeader=function(t){return this.requestHeader=t,this},t}(),f=/*#__PURE__*/function(){function t(t){void 0===t&&(t=4),this.pool=void 0,this.queue=void 0,this.workers=void 0,this.workersResolve=void 0,this.workerStatus=void 0,this.workerCreator=void 0,this.pool=t,this.queue=[],this.workers=[],this.workersResolve=[],this.workerStatus=0}var e=t.prototype;return e._initWorker=function(t){if(!this.workers[t]){var e=this.workerCreator();e.addEventListener(\"message\",this._onMessage.bind(this,t)),this.workers[t]=e}},e._getIdleWorker=function(){for(var t=0;t<this.pool;t++)if(!(this.workerStatus&1<<t))return t;return-1},e._onMessage=function(t,e){var r=this.workersResolve[t];if(r&&r(e),this.queue.length){var n=this.queue.shift(),i=n.msg,o=n.transfer;this.workersResolve[t]=n.resolve,this.workers[t].postMessage(i,o)}else this.workerStatus^=1<<t},e.setWorkerCreator=function(t){this.workerCreator=t},e.setWorkerLimit=function(t){this.pool=t},e.postMessage=function(t,e){var r=this;return new Promise(function(n){var i=r._getIdleWorker();-1!==i?(r._initWorker(i),r.workerStatus|=1<<i,r.workersResolve[i]=n,r.workers[i].postMessage(t,e)):r.queue.push({resolve:n,msg:t,transfer:e})})},e.destroy=function(){this.workers.forEach(function(t){return t.terminate()}),this.workersResolve.length=0,this.workers.length=0,this.queue.length=0,this.workerStatus=0},t}(),c={enabled:!1,files:{},add:function(t,e){},get:function(t){},remove:function(t){},clear:function(){this.files={}}},l={},v=/*#__PURE__*/function(e){var r,n;function i(t){var r;return(r=e.call(this,t)||this).mimeType=void 0,r.responseType=void 0,r}n=e,(r=i).prototype=Object.create(n.prototype),r.prototype.constructor=r,t(r,n);var o=i.prototype;return o.load=function(t,e,r,n){var i=this;void 0===t&&(t=\"\"),void 0!==this.path&&(t=this.path+t),t=this.manager.resolveURL(t);var o=c.get(t);if(void 0!==o)return this.manager.itemStart(t),setTimeout(function(){e&&e(o),i.manager.itemEnd(t)},0),o;if(void 0===l[t]){l[t]=[],l[t].push({onLoad:e,onProgress:r,onError:n});var s=new Request(t,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?\"include\":\"same-origin\"}),a=this.mimeType,h=this.responseType;fetch(s).then(function(e){if(200===e.status||0===e.status){if(0===e.status&&console.warn(\"FileLoader: HTTP Status 0 received.\"),\"undefined\"==typeof ReadableStream||void 0===e.body.getReader)return e;var r=l[t],n=e.body.getReader(),i=e.headers.get(\"Content-Length\"),o=i?parseInt(i):0,s=0!==o,a=0,h=new ReadableStream({start:function(t){!function e(){n.read().then(function(n){var i=n.value;if(n.done)t.close();else{for(var h=new ProgressEvent(\"progress\",{lengthComputable:s,loaded:a+=i.byteLength,total:o}),u=0,d=r.length;u<d;u++){var f=r[u];f.onProgress&&f.onProgress(h)}t.enqueue(i),e()}})}()}});return new Response(h)}throw new Error('fetch for \"'+e.url+'\" responded with '+e.status+\": \"+e.statusText)}).then(function(t){switch(h){case\"arraybuffer\":return t.arrayBuffer();case\"blob\":return t.blob();case\"document\":return t.text().then(function(t){return(new DOMParser).parseFromString(t,a)});case\"json\":return t.json();default:if(void 0===a)return t.text();var e=/charset=\"?([^;\"\\s]*)\"?/i.exec(a),r=e&&e[1]?e[1].toLowerCase():void 0,n=new TextDecoder(r);return t.arrayBuffer().then(function(t){return n.decode(t)})}}).then(function(e){c.add(t,e);var r=l[t];delete l[t];for(var n=0,i=r.length;n<i;n++){var o=r[n];o.onLoad&&o.onLoad(e)}}).catch(function(e){var r=l[t];if(void 0===r)throw i.manager.itemError(t),e;delete l[t];for(var n=0,o=r.length;n<o;n++){var s=r[n];s.onError&&s.onError(e)}i.manager.itemError(t)}).finally(function(){i.manager.itemEnd(t)}),this.manager.itemStart(t)}else l[t].push({onLoad:e,onProgress:r,onError:n})},o.setResponseType=function(t){return this.responseType=t,this},o.setMimeType=function(t){return this.mimeType=t,this},i}(d);function p(t){return JSON.parse(JSON.stringify(t))}var g=[[\"0\",10],[\"A\",26],[\"a\",26],[\"_\",1],[\"$\",1]].map(function(t){for(var e=[],r=t[0].charCodeAt(0),n=r+t[1],i=r;i<n;++i)e.push(i);return String.fromCharCode.apply(null,e)}).join(\"\");function m(t,e){return(e&&4!==e?[0,6]:[0,6,12,18]).map(function(e){return g.substr(parseInt(String(t/(1<<e)))%64,1)}).reverse().join(\"\")}function w(t){var e=[0,2,4,6,8,10,12,14,16,18,20,22,24,26,28,30].map(function(e){return parseInt(t.substr(e,2),16)});return m(e[0],2)+[1,4,7,10,13].map(function(t){return m((e[t]<<16)+(e[t+1]<<8)+e[t+2],4)}).join(\"\")}function y(t,e){var r=[];return function t(n){n.type===e&&r.push(n),(n.children||[]).forEach(function(e){t(e)})}(t),r}function _(t){return new Promise(function(e,r){setTimeout(e,t)})}function b(t){return new Promise(function(e,r){var n=new XMLHttpRequest;n.open(t.method||\"GET\",t.url,!0),n.onload=function(i){console.log(t.url,n.readyState,n.status),4===n.readyState&&(200===n.status?e(n.responseXML):r(n.statusText))},n.send(null)})}function L(t,e,r){var n=function(t){};e=e||n,r=r||n;var i=new XMLHttpRequest;i.overrideMimeType(\"application/json\"),i.open(\"GET\",t,!0),i.addEventListener(\"load\",function(t){var n=t.target.response;if(200===this.status){var i;try{i=JSON.parse(n)}catch(t){r(\"utils.loadJSON(): Failed to parse JSON response - \"+t)}e(i)}else if(0===this.status){console.warn(\"loadFile: HTTP Status 0 received.\");try{e(JSON.parse(n))}catch(t){r(\"utils.loadJSON(): Failed to parse JSON response - \"+t)}}else r(t)},!1),i.addEventListener(\"error\",function(t){r(t)},!1),i.send(null)}function S(t,e,r){var n=function(t){};e=e||n,r=r||n;var i=t.match(/^data:(.*?)(;base64)?,(.*)$/);if(i){var o=!!i[2],s=i[3];s=window.decodeURIComponent(s),o&&(s=window.atob(s));try{for(var a=new ArrayBuffer(s.length),h=new Uint8Array(a),u=0;u<s.length;u++)h[u]=s.charCodeAt(u);window.setTimeout(function(){e(a)},0)}catch(t){window.setTimeout(function(){r(t)},0)}}else{var d=new XMLHttpRequest;d.open(\"GET\",t,!0),d.responseType=\"arraybuffer\",d.onreadystatechange=function(){4===d.readyState&&(200===d.status?e(d.response):r(\"loadArrayBuffer error : \"+d.response))},d.send(null)}}function P(t){return t&&!t.propertyIsEnumerable(\"length\")&&\"object\"==typeof t&&\"number\"==typeof t.length}function T(t){return\"string\"==typeof t||t instanceof String}function k(t){return!isNaN(parseFloat(t))&&isFinite(t)}function O(t){return T(t)||k(t)}function E(t){return\"function\"==typeof t}function M(t){return!!t&&t.constructor==={}.constructor}function R(t){return x(t,{})}function x(t,e){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);return e}function C(t,e){for(var r in t)t.hasOwnProperty(r)&&null!=t[r]&&(e[r]=t[r]);return e}function j(t,e){for(var r in t)t.hasOwnProperty(r)&&null==e[r]&&(e[r]=t[r]);return e}function q(t){for(var e in t)if(t.hasOwnProperty(e))return!1;return!0}function H(t){return k(t)?\"\"+t:\"'\"+t+\"'\"}function I(t,e){var r=new t.constructor(t.length+e.length);return r.set(t),r.set(e,t.length),r}var N=function(){for(var t=[],e=0;e<256;e++)t[e]=(e<16?\"0\":\"\")+e.toString(16);return function(){var e=4294967295*Math.random()|0,r=4294967295*Math.random()|0,n=4294967295*Math.random()|0,i=4294967295*Math.random()|0;return t[255&e]+t[e>>8&255]+t[e>>16&255]+t[e>>24&255]+\"-\"+t[255&r]+t[r>>8&255]+\"-\"+t[r>>16&15|64]+t[r>>24&255]+\"-\"+t[63&n|128]+t[n>>8&255]+\"-\"+t[n>>16&255]+t[n>>24&255]+t[255&i]+t[i>>8&255]+t[i>>16&255]+t[i>>24&255]}}();export{c as Cache,u as DefaultLoadingManager,v as FileLoader,d as Loader,h as LoadingManager,s as Map,a as Queue,f as WorkerPool,x as apply,C as apply2,j as applyIf,m as b64,p as clone,w as compressGuid,I as concat,R as copy,N as createUUID,y as findNodeOfType,b as httpRequest,H as inQuotes,P as isArray,q as isEmptyObject,E as isFunction,O as isID,k as isNumeric,M as isObject,T as isString,S as loadArraybuffer,L as loadJSON,_ as timeout};\n//# sourceMappingURL=utils.js.map\n","var e=1e3,r=1001,a=1002,o=1003,p=1004,t=1004,v=1005,x=1005,b=1006,c=1007,d=1007,f=1008,g=1008,h=1009,i=1010,j=1011,k=1012,l=1013,m=1014,n=1015,q=1016,s=1017,u=1018,w=1020,y=1021,z=1022,A=1023,B=1024,C=1025,D=1026,E=1027,F=1028,G=1029,H=1030,I=1031,J=1033,K=33776,L=33777,M=33778,N=33779,O=35840,P=35841,Q=35842,R=35843,S=36196,T=37492,U=37496,V=37808,W=37809,X=37810,Y=37811,Z=37812,$=37813,_=37814,ee=37815,re=37816,ae=37817,oe=37818,pe=37819,te=37820,ve=37821,xe=36492,be=3e3,ce=3001,de=1e4,fe=10001,ge=10002,he=2e4,ie=20001,je=20002,ke=20003,le=20004,me=3e4,ne=300001,qe=4e5,se=400001,ue=400002,we=400003,ye=400004,ze=400005,Ae=5e5,Be=500001,Ce=500002,De=500003;export{y as AlphaFormat,i as ByteType,se as CentimetersUnit,r as ClampToEdgeWrapping,De as CustomProjectionType,D as DepthFormat,E as DepthStencilFormat,ne as FastRender,ye as FeetUnit,n as FloatType,Ce as FrustumProjectionType,de as GIFMediaType,q as HalfFloatType,ze as InchesUnit,l as IntType,fe as JPEGMediaType,be as LinearEncoding,b as LinearFilter,g as LinearMipMapLinearFilter,d as LinearMipMapNearestFilter,f as LinearMipmapLinearFilter,c as LinearMipmapNearestFilter,ie as LinesPrimitive,C as LuminanceAlphaFormat,B as LuminanceFormat,qe as MetersUnit,ue as MillimetersUnit,a as MirroredRepeatWrapping,o as NearestFilter,x as NearestMipMapLinearFilter,p as NearestMipMapNearestFilter,v as NearestMipmapLinearFilter,t as NearestMipmapNearestFilter,Be as OrthoProjectionType,ge as PNGMediaType,Ae as PerspectiveProjectionType,he as PointsPrimitive,me as QualityRender,A as RGBAFormat,J as RGBAIntegerFormat,pe as RGBA_ASTC_10x10_Format,re as RGBA_ASTC_10x5_Format,ae as RGBA_ASTC_10x6_Format,oe as RGBA_ASTC_10x8_Format,te as RGBA_ASTC_12x10_Format,ve as RGBA_ASTC_12x12_Format,V as RGBA_ASTC_4x4_Format,W as RGBA_ASTC_5x4_Format,X as RGBA_ASTC_5x5_Format,Y as RGBA_ASTC_6x5_Format,Z as RGBA_ASTC_6x6_Format,$ as RGBA_ASTC_8x5_Format,_ as RGBA_ASTC_8x6_Format,ee as RGBA_ASTC_8x8_Format,xe as RGBA_BPTC_Format,U as RGBA_ETC2_EAC_Format,R as RGBA_PVRTC_2BPPV1_Format,Q as RGBA_PVRTC_4BPPV1_Format,L as RGBA_S3TC_DXT1_Format,M as RGBA_S3TC_DXT3_Format,N as RGBA_S3TC_DXT5_Format,z as RGBFormat,S as RGB_ETC1_Format,T as RGB_ETC2_Format,P as RGB_PVRTC_2BPPV1_Format,O as RGB_PVRTC_4BPPV1_Format,K as RGB_S3TC_DXT1_Format,H as RGFormat,I as RGIntegerFormat,F as RedFormat,G as RedIntegerFormat,e as RepeatWrapping,j as ShortType,ke as SolidPrimitive,le as SurfacePrimitive,je as TrianglesPrimitive,h as UnsignedByteType,w as UnsignedInt248Type,m as UnsignedIntType,s as UnsignedShort4444Type,u as UnsignedShort5551Type,k as UnsignedShortType,we as YardsUnit,ce as sRGBEncoding};\n//# sourceMappingURL=index.es.map\n","import{newFloatArray as n,clamp as t,DEGTORAD as r}from\"@xeokit/math\";var u=s(),a=M(),o=M(),i=M(),e=M(),c=M(),f=s();function v(n,t){return n[0]*t[0]+n[1]*t[1]+n[2]*t[2]}function h(n){return new FloatArrayClass(n||2)}function M(n){return new Float64Array(n||3)}function s(n){return new FloatArrayClass(n||4)}function l(n,t){return t||(t=n),t[0]=-n[0],t[1]=-n[1],t[2]=-n[2],t}function d(n,t){return t||(t=n),t[0]=-n[0],t[1]=-n[1],t[2]=-n[2],t[3]=-n[3],t}function q(n,t,r){return r||(r=n),r[0]=n[0]+t[0],r[1]=n[1]+t[1],r[2]=n[2]+t[2],r[3]=n[3]+t[3],r}function X(n,t,r){return r||(r=n),r[0]=n[0]+t,r[1]=n[1]+t,r[2]=n[2]+t,r[3]=n[3]+t,r}function Y(n,t,r){return r||(r=n),r[0]=n[0]*t,r[1]=n[1]*t,r[2]=n[2]*t,r[3]=n[3]*t,r}function Z(n,t,r){return r||(r=n),r[0]=n[0]*t,r[1]=n[1]*t,r[2]=n[2]*t,r}function b(n,t,r){return r||(r=n),r[0]=n[0]*t,r[1]=n[1]*t,r}function g(n,t,r){return r||(r=n),r[0]=n[0]+t[0],r[1]=n[1]+t[1],r[2]=n[2]+t[2],r}function y(n,t,r){return r||(r=n),r[0]=n[0]+t,r[1]=n[1]+t,r[2]=n[2]+t,r}function w(n,t,r){return r||(r=n),r[0]=n[0]-t[0],r[1]=n[1]-t[1],r[2]=n[2]-t[2],r[3]=n[3]-t[3],r}function A(n,t){return n[0]===t[0]&&n[1]===t[1]&&n[2]===t[2]}function p(n,t,r){return r||(r=n),r[0]=n[0]-t[0],r[1]=n[1]-t[1],r[2]=n[2]-t[2],r}function F(n,t,r){return r||(r=n),r[0]=n[0]-t[0],r[1]=n[1]-t[1],r}function m(){for(var n=[].slice.call(arguments),t=new Float32Array(n[0]),r=1;r<n.length;r++)t[0]+=n[r][0],t[1]+=n[r][1];return t[0]/=n.length,t[1]/=n.length,t}function x(n,t,r){return r||(r=n),r[0]=n[0]-t,r[1]=n[1]-t,r[2]=n[2]-t,r[3]=n[3]-t,r}function C(n,t,r){return r||(r=n),r[0]=t-n[0],r[1]=t-n[1],r[2]=t-n[2],r[3]=t-n[3],r}function k(n,t,r){return r||(r=n),r[0]=n[0]*t[0],r[1]=n[1]*t[1],r[2]=n[2]*t[2],r[3]=n[3]*t[3],r}function j(n,t,r){return r||(r=n),r[0]=n[0]/t[0],r[1]=n[1]/t[1],r[2]=n[2]/t[2],r}function z(n,t,r){return r||(r=n),r[0]=n[0]/t[0],r[1]=n[1]/t[1],r[2]=n[2]/t[2],r[3]=n[3]/t[3],r}function B(n,t,r){return r||(r=t),r[0]=n/t[0],r[1]=n/t[1],r[2]=n/t[2],r}function D(n,t,r){return r||(r=n),r[0]=n[0]/t,r[1]=n[1]/t,r[2]=n[2]/t,r}function E(n,t,r){return r||(r=n),r[0]=n[0]/t,r[1]=n[1]/t,r[2]=n[2]/t,r[3]=n[3]/t,r}function G(n,t,r){return r||(r=t),r[0]=n/t[0],r[1]=n/t[1],r[2]=n/t[2],r[3]=n/t[3],r}function H(n,t){return n[0]*t[0]+n[1]*t[1]+n[2]*t[2]+n[3]*t[3]}function I(n,t){var r=n[0],u=n[1],a=n[2],o=t[0],i=t[1],e=t[2];return[u*e-a*i,a*o-r*e,r*i-u*o,0]}function J(n,t,r){r||(r=n);var u=n[0],a=n[1],o=n[2],i=t[0],e=t[1],c=t[2];return r[0]=a*c-o*e,r[1]=o*i-u*c,r[2]=u*e-a*i,r}function K(n){return H(n,n)}function L(n){return Math.sqrt(K(n))}function N(n,t){return n[0]*t[0]+n[1]*t[1]}function O(n){return v(n,n)}function P(n){return N(n,n)}function Q(n){return Math.sqrt(O(n))}var R,S=(R=M(),function(n,t){return Q(p(n,t,R))});function T(n){return Math.sqrt(P(n))}function U(n,t,r,u,a,o){var i=o||M(),e=(n-t)/(r-t);return i[0]=u[0]+e*(a[0]-u[0]),i[1]=u[1]+e*(a[1]-u[1]),i[2]=u[2]+e*(a[2]-u[2]),i}var V=function(){var n=h();return function(t,r){return T(F(t,r,n))}}();function W(n,t){return B(1,n,t)}function $(n,t){return Y(n,1/L(n),t)}function _(n,t){return Z(n,1/Q(n),t)}function nn(n,t){return b(n,1/T(n),t)}function tn(n,t){var r=v(n,t)/Math.sqrt(O(n)*O(t));return r=r<-1?-1:r>1?1:r,Math.acos(r)}var rn=function(){var n=M();return function(t,r){return n[0]=t[0],n[1]=t[1],n[2]=t[2],r[0]=Q(n),n[0]=t[4],n[1]=t[5],n[2]=t[6],r[1]=Q(n),n[0]=t[8],n[1]=t[9],n[2]=t[10],r[2]=Q(n),r}}();function un(n){for(var t=0,r=(n=Array.prototype.slice.call(n)).length;t<r;t++)n[t]=an(n[t]);return n}function an(n){return Math.round(1e5*n)/1e5}function on(n,t,r,u){void 0===u&&(u=M());var a=t[0]-n[0],o=t[1]-n[1],i=t[2]-n[2],e=r[0]-n[0],c=r[1]-n[1],f=r[2]-n[2],v=o*f-i*c,h=i*e-a*f,s=a*c-o*e,l=Math.sqrt(v*v+h*h+s*s);return 0===l?(u[0]=0,u[1]=0,u[2]=0):(u[0]=v/l,u[1]=h/l,u[2]=s/l),u}function en(t){return new n(t||9)}function cn(t){return n(t||16)}var fn=cn(),vn=cn();function hn(n,t){return n[0]===t[0]&&n[1]===t[1]&&n[2]===t[2]&&n[3]===t[3]&&n[4]===t[4]&&n[5]===t[5]&&n[6]===t[6]&&n[7]===t[7]&&n[8]===t[8]&&n[9]===t[9]&&n[10]===t[10]&&n[11]===t[11]&&n[12]===t[12]&&n[13]===t[13]&&n[14]===t[14]&&n[15]===t[15]}function Mn(n,t,r,u,a){var o=[],i=[];return o[2]=r,i[2]=u,i[1]=o[2]*Math.tan(n/2),o[1]=-i[1],i[0]=i[1]*t,o[0]=-i[0],sn(o,i,a)}function sn(n,t,r){r||(r=cn());var u=[n[0],n[1],n[2],0],a=[t[0],t[1],t[2],0];q(a,u,fn),w(a,u,vn);var o=2*u[2],i=vn[0],e=vn[1],c=vn[2];return r[0]=o/i,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=o/e,r[6]=0,r[7]=0,r[8]=fn[0]/i,r[9]=fn[1]/e,r[10]=-fn[2]/c,r[11]=-1,r[12]=0,r[13]=0,r[14]=-o*a[2]/c,r[15]=0,r}function ln(n,t,r,u,a,o,i){i||(i=cn());var e=t-n,c=u-r,f=o-a;return i[0]=2/e,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=2/c,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=-2/f,i[11]=0,i[12]=-(n+t)/e,i[13]=-(u+r)/c,i[14]=-(o+a)/f,i[15]=1,i}function dn(n,t,r,u,a,o,i){i||(i=cn());var e=t-n,c=u-r,f=o-a;return i[0]=2*a/e,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=2*a/c,i[6]=0,i[7]=0,i[8]=(t+n)/e,i[9]=(u+r)/c,i[10]=-(o+a)/f,i[11]=-1,i[12]=0,i[13]=0,i[14]=-o*a*2/f,i[15]=0,i}function qn(n){return n||(n=cn()),n[0]=1,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=1,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=1,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n}function Xn(n){return n||(n=cn()),n[0]=1,n[1]=0,n[2]=0,n[3]=0,n[4]=1,n[5]=0,n[6]=0,n[7]=0,n[8]=1,n}function Yn(n){return 1===n[0]&&0===n[1]&&0===n[2]&&0===n[3]&&0===n[4]&&1===n[5]&&0===n[6]&&0===n[7]&&0===n[8]&&0===n[9]&&1===n[10]&&0===n[11]&&0===n[12]&&0===n[13]&&0===n[14]&&1===n[15]}function Zn(n,t,r){r||(r=cn());var u,a,o,i,e,c,f=$([t[0],t[1],t[2],0],[]),v=Math.sin(n),h=Math.cos(n),M=1-h,s=f[0],l=f[1],d=f[2];return u=s*l,a=l*d,o=d*s,i=s*v,e=l*v,c=d*v,r[0]=M*s*s+h,r[1]=M*u+c,r[2]=M*o-e,r[3]=0,r[4]=M*u-c,r[5]=M*l*l+h,r[6]=M*a+i,r[7]=0,r[8]=M*o+e,r[9]=M*a-i,r[10]=M*d*d+h,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r}function bn(n,t,r,u){u||(u=cn());var a,o,i,e,c,f,v,h,M,s,l=n[0],d=n[1],q=n[2],X=r[0],Y=r[1],Z=r[2],b=t[0],g=t[1],y=t[2];return l===b&&d===g&&q===y?qn():(a=l-b,o=d-g,i=q-y,e=Y*(i*=s=1/Math.sqrt(a*a+o*o+i*i))-Z*(o*=s),c=Z*(a*=s)-X*i,f=X*o-Y*a,(s=Math.sqrt(e*e+c*c+f*f))?(e*=s=1/s,c*=s,f*=s):(e=0,c=0,f=0),v=o*f-i*c,h=i*e-a*f,M=a*c-o*e,(s=Math.sqrt(v*v+h*h+M*M))?(v*=s=1/s,h*=s,M*=s):(v=0,h=0,M=0),u[0]=e,u[1]=v,u[2]=a,u[3]=0,u[4]=c,u[5]=h,u[6]=o,u[7]=0,u[8]=f,u[9]=M,u[10]=i,u[11]=0,u[12]=-(e*l+c*d+f*q),u[13]=-(v*l+h*d+M*q),u[14]=-(a*l+o*d+i*q),u[15]=1,u)}function gn(n,t){t||(t=n);var r=n[0],u=n[1],a=n[2],o=n[3],i=n[4],e=n[5],c=n[6],f=n[7],v=n[8],h=n[9],M=n[10],s=n[11],l=n[12],d=n[13],q=n[14],X=n[15],Y=r*e-u*i,Z=r*c-a*i,b=r*f-o*i,g=u*c-a*e,y=u*f-o*e,w=a*f-o*c,A=v*d-h*l,p=v*q-M*l,F=v*X-s*l,m=h*q-M*d,x=h*X-s*d,C=M*X-s*q,k=1/(Y*C-Z*x+b*m+g*F-y*p+w*A);return t[0]=(e*C-c*x+f*m)*k,t[1]=(-u*C+a*x-o*m)*k,t[2]=(d*w-q*y+X*g)*k,t[3]=(-h*w+M*y-s*g)*k,t[4]=(-i*C+c*F-f*p)*k,t[5]=(r*C-a*F+o*p)*k,t[6]=(-l*w+q*b-X*Z)*k,t[7]=(v*w-M*b+s*Z)*k,t[8]=(i*x-e*F+f*A)*k,t[9]=(-r*x+u*F-o*A)*k,t[10]=(l*y-d*b+X*Y)*k,t[11]=(-v*y+h*b-s*Y)*k,t[12]=(-i*m+e*p-c*A)*k,t[13]=(r*m-u*p+a*A)*k,t[14]=(-l*g+d*Z-q*Y)*k,t[15]=(v*g-h*Z+M*Y)*k,t}function yn(n,t){var r=n[4],u=n[14],a=n[8],o=n[13],i=n[12],e=n[9];if(!t||n===t){var c=n[1],f=n[2],v=n[3],h=n[6],M=n[7],s=n[11];return n[1]=r,n[2]=a,n[3]=i,n[4]=c,n[6]=e,n[7]=o,n[8]=f,n[9]=h,n[11]=u,n[12]=v,n[13]=M,n[14]=s,n}return t[0]=n[0],t[1]=r,t[2]=a,t[3]=i,t[4]=n[1],t[5]=n[5],t[6]=e,t[7]=o,t[8]=n[2],t[9]=n[6],t[10]=n[10],t[11]=u,t[12]=n[3],t[13]=n[7],t[14]=n[11],t[15]=n[15],t}function wn(n,t,r){r||(r=n);var u=t[0],a=t[1],o=t[2],i=t[3];return r[0]=n[0]*u+n[4]*a+n[8]*o+n[12]*i,r[1]=n[1]*u+n[5]*a+n[9]*o+n[13]*i,r[2]=n[2]*u+n[6]*a+n[10]*o+n[14]*i,r[3]=n[3]*u+n[7]*a+n[11]*o+n[15]*i,r}function An(n,t,r){r||(r=n);var u=n[0],a=n[1],o=n[2],i=n[3],e=n[4],c=n[5],f=n[6],v=n[7],h=n[8],M=n[9],s=n[10],l=n[11],d=n[12],q=n[13],X=n[14],Y=n[15],Z=t[0],b=t[1],g=t[2],y=t[3],w=t[4],A=t[5],p=t[6],F=t[7],m=t[8],x=t[9],C=t[10],k=t[11],j=t[12],z=t[13],B=t[14],D=t[15];return r[0]=Z*u+b*e+g*h+y*d,r[1]=Z*a+b*c+g*M+y*q,r[2]=Z*o+b*f+g*s+y*X,r[3]=Z*i+b*v+g*l+y*Y,r[4]=w*u+A*e+p*h+F*d,r[5]=w*a+A*c+p*M+F*q,r[6]=w*o+A*f+p*s+F*X,r[7]=w*i+A*v+p*l+F*Y,r[8]=m*u+x*e+C*h+k*d,r[9]=m*a+x*c+C*M+k*q,r[10]=m*o+x*f+C*s+k*X,r[11]=m*i+x*v+C*l+k*Y,r[12]=j*u+z*e+B*h+D*d,r[13]=j*a+z*c+B*M+D*q,r[14]=j*o+z*f+B*s+D*X,r[15]=j*i+z*v+B*l+D*Y,r}function pn(t,r,u){void 0===u&&(u=n(9));var a=t[0],o=t[3],i=t[6],e=t[1],c=t[4],f=t[7],v=t[2],h=t[5],M=t[8],s=r[0],l=r[3],d=r[6],q=r[1],X=r[4],Y=r[7],Z=r[2],b=r[5],g=r[8];return u[0]=a*s+o*q+i*Z,u[3]=a*l+o*X+i*b,u[6]=a*d+o*Y+i*g,u[1]=e*s+c*q+f*Z,u[4]=e*l+c*X+f*b,u[7]=e*d+c*Y+f*g,u[2]=v*s+h*q+M*Z,u[5]=v*l+h*X+M*b,u[8]=v*d+h*Y+M*g,u}function Fn(n,t,r){r||(r=t);var u=t[0],a=t[1],o=t[2];return r[0]=n[0]*u+n[4]*a+n[8]*o+n[12],r[1]=n[1]*u+n[5]*a+n[9]*o+n[13],r[2]=n[2]*u+n[6]*a+n[10]*o+n[14],r}function mn(n,t,r){return r[0]=n[0]*t[0]+n[4]*t[1]+n[8]*t[2]+n[12]*t[3],r[1]=n[1]*t[0]+n[5]*t[1]+n[9]*t[2]+n[13]*t[3],r[2]=n[2]*t[0]+n[6]*t[1]+n[10]*t[2]+n[14]*t[3],r[3]=n[3]*t[0]+n[7]*t[1]+n[11]*t[2]+n[15]*t[3],r}function xn(n,t,r){for(var u,a,o,i,e,c=r||[],f=t.length,v=n[0],h=n[1],M=n[2],s=n[3],l=n[4],d=n[5],q=n[6],X=n[7],Y=n[8],Z=n[9],b=n[10],g=n[11],y=n[12],w=n[13],A=n[14],p=n[15],F=0;F<f;++F)u=(i=t[F])[0],a=i[1],o=i[2],(e=c[F]||(c[F]=[0,0,0]))[0]=v*u+l*a+Y*o+y,e[1]=h*u+d*a+Z*o+w,e[2]=M*u+q*a+b*o+A,e[3]=s*u+X*a+g*o+p;return c.length=f,c}function Cn(n,t,r){var u;r||(r=t);var a,o,i,e=t.length,c=n[0],f=n[1],v=n[2],h=n[3],M=n[4],s=n[5],l=n[6],d=n[7],q=n[8],X=n[9],Y=n[10],Z=n[11],b=n[12],g=n[13],y=n[14],w=n[15];for(u=0;u<e;u+=3)r[u+0]=c*(a=t[u+0])+M*(o=t[u+1])+q*(i=t[u+2])+b,r[u+1]=f*a+s*o+X*i+g,r[u+2]=v*a+l*o+Y*i+y,r[u+3]=h*a+d*o+Z*i+w;return r}function kn(n,t,r){var u;r||(r=t);var a,o,i,e=t.length,c=n[0],f=n[1],v=n[2],h=n[3],M=n[4],s=n[5],l=n[6],d=n[7],q=n[8],X=n[9],Y=n[10],Z=n[11],b=n[12],g=n[13],y=n[14],w=n[15];for(u=0;u<e;u+=4)r[u+0]=c*(a=t[u+0])+M*(o=t[u+1])+q*(i=t[u+2])+b,r[u+1]=f*a+s*o+X*i+g,r[u+2]=v*a+l*o+Y*i+y,r[u+3]=h*a+d*o+Z*i+w;return r}function jn(n,t,r){var u=t[0],a=t[1],o=t[2];return(r=r||M())[0]=n[0]*u+n[4]*a+n[8]*o,r[1]=n[1]*u+n[5]*a+n[9]*o,r[2]=n[2]*u+n[6]*a+n[10]*o,r}function zn(n,t,r){var u=t[0],a=t[1],o=t[2],i=t[3];return(r=r||s())[0]=n[0]*u+n[4]*a+n[8]*o+n[12]*i,r[1]=n[1]*u+n[5]*a+n[9]*o+n[13]*i,r[2]=n[2]*u+n[6]*a+n[10]*o+n[14]*i,r[3]=n[3]*u+n[7]*a+n[11]*o+n[15]*i,r}function Bn(n,t){void 0===t&&(t=qn());var r=n[0],u=n[1],a=n[2];return t[0]*=r,t[4]*=u,t[8]*=a,t[1]*=r,t[5]*=u,t[9]*=a,t[2]*=r,t[6]*=u,t[10]*=a,t[3]*=r,t[7]*=u,t[11]*=a,t}function Dn(n,t){return void 0===t&&(t=qn()),t[0]=n[0],t[5]=n[1],t[10]=n[2],t}function En(n,t){return void 0===t&&(t=Xn()),t[0]=n[0],t[4]=n[1],t}var Gn,Hn=(Gn=n(3),function(n,t,r,u){return Gn[0]=n,Gn[1]=t,Gn[2]=r,Dn(Gn,u)});function In(n,t,r,u){return u[0]*=n,u[4]*=t,u[8]*=r,u[1]*=n,u[5]*=t,u[9]*=r,u[2]*=n,u[6]*=t,u[10]*=r,u[3]*=n,u[7]*=t,u[11]*=r,u}function Jn(n){return Hn(n,n,n)}function Kn(n,t,r,u){return void 0===u&&(u=cn()),et(t,u),Bn(r,u),Nn(n,u),u}var Ln=function(){var n=M(),t=cn();return function(r,u,a,o){n[0]=r[0],n[1]=r[1],n[2]=r[2];var i=Q(n);n[0]=r[4],n[1]=r[5],n[2]=r[6];var e=Q(n);n[8]=r[8],n[9]=r[9],n[10]=r[10];var c=Q(n);Un(r)<0&&(i=-i),u[0]=r[12],u[1]=r[13],u[2]=r[14],t.set(r);var f=1/i,v=1/e,h=1/c;t[0]*=f,t[1]*=f,t[2]*=f,t[4]*=v,t[5]*=v,t[6]*=v,t[8]*=h,t[9]*=h,t[10]*=h,nt(t,a),o[0]=i,o[1]=e,o[2]=c}}();function Nn(n,t){return void 0===t&&(t=qn()),On(n[0],n[1],n[2],t)}function On(n,t,r,u){void 0===u&&(u=qn());var a=u[3];u[0]+=a*n,u[1]+=a*t,u[2]+=a*r;var o=u[7];u[4]+=o*n,u[5]+=o*t,u[6]+=o*r;var i=u[11];u[8]+=i*n,u[9]+=i*t,u[10]+=i*r;var e=u[15];return u[12]+=e*n,u[13]+=e*t,u[14]+=e*r,u}function Pn(n,t,r){return r[0]=n[0],r[1]=n[1],r[2]=n[2],r[3]=n[3],r[4]=n[4],r[5]=n[5],r[6]=n[6],r[7]=n[7],r[8]=n[8],r[9]=n[9],r[10]=n[10],r[11]=n[11],r[12]=t[0],r[13]=t[1],r[14]=t[2],r[15]=n[15],r}function Qn(n,t){var r=t||qn();return r[12]=n[0],r[13]=n[1],r[14]=n[2],r}function Rn(n,t){var r=t||Xn();return r[6]=n[0],r[7]=n[1],r}var Sn=function(){var t=n(3);return function(n,r,u,a){return t[0]=n,t[1]=r,t[2]=u,Qn(t,a)}}();function Tn(n,t){return Sn(n,n,n,t)}function Un(n){var t=n[0],r=n[1],u=n[2],a=n[3],o=n[4],i=n[5],e=n[6],c=n[7],f=n[8],v=n[9],h=n[10],M=n[11],s=n[12],l=n[13],d=n[14],q=n[15];return s*v*e*a-f*l*e*a-s*i*h*a+o*l*h*a+f*i*d*a-o*v*d*a-s*v*u*c+f*l*u*c+s*r*h*c-t*l*h*c-f*r*d*c+t*v*d*c+s*i*u*M-o*l*u*M-s*r*e*M+t*l*e*M+o*r*d*M-t*i*d*M-f*i*u*q+o*v*u*q+f*r*e*q-t*v*e*q-o*r*h*q+t*i*h*q}function Vn(n,r,u){void 0===u&&(u=M());var a=n[0],o=n[4],i=n[8],e=n[1],c=n[5],f=n[9],v=n[2],h=n[6],s=n[10];return\"XYZ\"===r?(u[1]=Math.asin(t(i,-1,1)),Math.abs(i)<.99999?(u[0]=Math.atan2(-f,s),u[2]=Math.atan2(-o,a)):(u[0]=Math.atan2(h,c),u[2]=0)):\"YXZ\"===r?(u[0]=Math.asin(-t(f,-1,1)),Math.abs(f)<.99999?(u[1]=Math.atan2(i,s),u[2]=Math.atan2(e,c)):(u[1]=Math.atan2(-v,a),u[2]=0)):\"ZXY\"===r?(u[0]=Math.asin(t(h,-1,1)),Math.abs(h)<.99999?(u[1]=Math.atan2(-v,s),u[2]=Math.atan2(-o,c)):(u[1]=0,u[2]=Math.atan2(e,a))):\"ZYX\"===r?(u[1]=Math.asin(-t(v,-1,1)),Math.abs(v)<.99999?(u[0]=Math.atan2(h,s),u[2]=Math.atan2(e,a)):(u[0]=0,u[2]=Math.atan2(-o,c))):\"YZX\"===r?(u[2]=Math.asin(t(e,-1,1)),Math.abs(e)<.99999?(u[0]=Math.atan2(-f,c),u[1]=Math.atan2(-v,a)):(u[0]=0,u[1]=Math.atan2(i,s))):\"XZY\"===r&&(u[2]=Math.asin(-t(o,-1,1)),Math.abs(o)<.99999?(u[0]=Math.atan2(h,c),u[1]=Math.atan2(i,a)):(u[0]=Math.atan2(-f,s),u[1]=0)),u}function Wn(n,t,r,u,a,o){var i=o||cn(),e=(n-t)/(r-t);return i[0]=u[0]+e*(a[0]-u[0]),i[1]=u[1]+e*(a[1]-u[1]),i[2]=u[2]+e*(a[2]-u[2]),i[3]=u[3]+e*(a[3]-u[3]),i[4]=u[4]+e*(a[4]-u[4]),i[5]=u[5]+e*(a[5]-u[5]),i[6]=u[6]+e*(a[6]-u[6]),i[7]=u[7]+e*(a[7]-u[7]),i[8]=u[8]+e*(a[8]-u[8]),i[9]=u[9]+e*(a[9]-u[9]),i[10]=u[10]+e*(a[10]-u[10]),i[11]=u[11]+e*(a[11]-u[11]),i[12]=u[12]+e*(a[12]-u[12]),i[13]=u[13]+e*(a[13]-u[13]),i[14]=u[14]+e*(a[14]-u[14]),i[15]=u[15]+e*(a[15]-u[15]),i}function $n(n){return void 0===n&&(n=s()),n[0]=0,n[1]=0,n[2]=0,n[3]=1,n}function _n(n,t,u){void 0===u&&(u=s());var a=n[0]*r/2,o=n[1]*r/2,i=n[2]*r/2,e=Math.cos(a),c=Math.cos(o),f=Math.cos(i),v=Math.sin(a),h=Math.sin(o),M=Math.sin(i);return\"XYZ\"===t?(u[0]=v*c*f+e*h*M,u[1]=e*h*f-v*c*M,u[2]=e*c*M+v*h*f,u[3]=e*c*f-v*h*M):\"YXZ\"===t?(u[0]=v*c*f+e*h*M,u[1]=e*h*f-v*c*M,u[2]=e*c*M-v*h*f,u[3]=e*c*f+v*h*M):\"ZXY\"===t?(u[0]=v*c*f-e*h*M,u[1]=e*h*f+v*c*M,u[2]=e*c*M+v*h*f,u[3]=e*c*f-v*h*M):\"ZYX\"===t?(u[0]=v*c*f-e*h*M,u[1]=e*h*f+v*c*M,u[2]=e*c*M-v*h*f,u[3]=e*c*f+v*h*M):\"YZX\"===t?(u[0]=v*c*f+e*h*M,u[1]=e*h*f+v*c*M,u[2]=e*c*M-v*h*f,u[3]=e*c*f-v*h*M):\"XZY\"===t&&(u[0]=v*c*f-e*h*M,u[1]=e*h*f-v*c*M,u[2]=e*c*M+v*h*f,u[3]=e*c*f+v*h*M),u}function nt(n,t){void 0===t&&(t=s());var r,u=n[0],a=n[4],o=n[8],i=n[1],e=n[5],c=n[9],f=n[2],v=n[6],h=n[10],M=u+e+h;return M>0?(r=.5/Math.sqrt(M+1),t[3]=.25/r,t[0]=(v-c)*r,t[1]=(o-f)*r,t[2]=(i-a)*r):u>e&&u>h?(r=2*Math.sqrt(1+u-e-h),t[3]=(v-c)/r,t[0]=.25*r,t[1]=(a+i)/r,t[2]=(o+f)/r):e>h?(r=2*Math.sqrt(1+e-u-h),t[3]=(o-f)/r,t[0]=(a+i)/r,t[1]=.25*r,t[2]=(c+v)/r):(r=2*Math.sqrt(1+h-u-e),t[3]=(i-a)/r,t[0]=(o+f)/r,t[1]=(c+v)/r,t[2]=.25*r),t}function tt(n,t,r){void 0===r&&(r=s());var u=Math.sqrt(v(n,n)*v(t,t)),a=u+v(n,t);return a<1e-8*u?(a=0,Math.abs(n[0])>Math.abs(n[2])?(r[0]=-n[1],r[1]=n[0],r[2]=0):(r[0]=0,r[1]=-n[2],r[2]=n[1])):J(n,t,r),r[3]=a,ct(r)}function rt(n,t){void 0===t&&(t=s());var r=n[3]/2,u=Math.sin(r);return t[0]=u*n[0],t[1]=u*n[1],t[2]=u*n[2],t[3]=Math.cos(r),t}function ut(n,t,r){return void 0===r&&(r=M()),et(n,fn),Vn(fn,t,r),r}function at(n,t,r){void 0===r&&(r=s());var u=n[0],a=n[1],o=n[2],i=n[3],e=t[0],c=t[1],f=t[2],v=t[3];return r[0]=i*e+u*v+a*f-o*c,r[1]=i*c+a*v+o*e-u*f,r[2]=i*f+o*v+u*c-a*e,r[3]=i*v-u*e-a*c-o*f,r}function ot(n,t,r){void 0===r&&(r=M());var u=t[0],a=t[1],o=t[2],i=n[0],e=n[1],c=n[2],f=n[3],v=f*u+e*o-c*a,h=f*a+c*u-i*o,s=f*o+i*a-e*u,l=-i*u-e*a-c*o;return r[0]=v*f+l*-i+h*-c-s*-e,r[1]=h*f+l*-e+s*-i-v*-c,r[2]=s*f+l*-c+v*-e-h*-i,r}function it(n,t){t=qn(t);var r=n[0],u=n[1],a=n[2],o=n[3],i=2*r,e=2*u,c=2*a,f=i*o,v=e*o,h=c*o,M=i*r,s=e*r,l=c*r,d=e*u,q=c*u,X=c*a;return t[0]=1-(d+X),t[1]=s+h,t[2]=l-v,t[4]=s-h,t[5]=1-(M+X),t[6]=q+f,t[8]=l+v,t[9]=q-f,t[10]=1-(M+d),t}function et(n,t){var r=n[0],u=n[1],a=n[2],o=n[3],i=r+r,e=u+u,c=a+a,f=r*i,v=r*e,h=r*c,M=u*e,s=u*c,l=a*c,d=o*i,q=o*e,X=o*c;return t[0]=1-(M+l),t[4]=v-X,t[8]=h+q,t[1]=v+X,t[5]=1-(f+l),t[9]=s-d,t[2]=h-q,t[6]=s+d,t[10]=1-(f+M),t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function ct(n,t){void 0===t&&(t=n);var r=L([n[0],n[1],n[2],n[3]]);return t[0]=n[0]/r,t[1]=n[1]/r,t[2]=n[2]/r,t[3]=n[3]/r,t}function ft(n,t){return void 0===t&&(t=n),t[0]=-n[0],t[1]=-n[1],t[2]=-n[2],t[3]=n[3],t}function vt(n,t){return ct(ft(n,t))}function ht(n,t){void 0===t&&(t=s());var r=(n=ct(n,u))[3],a=2*Math.acos(r),o=Math.sqrt(1-r*r);return o<.001?(t[0]=n[0],t[1]=n[1],t[2]=n[2]):(t[0]=n[0]/o,t[1]=n[1]/o,t[2]=n[2]/o),t[3]=a,t}function Mt(n,t,r,u,f,h){h=h||M();var s=p(u,r,a),l=p(f,r,o),d=J(t,l,i),q=v(s,d);if(q<1e-6)return null;var X=p(n,r,e),Y=v(X,d);if(Y<0||Y>q)return null;var Z=J(X,s,c),b=v(t,Z);if(b<0||Y+b>q)return null;var g=v(l,Z)/q;return h[0]=n[0]+g*t[0],h[1]=n[1]+g*t[1],h[2]=n[2]+g*t[2],h}function st(n,t,r,a,o){u[0]=t[0],u[1]=t[1],u[2]=t[2],u[3]=1,zn(n,u,f),a[0]=f[0],a[1]=f[1],a[2]=f[2],u[0]=r[0],u[1]=r[1],u[2]=r[2],jn(n,u,f),_(f),o[0]=f[0],o[1]=f[1],o[2]=f[2]}export{g as addVec3,y as addVec3Scalar,q as addVec4,X as addVec4Scalar,rt as angleAxisToQuaternion,tn as angleVec3,hn as compareMat4,A as compareVec3,Kn as composeMat4,ft as conjugateQuat,en as createMat3,cn as createMat4,h as createVec2,M as createVec3,s as createVec4,J as cross3Vec3,I as cross3Vec4,Ln as decomposeMat4,Un as determinantMat4,V as distVec2,S as distVec3,B as divScalarVec3,G as divScalarVec4,j as divVec3,D as divVec3Scalar,z as divVec4,E as divVec4Scalar,N as dotVec2,v as dotVec3,H as dotVec4,_n as eulerToQuat,dn as frustumMat4,sn as frustumMat4v,m as geometricMeanVec2,Xn as identityMat3,qn as identityMat4,$n as identityQuat,gn as inverseMat4,vt as inverseQuat,Yn as isIdentityMat4,T as lenVec2,Q as lenVec3,L as lenVec4,Wn as lerpMat4,U as lerpVec3,bn as lookAtMat4v,Vn as mat4ToEuler,nt as mat4ToQuat,pn as mulMat3,An as mulMat4,wn as mulMat4v4,at as mulQuats,b as mulVec2Scalar,Z as mulVec3Scalar,k as mulVec4,Y as mulVec4Scalar,l as negateVec3,d as negateVec4,ct as normalizeQuat,nn as normalizeVec2,_ as normalizeVec3,$ as normalizeVec4,ln as orthoMat4c,Mn as perspectiveMat4,ht as quatToAngleAxis,ut as quatToEuler,it as quatToMat4,et as quatToRotationMat4,Mt as rayTriangleIntersect,W as rcpVec3,Zn as rotationMat4v,In as scaleMat4c,Bn as scaleMat4v,En as scalingMat3v,Hn as scalingMat4c,Jn as scalingMat4s,Dn as scalingMat4v,Pn as setMat4Translation,P as sqLenVec2,O as sqLenVec3,K as sqLenVec4,C as subScalarVec4,F as subVec2,p as subVec3,w as subVec4,x as subVec4Scalar,Fn as transformPoint3,mn as transformPoint4,xn as transformPoints3,Cn as transformPositions3,kn as transformPositions4,st as transformRay,jn as transformVec3,zn as transformVec4,On as translateMat4c,Nn as translateMat4v,Rn as translationMat3v,Sn as translationMat4c,Tn as translationMat4s,Qn as translationMat4v,yn as transposeMat4,on as triangleNormal,ot as vec3ApplyQuat,rn as vec3FromMat4Scale,tt as vec3PairToQuat,un as vecToArray};\n//# sourceMappingURL=index.es.map\n","import type {FloatArrayParam} from \"@xeokit/math\";\n\nimport type {ViewLayer} from \"./ViewLayer\";\nimport type {SceneObject} from \"@xeokit/scene\";\nimport type {RendererViewObject} from \"./RendererViewObject\";\n\n/**\n * Represents and controls the visual state of a {@link @xeokit/scene!SceneModel | SceneObject} in\n * a {@link @xeokit/viewer!View |View's} canvas.\n *\n * ## Summary\n *\n * * Stored in {@link View.objects | View.objects} and {@link ViewLayer.objects | ViewLayer.objects}\n * * Viewer automatically creates one of these in each existing {@link @xeokit/viewer!View} for each {@link @xeokit/scene!SceneModel | SceneObject} created\n * * {@link SceneObject.layerId | SceneObject.layerId} determines which of the View's {@link ViewLayer | ViewLayers} to put the ViewObject in\n *\n * ## Overview\n *\n * Every View automatically maintains within itself a ViewObject for each {@link @xeokit/scene!SceneModel | SceneObject} that exists in the {@link @xeokit/viewer!Viewer}.\n *\n * Whenever we create a SceneObject, each View will automatically create a corresponding ViewObject within itself. When\n * we destroy a SceneObject, each View will automatically destroy its corresponding ViewObject. The ViewObjects in a View\n * are therefore a manifest of the ViewerObjects in the View.\n *\n * {@link ViewLayer}.\n */\nexport class ViewObject {\n\n    /**\n     * Unique ID of this ViewObject within {@link ViewLayer.objects}.\n     */\n    public readonly id: string;\n\n    /**\n     * The ViewLayer to which this ViewObject belongs.\n     */\n    public readonly layer: ViewLayer;\n\n    /**\n     * The corresponding {@link SceneObject}.\n     */\n    public readonly sceneObject: SceneObject;\n\n    /**\n     * The corresponding {@link RendererViewObject}.\n     * @internal\n     */\n    #rendererViewObject: RendererViewObject;\n\n    #state: {\n        visible: boolean;\n        culled: boolean;\n        pickable: boolean;\n        clippable: boolean;\n        collidable: boolean;\n        xrayed: boolean;\n        selected: boolean;\n        highlighted: boolean;\n        edges: boolean;\n        colorize: Float32Array;\n        colorized: boolean;\n        opacityUpdated: boolean;\n    };\n\n    /**\n     * @private\n     */\n    constructor(layer: ViewLayer, sceneObject: SceneObject, rendererViewObject: RendererViewObject) {\n\n        this.id = sceneObject.id;\n        this.layer = layer;\n        this.sceneObject = sceneObject;\n        this.#rendererViewObject = rendererViewObject;\n\n        this.#state = {\n            visible: true,\n            culled: false,\n            pickable: true,\n            clippable: true,\n            collidable: true,\n            xrayed: false,\n            selected: false,\n            highlighted: false,\n            edges: false,\n            colorize: new Float32Array(4),\n            colorized: false,\n            opacityUpdated: false,\n        };\n\n        this.#rendererViewObject.setVisible(this.layer.view.viewIndex, this.#state.visible);\n        this.layer.objectVisibilityUpdated(this, this.#state.visible, true);\n    }\n\n    /**\n     * Gets the World-space axis-aligned 3D boundary of this ViewObject.\n     */\n    get aabb(): FloatArrayParam {\n        return this.sceneObject.aabb;\n    }\n\n    /**\n     * Gets if this ViewObject is visible.\n     *\n     * * When {@link ViewObject.visible} is ````true```` the ViewObject will be registered by {@link ViewObject.id} in {@link ViewLayer.visibleObjects}.\n     * * Each ViewObject is only rendered when {@link ViewObject.visible} is ````true```` and {@link ViewObject.culled} is ````false````.\n     * * Use {@link ViewLayer.setObjectsVisible} to batch-update the visibility of ViewObjects, which fires a single event for the batch.\n     */\n    get visible(): boolean {\n        return this.#state.visible;\n    }\n\n    /**\n     * Sets if this ViewObject is visible.\n     *\n     * * When {@link ViewObject.visible} is ````true```` the ViewObject will be registered by {@link ViewObject.id} in {@link ViewLayer.visibleObjects}.\n     * * Each ViewObject is only rendered when {@link ViewObject.visible} is ````true```` and {@link ViewObject.culled} is ````false````.\n     * * Fires an \"objectVisibility\" event on associated {@link ViewLayer}s.\n     * * Use {@link ViewLayer.setObjectsVisible} to batch-update the visibility of ViewObjects, which fires a single event for the batch.\n     */\n    set visible(visible: boolean) {\n        if (visible === this.#state.visible) {\n            return;\n        }\n        this.#state.visible = visible;\n        this.#rendererViewObject.setVisible(this.layer.view.viewIndex, visible);\n        this.layer.objectVisibilityUpdated(this, visible, true);\n        this.layer.redraw();\n    }\n\n    /**\n     * Gets if this ViewObject is X-rayed.\n     *\n     * * When {@link ViewObject.xrayed} is ````true```` the ViewObject will be registered by {@link ViewObject.id} in {@link ViewLayer.xrayedObjects | ViewLayer.xrayedObjects}.\n     * * Use {@link ViewLayer.setObjectsXRayed} to batch-update the X-rayed state of ViewObjects.\n     */\n    get xrayed(): boolean {\n        return this.#state.xrayed;\n    }\n\n    /**\n     * Sets if this ViewObject is X-rayed.\n     *\n     * * When {@link ViewObject.xrayed} is ````true```` the ViewObject will be registered by {@link ViewObject.id} in {@link ViewLayer.xrayedObjects | ViewLayer.xrayedObjects}.\n     * * Use {@link ViewLayer.setObjectsXRayed} to batch-update the X-rayed state of ViewObjects.\n     */\n    set xrayed(xrayed: boolean) {\n        if (this.#state.xrayed === xrayed) {\n            return;\n        }\n        this.#state.xrayed = xrayed;\n        this.#rendererViewObject.setXRayed(this.layer.view.viewIndex, xrayed);\n        this.layer.objectXRayedUpdated(this, xrayed);\n        this.layer.redraw();\n    }\n\n    /**\n     * Gets if this ViewObject shows edges.\n     */\n    get edges(): boolean {\n        return this.#state.edges;\n    }\n\n    /**\n     * Sets if this ViewObject shows edges.\n     */\n    set edges(edges: boolean) {\n        if (this.#state.edges === edges) {\n            return;\n        }\n        this.#state.edges = edges;\n        this.#rendererViewObject.setEdges(this.layer.view.viewIndex, edges);\n        this.layer.redraw();\n    }\n\n    /**\n     * Gets if this ViewObject is highlighted.\n     *\n     * * When {@link ViewObject.highlighted} is ````true```` the ViewObject will be registered by {@link ViewObject.id} in {@link ViewLayer.highlightedObjects | ViewLayer.highlightedObjects}.\n     * * Use {@link ViewLayer.setObjectsHighlighted} to batch-update the highlighted state of ViewObjects.\n     */\n    get highlighted(): boolean {\n        return this.#state.highlighted;\n    }\n\n    /**\n     * Sets if this ViewObject is highlighted.\n     *\n     * * When {@link ViewObject.highlighted} is ````true```` the ViewObject will be registered by {@link ViewObject.id} in {@link ViewLayer.highlightedObjects | ViewLayer.highlightedObjects}.\n     * * Use {@link ViewLayer.setObjectsHighlighted} to batch-update the highlighted state of ViewObjects.\n     */\n    set highlighted(highlighted: boolean) {\n        if (highlighted === this.#state.highlighted) {\n            return;\n        }\n        this.#state.highlighted = highlighted;\n        this.#rendererViewObject.setHighlighted(\n            this.layer.view.viewIndex,\n            highlighted\n        );\n        this.layer.objectHighlightedUpdated(this, highlighted);\n        this.layer.redraw();\n    }\n\n    /**\n     * Gets if this ViewObject is selected.\n     *\n     * * When {@link ViewObject.selected} is ````true```` the ViewObject will be registered by {@link ViewObject.id} in {@link ViewLayer.selectedObjects | ViewLayer.selectedObjects}.\n     * * Use {@link ViewLayer.setObjectsSelected} to batch-update the selected state of ViewObjects.\n     */\n    get selected(): boolean {\n        return this.#state.selected;\n    }\n\n    /**\n     * Sets if this ViewObject is selected.\n     *\n     * * When {@link ViewObject.selected} is ````true```` the ViewObject will be registered by {@link ViewObject.id} in {@link ViewLayer.selectedObjects | ViewLayer.selectedObjects}.\n     * * Use {@link ViewLayer.setObjectsSelected} to batch-update the selected state of ViewObjects.\n     */\n    set selected(selected: boolean) {\n        if (selected === this.#state.selected) {\n            return;\n        }\n        this.#state.selected = selected;\n        this.#rendererViewObject.setSelected(this.layer.view.viewIndex, selected);\n        this.layer.objectSelectedUpdated(this, selected);\n        this.layer.redraw();\n    }\n\n    /**\n     * Gets if this ViewObject is culled.\n     *\n     * * The ViewObject is only rendered when {@link ViewObject.visible} is ````true```` and {@link ViewObject.culled} is ````false````.\n     * * Use {@link ViewLayer.setObjectsCulled} to batch-update the culled state of ViewObjects.\n     */\n    get culled(): boolean {\n        return this.#state.culled;\n    }\n\n    /**\n     * Sets if this ViewObject is culled.\n     *\n     * * The ViewObject is only rendered when {@link ViewObject.visible} is ````true```` and {@link ViewObject.culled} is ````false````.\n     * * Use {@link ViewLayer.setObjectsCulled} to batch-update the culled state of ViewObjects.\n     */\n    set culled(culled: boolean) {\n        if (culled === this.#state.culled) {\n            return;\n        }\n        this.#state.culled = culled;\n        this.layer.redraw();\n    }\n\n    /**\n     * Gets if this ViewObject is clippable.\n     *\n     * * Clipping is done by the {@link SectionPlane}s in {@link ViewLayer.sectionPlanes}.\n     * * Use {@link ViewLayer.setObjectsClippable} to batch-update the clippable state of ViewObjects.\n     */\n    get clippable(): boolean {\n        return this.#state.clippable;\n    }\n\n    /**\n     * Sets if this ViewObject is clippable.\n     *\n     * * Clipping is done by the {@link SectionPlane}s in {@link ViewLayer.sectionPlanes}.\n     * * Use {@link ViewLayer.setObjectsClippable} to batch-update the clippable state of ViewObjects.\n     */\n    set clippable(value: boolean) {\n        if (value === this.#state.clippable) {\n            return;\n        }\n        this.#state.clippable = value;\n        this.layer.redraw();\n    }\n\n    /**\n     * Gets if this ViewObject is included in boundary calculations.\n     *\n     * * When ````true````, the 3D World boundaries returned by {@link ViewLayer.aabb} will include this ViewObject's boundary.\n     * * The ViewObject's 3D boundary is held in {@link SceneObject.aabb}.\n     * * Use {@link ViewLayer.setObjectsCollidable} to batch-update the collidable state of ViewObjects.\n     */\n    get collidable(): boolean {\n        return this.#state.collidable;\n    }\n\n    /**\n     * Sets if this ViewObject included in boundary calculations.\n     *\n     * * When ````true````, the 3D World boundaries returned by {@link ViewLayer.aabb} will include this ViewObject's boundary.\n     * * The ViewObject's 3D boundary is held in {@link SceneObject.aabb}.\n     * * Use {@link ViewLayer.setObjectsCollidable} to batch-update the collidable state of ViewObjects.\n     */\n    set collidable(value: boolean) {\n        if (value === this.#state.collidable) {\n            return;\n        }\n        this.#state.collidable = value;\n        // this._setAABBDirty();\n        // this.layer._aabbDirty = true;\n    }\n\n    /**\n     * Gets if this ViewObject is pickable.\n     *\n     * * Picking is done with {@link ViewLayer.pick}.\n     * * Use {@link ViewLayer.setObjectsPickable} to batch-update the pickable state of ViewObjects.\n     */\n    get pickable(): boolean {\n        return this.#state.pickable;\n    }\n\n    /**\n     * Sets if this ViewObject is pickable.\n     *\n     * * Picking is done with {@link ViewLayer.pick}.\n     * * Use {@link ViewLayer.setObjectsPickable} to batch-update the pickable state of ViewObjects.\n     */\n    set pickable(pickable: boolean) {\n        if (this.#state.pickable === pickable) {\n            return;\n        }\n        this.#state.pickable = pickable;\n        // No need to trigger a render;\n        // state is only used when picking\n    }\n\n    /**\n     * Gets the RGB colorize color for this ViewObject.\n     *\n     * * Multiplies by rendered fragment colors.\n     * * Each element of the color is in range ````[0..1]````.\n     * * Use {@link ViewLayer.setObjectsColorized} to batch-update the colorized state of ViewObjects.\n     */\n    get colorize(): Float32Array {\n        return this.#state.colorize;\n    }\n\n    /**\n     * Sets the RGB colorize color for this ViewObject.\n     *\n     * * Multiplies by rendered fragment colors.\n     * * Each element of the color is in range ````[0..1]````.\n     * * Set to ````null```` or ````undefined```` to reset the colorize color to its default value of ````[1,1,1]````.\n     * * Use {@link ViewLayer.setObjectsColorized} to batch-update the colorized state of ViewObjects.\n     */\n    set colorize(value: FloatArrayParam | undefined | null) {\n        let colorize = this.#state.colorize;\n        if (value) {\n            colorize[0] = value[0];\n            colorize[1] = value[1];\n            colorize[2] = value[2];\n        } else {\n            colorize[0] = 1;\n            colorize[1] = 1;\n            colorize[2] = 1;\n        }\n        this.#state.colorized = !!value;\n        this.layer.objectColorizeUpdated(this, this.#state.colorized);\n        this.layer.redraw();\n    }\n\n    /**\n     * Gets the opacity factor for this ViewObject.\n     *\n     * * This is a factor in range ````[0..1]```` which multiplies by the rendered fragment alphas.\n     * * Use {@link ViewLayer.setObjectsOpacity} to batch-update the opacities of ViewObjects.\n     */\n    get opacity(): number {\n        return this.#state.colorize[3];\n    }\n\n    /**\n     * Sets the opacity factor for this ViewObject.\n     *\n     * * This is a factor in range ````[0..1]```` which multiplies by the rendered fragment alphas.\n     * * Set to ````null```` or ````undefined```` to reset the opacity to its default value of ````1````.\n     * * Use {@link ViewLayer.setObjectsOpacity} to batch-update the opacities of ViewObjects.\n     */\n    set opacity(opacity: number | undefined | null) {\n        let colorize = this.#state.colorize;\n        this.#state.opacityUpdated = opacity !== null && opacity !== undefined;\n        // @ts-ignore\n        colorize[3] = this.#state.opacityUpdated ? opacity : 1.0;\n        this.layer.objectOpacityUpdated(this, this.#state.opacityUpdated);\n        this.layer.redraw();\n    }\n\n    /**\n     * @private\n     */\n    _destroy() {\n        // Called by ViewLayer#destroyViewObjects\n        if (this.#state.visible) {\n            this.layer.objectVisibilityUpdated(this, false, false);\n        }\n        if (this.#state.xrayed) {\n            this.layer.objectXRayedUpdated(this, false);\n        }\n        if (this.#state.selected) {\n            this.layer.objectSelectedUpdated(this, false);\n        }\n        if (this.#state.highlighted) {\n            this.layer.objectHighlightedUpdated(this, false);\n        }\n        if (this.#state.colorized) {\n            this.layer.objectColorizeUpdated(this, false);\n        }\n        if (this.#state.opacityUpdated) {\n            this.layer.objectOpacityUpdated(this, false);\n        }\n        this.layer.redraw();\n    }\n}\n\n","import {EventDispatcher} from \"strongly-typed-events\";\nimport {Component, EventEmitter} from \"@xeokit/core\";\n\nimport * as matrix from '@xeokit/matrix';\n\n\nimport type {View} from \"./View\";\nimport type {FloatArrayParam} from \"@xeokit/math\";\n\n\n/**\n *  An arbitrarily-aligned World-space clipping plane.\n *\n * ## Summary\n *\n * * Belongs to a {@link @xeokit/viewer!View}.\n * * Slices portions off {@link ViewObject | ViewObjects} to create cross-section views or reveal interiors.\n * * Registered by {@link SectionPlane.id} in {@link View.sectionPlanes}.\n * * Indicates its World-space position in {@link SectionPlane.pos} and orientation vector in {@link SectionPlane.dir}.\n * * Discards elements from the half-space in the direction of {@link SectionPlane.dir}.\n * * Can be be enabled or disabled via {@link SectionPlane.active}.\n *\n * ## Usage\n *\n * In the example below, we'll create two SectionPlanes to slice a model loaded from glTF. Note that we could also create them\n * using a {@link SectionPlanesPlugin}.\n *\n * ````javascript\n * import {Viewer, GLTFLoaderPlugin, SectionPlane} from \"xeokit-viewer.es.js\";\n *\n * const viewer = new Viewer({\n *      canvasId: \"myCanvas\"\n * });\n *\n * const gltfLoaderPlugin = new GLTFModelsPlugin(viewer, {\n *      id: \"GLTFModels\"\n * });\n *\n * const model = gltfLoaderPlugin.load({\n *      id: \"myModel\",\n *      src: \"./models/gltf/mygltfmodel.gltf\"\n * });\n *\n * // Create a SectionPlane on negative diagonal\n * const sectionPlane1 = new SectionPlane(viewer.scene, {\n *     pos: [1.0, 1.0, 1.0],\n *     dir: [-1.0, -1.0, -1.0],\n *     active: true\n * }),\n *\n * // Create a SectionPlane on positive diagonal\n * const sectionPlane2 = new SectionPlane(viewer.scene, {\n *     pos: [-1.0, -1.0, -1.0],\n *     dir: [1.0, 1.0, 1.0],\n *     active: true\n * });\n * ````\n */\nclass SectionPlane extends Component {\n\n    /**\n     ID of this SectionPlane, unique within the {@link @xeokit/viewer!View}.\n     */\n    declare public id: string;\n\n    /**\n     * The View to which this DirLight belongs.\n     *\n     * @property view\n     * @type {View}\n     * @final\n     */\n    public readonly view: View;\n\n    /**\n     * Emits an event each time {@link SectionPlane.pos} changes.\n     *\n     * @event\n     */\n    readonly onPos: EventEmitter<SectionPlane, FloatArrayParam>;\n\n    /**\n     * Emits an event each time {@link SectionPlane.dir} changes.\n     *\n     * @event\n     */\n    readonly onDir: EventEmitter<SectionPlane, FloatArrayParam>;\n\n    /**\n     * Emits an event each time {@link SectionPlane.active} changes.\n     *\n     * @event\n     */\n    readonly onActive: EventEmitter<SectionPlane, boolean>;\n\n    #state: {\n        pos: Float64Array;\n        active: boolean;\n        dist: number;\n        dir: Float32Array\n    };\n\n    /**\n     * @private\n     * @constructor\n     */\n    constructor(view: View, cfg: {\n        pos?: FloatArrayParam;\n        active?: boolean;\n        dir?: FloatArrayParam\n    } = {}) {\n\n        super(view, cfg);\n\n        this.view = view;\n\n        this.#state = {\n            active: cfg.active !== false,\n            pos: new Float64Array(cfg.pos || [0, 0, 0]),\n            dir: new Float32Array(cfg.pos || [0, 0, -1]),\n            dist: 0\n        };\n\n        this.onPos = new EventEmitter(new EventDispatcher<SectionPlane, FloatArrayParam>());\n        this.onDir = new EventEmitter(new EventDispatcher<SectionPlane, FloatArrayParam>());\n        this.onActive = new EventEmitter(new EventDispatcher<SectionPlane, boolean>());\n    }\n\n    /**\n     * Gets if this SectionPlane is active or not.\n     *\n     * Default value is ````true````.\n     *\n     * @returns Returns ````true```` if active.\n     */\n    get active(): boolean {\n        return this.#state.active;\n    }\n\n    /**\n     * Sets if this SectionPlane is active or not.\n     *\n     * Default value is ````true````.\n     *\n     * @param value Set ````true```` to activate else ````false```` to deactivate.\n     */\n    set active(value: boolean) {\n        if (this.#state.active === value) {\n            return;\n        }\n        this.#state.active = value;\n        this.view.redraw();\n        this.onActive.dispatch(this, this.#state.active);\n    }\n\n    /**\n     * Gets the World-space position of this SectionPlane's plane.\n     *\n     * Default value is ````[0, 0, 0]````.\n     *\n     * @returns  Current position.\n     */\n    get pos(): Float64Array {\n        return this.#state.pos;\n    }\n\n    /**\n     * Sets the World-space position of this SectionPlane's plane.\n     *\n     * Default value is ````[0, 0, 0]````.\n     *\n     * @param value New position.\n     */\n    set pos(value: FloatArrayParam) {\n        this.#state.pos.set(value);\n        this.#state.dist = (-matrix.dotVec3(this.#state.pos, this.#state.dir));\n        this.onPos.dispatch(this, this.#state.pos);\n    }\n\n    /**\n     * Gets the direction of this SectionPlane's plane.\n     *\n     * Default value is ````[0, 0, -1]````.\n     *\n     * @returns value Current direction.\n     */\n    get dir(): Float32Array {\n        return this.#state.dir;\n    }\n\n    /**\n     * Sets the direction of this SectionPlane's plane.\n     *\n     * Default value is ````[0, 0, -1]````.\n     *\n     * @param value New direction.\n     */\n    set dir(value: FloatArrayParam) {\n        this.#state.dir.set(value);\n        this.#state.dist = (-matrix.dotVec3(this.#state.pos, this.#state.dir));\n        this.view.redraw();\n        this.onDir.dispatch(this, this.#state.dir);\n    }\n\n    /**\n     * Gets this SectionPlane's distance to the origin of the World-space coordinate system.\n     *\n     * This is the dot product of {@link SectionPlane.pos} and {@link SectionPlane.dir} and is automatically re-calculated\n     * each time either of two properties are updated.\n     *\n     * @returns Distance to the origin of the World-space coordinate system.\n     */\n    get dist(): number {\n        return this.#state.dist;\n    }\n\n    /**\n     * Inverts the direction of {@link SectionPlane.dir}.\n     */\n    flipDir() {\n        const dir = this.#state.dir;\n        dir[0] *= -1.0;\n        dir[1] *= -1.0;\n        dir[2] *= -1.0;\n        this.#state.dist = (-matrix.dotVec3(this.#state.pos, this.#state.dir));\n        this.onDir.dispatch(this, this.#state.dir);\n        this.view.redraw();\n    }\n\n    /**\n     * Destroys this SectionPlane.\n     */\n    destroy() {\n        this.onPos.clear();\n        this.onActive.clear;\n        this.onDir.clear();\n        super.destroy();\n    }\n}\n\nexport {SectionPlane};\n","import type {View} from \"./View\";\nimport {CentimetersUnit, FeetUnit, InchesUnit, MetersUnit, MillimetersUnit, YardsUnit} from \"@xeokit/constants\";\nimport {Component, EventEmitter} from \"@xeokit/core\";\nimport type {FloatArrayParam} from \"@xeokit/math\";\nimport {EventDispatcher} from \"strongly-typed-events\";\nimport {createVec3} from \"@xeokit/matrix\";\n\n\nconst unitsInfo = {\n    [MetersUnit]: {\n        abbrev: \"m\"\n    },\n    [CentimetersUnit]: {\n        abbrev: \"cm\"\n    },\n    [MillimetersUnit]: {\n        abbrev: \"mm\"\n    },\n    [YardsUnit]: {\n        abbrev: \"yd\"\n    },\n    [FeetUnit]: {\n        abbrev: \"ft\"\n    },\n    [InchesUnit]: {\n        abbrev: \"in\"\n    }\n};\n\n/**\n * Configures its {@link @xeokit/viewer!View}'s measurement unit and mapping between the Real-space and World-space 3D Cartesian coordinate systems.\n *\n *\n * ## Summary\n *\n * * Located at {@link View.metrics}.\n * * {@link Metrics.units} configures the Real-space unit type, which is {@link MetersUnit} by default.\n * * {@link Metrics.scale} configures the number of Real-space units represented by each unit within the World-space 3D coordinate system. This is ````1.0```` by default.\n * * {@link Metrics.origin} configures the 3D Real-space origin, in current Real-space units, at which this {@link @xeokit/viewer!View}'s World-space coordinate origin sits, This is ````[0,0,0]```` by default.\n *\n * ## Usage\n *\n * ````JavaScript\n * import {Viewer, constants} from \"xeokit-viewer.es.js\";\n *\n * const viewer = new Viewer();\n *\n * const view1 = myViewer.createView({\n *      id: \"myView\",\n *      canvasId: \"myCanvas1\"\n * });\n *\n * const metrics = view1.metrics;\n *\n * metrics.units = MetersUnit;\n * metrics.scale = 10.0;\n * metrics.origin = [100.0, 0.0, 200.0];\n * ````\n */\nclass Metrics extends Component {\n\n    #units: number;\n    #scale: number;\n    #origin: FloatArrayParam;\n\n    /**\n     * Emits an event each time {@link Metrics.units} changes.\n     *\n     * @event\n     */\n    readonly onUnits: EventEmitter<Metrics, number>;\n\n    /**\n     * Emits an event each time {@link Metrics.scale} changes.\n     *\n     * @event\n     */\n    readonly onScale: EventEmitter<Metrics, number>;\n\n    /**\n     * Emits an event each time {@link Metrics.origin} changes.\n     *\n     * @event\n     */\n    readonly onOrigin: EventEmitter<Metrics, FloatArrayParam>;\n\n\n    /**\n     * @private\n     */\n    constructor(view: View, cfg: {\n        origin?: FloatArrayParam;\n        scale?: number;\n        units?: number\n    } = {\n        units: MetersUnit,\n        scale: 1.0,\n        origin: [1, 1, 1]\n    }) {\n\n        super(view, cfg);\n\n        this.onUnits = new EventEmitter(new EventDispatcher<Metrics, number>());\n        this.onScale = new EventEmitter(new EventDispatcher<Metrics, number>());\n        this.onOrigin = new EventEmitter(new EventDispatcher<Metrics, FloatArrayParam>());\n\n        this.#units = MetersUnit;\n        this.#scale = 1.0;\n        this.#origin = createVec3([0, 0, 0]);\n\n        this.units = cfg.units;\n        this.scale = cfg.scale;\n        this.origin = cfg.origin;\n    }\n\n    /**\n     * Gets info about the supported Real-space unit types.\n     *\n     * With {@link constants} indicating each unit type, the info will be:\n     *\n     * ````javascript\n     * {\n     *     [MetersUnit]: {\n     *         abbrev: \"m\"\n     *     },\n     *     [CentimetersUnit]: {\n     *         abbrev: \"cm\"\n     *     },\n     *     [MillimetersUnit]: {\n     *         abbrev: \"mm\"\n     *     },\n     *     [YardsUnit]: {\n     *         abbrev: \"yd\"\n     *     },\n     *     [FeetUnit]: {\n     *         abbrev: \"ft\"\n     *     },\n     *     [InchesUnit]: {\n     *         abbrev: \"in\"\n     *     }\n     * }\n     * ````\n     *\n     * @type {*}\n     */\n    get unitsInfo(): {} {\n        return unitsInfo;\n    }\n\n    /**\n     * Gets the {@link @xeokit/viewer!View}'s Real-space unit type.\n     */\n    get units(): number {\n        return this.#units;\n    }\n\n    /**\n     * Sets the {@link @xeokit/viewer!View}'s Real-space unit type.\n     *\n     * Accepted values are {@link MetersUnit}, {@link CentimetersUnit}, {@link MillimetersUnit}, {@link YardsUnit}, {@link FeetUnit} and {@link InchesUnit}.\n     */\n    set units(value: number | undefined) {\n        if (!value) {\n            value = MetersUnit;\n        }\n        // @ts-ignore\n        const info = unitsInfo[value];\n        if (!info) {\n            this.error(\"Unsupported value for 'units': \" + value + \" defaulting to MetersUnit\");\n            value = MetersUnit;\n        }\n        this.#units = value;\n        this.onUnits.dispatch(this, this.#units);\n    }\n\n    /**\n     * Gets the number of Real-space units represented by each unit of the {@link @xeokit/viewer!View}'s World-space coordinate system.\n     */\n    get scale(): number {\n        return this.#scale;\n    }\n\n    /**\n     * Sets the number of Real-space units represented by each unit of the {@link @xeokit/viewer!View}'s World-space coordinate system.\n     *\n     * For example, if {@link Metrics.units} is {@link MetersUnit}, and there are ten meters per World-space coordinate system unit, then ````scale```` would have a value of ````10.0````.\n     */\n    set scale(value: number | undefined) {\n        value = value || 1;\n        if (value <= 0) {\n            this.error(\"scale value should be larger than zero\");\n            return;\n        }\n        this.#scale = value;\n        this.onScale.dispatch(this, this.#scale);\n    }\n\n    /**\n     * Gets the 3D Real-space origin, in Real-space units, at which this {@link @xeokit/viewer!View}'s World-space coordinate origin ````[0,0,0]```` sits.\n     */\n    get origin(): FloatArrayParam {\n        return this.#origin;\n    }\n\n    /**\n     * Sets the Real-space 3D origin, in Real-space units, at which this {@link @xeokit/viewer!View}'s World-space coordinate origin ````[0,0,0]```` sits.\n     */\n    set origin(value: FloatArrayParam | undefined) {\n        if (!value) {\n            this.#origin[0] = 0;\n            this.#origin[1] = 0;\n            this.#origin[2] = 0;\n            return;\n        }\n        this.#origin[0] = value[0];\n        this.#origin[1] = value[1];\n        this.#origin[2] = value[2];\n        this.onOrigin.dispatch(this, this.#origin);\n    }\n\n    /**\n     * Converts a 3D position from World-space to Real-space.\n     *\n     * This is equivalent to ````realPos = #origin + (worldPos * #scale)````.\n     *\n     * @param worldPos World-space 3D position, in World coordinate system units.\n     * @param [realPos] Destination for Real-space 3D position.\n     * @returns  Real-space 3D position, in units indicated by {@link Metrics#units}.\n     */\n    worldToRealPos(worldPos: FloatArrayParam, realPos: FloatArrayParam = createVec3()): FloatArrayParam {\n        realPos[0] = this.#origin[0] + (this.#scale * worldPos[0]);\n        realPos[1] = this.#origin[1] + (this.#scale * worldPos[1]);\n        realPos[2] = this.#origin[2] + (this.#scale * worldPos[2]);\n        return realPos;\n    }\n\n    /**\n     * Converts a 3D position from Real-space to World-space.\n     *\n     * This is equivalent to ````worldPos = (worldPos - #origin) / #scale````.\n     *\n     * @param realPos Real-space 3D position.\n     * @param [worldPos] Destination for World-space 3D position.\n     * @returns  World-space 3D position.\n     */\n    realToWorldPos(realPos: FloatArrayParam, worldPos: FloatArrayParam = createVec3()): FloatArrayParam {\n        worldPos[0] = (realPos[0] - this.#origin[0]) / this.#scale;\n        worldPos[1] = (realPos[1] - this.#origin[1]) / this.#scale;\n        worldPos[2] = (realPos[2] - this.#origin[2]) / this.#scale;\n        return worldPos;\n    }\n\n    /**\n     * @private\n     */\n    destroy() {\n        super.destroy();\n        this.onUnits.clear();\n        this.onScale.clear();\n        this.onOrigin.clear();\n    }\n}\n\nexport {Metrics};","import type {View} from \"./View\";\nimport {Component} from \"@xeokit/core\";\nimport {CustomProjectionType, FrustumProjectionType, QualityRender} from \"@xeokit/constants\";\n\n/**\n * Configures Scalable Ambient Obscurance (SAO) for a {@link @xeokit/viewer!View}.\n */\nexport class SAO extends Component {\n\n    /**\n     * The View to which this SAO belongs.\n     */\n    public readonly view: View;\n\n    #state: {\n        renderModes: number[];\n        intensity: number;\n        minResolution: number;\n        blendFactor: number;\n        numSamples: number;\n        bias: number;\n        scale: number;\n        blur: boolean;\n        blendCutoff: number;\n        enabled: boolean;\n        kernelRadius: number;\n    }\n\n    /** @private */\n    constructor(view: View, params: any) {\n\n        super(view, params);\n\n        this.view = view;\n\n        this.#state = {\n            renderModes: [QualityRender],\n            enabled: params.enabled !== false,\n            kernelRadius: params.kernelRadius || 100.0,\n            intensity: (params.intensity !== undefined) ? params.intensity : 0.15,\n            bias: (params.bias !== undefined) ? params.bias : 0.5,\n            scale: (params.scale !== undefined) ? params.scale : 1.0,\n            minResolution: (params.minResolution !== undefined) ? params.minResolution : 0.0,\n            numSamples: (params.numSamples !== undefined) ? params.numSamples : 10,\n            blur: !!(params.blur),\n            blendCutoff: (params.blendCutff !== undefined) ? params.blendCutoff : 0.3,\n            blendFactor: (params.blendFactor !== undefined) ? params.blendFactor : 1.0\n        };\n    }\n\n    /**\n     * Gets which rendering modes in which to render SAO.\n     *\n     * Accepted modes are {@link QualityRender} and {@link FastRender}.\n     *\n     * Default value is [{@link QualityRender}].\n     */\n    get renderModes(): number[] {\n        return this.#state.renderModes;\n    }\n\n    /**\n     * Sets which rendering modes in which to render SAO.\n     *\n     * Accepted modes are {@link QualityRender} and {@link FastRender}.\n     *\n     * Default value is [{@link QualityRender}].\n     */\n    set renderModes(value: number[]) {\n        this.#state.renderModes = value;\n        this.view.redraw();\n    }\n\n    /**\n     * Gets whether or not SAO is supported by this browser and GPU.\n     *\n     * Even when enabled, SAO will only work if supported.\n     */\n    get supported(): boolean {\n        return this.view.viewer.renderer.getSAOSupported();\n    }\n\n    /**\n     * Gets whether SAO is enabled for the {@link @xeokit/viewer!View}.\n     *\n     * Even when enabled, SAO will only apply if supported.\n     *\n     * Default value is ````false````.\n     */\n    get enabled(): boolean {\n        return this.#state.enabled;\n    }\n\n    /**\n     * Sets whether SAO is enabled for the {@link @xeokit/viewer!View}.\n     *\n     * Even when enabled, SAO will only work if supported.\n     *\n     * Default value is ````false````.\n     */\n    set enabled(value: boolean) {\n        value = !!value;\n        if (this.#state.enabled === value) {\n            return;\n        }\n        this.#state.enabled = value;\n        this.view.redraw();\n    }\n\n    /**\n     * Returns true if SAO is currently possible, where it is supported, enabled, and the current view state is compatible.\n     * Called internally by renderer logic.\n     * @private\n     */\n    get possible(): boolean {\n        if (!this.supported) {\n            return false;\n        }\n        if (!this.#state.enabled) {\n            return false;\n        }\n        const projectionType = this.view.camera.projectionType;\n        if (projectionType === CustomProjectionType) {\n            return false;\n        }\n        if (projectionType === FrustumProjectionType) {\n            return false;\n        }\n        return true;\n    }\n\n    /**\n     * Gets the maximum area that SAO takes into account when checking for possible occlusion for each fragment.\n     *\n     * Default value is ````100.0````.\n     */\n    get kernelRadius(): number {\n        return this.#state.kernelRadius;\n    }\n\n    /**\n     * Sets the maximum area that SAO takes into account when checking for possible occlusion for each fragment.\n     *\n     * Default value is ````100.0````.\n     */\n    set kernelRadius(value: number) {\n        if (value === undefined || value === null) {\n            value = 100.0;\n        }\n        if (this.#state.kernelRadius === value) {\n            return;\n        }\n        this.#state.kernelRadius = value;\n        this.view.redraw();\n    }\n\n    /**\n     * Gets the degree of darkening (ambient obscurance) produced by the SAO effect.\n     *\n     * Default value is ````0.15````.\n     */\n    get intensity(): number {\n        return this.#state.intensity;\n    }\n\n    /**\n     * Sets the degree of darkening (ambient obscurance) produced by the SAO effect.\n     *\n     * Default value is ````0.15````.\n     */\n    set intensity(value: number) {\n        if (value === undefined || value === null) {\n            value = 0.15;\n        }\n        if (this.#state.intensity === value) {\n            return;\n        }\n        this.#state.intensity = value;\n        this.view.redraw();\n    }\n\n    /**\n     * Gets the SAO bias.\n     *\n     * Default value is ````0.5````.\n     */\n    get bias(): number {\n        return this.#state.bias;\n    }\n\n    /**\n     * Sets the SAO bias.\n     *\n     * Default value is ````0.5````.\n     */\n    set bias(value: number) {\n        if (value === undefined || value === null) {\n            value = 0.5;\n        }\n        if (this.#state.bias === value) {\n            return;\n        }\n        this.#state.bias = value;\n        this.view.redraw();\n    }\n\n    /**\n     * Gets the SAO occlusion scale.\n     *\n     * Default value is ````1.0````.\n     */\n    get scale(): number {\n        return this.#state.scale;\n    }\n\n    /**\n     * Sets the SAO occlusion scale.\n     *\n     * Default value is ````1.0````.\n     */\n    set scale(value: number) {\n        if (value === undefined || value === null) {\n            value = 1.0;\n        }\n        if (this.#state.scale === value) {\n            return;\n        }\n        this.#state.scale = value;\n        this.view.redraw();\n    }\n\n    /**\n     * Gets the SAO minimum resolution.\n     *\n     * Default value is ````0.0````.\n     */\n    get minResolution(): number {\n        return this.#state.minResolution;\n    }\n\n    /**\n     * Sets the SAO minimum resolution.\n     *\n     * Default value is ````0.0````.\n     */\n    set minResolution(value: number) {\n        if (value === undefined || value === null) {\n            value = 0.0;\n        }\n        if (this.#state.minResolution === value) {\n            return;\n        }\n        this.#state.minResolution = value;\n        this.view.redraw();\n    }\n\n    /**\n     * Gets the number of SAO samples.\n     *\n     * Default value is ````10````.\n     */\n    get numSamples(): number {\n        return this.#state.numSamples;\n    }\n\n    /**\n     * Sets the number of SAO samples.\n     *\n     * Default value is ````10````.\n     *\n     * Update this sparingly, since it causes a shader recompile.\n     */\n    set numSamples(value: number) {\n        if (value === undefined || value === null) {\n            value = 10;\n        }\n        if (this.#state.numSamples === value) {\n            return;\n        }\n        this.#state.numSamples = value;\n        this.view.redraw();\n    }\n\n    /**\n     * Gets whether Guassian blur is enabled.\n     *\n     * Default value is ````true````.\n     */\n    get blur(): boolean {\n        return this.#state.blur;\n    }\n\n    /**\n     * Sets whether Guassian blur is enabled.\n     *\n     * Default value is ````true````.\n     */\n    set blur(value: boolean) {\n        value = (value !== false);\n        if (this.#state.blur === value) {\n            return;\n        }\n        this.#state.blur = value;\n        this.view.redraw();\n    }\n\n    /**\n     * Gets the SAO blend cutoff.\n     *\n     * Default value is ````0.3````.\n     *\n     * Normally you don't need to alter this.\n     */\n    get blendCutoff(): number {\n        return this.#state.blendCutoff;\n    }\n\n    /**\n     * Sets the SAO blend cutoff.\n     *\n     * Default value is ````0.3````.\n     *\n     * Normally you don't need to alter this.\n     */\n    set blendCutoff(value: number) {\n        if (value === undefined || value === null) {\n            value = 0.3;\n        }\n        if (this.#state.blendCutoff === value) {\n            return;\n        }\n        this.#state.blendCutoff = value;\n        this.view.redraw();\n    }\n\n    /**\n     * Gets the SAO blend scale.\n     *\n     * Default value is ````1.0````.\n     *\n     * Normally you don't need to alter this.\n     */\n    get blendFactor(): number {\n        return this.#state.blendFactor;\n    }\n\n    /**\n     * Sets the SAO blend factor.\n     *\n     * Default value is ````1.0````.\n     *\n     * Normally you don't need to alter this.\n     */\n    set blendFactor(value: number) {\n        if (value === undefined || value === null) {\n            value = 1.0;\n        }\n        if (this.#state.blendFactor === value) {\n            return;\n        }\n        this.#state.blendFactor = value;\n        this.view.redraw();\n    }\n\n    /**\n     * @private\n     */\n    destroy() {\n        super.destroy();\n    }\n}\n","import {Component} from \"@xeokit/core\";\nimport type {View} from \"./View\";\n\n\n/**\n * Configures the shape of \"lines\" geometry primitives.\n *\n * * Located at {@link View#linesMaterial}.\n */\nclass LinesMaterial extends Component {\n\n    /**\n     * The View to which this LinesMaterial belongs.\n     */\n    public readonly view: View;\n\n    #state: {\n        lineWidth: number\n    };\n\n    /**\n     * @private\n     */\n    constructor(view: View, options: { lineWidth: number } = {lineWidth: 1}) {\n\n        super(view, options);\n\n        this.view = view;\n\n        this.#state = {\n            lineWidth: (options.lineWidth !== undefined && options.lineWidth !== null) ? options.lineWidth : 1\n        };\n    }\n\n    /**\n     * Sets line width.\n     *\n     * Default value is ````1```` pixels.\n     */\n    set lineWidth(value: number) {\n        this.#state.lineWidth = value || 1;\n        this.view.redraw();\n    }\n\n    /**\n     * Gets the line width.\n     *\n     * Default value is ````1```` pixels.\n     */\n    get lineWidth(): number {\n        return this.#state.lineWidth;\n    }\n}\n\nexport {LinesMaterial};","import {EventDispatcher} from \"strongly-typed-events\";\nimport {Component, EventEmitter} from \"@xeokit/core\";\n\nimport {ViewObject} from \"./ViewObject\";\nimport type {Viewer} from \"./Viewer\";\nimport type {View} from \"./View\";\nimport type {Scene, SceneModel} from \"@xeokit/scene\";\n\n\n\n/**\n * A layer of {@link ViewObject | ViewObjects} in a {@link @xeokit/viewer!View}.\n *\n * See {@link \"@xeokit/viewer\"} for usage.\n *\n * ## Summary\n *\n * * Automatically stores a {@link ViewObject} for each existing {@link RendererObject} that has a matching {@link RendererObject.layerId | ViewerObject.layerId}\n * * Useful for segreggating {@link ViewObject | ViewObjects} into layers\n * * Created automatically or manually (see {@link View.createLayer | View.createLayer})\n * * Stored in {@link View.layers | View.layers}\n *\n * ## Overview\n *\n * ViewLayers organize a {@link View |View's} {@link ViewObject | ViewObjects} into layers, according to which aspects of\n * the view they represent. They make it easier for us to focus our interactions on the ViewObjects that are relevant\n * to the particular aspects we're interested in.\n *\n * ### Typical use case: segregating model objects from environment objects\n *\n * A typical use case for this feature is to group environmental {@link ViewObject | ViewObjects} (e.g. ground, skybox) in an \"environment\" ViewLayer,\n * and group model ViewObjects in a \"model\" ViewLayer. Then we can focus our model interactions (show, hide, highlight,\n * save/load BCF viewpoints, etc.) on the ViewObjects in the \"model\" ViewLayer, without involving the \"environment\"\n * ViewObjects at all, which are effectively in the background. We can basically ignore the environment objects as we\n * do various batch operations on our model objects, i.e. \"X-ray all\", \"X-ray everything except for walls\" and so on.\n *\n * ### Automatic ViewLayers\n *\n * By default, each {@link @xeokit/viewer!View} automatically lazy-creates ViewLayers within itself as required. As {@link RendererObject | ViewerObjects} appear in the\n * {@link @xeokit/viewer!Viewer}, {@link ViewObject | ViewObjects} and Viewlayers magically appear in each existing View.\n *\n * Recall that, whenever a {@link RendererObject} is created, each existing {@link @xeokit/viewer!View} will automatically create a\n * corresponding {@link ViewObject} to represent and control that ViewerObject's appearance within the View's canvas.\n *\n * If the {@link RendererObject} also happens to have a value set on its {@link RendererObject.layerId} ID property, then the View\n * will also automatically ensure that it contains a matching {@link ViewLayer}, and will register the new ViewObject\n * in that ViewLayer. Note that each ViewObject can belong to a maximum of one ViewLayer.\n *\n * When a {@link @xeokit/viewer!View} automatically creates Viewlayers, it will also automatically destroy them again whenever\n * their {@link RendererObject | ViewerObjects} have all been destroyed.\n *\n * ### Manual ViewLayers\n *\n * We can configure a {@link @xeokit/viewer!View} to **not** automatically create ViewLayers, and instead rely on us to manually create them.\n *\n * When we do that, the View will only create the {@link ViewObject | ViewObjects} within itself for the ViewLayers that we created. The\n * View will ignore all ViewerObjects that don't have {@link RendererObject.layerId} values that match the IDs of our\n * manually-created ViewLayers.\n *\n * This feature is useful for ensuring that aspect-focused Views don't contain huge numbers of unused ViewObjects for\n * ViewerObjects that they never need to show.\n *\n * When we manually create ViewLayers like this, then the View will not automatically destroy them whenever\n * their {@link RendererObject | ViewerObjects} have all been destroyed. This keeps the ViewLayers around, in case\n * we create matching ViewerObjects again in future.\n *\n * ## Examples\n *\n * ### Exampe 1: Automatic ViewLayers\n *\n * Create a {@link @xeokit/viewer!Viewer}:\n *\n *````javascript\n * import {Viewer} from \"@xeokit/viewer\";\n *\n * const myViewer = new Viewer({\n *      id: \"myViewer\"\n * });\n *````\n *\n * Create a {@link @xeokit/viewer!View}, with the default setting of ````false```` for {@link ViewParams.autoLayers}:\n *\n * ````javascript\n * const view1 = myViewer.createView({\n *      id: \"myView\",\n *      canvasId: \"myView1\",\n *      autoLayers: true // <<----------- Default\n * });\n *\n * view1.camera.eye = [-3.933, 2.855, 27.018];\n * view1.camera.look = [4.400, 3.724, 8.899];\n * view1.camera.up = [-0.018, 0.999, 0.039];\n * ````\n *\n * Next, we'll create a {@link @xeokit/scene!SceneModel | SceneModel} containing two model {@link RendererObject | ViewerObjects} that represent a building\n * foundation and walls, along with two environmental ViewerObjects that represent a skybox and ground plane.\n *\n * The ground and skybox ViewerObjects specify that their {@link ViewObject | ViewObjects} belong\n * to \"environment\" ViewLayers, while the model ViewerObjects specify that their ViewObjects belong to \"model\" ViewLayers.\n *\n * ````javascript\n * const sceneModel = myViewer.scene.createModel({\n *      id: \"myModel\"\n * });\n *\n * // (calls to SceneModel createGeometry and\n * // createMesh omitted for brevity)\n *\n * sceneModel.createObject({\n *      id: \"ground\",\n *      meshIds: [\"groundMesh}],\n *      layerId: \"environment\"\n * });\n *\n * sceneModel.createObject({\n *      id: \"skyBox\",\n *      meshIds: [\"skyBoxMesh}],\n *      layerId: \"environment\"\n * });\n *\n * sceneModel.createObject({\n *      id: \"houseFoundation\",\n *      meshIds: [\"myMesh}],\n *      layerId: \"model\"\n * });\n *\n * sceneModel.createObject({\n *      id: \"houseWalls\",\n *      meshIds: [\"myMesh}],\n *      layerId: \"model\"\n * });\n *\n * sceneModel.build();\n * ````\n *\n * Our {@link @xeokit/viewer!View} has now automatically created an \"environment\" {@link ViewLayer}, which contains {@link ViewObject | ViewObjects} for the skybox and\n * ground plane ViewerObjects, and a \"model\" ViewLayer, which contains ViewObjects for the house foundation and walls.\n *\n * We can now batch-update the ViewObjects in each ViewLayer independently. As mentioned, this is useful when we need to ignore things\n * like UI or environmental objects in batch-updates, BCF viewpoints etc.\n *\n * ````javascript\n * // viewer.objects contains four ViewerObjects with IDs \"ground\", \"skyBox\", \"houseFoundation\" and \"houseWalls\"\n *\n * // viewer.views.view1.objects contains four ViewObjects with IDs \"ground\", \"skyBox\", \"houseFoundation\" and \"houseWalls\"\n *\n * // viewer.views.view1.layers contains two ViewLayers with IDs \"environment\" and \"model\"\n *\n * const environmentLayer = view1.layers[\"environment\"];\n * environmentLayer.setObjectsVisible(environmentLayer.objectIds, true);\n\n * const modelLayer = view1.layers[\"model\"];\n * modelLayer.setObjectsVisible(modelLayer.objectIds, true);\n * ````\n *\n * ### Example 2: Manual ViewLayers\n *\n * Create a {@link @xeokit/viewer!Viewer}:\n *\n * ````javascript\n * import {Viewer} from \"@xeokit/viewer\";\n *\n * const myViewer = new Viewer({\n *      id: \"myViewer\"\n * });\n * ````\n *\n * Create a {@link @xeokit/viewer!View}, this time with ````false```` for {@link ViewParams.autoLayers}, in order to **not**\n * automatically create ViewLayers on demand:\n *\n * ````javascript\n * const view1 = myViewer.createView({\n *      id: \"myView\",\n *      canvasId: \"myCanvas1\",\n *      autoLayers: false // <<----------- Override default\n * });\n *\n * view1.camera.eye = [-3.933, 2.855, 27.018];\n * view1.camera.look = [4.400, 3.724, 8.899];\n * view1.camera.up = [-0.018, 0.999, 0.039];\n * ````\n *\n * We'll manually create the \"model\" ViewLayer, and won't create an \"environment\" ViewLayer:\n *\n * ````javascript\n * const modelViewLayer = view1.createLayer({\n *     id: \"model\",\n *     visible: true\n * });\n * ````\n *\n * As we did in the previous example, we'll now create a {@link @xeokit/scene!SceneModel | SceneModel} containing two model\n * {@link RendererObject | ViewerObjects} that represent a building foundation and walls, along with two environmental\n * ViewerObjects that represent a skybox and ground plane.\n *\n * As before, the ground and skybox ViewerObjects specify that their {@link ViewObject | ViewObjects} belong to \"environment\" ViewLayers,\n * while the model ViewerObjects specify that their ViewObjects belong to \"model\" ViewLayers.\n *\n * ````javascript\n * const sceneModel = myViewer.scene.createModel({\n *      id: \"myModel\"\n * });\n *\n * // (calls to SceneModel createGeometry and\n * // createMesh omitted for brevity)\n *\n * sceneModel.createObject({\n *      id: \"ground\",\n *      meshIds: [\"groundMesh}],\n *      layerId: \"environment\"\n * });\n *\n * sceneModel.createObject({\n *      id: \"skyBox\",\n *      meshIds: [\"skyBoxMesh}],\n *      layerId: \"environment\"\n * });\n *\n * sceneModel.createObject({\n *      id: \"houseFoundation\",\n *      meshIds: [\"myMesh}],\n *      layerId: \"model\"\n * });\n *\n * sceneModel.createObject({\n *      id: \"houseWalls\",\n *      meshIds: [\"myMesh}],\n *      layerId: \"model\"\n * });\n *\n * sceneModel.build();\n * ````\n *\n * This time, however, our {@link @xeokit/viewer!View} has now created {@link ViewObject | ViewObjects} for the \"model\" ViewerObjects, while\n * ignoring the \"environment\" ViewerObjects.\n *\n * As far as this View is concerned, the \"environment\" ViewerObjects do not exist.\n *\n * ````javascript\n * // viewer.scene.objects contains four SceneObjects with IDs \"ground\", \"skyBox\", \"houseFoundation\" and \"houseWalls\"\n *\n * // viewer.views.view1.objects contains two ViewObjects with IDs \"houseFoundation\" and \"houseWalls\"\n *\n * // viewer.views.view1.layers contains one ViewLayer with ID \"model\"\n *\n * const modelLayer = view1.layers[\"model\"];\n * modelLayer.setObjectsVisible(modelLayer.objectIds, true);\n * ````\n */\nclass ViewLayer extends Component {\n\n    /**\n     ID of this ViewLayer, unique within the {@link @xeokit/viewer!View}.\n\n     This ViewLayer is mapped by this ID in {@link View.layers}.\n     */\n    declare readonly id: string;\n\n    /**\n     * The Viewer to which this ViewLayer belongs.\n     */\n    declare readonly viewer: Viewer;\n\n    /**\n     * The View to which this ViewLayer belongs.\n     */\n    declare readonly view: View;\n\n    /**\n     * Map of the all {@link ViewObject | ViewObjects} in this ViewLayer.\n     *\n     * These are the ViewObjects for which {@link ViewObject.layerId} has the same value as {@link ViewLayer.id}.\n     *\n     * Each {@link ViewObject} is mapped here by {@link ViewObject.id}.\n     *\n     * The ViewLayer automatically ensures that there is a {@link ViewObject} here for\n     * each {@link RendererObject} in the {@link @xeokit/viewer!Viewer}\n     */\n    readonly objects: { [key: string]: ViewObject };\n\n    /**\n     * Map of the currently visible {@link ViewObject | ViewObjects} in this ViewLayer.\n     *\n     * A ViewObject is visible when {@link ViewObject.visible} is true.\n     *\n     * Each {@link ViewObject} is mapped here by {@link ViewObject.id}.\n     */\n    readonly visibleObjects: { [key: string]: ViewObject };\n\n    /**\n     * Map of currently x-rayed {@link ViewObject | ViewObjects} in this ViewLayer.\n     *\n     * A ViewObject is x-rayed when {@link ViewObject.xrayed} is true.\n     *\n     * Each {@link ViewObject} is mapped here by {@link ViewObject.id}.\n     */\n    readonly xrayedObjects: { [key: string]: ViewObject };\n\n    /**\n     * Map of currently highlighted {@link ViewObject | ViewObjects} in this ViewLayer.\n     *\n     * A ViewObject is highlighted when {@link ViewObject.highlighted} is true.\n     *\n     * Each {@link ViewObject} is mapped here by {@link ViewObject.id}.\n     */\n    readonly highlightedObjects: { [key: string]: ViewObject };\n\n    /**\n     * Map of currently selected {@link ViewObject | ViewObjects} in this ViewLayer.\n     *\n     * A ViewObject is selected when {@link ViewObject.selected} is true.\n     *\n     * Each {@link ViewObject} is mapped here by {@link ViewObject.id}.\n     */\n    readonly selectedObjects: { [key: string]: ViewObject };\n\n    /**\n     * Map of currently colorized {@link ViewObject | ViewObjects} in this ViewLayer.\n     *\n     * Each {@link ViewObject} is mapped here by {@link ViewObject.id}.\n     */\n    readonly colorizedObjects: { [key: string]: ViewObject };\n\n    /**\n     * Map of {@link ViewObject | ViewObjects} in this ViewLayer whose opacity has been updated.\n     *\n     * Each {@link ViewObject} is mapped here by {@link ViewObject.id}.\n     */\n    readonly opacityObjects: { [key: string]: ViewObject };\n\n    /**\n     * When true, View destroys this ViewLayer as soon as there are no ViewObjects\n     * that need it. When false, View retains it.\n     * @private\n     */\n    autoDestroy: boolean;\n\n    /**\n     * Emits an event each time the visibility of a {@link ViewObject} changes.\n     *\n     * ViewObjects are shown and hidden with {@link View.setObjectsVisible}, {@link ViewLayer.setObjectsVisible} or {@link ViewObject.visible}.\n     *\n     * @event\n     */\n    readonly onObjectVisibility: EventEmitter<ViewLayer, ViewObject>;\n\n    #numObjects: number;\n    #objectIds: string[] | null;\n    #numVisibleObjects: number;\n    #visibleObjectIds: string[] | null;\n    #numXRayedObjects: number;\n    #xrayedObjectIds: string[] | null;\n    #numHighlightedObjects: number;\n    #highlightedObjectIds: string[] | null;\n    #numSelectedObjects: number;\n    #selectedObjectIds: string[] | null;\n    #numColorizedObjects: number;\n    #colorizedObjectIds: string[] | null;\n    #numOpacityObjects: number;\n    #opacityObjectIds: string[] | null;\n\n    #qualityRender: boolean;\n\n    gammaOutput: boolean;\n\n    constructor(options: {\n        id: string;\n        viewer: Viewer;\n        view: View;\n        qualityRender?: boolean;\n        autoDestroy?: boolean;\n    }) {\n\n        super(options.view, options);\n\n        this.id = options.id;\n        this.viewer = options.viewer;\n        this.view = options.view;\n\n        this.objects = {};\n        this.visibleObjects = {};\n        this.xrayedObjects = {};\n        this.highlightedObjects = {};\n        this.selectedObjects = {};\n        this.colorizedObjects = {};\n        this.opacityObjects = {};\n\n        this.autoDestroy = (options.autoDestroy !== false);\n\n        this.#numObjects = 0;\n        this.#numVisibleObjects = 0;\n        this.#numXRayedObjects = 0\n        this.#numHighlightedObjects = 0;\n        this.#numSelectedObjects = 0;\n        this.#numColorizedObjects = 0;\n        this.#numOpacityObjects = 0;\n\n        this.#qualityRender = !!options.qualityRender;\n\n        this.onObjectVisibility = new EventEmitter(new EventDispatcher<ViewLayer, ViewObject>());\n\n        this.#initObjects();\n    }\n\n    /**\n     * Gets the gamma factor.\n     */\n    get gammaFactor() { // TODO\n        return 1.0;\n    }\n\n    /**\n     * Sets whether quality rendering is enabled for this ViewLayer.\n     *\n     * Default is ````false````.\n     */\n    set qualityRender(value: boolean) {\n        if (this.#qualityRender === value) {\n            return;\n        }\n        this.#qualityRender = value;\n        this.redraw();\n    }\n\n    /**\n     * Gets whether quality rendering is enabled for this ViewLayer.\n     *\n     * Default is ````false````.\n     */\n    get qualityRender(): boolean {\n        return this.#qualityRender;\n    }\n\n    /**\n     * Gets the number of {@link ViewObject | ViewObjects} in this ViewLayer.\n     */\n    get numObjects(): number {\n        return this.#numObjects;\n    }\n\n    /**\n     * Gets the IDs of the {@link ViewObject | ViewObjects} in this ViewLayer.\n     */\n    get objectIds(): string[] {\n        if (!this.#objectIds) {\n            this.#objectIds = Object.keys(this.objects);\n        }\n        return this.#objectIds;\n    }\n\n    /**\n     * Gets the number of visible {@link ViewObject | ViewObjects} in this ViewLayer.\n     */\n    get numVisibleObjects(): number {\n        return this.#numVisibleObjects;\n    }\n\n    /**\n     * Gets the IDs of the visible {@link ViewObject | ViewObjects} in this ViewLayer.\n     */\n    get visibleObjectIds(): string[] {\n        if (!this.#visibleObjectIds) {\n            this.#visibleObjectIds = Object.keys(this.visibleObjects);\n        }\n        return this.#visibleObjectIds;\n    }\n\n    /**\n     * Gets the number of X-rayed {@link ViewObject | ViewObjects} in this ViewLayer.\n     */\n    get numXRayedObjects(): number {\n        return this.#numXRayedObjects;\n    }\n\n    /**\n     * Gets the IDs of the X-rayed {@link ViewObject | ViewObjects} in this ViewLayer.\n     */\n    get xrayedObjectIds(): string[] {\n        if (!this.#xrayedObjectIds) {\n            this.#xrayedObjectIds = Object.keys(this.xrayedObjects);\n        }\n        return this.#xrayedObjectIds;\n    }\n\n    /**\n     * Gets the number of highlighted {@link ViewObject | ViewObjects} in this ViewLayer.\n     */\n    get numHighlightedObjects(): number {\n        return this.#numHighlightedObjects;\n    }\n\n    /**\n     * Gets the IDs of the highlighted {@link ViewObject | ViewObjects} in this ViewLayer.\n     */\n    get highlightedObjectIds(): string[] {\n        if (!this.#highlightedObjectIds) {\n            this.#highlightedObjectIds = Object.keys(this.highlightedObjects);\n        }\n        return this.#highlightedObjectIds;\n    }\n\n    /**\n     * Gets the number of selected {@link ViewObject | ViewObjects} in this ViewLayer.\n     */\n    get numSelectedObjects(): number {\n        return this.#numSelectedObjects;\n    }\n\n    /**\n     * Gets the IDs of the selected {@link ViewObject | ViewObjects} in this ViewLayer.\n     */\n    get selectedObjectIds(): string[] {\n        if (!this.#selectedObjectIds) {\n            this.#selectedObjectIds = Object.keys(this.selectedObjects);\n        }\n        return this.#selectedObjectIds;\n    }\n\n    /**\n     * Gets the number of colorized {@link ViewObject | ViewObjects} in this ViewLayer.\n     */\n    get numColorizedObjects(): number {\n        return this.#numColorizedObjects;\n    }\n\n    /**\n     * Gets the IDs of the colorized {@link ViewObject | ViewObjects} in this ViewLayer.\n     */\n    get colorizedObjectIds(): string[] {\n        if (!this.#colorizedObjectIds) {\n            this.#colorizedObjectIds = Object.keys(this.colorizedObjects);\n        }\n        return this.#colorizedObjectIds;\n    }\n\n    /**\n     * Gets the IDs of the {@link ViewObject | ViewObjects} in this ViewLayer that have updated opacities.\n     */\n    get opacityObjectIds(): string[] {\n        if (!this.#opacityObjectIds) {\n            this.#opacityObjectIds = Object.keys(this.opacityObjects);\n        }\n        return this.#opacityObjectIds;\n    }\n\n    /**\n     * Gets the number of {@link ViewObject | ViewObjects} in this ViewLayer that have updated opacities.\n     */\n    get numOpacityObjects(): number {\n        return this.#numOpacityObjects;\n    }\n\n    /**\n     * @private\n     */\n    registerViewObject(viewObject: ViewObject) {\n        this.objects[viewObject.id] = viewObject;\n        this.#numObjects++;\n        this.#objectIds = null; // Lazy regenerate\n    }\n\n    /**\n     * @private\n     */\n    deregisterViewObject(viewObject: ViewObject) {\n        delete this.objects[viewObject.id];\n        delete this.visibleObjects[viewObject.id];\n        delete this.xrayedObjects[viewObject.id];\n        delete this.highlightedObjects[viewObject.id];\n        delete this.selectedObjects[viewObject.id];\n        delete this.colorizedObjects[viewObject.id];\n        delete this.opacityObjects[viewObject.id];\n        this.#numObjects--;\n        this.#objectIds = null; // Lazy regenerate\n    }\n\n    /**\n     * @private\n     */\n    redraw() {\n        this.viewer.renderer.setImageDirty(this.view.viewIndex);\n    }\n\n    /**\n     * @private\n     */\n    objectVisibilityUpdated(viewObject: ViewObject, visible: boolean, notify: boolean = true) {\n        if (visible) {\n            this.visibleObjects[viewObject.id] = viewObject;\n            this.#numVisibleObjects++;\n        } else {\n            delete this.visibleObjects[viewObject.id];\n            this.#numVisibleObjects--;\n        }\n        this.#visibleObjectIds = null; // Lazy regenerate\n        if (notify) {\n            this.onObjectVisibility.dispatch(this, viewObject);\n        }\n        this.view.objectVisibilityUpdated(viewObject, visible, notify);\n    }\n\n    /**\n     * @private\n     */\n    objectXRayedUpdated(viewObject: ViewObject, xrayed: boolean) {\n        if (xrayed) {\n            this.xrayedObjects[viewObject.id] = viewObject;\n            this.#numXRayedObjects++;\n        } else {\n            delete this.xrayedObjects[viewObject.id];\n            this.#numXRayedObjects--;\n        }\n        this.#xrayedObjectIds = null; // Lazy regenerate\n        this.view.objectXRayedUpdated(viewObject, xrayed);\n    }\n\n    /**\n     * @private\n     */\n    objectHighlightedUpdated(viewObject: ViewObject, highlighted: boolean) {\n        if (highlighted) {\n            this.highlightedObjects[viewObject.id] = viewObject;\n            this.#numHighlightedObjects++;\n        } else {\n            delete this.highlightedObjects[viewObject.id];\n            this.#numHighlightedObjects--;\n        }\n        this.#highlightedObjectIds = null; // Lazy regenerate\n        this.view.objectHighlightedUpdated(viewObject, highlighted);\n    }\n\n    /**\n     * @private\n     */\n    objectSelectedUpdated(viewObject: ViewObject, selected: boolean) {\n        if (selected) {\n            this.selectedObjects[viewObject.id] = viewObject;\n            this.#numSelectedObjects++;\n        } else {\n            delete this.selectedObjects[viewObject.id];\n            this.#numSelectedObjects--;\n        }\n        this.#selectedObjectIds = null; // Lazy regenerate\n        this.view.objectSelectedUpdated(viewObject, selected);\n    }\n\n    /**\n     * @private\n     */\n    objectColorizeUpdated(viewObject: ViewObject, colorized: boolean) {\n        if (colorized) {\n            this.colorizedObjects[viewObject.id] = viewObject;\n            this.#numColorizedObjects++;\n        } else {\n            delete this.colorizedObjects[viewObject.id];\n            this.#numColorizedObjects--;\n        }\n        this.#colorizedObjectIds = null; // Lazy regenerate\n        this.view.objectColorizeUpdated(viewObject, colorized);\n    }\n\n    /**\n     * @private\n     */\n    objectOpacityUpdated(viewObject: ViewObject, opacityUpdated: boolean) {\n        if (opacityUpdated) {\n            this.opacityObjects[viewObject.id] = viewObject;\n            this.#numOpacityObjects++;\n        } else {\n            delete this.opacityObjects[viewObject.id];\n            this.#numOpacityObjects--;\n        }\n        this.#opacityObjectIds = null; // Lazy regenerate\n        this.view.objectOpacityUpdated(viewObject, opacityUpdated);\n    }\n\n    /**\n     * Updates the visibility of the given {@link ViewObject | ViewObjects} in this ViewLayer.\n     *\n     * - Updates {@link ViewObject.visible} on the Objects with the given IDs.\n     * - Updates {@link ViewLayer.visibleObjects} and {@link ViewLayer.numVisibleObjects}.\n     *\n     * @param {String[]} objectIds Array of {@link ViewObject.id} values.\n     * @param visible Whether or not to cull.\n     * @returns True if any {@link ViewObject | ViewObjects} were updated, else false if all updates were redundant and not applied.\n     */\n    setObjectsVisible(objectIds: string[], visible: boolean): boolean {\n        return this.withObjects(objectIds, (viewObject: ViewObject) => {\n            const changed = (viewObject.visible !== visible);\n            viewObject.visible = visible;\n            return changed;\n        });\n    }\n\n    /**\n     * Updates the collidability of the given {@link ViewObject | ViewObjects} in this ViewLayer.\n     *\n     * Updates {@link ViewObject.collidable} on the Objects with the given IDs.\n     *\n     * @param {String[]} objectIds Array of {@link ViewObject.id} values.\n     * @param collidable Whether or not to cull.\n     * @returns True if any {@link ViewObject | ViewObjects} were updated, else false if all updates were redundant and not applied.\n     */\n    setObjectsCollidable(objectIds: string[], collidable: boolean): boolean {\n        return this.withObjects(objectIds, (viewObject: ViewObject) => {\n            const changed = (viewObject.collidable !== collidable);\n            viewObject.collidable = collidable;\n            return changed;\n        });\n    }\n\n    /**\n     * Updates the culled status of the given {@link ViewObject | ViewObjects} in this ViewLayer.\n     *\n     * Updates {@link ViewObject.culled} on the Objects with the given IDs.\n     *\n     * @param {String[]} objectIds Array of {@link ViewObject.id} values.\n     * @param culled Whether or not to cull.\n     * @returns True if any {@link ViewObject | ViewObjects} were updated, else false if all updates were redundant and not applied.\n     */\n    setObjectsCulled(objectIds: string[], culled: boolean): boolean {\n        return this.withObjects(objectIds, (viewObject: ViewObject) => {\n            const changed = (viewObject.culled !== culled);\n            viewObject.culled = culled;\n            return changed;\n        });\n    }\n\n    /**\n     * Selects or deselects the given {@link ViewObject | ViewObjects} in this ViewLayer.\n     *\n     * - Updates {@link ViewObject.selected} on the Objects with the given IDs.\n     * - Updates {@link ViewLayer.selectedObjects} and {@link ViewLayer.numSelectedObjects}.\n     *\n     * @param  objectIds One or more {@link ViewObject.id} values.\n     * @param selected Whether or not to select.\n     * @returns True if any {@link ViewObject | ViewObjects} were updated, else false if all updates were redundant and not applied.\n     */\n    setObjectsSelected(objectIds: string[], selected: boolean): boolean {\n        return this.withObjects(objectIds, (viewObject: ViewObject) => {\n            const changed = (viewObject.selected !== selected);\n            viewObject.selected = selected;\n            return changed;\n        });\n    }\n\n    /**\n     * Highlights or un-highlights the given {@link ViewObject | ViewObjects} in this ViewLayer.\n     *\n     * - Updates {@link ViewObject.highlighted} on the Objects with the given IDs.\n     * - Updates {@link ViewLayer.highlightedObjects} and {@link ViewLayer.numHighlightedObjects}.\n     *\n     * @param  objectIds One or more {@link ViewObject.id} values.\n     * @param highlighted Whether or not to highlight.\n     * @returns True if any {@link ViewObject | ViewObjects} were updated, else false if all updates were redundant and not applied.\n     */\n    setObjectsHighlighted(objectIds: string[], highlighted: boolean): boolean {\n        return this.withObjects(objectIds, (viewObject: ViewObject) => {\n            const changed = (viewObject.highlighted !== highlighted);\n            viewObject.highlighted = highlighted;\n            return changed;\n        });\n    }\n\n    /**\n     * Applies or removes X-ray rendering for the given {@link ViewObject | ViewObjects} in this ViewLayer.\n     *\n     * - Updates {@link ViewObject.xrayed} on the Objects with the given IDs.\n     * - Updates {@link ViewLayer.xrayedObjects} and {@link ViewLayer.numXRayedObjects}.\n     *\n     * @param  objectIds One or more {@link ViewObject.id} values.\n     * @param xrayed Whether or not to xray.\n     * @returns True if any {@link ViewObject | ViewObjects} were updated, else false if all updates were redundant and not applied.\n     */\n    setObjectsXRayed(objectIds: string[], xrayed: boolean): boolean {\n        return this.withObjects(objectIds, (viewObject: ViewObject) => {\n            const changed = (viewObject.xrayed !== xrayed);\n            if (changed) {\n                viewObject.xrayed = xrayed;\n            }\n            return changed;\n        });\n    }\n\n    /**\n     * Colorizes the given {@link ViewObject | ViewObjects} in this ViewLayer.\n     *\n     * - Updates {@link ViewObject.colorize} on the Objects with the given IDs.\n     * - Updates {@link ViewLayer.colorizedObjects} and {@link ViewLayer.numColorizedObjects}.\n     *\n     * @param  objectIds One or more {@link ViewObject.id} values.\n     * @param colorize - RGB colorize factors in range ````[0..1,0..1,0..1]````.\n     * @returns True if any {@link ViewObject | ViewObjects} changed opacity, else false if all updates were redundant and not applied.\n     */\n    setObjectsColorized(objectIds: string[], colorize: number[]) {\n        return this.withObjects(objectIds, (viewObject: ViewObject) => {\n            viewObject.colorize = colorize;\n        });\n    }\n\n    /**\n     * Sets the opacity of the given {@link ViewObject | ViewObjects} in this ViewLayer.\n     *\n     * - Updates {@link ViewObject.opacity} on the Objects with the given IDs.\n     * - Updates {@link ViewLayer.opacityObjects} and {@link ViewLayer.numOpacityObjects}.\n     *\n     * @param  objectIds - One or more {@link ViewObject.id} values.\n     * @param opacity - Opacity factor in range ````[0..1]````.\n     * @returns True if any {@link ViewObject | ViewObjects} changed opacity, else false if all updates were redundant and not applied.\n     */\n    setObjectsOpacity(objectIds: string[], opacity: number): boolean {\n        return this.withObjects(objectIds, (viewObject: ViewObject) => {\n            const changed = (viewObject.opacity !== opacity);\n            if (changed) {\n                viewObject.opacity = opacity;\n            }\n            return changed;\n        });\n    }\n\n    /**\n     * Sets the pickability of the given {@link ViewObject | ViewObjects} in this ViewLayer.\n     *\n     * - Updates {@link ViewObject.pickable} on the Objects with the given IDs.\n     * - Enables or disables the ability to pick the given Objects with {@link ViewLayer.pick}.\n     *\n     * @param {String[]} objectIds Array of {@link ViewObject.id} values.\n     * @param pickable Whether or not to set pickable.\n     * @returns True if any {@link ViewObject | ViewObjects} were updated, else false if all updates were redundant and not applied.\n     */\n    setObjectsPickable(objectIds: string[], pickable: boolean): boolean {\n        return this.withObjects(objectIds, (viewObject: ViewObject) => {\n            const changed = (viewObject.pickable !== pickable);\n            if (changed) {\n                viewObject.pickable = pickable;\n            }\n            return changed;\n        });\n    }\n\n    /**\n     * Sets the clippability of the given {@link ViewObject | ViewObjects} in this ViewLayer.\n     *\n     * - Updates {@link ViewObject.clippable} on the Objects with the given IDs.\n     * - Enables or disables the ability to pick the given Objects with {@link ViewLayer.pick}.\n     *\n     * @param {String[]} objectIds Array of {@link ViewObject.id} values.\n     * @param clippable Whether or not to set clippable.\n     * @returns True if any {@link ViewObject | ViewObjects} were updated, else false if all updates were redundant and not applied.\n     */\n    setObjectsClippable(objectIds: string[], clippable: boolean): boolean {\n        return this.withObjects(objectIds, (viewObject: ViewObject) => {\n            const changed = (viewObject.clippable !== clippable);\n            if (changed) {\n                viewObject.clippable = clippable;\n            }\n            return changed;\n        });\n    }\n\n    /**\n     * Iterates with a callback over the given {@link ViewObject | ViewObjects} in this ViewLayer.\n     *\n     * @param  objectIds One or more {@link ViewObject.id} values.\n     * @param callback Callback to execute on each {@link ViewObject}.\n     * @returns True if any {@link ViewObject | ViewObjects} were updated, else false if all updates were redundant and not applied.\n     */\n    withObjects(objectIds: string[], callback: Function): boolean {\n        let changed = false;\n        for (let i = 0, len = objectIds.length; i < len; i++) {\n            const id = objectIds[i];\n            let viewObject = this.objects[id];\n            if (viewObject) {\n                changed = callback(viewObject) || changed;\n            }\n        }\n        return changed;\n    }\n\n    #initObjects() {\n        const models = this.viewer.scene.models;\n        for (const id in models) {\n            const model = models[id];\n            this.#createObjects(model);\n        }\n        this.viewer.scene.onModelCreated.subscribe((scene: Scene, model: SceneModel) => {\n            this.#createObjects(model);\n        });\n        this.viewer.scene.onModelDestroyed.subscribe((scene:Scene, model: SceneModel) => {\n            this.#destroyObjects(model);\n        });\n    }\n\n    #createObjects(model: SceneModel) {\n        const sceneObjects = model.objects;\n        for (let id in sceneObjects) {\n            const sceneObject = sceneObjects[id];\n            const rendererViewObject = this.viewer.renderer.rendererViewObjects[id];\n            if (rendererViewObject.layerId == this.id) {\n                const viewObject = new ViewObject(this, sceneObject, rendererViewObject);\n                this.objects[viewObject.id] = viewObject;\n                this.#numObjects++;\n                this.#objectIds = null; // Lazy regenerate\n            }\n        }\n    }\n\n    #destroyObjects(model: SceneModel) {\n        const viewerObjects = model.objects;\n        for (let id in viewerObjects) {\n            const viewerObject = viewerObjects[id];\n            const viewObject = this.objects[viewerObject.id];\n            viewObject._destroy();\n            this.#numObjects--;\n            this.#objectIds = null; // Lazy regenerate\n        }\n    }\n\n    /**\n     * Destroys this ViewLayer.\n     *\n     * Causes {@link @xeokit/viewer!Viewer} to fire a \"viewDestroyed\" event.\n     */\n    destroy() {\n        super.destroy();\n    }\n}\n\nexport {ViewLayer};\n","import {Component} from \"@xeokit/core\";\nimport type {FloatArrayParam} from \"@xeokit/math\";\n\nimport type {View} from \"./View\";\n\n/**\n * Configures the appearance of {@link ViewObject | ViewObjects} when they are xrayed, highlighted or selected.\n *\n * ## Summary\n *\n * * Located at {@link View.xrayMaterial}, {@link View.highlightMaterial} and {@link View.selectedMaterial}.\n * * XRay a {@link ViewObject} by setting {@link ViewObject.xrayed} ````true````.\n * * Highlight a {@link ViewObject} by setting {@link ViewObject.highlighted} ````true````.\n * * Select a {@link ViewObject} by setting {@link ViewObject.selected} ````true````.\n */\nclass EmphasisMaterial extends Component {\n\n    /**\n     * The View to which this EmphasisMaterial belongs.\n     */\n    public readonly view: View;\n\n    #state: {\n        fillColor: Float32Array;\n        backfaces: boolean;\n        edgeColor: Float32Array;\n        edgeWidth: number;\n        edgeAlpha: number;\n        edges: boolean;\n        fillAlpha: number;\n        fill: boolean\n    };\n\n    /**\n     * @private\n     */\n    constructor(view: View, options: {\n        fillColor?: FloatArrayParam;\n        backfaces?: boolean;\n        edgeColor?: FloatArrayParam;\n        edgeWidth?: number;\n        edgeAlpha?: number;\n        edges?: boolean;\n        fillAlpha?: number;\n        fill?: boolean;\n    } = {}) {\n\n        super(view, options);\n\n        this.view = view;\n\n        this.#state = {\n            fill: !!options.fill,\n            fillColor: new Float32Array(options.fillColor || [0.4, 0.4, 0.4]),\n            fillAlpha: (options.fillAlpha !== undefined && options.fillAlpha !== null) ? options.fillAlpha : 0.2,\n            edges: options.edges !== false,\n            edgeColor: new Float32Array(options.edgeColor || [0.2, 0.2, 0.2]),\n            edgeAlpha: (options.edgeAlpha !== undefined && options.edgeAlpha !== null) ? options.edgeAlpha : 0.5,\n            edgeWidth: (options.edgeWidth !== undefined && options.edgeWidth !== null) ? options.edgeWidth : 1,\n            backfaces: !!options.backfaces\n        };\n    }\n\n    /**\n     * Sets if the surfaces of emphasized {@link ViewObject | ViewObjects} are filled with color.\n     *\n     * Default is ````true````.\n     */\n    set fill(value: boolean) {\n        if (this.#state.fill === value) {\n            return;\n        }\n        this.#state.fill = value;\n        this.view.redraw();\n    }\n\n    /**\n     * Gets if the surfaces of emphasized {@link ViewObject | ViewObjects} are filled with color.\n     *\n     * Default is ````true````.\n     */\n    get fill(): boolean {\n        return this.#state.fill;\n    }\n\n    /**\n     * Sets the RGB surface fill color for the surfaces of emphasized {@link ViewObject | ViewObjects}.\n     *\n     * Default is ````[0.4, 0.4, 0.4]````.\n     */\n    set fillColor(value: FloatArrayParam) {\n        const fillColor = this.#state.fillColor;\n        if (fillColor[0] === value[0] && fillColor[1] === value[1] && fillColor[2] === value[2]) {\n            return;\n        }\n        fillColor[0] = 0.4;\n        fillColor[1] = 0.4;\n        fillColor[2] = 0.4;\n        this.view.redraw();\n    }\n\n    /**\n     * Gets the RGB surface fill color for the surfaces of emphasized {@link ViewObject | ViewObjects}.\n     *\n     * Default is ````[0.4, 0.4, 0.4]````.\n     */\n    get fillColor(): Float32Array {\n        return this.#state.fillColor;\n    }\n\n    /**\n     * Sets the transparency of the surfaces of emphasized {@link ViewObject | ViewObjects}.\n     *\n     * A value of ````0.0```` indicates fully transparent, ````1.0```` is fully opaque.\n     *\n     * Default is ````0.2````.\n     */\n    set fillAlpha(value: number) {\n        if (this.#state.fillAlpha === value) {\n            return;\n        }\n        this.#state.fillAlpha = value;\n        this.view.redraw();\n    }\n\n    /**\n     * Gets the transparency of the surfaces of emphasized {@link ViewObject | ViewObjects}.\n     *\n     * A value of ````0.0```` indicates fully transparent, ````1.0```` is fully opaque.\n     *\n     * Default is ````0.2````.\n     */\n    get fillAlpha(): number {\n        return this.#state.fillAlpha;\n    }\n\n    /**\n     * Sets if the edges on emphasized {@link ViewObject | ViewObjects} are visible.\n     *\n     * Default is ````true````.\n     */\n    set edges(value: boolean) {\n        if (this.#state.edges === value) {\n            return;\n        }\n        this.#state.edges = value;\n        this.view.redraw();\n    }\n\n    /**\n     * Gets if the edges on emphasized {@link ViewObject | ViewObjects} are visible.\n     *\n     * Default is ````true````.\n     */\n    get edges(): boolean {\n        return this.#state.edges;\n    }\n\n    /**\n     * Sets the RGB color of the edges of emphasized {@link ViewObject | ViewObjects}.\n     *\n     * Default is ```` [0.2, 0.2, 0.2]````.\n     */\n    set edgeColor(value: FloatArrayParam) {\n        let edgeColor = this.#state.edgeColor;\n        if (edgeColor[0] === value[0] && edgeColor[1] === value[1] && edgeColor[2] === value[2]) {\n            return;\n        }\n        edgeColor[0] = 0.2;\n        edgeColor[1] = 0.2;\n        edgeColor[2] = 0.2;\n        this.view.redraw();\n    }\n\n    /**\n     * Gets the RGB color of the edges of emphasized {@link ViewObject | ViewObjects}.\n     *\n     * Default is ```` [0.2, 0.2, 0.2]````.\n     */\n    get edgeColor(): Float32Array {\n        return this.#state.edgeColor;\n    }\n\n    /**\n     * Sets the transparency of the edges of emphasized {@link ViewObject | ViewObjects}.\n     *\n     * A value of ````0.0```` indicates fully transparent, ````1.0```` is fully opaque.\n     *\n     * Default is ````0.2````.\n     */\n    set edgeAlpha(value: number) {\n        if (this.#state.edgeAlpha === value) {\n            return;\n        }\n        this.#state.edgeAlpha = value;\n        this.view.redraw();\n    }\n\n    /**\n     * Gets the transparency of the edges of emphasized {@link ViewObject | ViewObjects}.\n     *\n     * A value of ````0.0```` indicates fully transparent, ````1.0```` is fully opaque.\n     *\n     * Default is ````0.2````.\n     */\n    get edgeAlpha(): number {\n        return this.#state.edgeAlpha;\n    }\n\n    /**\n     * Sets the width of the edges of emphasized {@link ViewObject | ViewObjects}.\n     *\n     * Default value is ````1.0```` pixels.\n     */\n    set edgeWidth(value: number) {\n        this.#state.edgeWidth = value;\n        this.view.redraw();\n    }\n\n    /**\n     * Gets the width of the edges of emphasized {@link ViewObject | ViewObjects}.\n     *\n     * This is not supported by WebGL implementations based on DirectX [2019].\n     *\n     * Default value is ````1.0```` pixels.\n     */\n    get edgeWidth(): number {\n        return this.#state.edgeWidth;\n    }\n\n    /**\n     * Sets whether to render backfaces of emphasized {@link ViewObject | ViewObjects} when {@link EmphasisMaterial.fill} is ````true````.\n     *\n     * Default is ````false````.\n     */\n    set backfaces(value: boolean) {\n        if (this.#state.backfaces === value) {\n            return;\n        }\n        this.#state.backfaces = value;\n        this.view.redraw();\n    }\n\n    /**\n     * Gets whether to render backfaces of emphasized {@link ViewObject | ViewObjects} when {@link EmphasisMaterial.fill} is ````true````.\n     *\n     * Default is ````false````.\n     */\n    get backfaces(): boolean {\n        return this.#state.backfaces;\n    }\n\n    /**\n     * @private\n     */\n    get hash(): string {\n        return \"\";\n    }\n\n    /**\n     * @private\n     */\n    destroy(): void {\n        super.destroy();\n    }\n}\n\nexport {EmphasisMaterial};","import {Component} from \"@xeokit/core\";\n\n\n\nimport type {View} from \"./View\";\nimport type {FloatArrayParam} from \"@xeokit/math\";\nimport {QualityRender} from \"@xeokit/constants\";\n\n\n/**\n * Configures the appearance of {@link ViewObject | ViewObjects} when their edges are emphasised.\n *\n * ## Summary\n *\n * * Located at {@link View.edgeMaterial}.\n * * Emphasise edges of a {@link ViewObject} by setting {@link ViewObject.edges} ````true````.\n */\nclass EdgeMaterial extends Component {\n\n    /**\n     * The View to which this EdgeMaterial belongs.\n     */\n    public readonly view: View;\n\n    /**\n     * @private\n     */\n    #state: {\n        edgeColor: Float32Array;\n        edgeWidth: number;\n        edgeAlpha: number;\n        edges: boolean;\n        renderModes: number[];\n    };\n\n    /**\n     * @private\n     */\n    constructor(view: View, options: {\n        edgeColor?: FloatArrayParam;\n        edgeWidth?: number;\n        edgeAlpha?: number;\n        edges?: boolean;\n        renderModes?: number[];\n    } = {}) {\n\n        super(view, options);\n\n        this.view = view;\n\n        this.#state = {\n            renderModes: options.renderModes || [QualityRender],\n            edges: options.edges !== false,\n            edgeColor: new Float32Array(options.edgeColor || [0.2, 0.2, 0.2]),\n            edgeAlpha: (options.edgeAlpha !== undefined && options.edgeAlpha !== null) ? options.edgeAlpha : 0.5,\n            edgeWidth: (options.edgeWidth !== undefined && options.edgeWidth !== null) ? options.edgeWidth : 1\n        };\n    }\n\n    /**\n     * Sets which rendering modes in which to render edges.\n     *\n     * Accepted modes are {@link QualityRender} and {@link FastRender}.\n     *\n     * Default value is [{@link QualityRender}].\n     */\n    set renderModes(value: number[]) {\n        this.#state.renderModes = value;\n        this.view.redraw();\n    }\n\n    /**\n     * Gets which rendering modes in which to render edges.\n     *\n     * Accepted modes are {@link QualityRender} and {@link FastRender}.\n     *\n     * Default value is [{@link QualityRender}].\n     */\n    get renderModes(): number[] {\n        return this.#state.renderModes;\n    }\n\n    /**\n     * Sets if edges of {@link ViewObjects} are visible.\n     *\n     * Default is ````true````.\n     */\n    set edges(value: boolean) {\n        if (this.#state.edges === value) {\n            return;\n        }\n        this.#state.edges = value;\n        this.view.redraw();\n    }\n\n    /**\n     * Gets if edges of {@link ViewObjects} are visible.\n     *\n     * Default is ````true````.\n     */\n    get edges(): boolean {\n        return this.#state.edges;\n    }\n\n    /**\n     * Sets RGB edge color for {@link ViewObjects}.\n     *\n     * Default value is ````[0.2, 0.2, 0.2]````.\n     */\n    set edgeColor(value: FloatArrayParam) {\n        let edgeColor = this.#state.edgeColor;\n        if (value && edgeColor[0] === value[0] && edgeColor[1] === value[1] && edgeColor[2] === value[2]) {\n            return;\n        }\n        edgeColor[0] = 0.2;\n        edgeColor[1] = 0.2;\n        edgeColor[2] = 0.2;\n        this.view.redraw();\n    }\n\n    /**\n     * Gets RGB edge color for {@link ViewObjects}.\n     *\n     * Default value is ````[0.2, 0.2, 0.2]````.\n     */\n    get edgeColor(): Float32Array {\n        return this.#state.edgeColor;\n    }\n\n    /**\n     * Sets edge transparency for {@link ViewObjects}.\n     *\n     * A value of ````0.0```` indicates fully transparent, ````1.0```` is fully opaque.\n     *\n     * Default value is ````1.0````.\n     */\n    set edgeAlpha(value: number) {\n        if (this.#state.edgeAlpha === value) {\n            return;\n        }\n        this.#state.edgeAlpha = value;\n        this.view.redraw();\n    }\n\n    /**\n     * Gets edge transparency for {@link ViewObjects}.\n     *\n     * A value of ````0.0```` indicates fully transparent, ````1.0```` is fully opaque.\n     *\n     * Default value is ````1.0````.\n     */\n    get edgeAlpha(): number {\n        return this.#state.edgeAlpha;\n    }\n\n    /**\n     * Sets edge width for {@link ViewObjects}.\n     *\n     * Default value is ````1.0```` pixels.\n     */\n    set edgeWidth(value: number) {\n        if (this.#state.edgeWidth === value) {\n            return;\n        }\n        this.#state.edgeWidth = value;\n        this.view.redraw();\n    }\n\n    /**\n     * Gets edge width for {@link ViewObjects}.\n     *\n     * This is not supported by WebGL implementations based on DirectX [2019].\n     *\n     * Default value is ````1.0```` pixels.\n     */\n    get edgeWidth(): number {\n        return this.#state.edgeWidth;\n    }\n\n    /**\n     * @private\n     */\n    destroy() {\n        super.destroy();\n    }\n}\n\nexport {EdgeMaterial};","import {Component} from \"@xeokit/core\";\nimport type {View} from \"./View\";\n\n/**\n * Configures the size and shape of {@link ViewObject | ViewObjects} that represent clouds of points.\n *\n * ## Summary\n *\n * * Located at {@link View.pointsMaterial}.\n * * Supports round and square points.\n * * Optional perspective point scaling.\n */\nclass PointsMaterial extends Component {\n\n    /**\n     * The View to which this PointsMaterial belongs.\n     */\n    public readonly view: View;\n\n    #state: {\n        pointSize: number,\n        roundPoints: boolean,\n        perspectivePoints: boolean,\n        minPerspectivePointSize: number,\n        maxPerspectivePointSize: number,\n        filterIntensity: boolean,\n        minIntensity: number,\n        maxIntensity: number\n    };\n\n    /**\n     * @private\n     */\n    constructor(view: View, options: {\n        pointSize?: number,\n        roundPoints?: boolean,\n        perspectivePoints?: boolean,\n        minPerspectivePointSize?: number,\n        maxPerspectivePointSize?: number,\n        filterIntensity?: boolean,\n        minIntensity?: number,\n        maxIntensity?: number\n    } = {}) {\n\n        super(view, options);\n\n        this.view = view;\n\n        this.#state = {\n            pointSize: (options.pointSize !== undefined && options.pointSize !== null) ? options.pointSize : 1,\n            roundPoints: options.roundPoints !== false,\n            perspectivePoints: options.perspectivePoints !== false,\n            minPerspectivePointSize: (options.minPerspectivePointSize !== undefined && options.minPerspectivePointSize !== null) ? options.minPerspectivePointSize : 1,\n            maxPerspectivePointSize: (options.maxPerspectivePointSize !== undefined && options.maxPerspectivePointSize !== null) ? options.maxPerspectivePointSize : 6,\n            filterIntensity: !!options.filterIntensity,\n            minIntensity: (options.minIntensity !== undefined && options.minIntensity !== null) ? options.minIntensity : 0,\n            maxIntensity: (options.maxIntensity !== undefined && options.maxIntensity !== null) ? options.maxIntensity : 1\n        };\n    }\n\n    /**\n     * Sets point size.\n     *\n     * Default value is ````2.0```` pixels.\n     */\n    set pointSize(value: number) {\n        this.#state.pointSize = value;\n        this.view.redraw();\n    }\n\n    /**\n     * Gets point size.\n     *\n     * Default value is ````2.0```` pixels.\n     */\n    get pointSize(): number {\n        return this.#state.pointSize;\n    }\n\n\n    /**\n     * Sets if points are round or square.\n     *\n     * Default is ````true```` to set points round.\n     */\n    set roundPoints(value: boolean) {\n        if (this.#state.roundPoints === value) {\n            return;\n        }\n        this.#state.roundPoints = value;\n        this.view.rebuild();\n    }\n\n    /**\n     * Gets if points are round or square.\n     *\n     * Default is ````true```` to set points round.\n     */\n    get roundPoints(): boolean {\n        return this.#state.roundPoints;\n    }\n\n    /**\n     * Sets if rendered point size reduces with distance when {@link Camera.projection} is set to ````PerspectiveProjectionType````.\n     *\n     * Default is ````true````.\n     */\n    set perspectivePoints(value: boolean) {\n        if (this.#state.perspectivePoints === value) {\n            return;\n        }\n        this.#state.perspectivePoints = value;\n        this.view.rebuild();\n    }\n\n    /**\n     * Gets if rendered point size reduces with distance when {@link Camera.projection} is set to PerspectiveProjectionType.\n     *\n     * Default is ````false````.\n     */\n    get perspectivePoints(): boolean {\n        return this.#state.perspectivePoints;\n    }\n\n    /**\n     * Sets the minimum rendered size of points when {@link PointsMaterial.perspectivePoints} is ````true````.\n     *\n     * Default value is ````1.0```` pixels.\n     */\n    set minPerspectivePointSize(value: number) {\n        if (this.#state.minPerspectivePointSize === value) {\n            return;\n        }\n        this.#state.minPerspectivePointSize = value;\n        this.view.rebuild();\n    }\n\n    /**\n     * Gets the minimum rendered size of points when {@link PointsMaterial.perspectivePoints} is ````true````.\n     *\n     * Default value is ````1.0```` pixels.\n     *\n     * @type {Number}\n     */\n    get minPerspectivePointSize(): number {\n        return this.#state.minPerspectivePointSize;\n    }\n\n    /**\n     * Sets the maximum rendered size of points when {@link PointsMaterial.perspectivePoints} is ````true````.\n     *\n     * Default value is ````6```` pixels.\n     */\n    set maxPerspectivePointSize(value: number) {\n        if (this.#state.maxPerspectivePointSize === value) {\n            return;\n        }\n        this.#state.maxPerspectivePointSize = value;\n        this.view.rebuild();\n    }\n\n    /**\n     * Gets the maximum rendered size of points when {@link PointsMaterial.perspectivePoints} is ````true````.\n     *\n     * Default value is ````6```` pixels.\n     */\n    get maxPerspectivePointSize(): number {\n        return this.#state.maxPerspectivePointSize;\n    }\n\n    /**\n     * Sets if rendered point size reduces with distance when {@link Camera.projection} is set to ````PerspectiveProjectionType````.\n     *\n     * Default is ````false````.\n     */\n    set filterIntensity(value: boolean) {\n        if (this.#state.filterIntensity === value) {\n            return;\n        }\n        this.#state.filterIntensity = value;\n        this.view.rebuild();\n    }\n\n    /**\n     * Gets if rendered point size reduces with distance when {@link Camera.projection} is set to PerspectiveProjectionType.\n     *\n     * Default is ````false````.\n     */\n    get filterIntensity(): boolean {\n        return this.#state.filterIntensity;\n    }\n\n    /**\n     * Sets the minimum rendered size of points when {@link PointsMaterial.perspectivePoints} is ````true````.\n     *\n     * Default value is ````0````.\n     */\n    set minIntensity(value: number) {\n        if (this.#state.minIntensity === value) {\n            return;\n        }\n        this.#state.minIntensity = value;\n        this.view.redraw();\n    }\n\n    /**\n     * Gets the minimum rendered size of points when {@link PointsMaterial.filterIntensity} is ````true````.\n     *\n     * Default value is ````0````.\n     */\n    get minIntensity(): number {\n        return this.#state.minIntensity;\n    }\n\n    /**\n     * Sets the maximum rendered size of points when {@link PointsMaterial.filterIntensity} is ````true````.\n     *\n     * Default value is ````1````.\n     */\n    set maxIntensity(value: number) {\n        if (this.#state.maxIntensity === value) {\n            return;\n        }\n        this.#state.maxIntensity = value;\n        this.view.redraw();\n    }\n\n    /**\n     * Gets the maximum rendered size of points when {@link PointsMaterial.filterIntensity} is ````true````.\n     *\n     * Default value is ````1````.\n     */\n    get maxIntensity(): number {\n        return this.#state.maxIntensity;\n    }\n\n    /**\n     * @private\n     */\n    get hash(): string {\n        const state = this.#state;\n        return `${state.pointSize};\n        ${state.roundPoints};\n        ${state.perspectivePoints};\n        ${state.minPerspectivePointSize};\n        ${state.maxPerspectivePointSize};\n        ${state.filterIntensity}`;\n    }\n\n    /**\n     * @private\n     */\n    destroy() {\n        super.destroy();\n    }\n}\n\nexport {PointsMaterial};","import {EventDispatcher} from \"strongly-typed-events\";\n\n\nimport type {Camera} from \"./Camera\";\nimport {Component, EventEmitter} from \"@xeokit/core\";\nimport {PerspectiveProjectionType} from \"@xeokit/constants\";\nimport type {FloatArrayParam} from \"@xeokit/math\";\nimport {inverseMat4, createMat4, mulMat4v4, mulVec3Scalar, perspectiveMat4, transposeMat4} from \"@xeokit/matrix\";\n\n/**\n * PerspectiveProjection projection configuration for a {@link @xeokit/viewer!Camera} .\n *\n * ## Summary\n *\n * * Located at {@link Camera.perspectiveProjection}.\n * * Implicitly sets the left, right, top, bottom frustum planes using {@link PerspectiveProjection.fov}.\n * * {@link PerspectiveProjection.near} and {@link PerspectiveProjection.far} specify the distances to the clipping planes.\n * * {@link PerspectiveProjection.onProjMatrix} will fire an event whenever {@link PerspectiveProjection.projMatrix} updates, which indicates that one or more other properties have updated.\n */\nexport class PerspectiveProjection extends Component {\n\n    /**\n     * The Camera this PerspectiveProjection belongs to.\n     */\n    public readonly camera: Camera;\n\n    /**\n     * Emits an event each time {@link PerspectiveProjection.projMatrix} updates.\n     *\n     * @event\n     */\n    readonly onProjMatrix: EventEmitter<PerspectiveProjection, FloatArrayParam>;\n\n    /**\n     * The type of this projection.\n     */\n    static readonly type: number = PerspectiveProjectionType;\n\n    #state: {\n        far: number;\n        near: number;\n        fov: number;\n        fovAxis: string;\n        projMatrix: FloatArrayParam;\n        inverseProjMatrix: FloatArrayParam;\n        transposedProjMatrix: FloatArrayParam;\n    };\n\n    #inverseMatrixDirty: boolean;\n    #transposedProjMatrixDirty: boolean;\n    #onViewBoundary: any;\n\n\n    /**\n     * @private\n     */\n    constructor(camera: Camera, cfg: {\n        fov?: number,\n        fovAxis?: string,\n        near?: number,\n        far?: number\n    } = {}) {\n\n        super(camera, cfg);\n\n        this.camera = camera;\n\n        this.#state = {\n            near: cfg.near || 0.1,\n            far: cfg.far || 2000.0,\n            fov: cfg.fov || 60.0,\n            fovAxis: cfg.fovAxis || \"min\",\n            projMatrix: createMat4(),\n            inverseProjMatrix: createMat4(),\n            transposedProjMatrix: createMat4()\n        };\n\n        this.#inverseMatrixDirty = true;\n        this.#transposedProjMatrixDirty = true;\n\n        this.#onViewBoundary = this.camera.view.onBoundary.subscribe( () => {\n            this.setDirty();\n        });\n\n        this.onProjMatrix = new EventEmitter(new EventDispatcher<PerspectiveProjection, FloatArrayParam>());\n    }\n\n    /**\n     * Gets the PerspectiveProjection's field-of-view angle (FOV).\n     *\n     * Default value is ````60.0````.\n     *\n     * @returns {Number} Current field-of-view.\n     */\n    get fov(): number {\n        return this.#state.fov;\n    }\n\n    /**\n     * Sets the PerspectiveProjection's field-of-view angle (FOV).\n     *\n     * Default value is ````60.0````.\n     *\n     * @param value New field-of-view.\n     */\n    set fov(value: number) {\n        if (value === this.#state.fov) {\n            return;\n        }\n        this.#state.fov = value;\n        this.setDirty();\n     }\n\n    /**\n     * Gets the PerspectiveProjection's FOV axis.\n     *\n     * Options are ````\"x\"````, ````\"y\"```` or ````\"min\"````, to use the minimum axis.\n     *\n     * Default value is ````\"min\"````.\n     *\n     * @returns {String} The current FOV axis value.\n     */\n    get fovAxis(): string {\n        return this.#state.fovAxis;\n    }\n\n    /**\n     * Sets the PerspectiveProjection's FOV axis.\n     *\n     * Options are ````\"x\"````, ````\"y\"```` or ````\"min\"````, to use the minimum axis. \n     *\n     * Default value ````\"min\"````.\n     *\n     * @param value New FOV axis value.\n     */\n    set fovAxis(value: string) {\n        value = value || \"min\";\n        if (this.#state.fovAxis === value) {\n            return;\n        }\n        if (value !== \"x\" && value !== \"y\" && value !== \"min\") {\n            this.error(\"Unsupported value for 'fovAxis': \" + value + \" - defaulting to 'min'\");\n            value = \"min\";\n        }\n        this.#state.fovAxis = value;\n        this.setDirty();\n    }\n\n    /**\n     * Gets the position of the PerspectiveProjection's near plane on the positive View-space Z-axis.\n     *\n     * Default value is ````0.1````.\n     *\n     * @returns The PerspectiveProjection's near plane position.\n     */\n    get near(): number {\n        return this.#state.near;\n    }\n\n    /**\n     * Sets the position of the PerspectiveProjection's near plane on the positive View-space Z-axis.\n     *\n     * Default value is ````0.1````.\n     *\n     * @param value New PerspectiveProjection near plane position.\n     */\n    set near(value: number) {\n        if (this.#state.near === value) {\n            return;\n        }\n        this.#state.near = value;\n        this.setDirty();\n    }\n\n    /**\n     * Gets the position of this PerspectiveProjection's far plane on the positive View-space Z-axis.\n     *\n     * @return {Number} The PerspectiveProjection's far plane position.\n     */\n    get far(): number {\n        return this.#state.far;\n    }\n\n    /**\n     * Sets the position of this PerspectiveProjection's far plane on the positive View-space Z-axis.\n     *\n     * @param value New PerspectiveProjection far plane position.\n     */\n    set far(value: number) {\n        if (this.#state.far === value) {\n            return;\n        }\n        this.#state.far = value;\n        this.setDirty();\n    }\n\n    /**\n     * Gets the PerspectiveProjection's projection transform matrix.\n     *\n     * Default value is ````[1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1]````.\n     *\n     * @returns  The PerspectiveProjection's projection matrix.\n     */\n    get projMatrix(): FloatArrayParam {\n        if (this.dirty) {\n            this.cleanIfDirty();\n        }\n        return this.#state.projMatrix;\n    }\n\n    /**\n     * Gets the inverse of {@link PerspectiveProjection.projMatrix}.\n     *\n     * @returns  The inverse of {@link PerspectiveProjection.projMatrix}.\n     */\n    get inverseProjMatrix(): FloatArrayParam {\n        if (this.dirty) {\n            this.cleanIfDirty();\n        }\n        if (this.#inverseMatrixDirty) {\n            inverseMat4(this.#state.projMatrix, this.#state.inverseProjMatrix);\n            this.#inverseMatrixDirty = false;\n        }\n        return this.#state.inverseProjMatrix;\n    }\n\n    /**\n     * Gets the transpose of {@link PerspectiveProjection.projMatrix}.\n     *\n     * @returns  The transpose of {@link PerspectiveProjection.projMatrix}.\n     */\n    get transposedProjMatrix(): FloatArrayParam {\n        if (this.dirty) {\n            this.cleanIfDirty();\n        }\n        if (this.#transposedProjMatrixDirty) {\n            transposeMat4(this.#state.projMatrix, this.#state.transposedProjMatrix);\n            this.#transposedProjMatrixDirty = false;\n        }\n        return this.#state.transposedProjMatrix;\n    }\n\n    /**\n     * @private\n     */\n    clean() {\n        const WIDTH_INDEX = 2;\n        const HEIGHT_INDEX = 3;\n        const boundary = this.camera.view.boundary;\n        const aspect = boundary[WIDTH_INDEX] / boundary[HEIGHT_INDEX];\n        const fovAxis = this.#state.fovAxis;\n        let fov = this.#state.fov;\n        if (fovAxis === \"x\" || (fovAxis === \"min\" && aspect < 1) || (fovAxis === \"max\" && aspect > 1)) {\n            fov = fov / aspect;\n        }\n        fov = Math.min(fov, 120);\n        perspectiveMat4(fov * (Math.PI / 180.0), aspect, this.#state.near, this.#state.far, this.#state.projMatrix);\n        this.#inverseMatrixDirty = true;\n        this.#transposedProjMatrixDirty = true;\n        this.camera.view.redraw();\n        this.onProjMatrix.dispatch(this, this.#state.projMatrix);\n    }\n\n    /**\n     * Un-projects the given View-space coordinates and Screen-space depth, using this PerspectiveProjection projection.\n     *\n     * @param canvasPos Inputs 2D View-space coordinates.\n     * @param screenZ Inputs Screen-space Z coordinate.\n     * @param screenPos Outputs 3D Screen/Clip-space coordinates.\n     * @param viewPos Outputs un-projected 3D View-space coordinates.\n     * @param worldPos Outputs un-projected 3D World-space coordinates.\n     */\n    unproject(canvasPos: FloatArrayParam, screenZ: number, screenPos: FloatArrayParam, viewPos: FloatArrayParam, worldPos: FloatArrayParam): FloatArrayParam {\n\n        const canvasElement = this.camera.view.canvasElement;\n        const halfViewWidth = canvasElement.offsetWidth / 2.0;\n        const halfViewHeight = canvasElement.offsetHeight / 2.0;\n\n        screenPos[0] = (canvasPos[0] - halfViewWidth) / halfViewWidth;\n        screenPos[1] = (canvasPos[1] - halfViewHeight) / halfViewHeight;\n        screenPos[2] = screenZ;\n        screenPos[3] = 1.0;\n\n        mulMat4v4(this.inverseProjMatrix, screenPos, viewPos);\n        mulVec3Scalar(viewPos, 1.0 / viewPos[3]);\n\n        viewPos[3] = 1.0;\n        viewPos[1] *= -1;\n\n        mulMat4v4(this.camera.inverseViewMatrix, viewPos, worldPos);\n\n        return worldPos;\n    }\n\n    /** @private\n     *\n     */\n    destroy() {\n        super.destroy();\n        this.camera.view.onBoundary.unsubscribe(this.#onViewBoundary);\n        this.onProjMatrix.clear();\n    }\n}\n","\nimport {EventDispatcher} from \"strongly-typed-events\";\nimport type {Camera} from \"./Camera\";\nimport {Component, EventEmitter} from \"@xeokit/core\";\nimport type {FloatArrayParam} from \"@xeokit/math\";\nimport {OrthoProjectionType} from \"@xeokit/constants\";\nimport {inverseMat4, createMat4, mulMat4v4, mulVec3Scalar, orthoMat4c, transposeMat4} from \"@xeokit/matrix\";\n\n/**\n * Orthographic projection configuration for a {@link @xeokit/viewer!Camera} .\n *\n * * Located at {@link Camera.orthoProjection}.\n * * Works like Blender's orthographic projection, where the positions of the left, right, top and bottom planes are implicitly\n * indicated with a single {@link OrthoProjection.scale} property, which causes the frustum to be symmetrical on X and Y axis, large enough to\n * contain the number of units given by {@link OrthoProjection.scale}.\n * * {@link OrthoProjection.near} and {@link OrthoProjection.far} indicated the distances to the clipping planes.\n * * {@link OrthoProjection.onProjMatrix} will fire an event whenever {@link OrthoProjection.projMatrix} updates, which indicates that one or more other properties have updated.\n */\nexport class OrthoProjection extends Component {\n\n    /**\n     * The Camera this OrthoProjection belongs to.\n     */\n    public readonly camera: Camera;\n\n    /**\n     * Emits an event each time {@link OrthoProjection.projMatrix} updates.\n     *\n     * @event\n     */\n    readonly onProjMatrix: EventEmitter<OrthoProjection, FloatArrayParam>;\n\n    /**\n     * The type of this projection.\n     */\n    static readonly type: number = OrthoProjectionType;\n\n    #state: {\n        far: number;\n        near: number;\n        scale: number;\n        projMatrix: FloatArrayParam;\n        inverseProjMatrix: FloatArrayParam;\n        transposedProjMatrix: FloatArrayParam;\n    };\n\n    #inverseMatrixDirty: boolean;\n    #transposedProjMatrixDirty: boolean;\n    #onViewBoundary: any;\n\n    /**\n     * @private\n     */\n    constructor(camera: Camera, cfg: {\n        far?: number;\n        near?: number;\n        scale?: number;\n    } = {}) {\n\n        super(camera, cfg);\n\n        this.camera = camera;\n\n        this.#state = {\n            near: cfg.near || 0.1,\n            far: cfg.far || 2000.0,\n            scale: cfg.scale || 1.0,\n            projMatrix: createMat4(),\n            inverseProjMatrix: createMat4(),\n            transposedProjMatrix: createMat4()\n        };\n\n        this.onProjMatrix = new EventEmitter(new EventDispatcher<OrthoProjection, FloatArrayParam>());\n\n        this.#inverseMatrixDirty = true;\n        this.#transposedProjMatrixDirty = true;\n\n        this.#onViewBoundary = this.camera.view.onBoundary.subscribe(() => {\n            this.setDirty();\n        });\n    }\n\n    /**\n     * Gets scale factor for this OrthoProjection's extents on X and Y axis.\n     *\n     * Clamps to minimum value of ````0.01```.\n     *\n     * Default value is ````1.0````\n     *\n     * returns New OrthoProjection scale value.\n     */\n    get scale(): number {\n        return this.#state.scale;\n    }\n\n    /**\n     * Sets scale factor for this OrthoProjection's extents on X and Y axis.\n     *\n     * Clamps to minimum value of ````0.01```.\n     *\n     * Default value is ````1.0````\n     * @param value New scale value.\n     */\n    set scale(value: number) {\n        if (value <= 0) {\n            value = 0.01;\n        }\n        this.#state.scale = value;\n        this.setDirty();\n    }\n\n    /**\n     * Gets the position of the OrthoProjection's near plane on the positive View-space Z-axis.\n     *\n     * Default value is ````0.1````.\n     *\n     * returns New OrthoProjection near plane position.\n     */\n    get near(): number {\n        return this.#state.near;\n    }\n\n    /**\n     * Sets the position of the OrthoProjection's near plane on the positive View-space Z-axis.\n     *\n     * Default value is ````0.1````.\n     *\n     * @param value New OrthoProjection near plane position.\n     */\n    set near(value: number) {\n        if (this.#state.near === value) {\n            return;\n        }\n        this.#state.near = value;\n        this.setDirty();\n    }\n\n    /**\n     * Gets the position of the OrthoProjection's far plane on the positive View-space Z-axis.\n     *\n     * Default value is ````10000.0````.\n     *\n     * returns New far ortho plane position.\n     */\n    get far(): number {\n        return this.#state.far;\n    }\n\n    /**\n     * Sets the position of the OrthoProjection's far plane on the positive View-space Z-axis.\n     *\n     * Default value is ````2000.0````.\n     *\n     * @param value New far ortho plane position.\n     */\n    set far(value: number) {\n        if (this.#state.far === value) {\n            return;\n        }\n        this.#state.far = value;\n        this.setDirty();\n    }\n\n    /**\n     * Gets the OrthoProjection's projection transform matrix.\n     *\n     * Default value is ````[1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1]````.\n     *\n     * @returns  The OrthoProjection's projection matrix.\n     */\n    get projMatrix(): FloatArrayParam {\n        if (this.dirty) {\n            this.cleanIfDirty();\n        }\n        return this.#state.projMatrix;\n    }\n\n    /**\n     * Gets the inverse of {@link OrthoProjection.projMatrix}.\n     *\n     * @returns  The inverse of {@link OrthoProjection.projMatrix}.\n     */\n    get inverseProjMatrix(): FloatArrayParam {\n        if (this.dirty) {\n            this.cleanIfDirty();\n        }\n        if (this.#inverseMatrixDirty) {\n            inverseMat4(this.#state.projMatrix, this.#state.inverseProjMatrix);\n            this.#inverseMatrixDirty = false;\n        }\n        return this.#state.inverseProjMatrix;\n    }\n\n    /**\n     * Gets the transpose of {@link OrthoProjection.projMatrix}.\n     *\n     * @returns  The transpose of {@link OrthoProjection.projMatrix}.\n     */\n    get transposedProjMatrix(): FloatArrayParam {\n        if (this.dirty) {\n            this.cleanIfDirty();\n        }\n        if (this.#transposedProjMatrixDirty) {\n            transposeMat4(this.#state.projMatrix, this.#state.transposedProjMatrix);\n            this.#transposedProjMatrixDirty = false;\n        }\n        return this.#state.transposedProjMatrix;\n    }\n\n    /**\n     * @private\n     */\n    clean() {\n\n        const WIDTH_INDEX = 2;\n        const HEIGHT_INDEX = 3;\n\n        const view = this.camera.view;\n        const scale = this.#state.scale;\n        const halfSize = 0.5 * scale;\n\n        const boundary = view.boundary;\n        const boundaryWidth = boundary[WIDTH_INDEX];\n        const boundaryHeight = boundary[HEIGHT_INDEX];\n        const aspect = boundaryWidth / boundaryHeight;\n\n        let left;\n        let right;\n        let top;\n        let bottom;\n\n        if (boundaryWidth > boundaryHeight) {\n            left = -halfSize;\n            right = halfSize;\n            top = halfSize / aspect;\n            bottom = -halfSize / aspect;\n\n        } else {\n            left = -halfSize * aspect;\n            right = halfSize * aspect;\n            top = halfSize;\n            bottom = -halfSize;\n        }\n\n        orthoMat4c(left, right, bottom, top, this.#state.near, this.#state.far, this.#state.projMatrix);\n\n        this.#inverseMatrixDirty = true;\n        this.#transposedProjMatrixDirty = true;\n\n        this.camera.view.redraw();\n\n        this.onProjMatrix.dispatch(this, this.#state.projMatrix);\n    }\n\n    /**\n     * Un-projects the given View-space coordinates, using this OrthoProjection projection.\n     *\n     * @param canvasPos Inputs 2D View-space coordinates.\n     * @param screenZ Inputs Screen-space Z coordinate.\n     * @param screenPos Outputs 3D Screen/Clip-space coordinates.\n     * @param viewPos Outputs un-projected 3D View-space coordinates.\n     * @param worldPos Outputs un-projected 3D World-space coordinates.\n     */\n    unproject(\n        canvasPos: FloatArrayParam,\n        screenZ: number,\n        screenPos: FloatArrayParam,\n        viewPos: FloatArrayParam,\n        worldPos: FloatArrayParam): FloatArrayParam {\n\n        const canvas = this.camera.view.canvasElement;\n\n        const halfViewWidth = canvas.offsetWidth / 2.0;\n        const halfViewHeight = canvas.offsetHeight / 2.0;\n\n        screenPos[0] = (canvasPos[0] - halfViewWidth) / halfViewWidth;\n        screenPos[1] = (canvasPos[1] - halfViewHeight) / halfViewHeight;\n        screenPos[2] = screenZ;\n        screenPos[3] = 1.0;\n\n        mulMat4v4(this.inverseProjMatrix, screenPos, viewPos);\n        mulVec3Scalar(viewPos, 1.0 / viewPos[3]);\n\n        viewPos[3] = 1.0;\n        viewPos[1] *= -1;\n\n        mulMat4v4(this.camera.inverseViewMatrix, viewPos, worldPos);\n\n        return worldPos;\n    }\n\n    /** @private\n     *\n     */\n    destroy() {\n        super.destroy();\n        this.camera.view.onBoundary.unsubscribe(this.#onViewBoundary);\n        this.onProjMatrix.clear();\n    }\n}\n\n","\nimport {EventDispatcher} from \"strongly-typed-events\";\n\nimport type {Camera} from \"./Camera\";\nimport {Component, EventEmitter} from \"@xeokit/core\";\nimport type {FloatArrayParam} from \"@xeokit/math\";\nimport {CustomProjectionType} from \"@xeokit/constants\";\nimport {identityMat4, inverseMat4, createMat4, mulMat4v4, mulVec3Scalar, transposeMat4} from \"@xeokit/matrix\";\n\n/**\n * Configures a custom projection for a {@link @xeokit/viewer!Camera} .\n *\n * * Located at {@link Camera.customProjection}.\n * * {@link CustomProjection.onProjMatrix} will fire an event whenever {@link CustomProjection.projMatrix} updates, which indicates that one or more other properties have updated.\n */\nclass CustomProjection extends Component {\n\n    /**\n     * The Camera this CustomProjection belongs to.\n     */\n    public readonly camera: Camera;\n\n    /**\n     * Emits an event each time {@link CustomProjection.projMatrix} updates.\n     *\n     * @event\n     */\n    readonly onProjMatrix: EventEmitter<CustomProjection, FloatArrayParam>;\n\n    /**\n     * The type of this projection.\n     */\n    static readonly type: number = CustomProjectionType;\n\n    #state: {\n        projMatrix: FloatArrayParam;\n        transposedProjMatrix: FloatArrayParam;\n        inverseProjMatrix: FloatArrayParam\n    };\n\n    #inverseProjMatrixDirty: boolean;\n    #transposedProjMatrixDirty: boolean;\n\n    /**\n     * @private\n     */\n    constructor(camera: Camera, cfg: {\n        projMatrix?: FloatArrayParam\n    } = {}) {\n\n        super(camera, cfg);\n\n        this.camera = camera;\n\n        this.#state = {\n            projMatrix: createMat4(cfg.projMatrix || identityMat4()),\n            inverseProjMatrix: createMat4(),\n            transposedProjMatrix: createMat4()\n        };\n\n        this.onProjMatrix = new EventEmitter(new EventDispatcher<CustomProjection, FloatArrayParam>());\n\n        this.#inverseProjMatrixDirty = true;\n        this.#transposedProjMatrixDirty = false;\n    }\n\n    /**\n     * Gets the CustomProjection's projection transform matrix.\n     *\n     * Default value is ````[1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1]````.\n     *\n     * @return  New value for the CustomProjection's matrix.\n     */\n    get projMatrix(): FloatArrayParam {\n        return this.#state.projMatrix;\n    }\n\n    /**\n     * Sets the CustomProjection's projection transform matrix.\n     *\n     * Default value is ````[1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1]````.\n     *\n     * @param projMatrix New value for the CustomProjection's matrix.\n     */\n    set projMatrix(projMatrix: FloatArrayParam) {\n        // @ts-ignore\n        this.#state.projMatrix.set(projMatrix);\n        this.#inverseProjMatrixDirty = true;\n        this.#transposedProjMatrixDirty = true;\n        this.setDirty();\n        this.camera.view.redraw();\n        this.onProjMatrix.dispatch(this, this.#state.projMatrix);\n    }\n\n    /**\n     * Gets the inverse of {@link CustomProjection.projMatrix}.\n     *\n     * @returns The inverse of {@link CustomProjection.projMatrix}.\n     */\n    get inverseProjMatrix(): FloatArrayParam {\n        if (this.dirty) {\n            this.cleanIfDirty();\n        }\n        if (this.#inverseProjMatrixDirty) {\n            inverseMat4(this.#state.projMatrix, this.#state.inverseProjMatrix);\n            this.#inverseProjMatrixDirty = false;\n        }\n        return this.#state.inverseProjMatrix;\n    }\n\n    /**\n     * Gets the transpose of {@link CustomProjection.projMatrix}.\n     *\n     * @returns The transpose of {@link CustomProjection.projMatrix}.\n     */\n    get transposedProjMatrix(): FloatArrayParam {\n        if (this.dirty) {\n            this.cleanIfDirty();\n        }\n        if (this.#transposedProjMatrixDirty) {\n            transposeMat4(this.#state.projMatrix, this.#state.transposedProjMatrix);\n            this.#transposedProjMatrixDirty = false;\n        }\n        return this.#state.transposedProjMatrix;\n    }\n\n    /**\n     * Un-projects the given View-space coordinates, using this CustomProjection.\n     *\n     * @param canvasPos Inputs 2D View-space coordinates.\n     * @param screenZ Inputs Screen-space Z coordinate.\n     * @param screenPos Outputs 3D Screen/Clip-space coordinates.\n     * @param viewPos Outputs un-projected 3D View-space coordinates.\n     * @param worldPos Outputs un-projected 3D World-space coordinates.\n     */\n    unproject(\n        canvasPos: FloatArrayParam,\n        screenZ: number,\n        screenPos: FloatArrayParam,\n        viewPos: FloatArrayParam,\n        worldPos: FloatArrayParam) {\n        const canvasElement = this.camera.view.canvasElement;\n        const halfViewWidth = canvasElement.offsetWidth / 2.0;\n        const halfViewHeight = canvasElement.offsetHeight / 2.0;\n        screenPos[0] = (canvasPos[0] - halfViewWidth) / halfViewWidth;\n        screenPos[1] = (canvasPos[1] - halfViewHeight) / halfViewHeight;\n        screenPos[2] = screenZ;\n        screenPos[3] = 1.0;\n        mulMat4v4(this.inverseProjMatrix, screenPos, viewPos);\n        mulVec3Scalar(viewPos, 1.0 / viewPos[3]);\n        viewPos[3] = 1.0;\n        viewPos[1] *= -1;\n        mulMat4v4(this.camera.inverseViewMatrix, viewPos, worldPos);\n        return worldPos;\n    }\n\n    /** @private\n     *\n     */\n    destroy() {\n        super.destroy();\n        this.onProjMatrix.clear();\n    }\n}\n\nexport {CustomProjection};","import{createVec3 as t,createMat4 as n,subVec3 as r,lenVec3 as e,createVec2 as o,mulMat4 as i}from\"@xeokit/matrix\";import{newFloatArray as u,MAX_DOUBLE as f,MIN_DOUBLE as a}from\"@xeokit/math\";import{decompressPoint3 as s}from\"@xeokit/compression\";var c=t(),v=t(),l=n();function h(t){return new Float64Array(t||6)}function m(t){return new Int16Array(t||6)}function p(t){return u(t||4)}function x(t){return u(t||32)}function d(t){return u(t||16)}function V(t,n,r,e){return u([t,n,r,e])}function w(t,n,r){var e;void 0===r&&(r=n);var o,i,u,f=n.length,a=t[0],s=t[1],c=t[2],v=t[3],l=t[4],h=t[5],m=t[6],p=t[7],x=t[8],d=t[9],V=t[10],w=t[11],g=t[12],k=t[13],y=t[14],M=t[15];for(e=0;e<f;e+=4)r[e+0]=a*(o=n[e+0])+l*(i=n[e+1])+x*(u=n[e+2])+g,r[e+1]=s*o+h*i+d*u+k,r[e+2]=c*o+m*i+V*u+y,r[e+3]=v*o+p*i+w*u+M;return r}function g(t,n){return t[0]<=n[0]&&n[3]<=t[3]&&t[1]<=n[1]&&t[2]<=n[2]}function k(t,n){return t[0]<=n[0]&&n[3]<=t[3]&&t[1]<=n[1]&&n[4]<=t[4]&&t[2]<=n[2]&&n[5]<=t[5]}var y,M,b,A=(y=u(3),M=u(3),b=u(3),function(t){return y[0]=t[0],y[1]=t[1],y[2]=t[2],M[0]=t[3],M[1]=t[4],M[2]=t[5],r(M,y,b),Math.abs(e(b))}),q=function(){var t=u(3),n=u(3),o=u(3);return function(i,u){t[0]=i[0],t[1]=i[1],t[2]=i[2],n[0]=i[3],n[1]=i[4],n[2]=i[5];var f=r(n,t,o),a=u[0]-i[0],s=i[3]-u[0],c=u[1]-i[1],v=i[4]-u[1],l=u[2]-i[2],h=i[5]-u[2];return f[0]+=a>s?a:s,f[1]+=c>v?c:v,f[2]+=l>h?l:h,Math.abs(e(f))}}();function F(t){return(t[3]-t[0])*(t[4]-t[1])*(t[5]-t[2])}function I(n,r){return void 0===r&&(r=t()),r[0]=(n[0]+n[3])/2,r[1]=(n[1]+n[4])/2,r[2]=(n[2]+n[5])/2,r}function j(t,n){return void 0===n&&(n=o()),n[0]=(t[2]+t[0])/2,n[1]=(t[3]+t[1])/2,n}function z(t){return void 0===t&&(t=h()),t[0]=f,t[1]=f,t[2]=f,t[3]=a,t[4]=a,t[5]=a,t}function B(t){return void 0===t&&(t=m()),t[0]=65535,t[1]=65535,t[2]=65535,t[3]=-65535,t[4]=-65535,t[5]=-65535,t}function C(t,n){return void 0===t&&(t=h()),void 0===n&&(n=x()),n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=1,n[4]=t[3],n[5]=t[1],n[6]=t[2],n[7]=1,n[8]=t[3],n[9]=t[4],n[10]=t[2],n[11]=1,n[12]=t[0],n[13]=t[4],n[14]=t[2],n[15]=1,n[16]=t[0],n[17]=t[1],n[18]=t[5],n[19]=1,n[20]=t[3],n[21]=t[1],n[22]=t[5],n[23]=1,n[24]=t[3],n[25]=t[4],n[26]=t[5],n[27]=1,n[28]=t[0],n[29]=t[4],n[30]=t[5],n[31]=1,n}function D(t,n){return t[0]>n[0]&&(t[0]=n[0]),t[1]>n[1]&&(t[1]=n[1]),t[2]>n[2]&&(t[2]=n[2]),t[3]<n[3]&&(t[3]=n[3]),t[4]<n[4]&&(t[4]=n[4]),t[5]<n[5]&&(t[5]=n[5]),t}function E(t,n){return t[0]>n[0]&&(t[0]=n[0]),t[1]>n[1]&&(t[1]=n[1]),t[3]<n[3]&&(t[3]=n[3]),t[4]<n[4]&&(t[4]=n[4]),t}function G(t,n){return t[0]>n[0]&&(t[0]=n[0]),t[1]>n[1]&&(t[1]=n[1]),t[2]>n[2]&&(t[2]=n[2]),t[3]<n[0]&&(t[3]=n[0]),t[4]<n[1]&&(t[4]=n[1]),t[5]<n[2]&&(t[5]=n[2]),t}function H(t,n){return t[0]>n[0]&&(t[0]=n[0]),t[1]>n[1]&&(t[1]=n[1]),t[3]<n[0]&&(t[3]=n[0]),t[4]<n[1]&&(t[4]=n[1]),t}function J(t,n){for(var r,e,o,i=0,u=n.length;i<u;i+=3)e=n[i+1],o=n[i+2],t[0]>(r=n[i])&&(t[0]=r),t[1]>e&&(t[1]=e),t[2]>o&&(t[2]=o),t[3]<r&&(t[3]=r),t[4]<e&&(t[4]=e),t[5]<o&&(t[5]=o);return t}function K(t,n){return void 0===n&&(n=x()),n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=1,n[4]=t[3],n[5]=t[1],n[6]=t[2],n[7]=1,n[8]=t[3],n[9]=t[4],n[10]=t[2],n[11]=1,n[12]=t[0],n[13]=t[4],n[14]=t[2],n[15]=1,n[16]=t[0],n[17]=t[1],n[18]=t[5],n[19]=1,n[20]=t[3],n[21]=t[1],n[22]=t[5],n[23]=1,n[24]=t[3],n[25]=t[4],n[26]=t[5],n[27]=1,n[28]=t[0],n[29]=t[4],n[30]=t[5],n[31]=1,n}var L,N=(L=u(3),function(t,n,r){n=n||h();for(var e,o,i,u=f,c=f,v=f,l=a,m=a,p=a,x=0,d=t.length;x<d;x+=3)r?(L[0]=t[x+0],L[1]=t[x+1],L[2]=t[x+2],s(L,r,L),e=L[0],o=L[1],i=L[2]):(e=t[x+0],o=t[x+1],i=t[x+2]),e<u&&(u=e),o<c&&(c=o),i<v&&(v=i),e>l&&(l=e),o>m&&(m=o),i>p&&(p=i);return n[0]=u,n[1]=c,n[2]=v,n[3]=l,n[4]=m,n[5]=p,n});function O(t,n){void 0===n&&(n=h());for(var r,e,o,i=f,u=f,s=f,c=a,v=a,l=a,m=0,p=t.length;m<p;m+=4)(r=t[m+0])<i&&(i=r),(e=t[m+1])<u&&(u=e),(o=t[m+2])<s&&(s=o),r>c&&(c=r),e>v&&(v=e),o>l&&(l=o);return n[0]=i,n[1]=u,n[2]=s,n[3]=c,n[4]=v,n[5]=l,n}function P(t,n){void 0===n&&(n=h());for(var r,e,o,i=f,u=f,s=f,c=a,v=a,l=a,m=0,p=t.length;m<p;m++)(r=t[m][0])<i&&(i=r),(e=t[m][1])<u&&(u=e),(o=t[m][2])<s&&(s=o),r>c&&(c=r),e>v&&(v=e),o>l&&(l=o);return n[0]=i,n[1]=u,n[2]=s,n[3]=c,n[4]=v,n[5]=l,n}function Q(n,r){void 0===r&&(r=t());for(var e=0,o=0,i=0,u=0,f=n.length;u<f;u+=3)e+=n[u+0],o+=n[u+1],i+=n[u+2];var a=n.length/3;return r[0]=e/a,r[1]=o/a,r[2]=i/a,r}var R=/*#__PURE__*/function(){function n(){this.testVertex=void 0,this.offset=void 0,this.normal=void 0,this.normal=t(),this.offset=0,this.testVertex=t()}return n.prototype.set=function(t,n,r,e){var o=1/Math.sqrt(t*t+n*n+r*r);this.normal[0]=t*o,this.normal[1]=n*o,this.normal[2]=r*o,this.offset=e*o,this.testVertex[0]=this.normal[0]>=0?1:0,this.testVertex[1]=this.normal[1]>=0?1:0,this.testVertex[2]=this.normal[2]>=0?1:0},n}(),S=1,T=2,U=3,W=function(){this.planes=void 0,this.planes=[new R,new R,new R,new R,new R,new R]};function X(t,n,r){var e=i(n,t,l),o=e[0],u=e[1],f=e[2],a=e[3],s=e[4],c=e[5],v=e[6],h=e[7],m=e[8],p=e[9],x=e[10],d=e[11],V=e[12],w=e[13],g=e[14],k=e[15];return(r=r||new W).planes[0].set(a-o,h-s,d-m,k-V),r.planes[1].set(a+o,h+s,d+m,k+V),r.planes[2].set(a-u,h-c,d-p,k-w),r.planes[3].set(a+u,h+c,d+p,k+w),r.planes[4].set(a-f,h-v,d-x,k-g),r.planes[5].set(a+f,h+v,d+x,k+g),r}function Y(t,n){var r=1,e=c,o=v;e[0]=n[0],e[1]=n[1],e[2]=n[2],o[0]=n[3],o[1]=n[4],o[2]=n[5];for(var i=[e,o],u=0;u<6;++u){var f=t.planes[u];if(f.normal[0]*i[f.testVertex[0]][0]+f.normal[1]*i[f.testVertex[1]][1]+f.normal[2]*i[f.testVertex[2]][2]+f.offset<0)return 3;f.normal[0]*i[1-f.testVertex[0]][0]+f.normal[1]*i[1-f.testVertex[1]][1]+f.normal[2]*i[1-f.testVertex[2]][2]+f.offset<0&&(r=2)}return r}function Z(t,n){return 2}function $(t,n,r){return!0}function _(t,n,r,e){return!0}function tt(t,n,r){return!0}function nt(t,n){return!0}function rt(t,n){return!0}function et(t,n,r){return!1}function ot(t,n,r){return!1}function it(t,n){for(var r=t[0],e=t[1],o=t[2],i=t[3],u=t[4],f=t[5],a=0,s=n.length;a<s;a+=3){var c=n[a];if(r<=c&&c<=i){var v=n[a+1];if(e<=v&&v<=u){var l=n[a+2];if(o<=l&&l<=f)return!0}}}return!1}function ut(t,n){return t[0]<=n[0]&&n[0]<=t[3]&&t[1]<=n[1]&&n[1]<=t[4]&&t[2]<=n[2]&&n[2]<=t[5]}function ft(t,n){return t[0]<=n[0]&&n[0]<=t[3]&&t[1]<=n[1]&&n[1]<=t[4]}export{C as AABB3ToOBB3,K as ABB3ToOBB3,W as Frustum3,R as FrustumPlane3,S as INSIDE,T as INTERSECT,O as OBB3ToAABB3,U as OUTSIDE,z as collapseAABB3,B as collapseAABB3Int16,g as containsAABB2,ft as containsAABB2Point2,k as containsAABB3,ut as containsAABB3Point3,p as createAABB2,h as createAABB3,m as createAABB3Int16,d as createOBB2,x as createOBB3,V as createSphere3,E as expandAABB2,H as expandAABB2Point2,D as expandAABB3,G as expandAABB3Point3,J as expandAABB3Points3,j as getAABB2Center,F as getAABB3Area,I as getAABB3Center,A as getAABB3Diag,q as getAABB3DiagPoint,Q as getPositions3Center,ot as intersectAABB3Lines3,it as intersectAABB3Positions3,et as intersectAABB3Triangles3,Z as intersectAABB3s,Y as intersectFrustum3AABB3,tt as intersectFrustum3Lines3,rt as intersectFrustum3Point3,nt as intersectFrustum3Positions3,_ as intersectFrustum3Triangle3,$ as intersectFrustum3Triangles3,P as points3ToAABB3,N as positions3ToAABB3,X as setFrustum3,w as transformOBB3};\n//# sourceMappingURL=index.es.map\n","import {EventDispatcher} from \"strongly-typed-events\";\nimport {\n    addVec3,\n    createMat4,\n    createVec3,\n    cross3Vec3,\n    dotVec3,\n    identityMat4,\n    inverseMat4,\n    lenVec3,\n    lookAtMat4v,\n    mulMat4,\n    mulVec3Scalar,\n    normalizeVec3,\n    rotationMat4v,\n    subVec3,\n    transformPoint3,\n    transposeMat4\n} from \"@xeokit/matrix\";\n\nimport {PerspectiveProjection} from './PerspectiveProjection';\nimport {OrthoProjection} from './OrthoProjection';\nimport type {FrustumProjection} from './FrustumProjection';\nimport {CustomProjection} from './CustomProjection';\nimport type {View} from \"./View\";\nimport {Component, EventEmitter} from \"@xeokit/core\";\nimport {DEGTORAD, FloatArrayParam} from \"@xeokit/math\";\nimport {\n    CustomProjectionType,\n    FrustumProjectionType,\n    OrthoProjectionType,\n    PerspectiveProjectionType\n} from \"@xeokit/constants\";\nimport {Frustum3, setFrustum3} from \"@xeokit/boundaries\";\n\n\nconst tempVec3 = createVec3();\nconst tempVec3b = createVec3();\nconst tempVec3c = createVec3();\nconst tempVec3d = createVec3();\nconst tempVec3e = createVec3();\nconst tempVec3f = createVec3();\nconst tempMat = createMat4();\nconst tempMatb = createMat4();\nconst eyeLookVec = createVec3();\nconst eyeLookVecNorm = createVec3();\nconst eyeLookOffset = createVec3();\nconst offsetEye = createVec3();\n\n\n/**\n * Controls the viewpoint and projection for a {@link @xeokit/viewer!View}.\n *\n * ## Summary\n *\n * * Located at {@link View.camera}\n * * Views are located at {@link Viewer.views}\n * * Controls camera viewing and projection transforms\n * * Provides methods to pan, zoom and orbit\n * * Dynamically configurable World-space axis\n * * Has {@link PerspectiveProjection}, {@link OrthoProjection} and {@link FrustumProjection} and {@link CustomProjection}, which you can dynamically switch between\n * * Switchable gimbal lock\n * * Can be flown to look at targets using the View's {@link CameraFlightAnimation}\n * * Can be animated along a path using a {@link CameraPathAnimation}\n *\n * ## Getting a View's Camera\n *\n * Let's create a {@link @xeokit/viewer!Viewer} with a single {@link @xeokit/viewer!View}, from which we'll get a Camera:\n *\n * ````javascript\n * const viewer = new Viewer();\n *\n * const view = new View(viewer, {\n *      canvasId: \"myCanvas1\"\n * });\n *\n * const camera = view.camera;\n * ````\n *\n * ## Setting the Camera Position\n *\n * Get and set the Camera's absolute position:\n *\n * ````javascript\n * camera.eye = [-10,0,0];\n * camera.look = [-10,0,0];\n * camera.up = [0,1,0];\n * ````\n *\n * ## Camera View and Projection Matrices\n *\n * The Camera's *view matrix* transforms coordinates from World-space to View-space:\n *\n * ````javascript\n * var viewMatrix = camera.viewMatrix;\n * ````\n *\n * {@link Camera.onViewMatrix} fires whenever {@link Camera.viewMatrix} updates:\n *\n * ````javascript\n * camera.onViewMatrix.subscribe((camera, matrix) => { ... });\n * ````\n *\n * ## Rotating the Camera\n *\n * Orbiting the {@link Camera.look} position:\n *\n * ````javascript\n * camera.orbitYaw(20.0);\n * camera.orbitPitch(10.0);\n * ````\n *\n * Perform a *first-person* rotation, in which we rotate {@link Camera.look} and {@link Camera.up} about {@link Camera.eye}:\n *\n * ````javascript\n * camera.yaw(5.0);\n * camera.pitch(-10.0);\n * ````\n *\n * ## Panning the Camera\n *\n * Pan along the Camera's local axis (ie. left/right, up/down, forward/backward):\n *\n * ````javascript\n * camera.pan([-20, 0, 10]);\n * ````\n *\n * ## Zooming the Camera\n *\n * Zoom to vary distance between {@link Camera.eye} and {@link Camera.look}:\n *\n * ````javascript\n * camera.zoom(-5); // Move five units closer\n * ````\n *\n * Get the current distance between {@link Camera.eye} and {@link Camera.look}:\n *\n * ````javascript\n * var distance = camera.eyeLookDist;\n * ````\n *\n * ## Projection\n *\n * The Camera has a Component to manage each projection type, which are: {@link PerspectiveProjection}, {@link OrthoProjection}\n * and {@link FrustumProjection} and {@link CustomProjection}.\n *\n * You can configure those components at any time, regardless of which is currently active:\n *\n * The Camera has a {@link PerspectiveProjection} to manage perspective\n * ````javascript\n *\n * // Set some properties on PerspectiveProjection\n * camera.perspectiveProjection.near = 0.4;\n * camera.perspectiveProjection.fov = 45;\n *\n * // Set some properties on OrthoProjection\n * camera.orthoProjection.near = 0.8;\n * camera.orthoProjection.far = 1000;\n *\n * // Set some properties on FrustumProjection\n * camera.frustumProjection.left = -1.0;\n * camera.frustumProjection.right = 1.0;\n * camera.frustumProjection.far = 1000.0;\n *\n * // Set the matrix property on CustomProjection\n * camera.customProjection.projMatrix = [1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1];\n *\n * // Switch between the projection types\n * Camera.projectionType = PerspectiveProjectionType; // Switch to perspective\n * Camera.projectionType = FrustumProjectiontype; // Switch to frustum\n * Camera.projectionType = OrthoProjectionType; // Switch to ortho\n * Camera.projectionType = CustomProjectionType; // Switch to custom\n * ````\n *\n * Camera provides the projection matrix for the currently active projection in {@link Camera.projMatrix}.\n *\n * Get the projection matrix:\n *\n * ````javascript\n * var projMatrix = camera.projMatrix;\n * ````\n *\n * Listen for projection matrix updates:\n *\n * ````javascript\n * camera.onProjMatrix((camera, matrix) => { ... });\n * ````\n *\n * ## Configuring World up direction\n *\n * We can dynamically configure the directions of the World-space coordinate system.\n *\n * Setting the +Y axis as World \"up\", +X as right and -Z as forwards (convention in some modeling software):\n *\n * ````javascript\n * camera.worldAxis = [\n *     1, 0, 0,    // Right\n *     0, 1, 0,    // Up\n *     0, 0,-1     // Forward\n * ];\n * ````\n *\n * Setting the +Z axis as World \"up\", +X as right and -Y as \"up\" (convention in most CAD and BIM viewers):\n *\n * ````javascript\n * camera.worldAxis = [\n *     1, 0, 0, // Right\n *     0, 0, 1, // Up\n *     0,-1, 0  // Forward\n * ];\n * ````\n *\n * The Camera has read-only convenience properties that provide each axis individually:\n *\n * ````javascript\n * var worldRight = camera.worldRight;\n * var worldForward = camera.worldForward;\n * var worldUp = camera.worldUp;\n * ````\n *\n * ## Gimbal locking\n *\n * By default, the Camera locks yaw rotation to pivot about the World-space \"up\" axis. We can dynamically lock and unlock that at any time:\n *\n * ````javascript\n * camera.gimbalLock = false; // Yaw rotation now happens about Camera's local Y-axis\n * camera.gimbalLock = true; // Yaw rotation now happens about World's \"up\" axis\n * ````\n *\n * See: <a href=\"https://en.wikipedia.org/wiki/Gimbal_lock\">https://en.wikipedia.org/wiki/Gimbal_lock</a>\n */\nclass Camera extends Component {\n\n    /**\n     * The View to which this Camera belongs.\n     *\n     * @property view\n     * @type {View}\n     * @final\n     */\n    public readonly view: View;\n\n    /**\n     * The perspective projection.\n     *\n     * The Camera uses this while {@link Camera.projectionType} equals {@link PerspectiveProjectionType}.\n     */\n    public readonly perspectiveProjection: PerspectiveProjection;\n\n    /**\n     * The orthographic projection.\n     *\n     * The Camera uses this while {@link Camera.projectionType} equals {@link OrthoProjectionType}.\n     */\n    public readonly orthoProjection: OrthoProjection;\n\n    /**\n     * The frustum projection.\n     *\n     * The Camera uses this while {@link Camera.projectionType} equals {@link FrustumProjectionType}.\n     */\n    public readonly frustumProjection: FrustumProjection;\n\n    /**\n     * The custom projection.\n     *\n     * The Camera uses this while {@link Camera.projectionType} equals {@link CustomProjectionType}.\n     */\n    public readonly customProjection: CustomProjection;\n\n    /**\n     * Emits an event each time {@link Camera.projectionType} updates.\n     *\n     * ````javascript\n     * myView.camera.onProjectionType.subscribe((camera, projType) => { ... });\n     * ````\n     *\n     * @event\n     */\n    readonly onProjectionType: EventEmitter<Camera, number>;\n\n    /**\n     * Emits an event each time {@link Camera.viewMatrix} updates.\n     *\n     * ````javascript\n     * myView.camera.onViewMatrix.subscribe((camera, viewMatrix) => { ... });\n     * ````\n     *\n     * @event\n     */\n    readonly onViewMatrix: EventEmitter<Camera, FloatArrayParam>;\n\n    /**\n     * Emits an event each time {@link Camera.projMatrix} updates.\n     *\n     * ````javascript\n     * myView.camera.onProjMatrix.subscribe((camera, projMatrix) => { ... });\n     * ````\n     *\n     * @event\n     */\n    readonly onProjMatrix: EventEmitter<Camera, FloatArrayParam>;\n\n    /**\n     * Emits an event each time {@link Camera.worldAxis} updates.\n     *\n     * ````javascript\n     * myView.camera.onWorldAxis.subscribe((camera, worldAxis) => { ... });\n     * ````\n     *\n     * @event\n     */\n    readonly onWorldAxis: EventEmitter<Camera, FloatArrayParam>;\n\n    /**\n     * Emits an event each time {@link Camera.frustum} updates.\n     *\n     * ````javascript\n     * myView.camera.onFrustum.subscribe((camera, frustum) => { ... });\n     * ````\n     *\n     * @event\n     */\n    readonly onFrustum: EventEmitter<Camera, Frustum3>;\n\n    readonly #state: {\n        deviceMatrix: FloatArrayParam,\n        viewNormalMatrix: FloatArrayParam,\n        hasDeviceMatrix: boolean,\n        viewMatrix: FloatArrayParam,\n        inverseViewMatrix: FloatArrayParam,\n        eye: FloatArrayParam,\n        look: FloatArrayParam,\n        up: FloatArrayParam,\n        worldAxis: FloatArrayParam,\n        worldUp: FloatArrayParam,\n        worldRight: FloatArrayParam,\n        worldForward: FloatArrayParam,\n        gimbalLock: boolean,\n        constrainPitch: boolean,\n        projectionType: number\n    };\n\n    /**\n     * The viewing frustum.\n     */\n    #frustum: Frustum3;\n    #activeProjection: PerspectiveProjection | OrthoProjection | FrustumProjection | CustomProjection;\n\n    /**\n     * @private\n     */\n    constructor(view: View, cfg: {\n        eye?: FloatArrayParam;\n        look?: FloatArrayParam,\n        up?: FloatArrayParam;\n        deviceMatrix?: FloatArrayParam;\n        gimbalLock?: boolean;\n        worldAxis?: FloatArrayParam;\n        constrainPitch?: boolean;\n        projectionType?: number\n    } = {}) {\n\n        super(view, cfg);\n\n        this.onProjectionType = new EventEmitter(new EventDispatcher<Camera, number>());\n        this.onViewMatrix = new EventEmitter(new EventDispatcher<Camera, FloatArrayParam>());\n        this.onProjMatrix = new EventEmitter(new EventDispatcher<Camera, FloatArrayParam>());\n        this.onWorldAxis = new EventEmitter(new EventDispatcher<Camera, FloatArrayParam>());\n        this.onFrustum = new EventEmitter(new EventDispatcher<Camera, Frustum3>());\n\n        this.view = view;\n\n        this.#state = {\n            eye: createVec3(cfg.eye || [0, 0, 10]),\n            look: createVec3(cfg.look || [0, 0, 0]),\n            up: createVec3(cfg.up || [0, 1, 0]),\n            worldUp: createVec3([0, 1, 0]),\n            worldRight: createVec3([1, 0, 0]),\n            worldForward: createVec3([0, 0, -1]),\n            worldAxis: new Float32Array(cfg.worldAxis || [1, 0, 0, 0, 1, 0, 0, 0, 1]),\n            gimbalLock: cfg.gimbalLock !== false,\n            constrainPitch: cfg.constrainPitch === true,\n            projectionType: cfg.projectionType || PerspectiveProjectionType,\n            deviceMatrix: cfg.deviceMatrix ? createMat4(cfg.deviceMatrix) : identityMat4(),\n            hasDeviceMatrix: !!cfg.deviceMatrix,\n            viewMatrix: createMat4(),\n            viewNormalMatrix: createMat4(),\n            inverseViewMatrix: createMat4()\n        };\n\n        this.#frustum = new Frustum3();\n\n        this.perspectiveProjection = new PerspectiveProjection(this);\n        this.orthoProjection = new OrthoProjection(this);\n        this.customProjection = new CustomProjection(this);\n\n        this.#activeProjection = this.perspectiveProjection;\n\n        this.perspectiveProjection.onProjMatrix.subscribe(() => {\n            if (this.#state.projectionType === PerspectiveProjectionType) {\n                this.onProjMatrix.dispatch(this, this.perspectiveProjection.projMatrix);\n            }\n        });\n\n        this.orthoProjection.onProjMatrix.subscribe(() => {\n            if (this.#state.projectionType === OrthoProjectionType) {\n                this.onProjMatrix.dispatch(this, this.orthoProjection.projMatrix);\n            }\n        });\n\n        this.frustumProjection.onProjMatrix.subscribe(() => {\n            if (this.#state.projectionType === FrustumProjectionType) {\n                this.onProjMatrix.dispatch(this, this.frustumProjection.projMatrix);\n            }\n        });\n\n        this.customProjection.onProjMatrix.subscribe(() => {\n            if (this.#state.projectionType === CustomProjectionType) {\n                this.onProjMatrix.dispatch(this, this.customProjection.projMatrix);\n            }\n        });\n    }\n\n    /**\n     * Gets the currently active projection for this Camera.\n     *\n     * The currently active project is selected with {@link Camera.projectionType}.\n     *\n     * @returns {PerspectiveProjection|OrthoProjection|FrustumProjection|CustomProjection} The currently active projection is active.\n     */\n    get project(): PerspectiveProjection | OrthoProjection | FrustumProjection | CustomProjection {\n        return this.#activeProjection;\n    }\n\n    /**\n     * Gets the position of the Camera's eye.\n     *\n     * Default vale is ````[0,0,10]````.\n     *\n     * @type {Number[]} New eye position.\n     */\n    get eye(): FloatArrayParam {\n        return this.#state.eye;\n    }\n\n    /**\n     * Sets the position of the Camera's eye.\n     *\n     * Default value is ````[0,0,10]````.\n     *\n     * @emits \"eye\" event on change, with the value of this property.\n     * @type {Number[]} New eye position.\n     */\n    set eye(eye: FloatArrayParam) {\n        // @ts-ignore\n        this.#state.eye.set(eye);\n        this.setDirty(); // Ensure matrix built on next \"tick\"\n    }\n\n    /**\n     * Gets the position of this Camera's point-of-interest.\n     *\n     * Default value is ````[0,0,0]````.\n     *\n     * @returns {Number[]} Camera look position.\n     */\n    get look(): FloatArrayParam {\n        return this.#state.look;\n    }\n\n    /**\n     * Sets the position of this Camera's point-of-interest.\n     *\n     * Default value is ````[0,0,0]````.\n     *\n     * @param look Camera look position.\n     */\n    set look(look: FloatArrayParam) {\n        // @ts-ignore\n        this.#state.look.set(look);\n        this.setDirty(); // Ensure matrix built on next \"tick\"\n    }\n\n    /**\n     * Gets the direction of this Camera's {@link Camera.up} vector.\n     *\n     * @returns {Number[]} Direction of \"up\".\n     */\n    get up(): FloatArrayParam {\n        return this.#state.up;\n    }\n\n    /**\n     * Sets the direction of this Camera's {@link Camera.up} vector.\n     *\n     * @param up Direction of \"up\".\n     */\n    set up(up: FloatArrayParam) {\n        // @ts-ignore\n        this.#state.up.set(up);\n        this.setDirty();\n    }\n\n    /**\n     * Gets the direction of World-space \"up\".\n     *\n     * This is set by {@link Camera.worldAxis}.\n     *\n     * Default value is ````[0,1,0]````.\n     *\n     * @returns {Number[]} The \"up\" vector.\n     */\n    get worldUp(): FloatArrayParam {\n        return this.#state.worldUp;\n    }\n\n    /**\n     * Gets the direction of World-space \"right\".\n     *\n     * This is set by {@link Camera.worldAxis}.\n     *\n     * Default value is ````[1,0,0]````.\n     *\n     * @returns {Number[]} The \"up\" vector.\n     */\n    get worldRight(): FloatArrayParam {\n        return this.#state.worldRight;\n    }\n\n    /**\n     * Gets the direction of World-space \"forwards\".\n     *\n     * This is set by {@link Camera.worldAxis}.\n     *\n     * Default value is ````[0,0,1]````.\n     *\n     * @returns {Number[]} The \"up\" vector.\n     */\n    get worldForward(): FloatArrayParam {\n        return this.#state.worldForward;\n    }\n\n    /**\n     * Gets whether to prevent camera from being pitched upside down.\n     *\n     * The camera is upside down when the angle between {@link Camera.up} and {@link Camera.worldUp} is less than one degree.\n     *\n     * Default value is ````false````.\n     *\n     * @returns {Boolean} ````true```` if pitch rotation is currently constrained.\n     */\n    get constrainPitch(): boolean {\n        return this.#state.constrainPitch;\n    }\n\n    /**\n     * Sets whether to prevent camera from being pitched upside down.\n     *\n     * The camera is upside down when the angle between {@link Camera.up} and {@link Camera.worldUp} is less than one degree.\n     *\n     * Default value is ````false````.\n     *\n     * @param value Set ````true```` to contrain pitch rotation.\n     */\n    set constrainPitch(value: boolean) {\n        this.#state.constrainPitch = value;\n    }\n\n    /**\n     * Gets whether to lock yaw rotation to pivot about the World-space \"up\" axis.\n     *\n     * @returns {Boolean} Returns ````true```` if gimbal is locked.\n     */\n    get gimbalLock(): boolean {\n        return this.#state.gimbalLock;\n    }\n\n    /**\n     * Sets whether to lock yaw rotation to pivot about the World-space \"up\" axis.\n     *\n     * @params {Boolean} gimbalLock Set true to lock gimbal.\n     */\n    set gimbalLock(value: boolean) {\n        this.#state.gimbalLock = value;\n    }\n\n    /**\n     * Gets the up, right and forward axis of the World coordinate system.\n     *\n     * Has format: ````[rightX, rightY, rightZ, upX, upY, upZ, forwardX, forwardY, forwardZ]````\n     *\n     * Default axis is ````[1, 0, 0, 0, 1, 0, 0, 0, 1]````\n     *\n     * @returns {Number[]} The current World coordinate axis.\n     */\n    get worldAxis(): FloatArrayParam {\n        return this.#state.worldAxis;\n    }\n\n    /**\n     * Sets the up, right and forward axis of the World coordinate system.\n     *\n     * Has format: ````[rightX, rightY, rightZ, upX, upY, upZ, forwardX, forwardY, forwardZ]````\n     *\n     * Default axis is ````[1, 0, 0, 0, 1, 0, 0, 0, 1]````\n     *\n     * @param axis The new Wworld coordinate axis.\n     */\n    set worldAxis(axis: FloatArrayParam) {\n        const state = this.#state;\n        // @ts-ignore\n        state.worldAxis.set(axis);\n        state.worldRight[0] = state.worldAxis[0];\n        state.worldRight[1] = state.worldAxis[1];\n        state.worldRight[2] = state.worldAxis[2];\n        state.worldUp[0] = state.worldAxis[3];\n        state.worldUp[1] = state.worldAxis[4];\n        state.worldUp[2] = state.worldAxis[5];\n        state.worldForward[0] = state.worldAxis[6];\n        state.worldForward[1] = state.worldAxis[7];\n        state.worldForward[2] = state.worldAxis[8];\n        this.onWorldAxis.dispatch(this, state.worldAxis);\n    }\n\n    /**\n     * Gets an optional matrix to premultiply into {@link Camera.projMatrix} matrix.\n     *\n     * @returns {Number[]} The matrix.\n     */\n    get deviceMatrix(): FloatArrayParam {\n        // @ts-ignore\n        return this.#state.deviceMatrix;\n    }\n\n    /**\n     * Sets an optional matrix to premultiply into {@link Camera.projMatrix} matrix.\n     *\n     * This is intended to be used for stereo rendering with WebVR etc.\n     *\n     * @param matrix The matrix.\n     */\n    set deviceMatrix(matrix: FloatArrayParam) {\n        // @ts-ignore\n        this.#state.deviceMatrix.set(matrix || [1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1]);\n        this.#state.hasDeviceMatrix = !!matrix;\n        this.setDirty();\n    }\n\n    /**\n     * Gets if the World-space X-axis is \"up\".\n     * @returns {boolean}\n     */\n    get xUp(): boolean {\n        return this.#state.worldUp[0] > this.#state.worldUp[1] && this.#state.worldUp[0] > this.#state.worldUp[2];\n    }\n\n    /**\n     * Gets if the World-space Y-axis is \"up\".\n     * @returns {boolean}\n     */\n    get yUp(): boolean {\n        return this.#state.worldUp[1] > this.#state.worldUp[0] && this.#state.worldUp[1] > this.#state.worldUp[2];\n    }\n\n    /**\n     * Gets if the World-space Z-axis is \"up\".\n     * @returns {boolean}\n     */\n    get zUp(): boolean {\n        return this.#state.worldUp[2] > this.#state.worldUp[0] && this.#state.worldUp[2] > this.#state.worldUp[1];\n    }\n\n    /**\n     * Gets distance from {@link Camera.look} to {@link Camera.eye}.\n     *\n     * @returns {Number} The distance.\n     */\n    get eyeLookDist(): number {\n        return lenVec3(subVec3(this.#state.look, this.#state.eye, tempVec3));\n    }\n\n    /**\n     * Gets the Camera's viewing transformation matrix.\n     *\n     * @returns {Number[]} The viewing transform matrix.\n     */\n    get viewMatrix(): FloatArrayParam {\n        if (this.dirty) {\n            this.cleanIfDirty();\n        }\n        return this.#state.viewMatrix;\n    }\n\n    /**\n     * Gets the inverse of the Camera's viewing transform matrix.\n     *\n     * @returns {Number[]} The inverse viewing transform matrix.\n     */\n    get inverseViewMatrix(): FloatArrayParam {\n        if (this.dirty) {\n            this.cleanIfDirty();\n        }\n        return this.#state.inverseViewMatrix;\n    }\n\n    /**\n     * Gets the Camera's projection transformation projMatrix.\n     *\n     * @returns {Number[]} The projection matrix.\n     */\n    get projMatrix(): FloatArrayParam {\n        // @ts-ignore\n        return this.#activeProjection.projMatrix;\n    }\n\n    /**\n     * Gets the Camera's 3D World-space viewing frustum.\n     *\n     * @returns {Frustum3} The frustum.\n     */\n    get frustum() {\n        if (this.dirty) {\n            this.cleanIfDirty();\n        }\n        return this.#frustum;\n    }\n\n    /**\n     * Gets the active projection type.\n     *\n     * Possible values are ````PerspectiveProjectionType````, ````OrthoProjectionType````, ````\"frustum\"```` and ````\"customProjection\"````.\n     *\n     * Default value is ````PerspectiveProjectionType````.\n     *\n     * @returns {number} Identifies the active projection type.\n     */\n    get projectionType(): number {\n        return this.#state.projectionType;\n    }\n\n    /**\n     * Sets the active projection type.\n     *\n     * Accepted values are ````PerspectiveProjectionType````, ````OrthoProjectionType````, ````\"frustum\"```` and ````\"customProjection\"````.\n     *\n     * Default value is ````PerspectiveProjectionType````.\n     *\n     * @param value Identifies the active projection type.\n     */\n    set projectionType(value: number | undefined) {\n        value = value || PerspectiveProjectionType;\n        if (this.#state.projectionType === value) {\n            return;\n        }\n        if (value === PerspectiveProjectionType) {\n            this.#activeProjection = this.perspectiveProjection;\n        } else if (value === OrthoProjectionType) {\n            this.#activeProjection = this.orthoProjection;\n        } else if (value === FrustumProjectionType) {\n            this.#activeProjection = this.frustumProjection;\n        } else if (value === CustomProjectionType) {\n            this.#activeProjection = this.customProjection;\n        } else {\n            this.error(\"Unsupported value for 'projection': \" + value + \" defaulting to PerspectiveProjectionType\");\n            this.#activeProjection = this.perspectiveProjection;\n            value = PerspectiveProjectionType;\n        }\n        // @ts-ignore\n        this.#activeProjection.clean();\n        this.#state.projectionType = value;\n        this.clean();\n        this.onProjectionType.dispatch(this, this.#state.projectionType);\n        this.onProjMatrix.dispatch(this, this.#activeProjection.projMatrix);\n    }\n\n    clean() {\n        const state = this.#state;\n        // In ortho mode, build the view matrix with an eye position that's translated\n        // well back from look, so that the front sectionPlane plane doesn't unexpectedly cut\n        // the front off the view (not a problem with perspective, since objects close enough\n        // to be clipped by the front plane are usually too big to see anything of their cross-sections).\n        let eye;\n        if (this.projectionType === OrthoProjectionType) {\n            subVec3(this.#state.eye, this.#state.look, eyeLookVec);\n            normalizeVec3(eyeLookVec, eyeLookVecNorm);\n            mulVec3Scalar(eyeLookVecNorm, 1000.0, eyeLookOffset);\n            addVec3(this.#state.look, eyeLookOffset, offsetEye);\n            eye = offsetEye;\n        } else {\n            eye = this.#state.eye;\n        }\n        if (state.hasDeviceMatrix) {\n            lookAtMat4v(eye, this.#state.look, this.#state.up, tempMatb);\n            mulMat4(state.deviceMatrix, tempMatb, state.viewMatrix);\n        } else {\n            lookAtMat4v(eye, this.#state.look, this.#state.up, state.viewMatrix);\n        }\n        inverseMat4(this.#state.viewMatrix, this.#state.inverseViewMatrix);\n        transposeMat4(this.#state.inverseViewMatrix, this.#state.viewNormalMatrix);\n        this.view.redraw();\n        setFrustum3(this.#state.viewMatrix, this.#activeProjection.projMatrix, this.#frustum);\n        this.onViewMatrix.dispatch(this, this.#state.viewMatrix);\n        this.onFrustum.dispatch(this, this.#frustum);\n    }\n\n    /**\n     * Rotates {@link Camera.eye} about {@link Camera.look}, around the {@link Camera.up} vector\n     *\n     * @param angleInc Angle of rotation in degrees\n     */\n    orbitYaw(angleInc: number) {\n        let lookEyeVec = subVec3(this.#state.eye, this.#state.look, tempVec3);\n        rotationMat4v(angleInc * 0.0174532925, this.#state.gimbalLock ? this.#state.worldUp : this.#state.up, tempMat);\n        lookEyeVec = transformPoint3(tempMat, lookEyeVec, tempVec3b);\n        this.eye = addVec3(this.#state.look, lookEyeVec, tempVec3c); // Set eye position as 'look' plus 'eye' vector\n        this.up = transformPoint3(tempMat, this.#state.up, tempVec3d); // Rotate 'up' vector\n    }\n\n    /**\n     * Rotates {@link Camera.eye} about {@link Camera.look} around the right axis (orthogonal to {@link Camera.up} and \"look\").\n     *\n     * @param angleInc Angle of rotation in degrees\n     */\n    orbitPitch(angleInc: number) {\n        if (this.#state.constrainPitch) {\n            angleInc = dotVec3(this.#state.up, this.#state.worldUp) / DEGTORAD;\n            if (angleInc < 1) {\n                return;\n            }\n        }\n        let eye2 = subVec3(this.#state.eye, this.#state.look, tempVec3);\n        const left = cross3Vec3(normalizeVec3(eye2, tempVec3b), normalizeVec3(this.#state.up, tempVec3c));\n        rotationMat4v(angleInc * 0.0174532925, left, tempMat);\n        eye2 = transformPoint3(tempMat, eye2, tempVec3d);\n        this.up = transformPoint3(tempMat, this.#state.up, tempVec3e);\n        this.eye = addVec3(eye2, this.#state.look, tempVec3f);\n    }\n\n    /**\n     * Rotates {@link Camera.look} about {@link Camera.eye}, around the {@link Camera.up} vector.\n     *\n     * @param angleInc Angle of rotation in degrees\n     */\n    yaw(angleInc: number) {\n        let look2 = subVec3(this.#state.look, this.#state.eye, tempVec3);\n        rotationMat4v(angleInc * 0.0174532925, this.#state.gimbalLock ? this.#state.worldUp : this.#state.up, tempMat);\n        look2 = transformPoint3(tempMat, look2, tempVec3b);\n        this.look = addVec3(look2, this.#state.eye, tempVec3c);\n        if (this.#state.gimbalLock) {\n            this.up = transformPoint3(tempMat, this.#state.up, tempVec3d);\n        }\n    }\n\n    /**\n     * Rotates {@link Camera.look} about {@link Camera.eye}, around the right axis (orthogonal to {@link Camera.up} and \"look\").\n\n     * @param angleInc Angle of rotation in degrees\n     */\n    pitch(angleInc: number) {\n        if (this.#state.constrainPitch) {\n            angleInc = dotVec3(this.#state.up, this.#state.worldUp) / DEGTORAD;\n            if (angleInc < 1) {\n                return;\n            }\n        }\n        let look2 = subVec3(this.#state.look, this.#state.eye, tempVec3);\n        const left = cross3Vec3(normalizeVec3(look2, tempVec3b), normalizeVec3(this.#state.up, tempVec3c));\n        rotationMat4v(angleInc * 0.0174532925, left, tempMat);\n        this.up = transformPoint3(tempMat, this.#state.up, tempVec3f);\n        look2 = transformPoint3(tempMat, look2, tempVec3d);\n        this.look = addVec3(look2, this.#state.eye, tempVec3e);\n    }\n\n    /**\n     * Pans the Camera along its local X, Y and Z axis.\n     *\n     * @param pan The pan vector\n     */\n    pan(pan: FloatArrayParam) {\n        const eye2 = subVec3(this.#state.eye, this.#state.look, tempVec3);\n        const vec = [0, 0, 0];\n        let v;\n        if (pan[0] !== 0) {\n            const left = cross3Vec3(normalizeVec3(eye2, []), normalizeVec3(this.#state.up, tempVec3b));\n            v = mulVec3Scalar(left, pan[0]);\n            vec[0] += v[0];\n            vec[1] += v[1];\n            vec[2] += v[2];\n        }\n        if (pan[1] !== 0) {\n            v = mulVec3Scalar(normalizeVec3(this.#state.up, tempVec3c), pan[1]);\n            vec[0] += v[0];\n            vec[1] += v[1];\n            vec[2] += v[2];\n        }\n        if (pan[2] !== 0) {\n            v = mulVec3Scalar(normalizeVec3(eye2, tempVec3d), pan[2]);\n            vec[0] += v[0];\n            vec[1] += v[1];\n            vec[2] += v[2];\n        }\n        this.eye = addVec3(this.#state.eye, vec, tempVec3e);\n        this.look = addVec3(this.#state.look, vec, tempVec3f);\n    }\n\n    /**\n     * Increments/decrements the Camera's zoom factor, which is the distance between {@link Camera.eye} and {@link Camera.look}.\n     *\n     * @param delta Zoom factor increment.\n     */\n    zoom(delta: number) {\n        const vec = subVec3(this.#state.eye, this.#state.look, tempVec3);\n        const lenLook = Math.abs(lenVec3(vec));\n        const newLenLook = Math.abs(lenLook + delta);\n        if (newLenLook < 0.5) {\n            return;\n        }\n        const dir = normalizeVec3(vec, tempVec3c);\n        this.eye = addVec3(this.#state.look, mulVec3Scalar(dir, newLenLook), tempVec3d);\n    }\n\n\n    /**\n     * @private\n     */\n    destroy() {\n        super.destroy();\n        this.onProjectionType.clear();\n        this.onViewMatrix.clear();\n        this.onProjMatrix.clear();\n        this.onWorldAxis.clear();\n    }\n\n\n}\n\nexport {Camera};\n","import {Queue, Map, inQuotes} from \"@xeokit/utils\";\n\nimport {stats} from './stats';\nimport type {Viewer} from \"./Viewer\";\n\n\nexport interface TickEvent {\n    viewerId: string;\n    time: number;\n    startTime: number;\n    prevTime: number;\n    deltaTime: number;\n}\n\nconst tickEvent: TickEvent = {\n    viewerId: \"\",\n    time: 0,\n    startTime: 0,\n    prevTime: 0,\n    deltaTime: 0\n};\n\nclass Scheduler {\n\n    public readonly viewers: { [key: string]: Viewer };\n\n    #viewersRenderInfo: { [key: string]: any } = {};\n\n    // @ts-ignore\n    #viewerIDMap: Map = new Map(); // Ensures unique viewer IDs\n    #taskQueue: Queue = new Queue(); // Task queue, which is pumped on each frame; tasks are pushed to it with calls to xeokit.schedule\n    #taskBudget: number = 10; // Millisecs we're allowed to spend on tasks in each frame\n    #lastTime: number = 0;\n    #elapsedTime: number = 0;\n\n    /**\n     * @private\n     */\n    constructor() {\n\n        this.viewers = {};\n\n        const frame = () => {\n            const time = Date.now();\n            if (this.#lastTime > 0) {\n                this.#elapsedTime = time - this.#lastTime;\n            }\n            this.#runTasks(time);\n            this.#fireTickEvents(time);\n            this.#renderViewers();\n            this.#lastTime = time;\n\n            requestAnimationFrame(frame);\n        };\n\n        requestAnimationFrame(frame);\n    }\n\n    #runTasks(time: number) {\n        const tasksRun = this.#runTasksUntil(time + this.#taskBudget);\n        const tasksScheduled = this.getNumTasks();\n        stats.frame.tasksRun = tasksRun;\n        stats.frame.tasksScheduled = tasksScheduled;\n        stats.frame.tasksBudget = this.#taskBudget;\n    }\n\n    #runTasksUntil(until: number = -1) {\n        let time = (new Date()).getTime();\n        let tasksRun = 0;\n        while (this.#taskQueue.length > 0 && (until < 0 || time < until)) {\n            const callback = this.#taskQueue.shift();\n            const scope = this.#taskQueue.shift();\n            if (scope) {\n                callback.call(scope);\n            } else {\n                callback();\n            }\n            time = (new Date()).getTime();\n            tasksRun++;\n        }\n        return tasksRun;\n    }\n\n    #fireTickEvents(time: number) {\n        tickEvent.time = time;\n        for (let id in scheduler.viewers) {\n            if (this.viewers.hasOwnProperty(id)) {\n                const viewer = this.viewers[id];\n                tickEvent.viewerId = id;\n                tickEvent.startTime = viewer.startTime;\n                tickEvent.deltaTime = tickEvent.prevTime != null ? tickEvent.time - tickEvent.prevTime : 0;\n                viewer.onTick.dispatch(viewer, tickEvent);\n            }\n        }\n        tickEvent.prevTime = time;\n    }\n\n    #renderViewers() {\n        for (let id in this.viewers) {\n            if (this.viewers.hasOwnProperty(id)) {\n                const viewer = this.viewers[id];\n                let renderInfo = this.#viewersRenderInfo[id];\n                if (!renderInfo) {\n                    renderInfo = this.#viewersRenderInfo[id] = {}; // FIXME\n                }\n\n\n                // const ticksPerOcclusionTest = viewer.ticksPerOcclusionTest;\n                // if (renderInfo.ticksPerOcclusionTest !== ticksPerOcclusionTest) {\n                //     renderInfo.ticksPerOcclusionTest = ticksPerOcclusionTest;\n                //     renderInfo.renderCountdown = ticksPerOcclusionTest;\n                // }\n                // if (--viewer.occlusionTestCountdown <= 0) {\n                //     viewer.doOcclusionTest();\n                //     viewer.occlusionTestCountdown = ticksPerOcclusionTest;\n                // }\n                //\n                // ticksPerRender = viewer.ticksPerRender;\n                // if (renderInfo.ticksPerRender !== ticksPerRender) {\n                //     renderInfo.ticksPerRender = ticksPerRender;\n                //     renderInfo.renderCountdown = ticksPerRender;\n                // }\n                // if (--renderInfo.renderCountdown === 0) {\n                    viewer.render({});\n                //     renderInfo.renderCountdown = ticksPerRender;\n                // }\n            }\n        }\n    }\n\n    registerViewer(viewer: Viewer) {\n        if (viewer.id) {\n            if (this.viewers[viewer.id]) {\n                console.error(`[ERROR] Viewer ${inQuotes(viewer.id)} already exists`);\n                return;\n            }\n        } else { // Auto-generated ID\n            // @ts-ignore\n            // noinspection JSConstantReassignment\n            viewer.id = this.#viewerIDMap.addItem({});\n        }\n        this.viewers[viewer.id] = viewer;\n        // const ticksPerOcclusionTest = viewer.ticksPerOcclusionTest;\n        // const ticksPerRender = viewer.ticksPerRender;\n        this.#viewersRenderInfo[viewer.id] = {\n            // ticksPerOcclusionTest: ticksPerOcclusionTest,\n            // ticksPerRender: ticksPerRender,\n            // renderCountdown: ticksPerRender\n        };\n        stats.components.viewers++;\n    }\n\n    deregisterViewer(viewer:Viewer) {\n        if (!this.viewers[viewer.id]) {\n            return;\n        }\n        this.#viewerIDMap.removeItem(viewer.id);\n        delete this.viewers[viewer.id];\n        delete this.#viewersRenderInfo[viewer.id];\n        stats.components.viewers--;\n    }\n\n    scheduleTask(callback: Function, scope: any) {\n        this.#taskQueue.push(callback);\n        this.#taskQueue.push(scope);\n    }\n\n    getNumTasks() {\n        return this.#taskQueue.length;\n    }\n}\n\nconst scheduler = new Scheduler();\n\nexport {scheduler};","import {EventDispatcher} from \"strongly-typed-events\";\n\n\nimport {scheduler} from './scheduler';\nimport type {View} from \"./View\";\nimport type {Camera} from \"./Camera\";\nimport {addVec3, lenVec3, lerpMat4, lerpVec3, mulVec3Scalar, normalizeVec3, subVec3, createVec3} from \"@xeokit/matrix\";\nimport {Component, EventEmitter} from \"@xeokit/core\";\nimport {DEGTORAD, FloatArrayParam} from \"@xeokit/math\";\nimport {getAABB3Center, getAABB3Diag, getAABB3DiagPoint} from \"@xeokit/boundaries\";\nimport {CustomProjectionType, OrthoProjectionType, PerspectiveProjectionType} from \"@xeokit/constants\";\n\nconst tempVec3 = createVec3();\nconst newLook = createVec3();\nconst newEye = createVec3();\nconst newUp = createVec3();\nconst newLookEyeVec = createVec3();\n\n/**\n * Animates its {@link View |View's} {@link @xeokit/viewer!Camera}  to look at specified objects, boundaries or locations.\n *\n * ## Summary\n *\n * * Belongs to a {@link @xeokit/viewer!View}, and is located at {@link View.cameraFlight}\n * * Controls the View's {@link @xeokit/viewer!Camera} , which is located at {@link View.camera}\n * * Navigates the Camera to look at a {@link ViewerObject} or boundary\n * * Navigates the Camera to an explicit position given as ````eye````, ````look```` and ````up```` vectors\n * * Jumps or flies the Camera\n * * Smoothly transitions between projections\n */\nclass CameraFlightAnimation extends Component {\n\n    /**\n     * The View that owns this CameraFlightAnimation.\n     */\n    public readonly view: View;\n\n    /**\n     * The Camera controlled by this CameraFlightAnimation.\n     */\n    public readonly camera: Camera;\n\n    #duration: number;\n    #look1: FloatArrayParam;\n    #eye1: FloatArrayParam;\n    #up1: FloatArrayParam;\n    #look2: FloatArrayParam;\n    #eye2: FloatArrayParam;\n    #up2: FloatArrayParam;\n    #orthoScale1: number;\n    #orthoScale2: number;\n    #fit: boolean;\n    #trail: boolean;\n    #flying: boolean;\n    #flyEyeLookUp: boolean;\n    #flyingEye: boolean;\n    #flyingLook: boolean;\n    #callback: any;\n    #callbackScope: any;\n    #time1: number | null;\n    #time2: number | null;\n    easing: boolean;\n    #flyingEyeLookUp: boolean;\n    #fitFOV: number;\n    #projection2: number;\n    #projMatrix1: FloatArrayParam;\n    #projMatrix2: FloatArrayParam;\n\n\n    /**\n     * Emits an event each time the animation starts.\n     *\n     * @event\n     */\n    readonly onStarted: EventEmitter<CameraFlightAnimation, null>;\n\n    /**\n     * Emits an event each time the animation stops.\n     *\n     * @event\n     */\n    readonly onStopped: EventEmitter<CameraFlightAnimation, null>;\n\n    /**\n     * Emits an event each time the animation stops.\n     *\n     * @event\n     */\n    readonly onCancelled: EventEmitter<CameraFlightAnimation, null>;\n\n    /**\n     @private\n     */\n    constructor(view: View, cfg?: {\n        duration: number\n    }) {\n\n        super(view, cfg);\n\n        this.view = view;\n        this.camera = view.camera;\n\n        this.#look1 = createVec3();\n        this.#eye1 = createVec3();\n        this.#up1 = createVec3();\n        this.#look2 = createVec3();\n        this.#eye2 = createVec3();\n        this.#up2 = createVec3();\n        this.#orthoScale1 = 1;\n        this.#orthoScale2 = 1;\n        this.#flying = false;\n        this.#flyEyeLookUp = false;\n        this.#flyingEye = false;\n        this.#flyingLook = false;\n        this.#callback = null;\n        this.#callbackScope = null;\n        this.#time1 = null;\n        this.#time2 = null;\n        this.easing = true;\n        this.#trail = false;\n        this.#fit = true;\n        this.#duration = 500;\n\n        this.onStarted = new EventEmitter(new EventDispatcher<CameraFlightAnimation, null>());\n        this.onStopped = new EventEmitter(new EventDispatcher<CameraFlightAnimation, null>());\n        this.onCancelled = new EventEmitter(new EventDispatcher<CameraFlightAnimation, null>());\n    }\n\n    /**\n     * Flies the {@link @xeokit/viewer!Camera}  to a target.\n     *\n     *  * When the target is a boundary, the {@link @xeokit/viewer!Camera}  will fly towards the target and stop when the target fills most of the canvas.\n     *  * When the target is an explicit {@link @xeokit/viewer!Camera}  position, given as ````eye````, ````look```` and ````up````, then CameraFlightAnimation will interpolate the {@link @xeokit/viewer!Camera}  to that target and stop there.\n     *\n     * @param {Object|Component} [params=Scene] Either a parameters object or a {@link @xeokit/core!Component} subtype that has\n     * an AABB. Defaults to the {@link Scene}, which causes the {@link @xeokit/viewer!Camera}  to fit the Scene in view.\n     * @param [params.arc=0] Factor in range ````[0..1]```` indicating how much the {@link Camera.eye} position\n     * will swing away from its {@link Camera.look} position as it flies to the target.\n     * @param {Number|String|Component} [params.component] ID or instance of a component to fly to. Defaults to the entire {@link Scene}.\n     * @param [params.aabb] World-space axis-aligned bounding box (AABB) target to fly to.\n     * @param [params.eye] Position to fly the eye position to.\n     * @param [params.look] Position to fly the look position to.\n     * @param [params.up] Position to fly the up vector to.\n     * @param [params.projection] Projection type to transition into as we fly. Can be any of the values of {@link Camera.projectionType}.\n     * @param [params.fit=true] Whether to fit the target to the view volume. Overrides {@link CameraFlightAnimation.fit}.\n     * @param [params.fitFOV] How much of field-of-view, in degrees, that a target {@link ViewerObject} or its AABB should\n     * fill the canvas on arrival. Overrides {@link CameraFlightAnimation.fitFOV}.\n     * @param [params.duration] Flight duration in seconds.  Overrides {@link CameraFlightAnimation.duration}.\n     * @param [params.orthoScale] Animate the Camera's orthographic scale to this target value. See {@link Ortho.scale}.\n     * @param {Function} [callback] Callback fired on arrival.\n     * @param {Object} [scope] Optional scope for callback.\n     */\n    flyTo(params: {\n              projection?: number;\n              orthoScale?: number;\n              aabb?: FloatArrayParam;\n              length?: number;\n              eye?: FloatArrayParam;\n              look?: FloatArrayParam;\n              up?: FloatArrayParam;\n              poi?: FloatArrayParam;\n              fitFOV?: number;\n              duration?: number;\n          } = {},\n          callback: {\n              (): void; call: (arg0: any) => void;\n          }) {\n\n        if (this.#flying) {\n            this.stop();\n        }\n\n        this.#flying = false;\n        this.#flyingEye = false;\n        this.#flyingLook = false;\n        this.#flyingEyeLookUp = false;\n\n        this.#callback = callback;\n\n        const camera = this.camera;\n        const flyToProjection = (!!params.projection) && (params.projection !== camera.projectionType);\n\n        this.#eye1[0] = camera.eye[0];\n        this.#eye1[1] = camera.eye[1];\n        this.#eye1[2] = camera.eye[2];\n\n        this.#look1[0] = camera.look[0];\n        this.#look1[1] = camera.look[1];\n        this.#look1[2] = camera.look[2];\n\n        this.#up1[0] = camera.up[0];\n        this.#up1[1] = camera.up[1];\n        this.#up1[2] = camera.up[2];\n\n        this.#orthoScale1 = camera.orthoProjection.scale;\n        this.#orthoScale2 = params.orthoScale || this.#orthoScale1;\n\n        let aabb: FloatArrayParam;\n        let eye: FloatArrayParam;\n        let look: FloatArrayParam;\n        let up: FloatArrayParam;\n\n        if (params.aabb) {\n            aabb = params.aabb;\n\n        } else if ((params.eye && params.look) || params.up) {\n            // @ts-ignore\n            eye = params.eye;\n            // @ts-ignore\n            look = params.look;\n            // @ts-ignore\n            up = params.up;\n\n        } else if (params.eye) {\n            eye = params.eye;\n\n        } else if (params.look) {\n            look = params.look;\n\n        } else {\n            if (!flyToProjection) {\n                aabb = this.view.aabb;\n            }\n        }\n\n        const poi = params.poi;\n        // @ts-ignore\n        if (aabb) {\n\n            if (aabb[3] < aabb[0] || aabb[4] < aabb[1] || aabb[5] < aabb[2]) { // Don't fly to an inverted boundary\n                return;\n            }\n\n            if (aabb[3] === aabb[0] && aabb[4] === aabb[1] && aabb[5] === aabb[2]) { // Don't fly to an empty boundary\n                return;\n            }\n\n            aabb = aabb.slice();\n            const aabbCenter = getAABB3Center(aabb);\n\n            this.#look2 = poi || aabbCenter;\n\n            const eyeLookVec = subVec3(this.#eye1, this.#look1, tempVec3);\n            const eyeLookVecNorm = normalizeVec3(eyeLookVec);\n            const diag = poi ? getAABB3DiagPoint(aabb, poi) : getAABB3Diag(aabb);\n            const fitFOV = params.fitFOV || this.#fitFOV;\n            const sca = Math.abs(diag / Math.tan(fitFOV * DEGTORAD));\n\n            this.#orthoScale2 = diag * 1.1;\n\n            this.#eye2[0] = this.#look2[0] + (eyeLookVecNorm[0] * sca);\n            this.#eye2[1] = this.#look2[1] + (eyeLookVecNorm[1] * sca);\n            this.#eye2[2] = this.#look2[2] + (eyeLookVecNorm[2] * sca);\n\n            this.#up2[0] = this.#up1[0];\n            this.#up2[1] = this.#up1[1];\n            this.#up2[2] = this.#up1[2];\n\n            this.#flyingEyeLookUp = true;\n\n            // @ts-ignore\n        } else if (eye || look || up) {\n            // @ts-ignore\n            this.#flyingEyeLookUp = !!eye && !!look && !!up;\n            // @ts-ignore\n            this.#flyingEye = !!eye && !look;\n            // @ts-ignore\n            this.#flyingLook = !!look && !eye;\n            // @ts-ignore\n            if (eye) {\n                this.#eye2[0] = eye[0];\n                this.#eye2[1] = eye[1];\n                this.#eye2[2] = eye[2];\n            }\n            // @ts-ignore\n            if (look) {\n                this.#look2[0] = look[0];\n                this.#look2[1] = look[1];\n                this.#look2[2] = look[2];\n            }\n            // @ts-ignore\n            if (up) {\n                this.#up2[0] = up[0];\n                this.#up2[1] = up[1];\n                this.#up2[2] = up[2];\n            }\n        }\n\n        if (flyToProjection) {\n\n            if (params.projection === OrthoProjectionType && camera.projectionType !== OrthoProjectionType) {\n                this.#projection2 = OrthoProjectionType;\n                this.#projMatrix1 = camera.projMatrix.slice();\n                this.#projMatrix2 = camera.orthoProjection.projMatrix.slice();\n                camera.projectionType = CustomProjectionType;\n            }\n\n            if (params.projection === PerspectiveProjectionType && camera.projectionType !== PerspectiveProjectionType) {\n                this.#projection2 = PerspectiveProjectionType;\n                this.#projMatrix1 = camera.projMatrix.slice();\n                this.#projMatrix2 = camera.perspectiveProjection.projMatrix.slice();\n                camera.projectionType = CustomProjectionType;\n            }\n        } else {\n            // @ts-ignore\n            this.#projection2 = null;\n        }\n\n        this.onStarted.dispatch(this, null);\n\n        this.#time1 = Date.now();\n        this.#time2 = this.#time1 + (params.duration ? params.duration * 1000 : this.#duration);\n\n        this.#flying = true; // False as soon as we stop\n\n        scheduler.scheduleTask(this.#update, this);\n    }\n\n    /**\n     * Jumps the {@link @xeokit/viewer!View}'s {@link @xeokit/viewer!Camera}  to the given target.\n     *\n     * * When the target is a boundary, this CameraFlightAnimation will position the {@link @xeokit/viewer!Camera}  at where the target fills most of the canvas.\n     * * When the target is an explicit {@link @xeokit/viewer!Camera}  position, given as ````eye````, ````look```` and ````up```` vectors, then this CameraFlightAnimation will jump the {@link @xeokit/viewer!Camera}  to that target.\n     *\n     * @param {*|Component} params  Either a parameters object or a {@link @xeokit/core!Component} subtype that has a World-space AABB.\n     * @param [params.arc=0]  Factor in range [0..1] indicating how much the {@link Camera.eye} will swing away from its {@link Camera.look} as it flies to the target.\n     * @param {Number|String|Component} [params.component] ID or instance of a component to fly to.\n     * @param [params.aabb]  World-space axis-aligned bounding box (AABB) target to fly to.\n     * @param [params.eye] Position to fly the eye position to.\n     * @param [params.look]  Position to fly the look position to.\n     * @param [params.up] Position to fly the up vector to.\n     * @param [params.projection] Projection type to transition into. Can be any of the values of {@link Camera.projectionType}.\n     * @param [params.fitFOV] How much of field-of-view, in degrees, that a target {@link ViewerObject} or its AABB should fill the canvas on arrival. Overrides {@link CameraFlightAnimation.fitFOV}.\n     * @param [params.fit] Whether to fit the target to the view volume. Overrides {@link CameraFlightAnimation.fit}.\n     */\n    jumpTo(params: any) {\n        this.#jumpTo(params);\n    }\n\n    #jumpTo(params: any) {\n\n        if (this.#flying) {\n            this.stop();\n        }\n\n        const camera = this.camera;\n\n        let aabb: FloatArrayParam;\n        let newEye: FloatArrayParam;\n        let newLook: FloatArrayParam;\n        let newUp: FloatArrayParam;\n\n        if (params.aabb) { // Boundary3D\n            aabb = params.aabb;\n        } else if (params.eye || params.look || params.up) { // Camera pose\n            newEye = params.eye;\n            newLook = params.look;\n            newUp = params.up;\n        } else {\n            aabb = this.view.aabb;\n        }\n\n        const poi = params.poi;\n        // @ts-ignore\n        if (aabb) {\n\n            if (aabb[3] <= aabb[0] || aabb[4] <= aabb[1] || aabb[5] <= aabb[2]) { // Don't fly to an empty boundary\n                return;\n            }\n\n            const diag = poi ? getAABB3DiagPoint(aabb, poi) : getAABB3Diag(aabb);\n            // @ts-ignore\n            newLook = poi || getAABB3Center(aabb, newLook);\n\n            if (this.#trail) {\n                subVec3(camera.look, newLook, newLookEyeVec);\n            } else {\n                subVec3(camera.eye, camera.look, newLookEyeVec);\n            }\n\n            normalizeVec3(newLookEyeVec);\n            let dist;\n            const fit = (params.fit !== undefined) ? params.fit : this.#fit;\n\n            if (fit) {\n                dist = Math.abs((diag) / Math.tan((params.fitFOV || this.#fitFOV) * DEGTORAD));\n\n            } else {\n                dist = lenVec3(subVec3(camera.eye, camera.look, tempVec3));\n            }\n\n            mulVec3Scalar(newLookEyeVec, dist);\n\n            camera.eye = addVec3(newLook, newLookEyeVec, tempVec3);\n            camera.look = newLook;\n\n            this.camera.orthoProjection.scale = diag * 1.1;\n            // @ts-ignore\n        } else if (newEye || newLook || newUp) {\n            // @ts-ignore\n            if (newEye) {\n                camera.eye = newEye;\n            } // @ts-ignore\n            if (newLook) {\n                camera.look = newLook;\n            } // @ts-ignore\n            if (newUp) {\n                camera.up = newUp;\n            }\n        }\n\n        if (params.projection) {\n            camera.projectionType = params.projection;\n        }\n    }\n\n    #update() {\n        if (!this.#flying) {\n            return;\n        }\n        const time = Date.now();\n        // @ts-ignore\n        let t = (time - this.#time1) / (this.#time2 - this.#time1);\n        const stopping = (t >= 1);\n\n        if (t > 1) {\n            t = 1;\n        }\n\n        const tFlight = this.easing ? CameraFlightAnimation.#ease(t, 0, 1, 1) : t;\n        const camera = this.camera;\n\n        if (this.#flyingEye || this.#flyingLook) {\n\n            if (this.#flyingEye) {\n                subVec3(camera.eye, camera.look, newLookEyeVec);\n                camera.eye = lerpVec3(tFlight, 0, 1, this.#eye1, this.#eye2, newEye);\n                camera.look = subVec3(newEye, newLookEyeVec, newLook);\n            } else if (this.#flyingLook) {\n                camera.look = lerpVec3(tFlight, 0, 1, this.#look1, this.#look2, newLook);\n                camera.up = lerpVec3(tFlight, 0, 1, this.#up1, this.#up2, newUp);\n            }\n\n        } else if (this.#flyingEyeLookUp) {\n\n            camera.eye = lerpVec3(tFlight, 0, 1, this.#eye1, this.#eye2, newEye);\n            camera.look = lerpVec3(tFlight, 0, 1, this.#look1, this.#look2, newLook);\n            camera.up = lerpVec3(tFlight, 0, 1, this.#up1, this.#up2, newUp);\n        }\n\n        if (this.#projection2) {\n            const tProj = (this.#projection2 === OrthoProjectionType) ? CameraFlightAnimation.#easeOutExpo(t, 0, 1, 1) : CameraFlightAnimation.#easeInCubic(t, 0, 1, 1);\n            camera.customProjection.projMatrix = lerpMat4(tProj, 0, 1, this.#projMatrix1, this.#projMatrix2);\n\n        } else {\n            camera.orthoProjection.scale = this.#orthoScale1 + (t * (this.#orthoScale2 - this.#orthoScale1));\n        }\n\n        if (stopping) {\n            camera.orthoProjection.scale = this.#orthoScale2;\n            this.stop();\n            return;\n        }\n        scheduler.scheduleTask(this.#update, this); // Keep flying\n    }\n\n    static #ease(t: number, b: number, c: number, d: number) { // Quadratic easing out - decelerating to zero velocity http://gizma.com/easing\n        t /= d;\n        return -c * t * (t - 2) + b;\n    }\n\n    static #easeInCubic(t: number, b: number, c: number, d: number) {\n        t /= d;\n        return c * t * t * t + b;\n    }\n\n    static #easeOutExpo(t: number, b: number, c: number, d: number) {\n        return c * (-Math.pow(2, -10 * t / d) + 1) + b;\n    }\n\n    /**\n     * Stops an earlier {@link CameraFlightAnimation.flyTo}, fires arrival callback, then \"stopped\" event.\n     */\n    stop() {\n        if (!this.#flying) {\n            return;\n        }\n        this.#flying = false;\n        this.#time1 = null;\n        this.#time2 = null;\n        if (this.#projection2) {\n            this.camera.projectionType = this.#projection2;\n        }\n        const callback = this.#callback;\n        if (callback) {\n            this.#callback = null;\n            callback();\n        }\n        this.onStopped.dispatch(this, null);\n    }\n\n    /**\n     * Cancels a flight in progress, without calling the arrival callback.\n     */\n    cancel() {\n        if (!this.#flying) {\n            return;\n        }\n        this.#flying = false;\n        this.#time1 = null;\n        this.#time2 = null;\n        if (this.#callback) {\n            this.#callback = null;\n        }\n        this.onCancelled.dispatch(this, null);\n    }\n\n    /**\n     * Sets the flight duration in seconds.\n     *\n     * Stops any flight currently in progress.\n     *\n     * Default value is ````0.5````.\n     */\n    set duration(value: number) {\n        this.#duration = value ? (value * 1000.0) : 500;\n        this.stop();\n    }\n\n    /**\n     * Gets the flight duration in seconds.\n     *\n     * Default value is ````0.5````.\n     */\n    get duration(): number {\n        return this.#duration / 1000.0;\n    }\n\n    /**\n     * When flying to a {@link @xeokit/scene!SceneModel | SceneModel}, {@link ViewerObject} or boundary, indicates if the CameraFlightAnimation always adjusts\n     * the distance of {@link Camera.eye} from {@link Camera.look} to ensure that the target always fits in view.\n     *\n     * When false, the eye will remain fixed at its current distance from the look position.\n     *\n     * Default value is ````true````.\n     */\n    set fit(value: boolean) {\n        this.#fit = value;\n    }\n\n    /**\n     * When flying to a {@link @xeokit/scene!SceneModel | SceneModel}, {@link ViewerObject} or boundary, indicates if the CameraFlightAnimation always adjusts\n     * the distance of {@link Camera.eye} from {@link Camera.look} to ensure that the target always fits in view.\n     *\n     * When false, the eye will remain fixed at its current distance from the look position.\n     *\n     * Default value is ````true````.\n     */\n    get fit(): boolean {\n        return this.#fit;\n    }\n\n    /**\n     * Sets how much of the perspective field-of-view, in degrees, that a target {@link ViewerObject.aabb} should\n     * fill the canvas when calling {@link CameraFlightAnimation.flyTo} or {@link CameraFlightAnimation.jumpTo}.\n     *\n     * Default value is ````45````.\n     */\n    set fitFOV(value: number) {\n        this.#fitFOV = value;\n    }\n\n    /**\n     * Gets how much of the perspective field-of-view, in degrees, that a target {@link ViewerObject.aabb} should\n     * fill the canvas when calling {@link CameraFlightAnimation.flyTo} or {@link CameraFlightAnimation.jumpTo}.\n     *\n     * Default value is ````45````.\n     */\n    get fitFOV(): number {\n        return this.#fitFOV;\n    }\n\n    /**\n     * Indicates if this CameraFlightAnimation will orient the {@link @xeokit/viewer!Camera} \n     * in the direction that it is flying.\n     *\n     * Default value is ````false````.\n     */\n    set trail(value: boolean) {\n        this.#trail = value;\n    }\n\n    /**\n     * Indicates if this CameraFlightAnimation will orient the {@link @xeokit/viewer!Camera} \n     * in the direction that it is flying.\n     *\n     * Default value is ````false````.\n     */\n    get trail(): boolean {\n        return this.#trail;\n    }\n\n    /**\n     * @private\n     */\n    destroy() {\n        this.stop();\n        super.destroy();\n        this.onStarted.clear();\n        this.onStopped.clear();\n        this.onCancelled.clear();\n    }\n}\n\nexport {CameraFlightAnimation};\n","import { EventDispatcher } from \"strongly-typed-events\";\nimport { Component, EventEmitter } from \"@xeokit/core\";\nimport { createUUID } from \"@xeokit/utils\";\nimport { QualityRender } from \"@xeokit/constants\";\nimport type { FloatArrayParam, IntArrayParam } from \"@xeokit/math\";\nimport { createVec3 } from \"@xeokit/matrix\";\nimport type { Scene, SceneModel } from \"@xeokit/scene\";\n\nimport { ViewObject } from \"./ViewObject\";\nimport { SectionPlane } from \"./SectionPlane\";\nimport type { Viewer } from \"./Viewer\";\nimport { Metrics } from \"./Metriqs\";\nimport { SAO } from \"./SAO\";\nimport { LinesMaterial } from \"./LinesMaterial\";\nimport { ViewLayer } from \"./ViewLayer\";\nimport type { ViewLayerParams } from \"./ViewLayerParams\";\nimport type { SectionPlaneParams } from \"./SectionPlaneParams\";\nimport { EmphasisMaterial } from \"./EmphasisMaterial\";\nimport { EdgeMaterial } from \"./EdgeMaterial\";\nimport { PointsMaterial } from \"./PointsMaterial\";\nimport { Camera } from \"./Camera\";\nimport type { PointLight } from \"./PointLight\";\nimport { CameraFlightAnimation } from \"./CameraFlightAnimation\";\nimport type { AmbientLight } from \"./AmbientLight\";\nimport type { DirLight } from \"./DirLight\";\nimport type { RendererViewObject } from \"./RendererViewObject\";\n\n/**\n * An independently-configurable view of the models in a {@link @xeokit/viewer!Viewer}.\n *\n * See {@link @xeokit/viewer} for usage.\n *\n * ## Overview\n *\n * A View is an independently-configurable view of the {@link RendererViewObject | ViewerObjects} existing within a Viewer, with\n * its own HTML canvas. A View automatically contains a {@link ViewObject} for each existing ViewerObject. ViewObjects\n * function as a kind of proxy for the ViewerObjects, through which we control their appearance\n * (show/hide/highlight etc.) within that particular View's canvas.\n *\n * Using Views, we can essentially have multiple canvases viewing the same model, each canvas perhaps showing a different subset\n * of the objects, with different visual effects, camera position etc.\n *\n * ## Quickstart\n *\n * * Create a View with {@link Viewer.createView}\n * * Control the View's viewpoint and projection with {@link View.camera}\n * * Create light sources with {@link View.createLightSource}\n * * Create slicing planes with {@link View createSectionPlane}\n * * Each View automatically has a {@link ViewObject} for every {@link RendererViewObject}\n * * Uses {@link ViewLayer | ViewLayers} to organize ViewObjects into layers\n * * Optionally uses ViewLayers to mask which ViewObjects are automatically maintained\n * * Control the visibility of ViewObjects with {@link View.setObjectsVisible}\n * * Emphasise ViewObjects with {@link View.setObjectsHighlighted}, {@link View.setObjectsSelected}, {@link View.setObjectsXRayed} and {@link View.setObjectsColorized}\n *\n * ## Examples\n *\n * Create a view in a given canvas, with three objects visible and a couple of object X-rayed (rendered translucent):\n *\n * ````javascript\n * const view1 = myViewer.createView({\n *      id: \"myView\",\n *      canvasId: \"myView1\"\n * });\n *\n * view1.camera.eye = [-3.933, 2.855, 27.018];\n * view1.camera.look = [4.400, 3.724, 8.899];\n * view1.camera.up = [-0.018, 0.999, 0.039];\n *\n * view1.setObjectsVisible([\"myObject1\", \"myObject2\", \"myObject3\", ...], true);\n * view1.setObjectsXRayed([\"myObject1\", \"myObject\", ...], true);\n * ````\n *\n * Create a second view, using a different canvas, that shows two objects visible, with one of them highlighted:\n *\n * ```` javascript\n * const view2 = myViewer.createView({\n *      id: \"myView2\",\n *      canvasId: \"myView2\"\n * });\n *\n * view2.camera.eye = [-1.4, 1.5, 15.8];\n * view2.camera.look = [4.0, 3.7, 1.8];\n * view2.camera.up = [0.0, 0.9, 0.0];\n *\n * view2.setObjectsVisible([\"myObject1\", \"myObject3\", ...], true);\n * view2.setObjectsHighlighted([\"myObject3\", ...], true);\n * ````\n */\nclass View extends Component {\n  /**\n     ID of this View, unique within the {@link @xeokit/viewer!Viewer}.\n     */\n  declare viewId: string;\n\n  /**\n   * The Viewer to which this View belongs.\n   */\n  declare readonly viewer: Viewer;\n\n  /**\n   * The index of this View in {@link Viewer.viewList}.\n   * @private\n   */\n  viewIndex: number;\n\n  /**\n   * Manages the Camera for this View.\n   */\n  readonly camera: Camera;\n\n  /**\n   * The HTML canvas.\n   */\n  public canvasElement: HTMLCanvasElement;\n\n  /**\n   * Indicates if this View is transparent.\n   */\n  public readonly transparent: boolean;\n\n  /**\n   * Boundary of the canvas in absolute browser window coordinates.\n   * Format is ````[xmin, ymin, xwidth, ywidth]````.\n   */\n  public readonly boundary: number[];\n  /**\n   * Whether the logarithmic depth buffer is enabled for this View.\n   */\n  readonly logarithmicDepthBufferEnabled: boolean;\n  /**\n   * Configures Scalable Ambient Obscurance (SAO) for this View.\n   */\n  readonly sao: SAO;\n  /**\n   * Flies or jumps the View's {@link @xeokit/viewer!Camera}  to given positions.\n   */\n  readonly cameraFlight: CameraFlightAnimation;\n  /**\n   * Manages measurement units, origin and scale for this View.\n   */\n  readonly metrics: Metrics;\n  /**\n   * Configures the X-rayed appearance of {@link ViewObject | ViewObjects} in this View.\n   */\n  readonly xrayMaterial: EmphasisMaterial;\n  /**\n   * Configures the highlighted appearance of {@link ViewObject | ViewObjects} in this View.\n   */\n  readonly highlightMaterial: EmphasisMaterial;\n  /**\n   * Configures the appearance of {@link ViewObject | ViewObjects} in this View.\n   */\n  readonly selectedMaterial: EmphasisMaterial;\n  /**\n   * Configures the appearance of edges belonging to {@link ViewObject} in this View.\n   */\n  readonly edgeMaterial: EdgeMaterial;\n  /**\n   * Configures the appearance of point primitives belonging to {@link ViewObject | ViewObjects} in this View .\n   */\n  readonly pointsMaterial: PointsMaterial;\n  /**\n   * Configures the appearance of lines belonging to {@link ViewObject | ViewObjects} in this View.\n   */\n  readonly linesMaterial: LinesMaterial;\n\n  /**\n   * Map of the all {@link ViewObject | ViewObjects} in this View.\n   *\n   * Each {@link ViewObject} is mapped here by {@link ViewObject.id}.\n   *\n   * The View automatically ensures that there is a {@link ViewObject} here for\n   * each {@link RendererViewObject} in the {@link @xeokit/viewer!Viewer}\n   */\n  readonly objects: { [key: string]: ViewObject };\n\n  /**\n   * Map of the currently visible {@link ViewObject | ViewObjects} in this View.\n   *\n   * A ViewObject is visible when {@link ViewObject.visible} is true.\n   *\n   * Each {@link ViewObject} is mapped here by {@link ViewObject.id}.\n   */\n  readonly visibleObjects: { [key: string]: ViewObject };\n\n  /**\n   * Map of currently x-rayed {@link ViewObject | ViewObjects} in this View.\n   *\n   * A ViewObject is x-rayed when {@link ViewObject.xrayed} is true.\n   *\n   * Each {@link ViewObject} is mapped here by {@link ViewObject.id}.\n   */\n  readonly xrayedObjects: { [key: string]: ViewObject };\n\n  /**\n   * Map of currently highlighted {@link ViewObject | ViewObjects} in this View.\n   *\n   * A ViewObject is highlighted when {@link ViewObject.highlighted} is true.\n   *\n   * Each {@link ViewObject} is mapped here by {@link ViewObject.id}.\n   */\n  readonly highlightedObjects: { [key: string]: ViewObject };\n\n  /**\n   * Map of currently selected {@link ViewObject | ViewObjects} in this View.\n   *\n   * A ViewObject is selected when {@link ViewObject.selected} is true.\n   *\n   * Each {@link ViewObject} is mapped here by {@link ViewObject.id}.\n   */\n  readonly selectedObjects: { [key: string]: ViewObject };\n\n  /**\n   * Map of currently colorized {@link ViewObject | ViewObjects} in this View.\n   *\n   * Each {@link ViewObject} is mapped here by {@link ViewObject.id}.\n   */\n  readonly colorizedObjects: { [key: string]: ViewObject };\n\n  /**\n   * Map of {@link ViewObject | ViewObjects} in this View whose opacity has been updated.\n   *\n   * Each {@link ViewObject} is mapped here by {@link ViewObject.id}.\n   */\n  readonly opacityObjects: { [key: string]: ViewObject };\n\n  /**\n   * Map of {@link SectionPlane}s in this View.\n   *\n   * Each {@link SectionPlane} is mapped here by {@link SectionPlane.id}.\n   */\n  readonly sectionPlanes: { [key: string]: SectionPlane };\n\n  /**\n   * List of {@link SectionPlane}s in this View.\n   */\n  readonly sectionPlanesList: SectionPlane[] = [];\n\n  /**\n   * Map of light sources in this View.\n   */\n  readonly lights: { [key: string]: AmbientLight | PointLight | DirLight };\n\n  /**\n   * List of light sources in this View.\n   */\n  readonly lightsList: (AmbientLight | PointLight | DirLight)[] = [];\n  gammaOutput: boolean;\n\n  /**\n   * Map of the all {@link ViewLayer}s in this View.\n   *\n   * Each {@link ViewLayer} is mapped here by {@link ViewLayer.id}.\n   */\n  readonly layers: { [key: string]: ViewLayer };\n\n  /**\n   * Whether the View will automatically create {@link ViewLayer | ViewLayers} on-demand\n   * as {@link RendererViewObject | ViewerObjects} are created.\n   *\n   * When ````true```` (default), the View will automatically create {@link ViewLayer | ViewLayers} as needed for each new\n   * {@link RendererViewObject.layerId} encountered, including a \"default\" ViewLayer for ViewerObjects that have no\n   * layerId. This default setting therefore ensures that a ViewObject is created in the View for every ViewerObject that is created.\n   *\n   * If you set this ````false````, however, then the View will only create {@link ViewObject | ViewObjects} for {@link RendererViewObject | ViewerObjects} that have\n   * a {@link RendererViewObject.layerId} that matches the ID of a {@link ViewLayer} that you have explicitly created previously with {@link View.createLayer}.\n   *\n   * Setting this parameter false enables Views to contain only the ViewObjects that they actually need to show, i.e. to represent only\n   * ViewerObjects that they need to view. This enables a View to avoid wastefully creating and maintaining ViewObjects for ViewerObjects\n   * that it never needs to show.\n   */\n  readonly autoLayers: boolean;\n\n  /**\n   * Emits an event each time the canvas boundary changes.\n   *\n   * @event\n   */\n  readonly onBoundary: EventEmitter<View, IntArrayParam>;\n\n  /**\n   * Emits an event each time the visibility of a {@link ViewObject} changes in this View.\n   *\n   * ViewObjects are shown and hidden with {@link View.setObjectsVisible}, {@link ViewLayer.setObjectsVisible} or {@link ViewObject.visible}.\n   *\n   * @event\n   */\n  readonly onObjectVisibility: EventEmitter<View, ViewObject>;\n\n  /**\n   * Emits an event each time the X-ray state of a {@link ViewObject} changes in this View.\n   *\n   * ViewObjects are X-rayed with {@link View.setObjectsXRayed}, {@link ViewLayer.setObjectsXRayed} or {@link ViewObject.xrayed}.\n   *\n   * @event\n   */\n  readonly onObjectXRayed: EventEmitter<View, ViewObject>;\n\n  /**\n   * Emits an event each time a {@link ViewLayer} is created in this View.\n   *\n   * Layers are created explicitly with {@link View.createLayer}, or implicitly with {@link View.createModel} and {@link CreateModelParams.layerId}.\n   *\n   * @event\n   */\n  readonly onLayerCreated: EventEmitter<View, ViewLayer>;\n\n  /**\n   * Emits an event each time a {@link ViewLayer} in this View is destroyed.\n   *\n   * ViewLayers are destroyed explicitly with {@link ViewLayer.destroy}, or implicitly when they become empty and {@link View.autoLayers} is false.\n   *\n   * @event\n   */\n  readonly onLayerDestroyed: EventEmitter<View, ViewLayer>;\n\n  /**\n   * Emits an event each time a {@link SectionPlane} is created in this View.\n   *\n   * @event\n   */\n  readonly onSectionPlaneCreated: EventEmitter<View, SectionPlane>;\n\n  /**\n   * Emits an event each time a {@link SectionPlane} in this View is destroyed.\n   *\n   * @event\n   */\n  readonly onSectionPlaneDestroyed: EventEmitter<View, SectionPlane>;\n\n  #onTick: () => void;\n\n  #backgroundColor: FloatArrayParam;\n  #backgroundColorFromAmbientLight: boolean;\n  #resolutionScale: number;\n  #numObjects: number;\n  #objectIds: string[] | null;\n  #numVisibleObjects: number;\n  #visibleObjectIds: string[] | null;\n  #numXRayedObjects: number;\n  #xrayedObjectIds: string[] | null;\n  #numHighlightedObjects: number;\n  #highlightedObjectIds: string[] | null;\n  #numSelectedObjects: number;\n  #selectedObjectIds: string[] | null;\n  #numColorizedObjects: number;\n  #colorizedObjectIds: string[] | null;\n  #numOpacityObjects: number;\n  #opacityObjectIds: string[] | null;\n  #qualityRender: boolean;\n  #lightsHash: string | null = null;\n  #sectionPlanesHash: string | null = null;\n\n  /**\n   * @private\n   */\n  constructor(options: {\n    viewer: Viewer;\n    origin?: number[];\n    scale?: number;\n    units?: number;\n    canvasId?: string;\n    canvasElement: HTMLCanvasElement;\n    backgroundColor?: any[];\n    backgroundColorFromAmbientLight?: boolean;\n    premultipliedAlpha?: boolean;\n    transparent?: boolean;\n    qualityRender?: boolean;\n    logarithmicDepthBufferEnabled?: boolean;\n    autoLayers?: boolean;\n  }) {\n    super(null, options);\n\n    this.viewer = options.viewer;\n\n    const canvas =\n      options.canvasElement ||\n      document.getElementById(<string>options.canvasId);\n    if (!(canvas instanceof HTMLCanvasElement)) {\n      throw \"Mandatory View config expected: valid canvasId or canvasElement\";\n    }\n\n    this.viewIndex = 0;\n    this.objects = {};\n    this.visibleObjects = {};\n    this.xrayedObjects = {};\n    this.highlightedObjects = {};\n    this.selectedObjects = {};\n    this.colorizedObjects = {};\n    this.opacityObjects = {};\n    this.sectionPlanes = {};\n    this.sectionPlanesList = [];\n    this.lights = {};\n    this.lightsList = [];\n    this.layers = {};\n\n    this.#numObjects = 0;\n    this.#objectIds = null;\n    this.#numVisibleObjects = 0;\n    this.#visibleObjectIds = null;\n    this.#numXRayedObjects = 0;\n    this.#xrayedObjectIds = null;\n    this.#numHighlightedObjects = 0;\n    this.#highlightedObjectIds = null;\n    this.#numSelectedObjects = 0;\n    this.#selectedObjectIds = null;\n    this.#numColorizedObjects = 0;\n    this.#colorizedObjectIds = null;\n    this.#numOpacityObjects = 0;\n    this.#opacityObjectIds = null;\n    this.#qualityRender = !!options.qualityRender;\n    this.gammaOutput = true;\n\n    this.#sectionPlanesHash = null;\n    this.#lightsHash = null;\n\n    // this.canvas = new View(this, {\n    //     canvas: canvas,\n    //     transparent: !!options.transparent,\n    //     backgroundColor: options.backgroundColor,\n    //     backgroundColorFromAmbientLight: !!options.backgroundColorFromAmbientLight,\n    //     premultipliedAlpha: !!options.premultipliedAlpha\n    // });\n    //\n    // this.canvas.onBoundary.subscribe(() => {\n    //     this.redraw();\n    // });\n\n    this.onBoundary = new EventEmitter(\n      new EventDispatcher<View, IntArrayParam>()\n    );\n\n    this.#resolutionScale = 1;\n    this.#backgroundColor = createVec3([\n      options.backgroundColor ? options.backgroundColor[0] : 1,\n      options.backgroundColor ? options.backgroundColor[1] : 1,\n      options.backgroundColor ? options.backgroundColor[2] : 1,\n    ]);\n    this.#backgroundColorFromAmbientLight =\n      !!options.backgroundColorFromAmbientLight;\n\n    this.canvasElement = options.canvasElement;\n    this.transparent = !!options.transparent;\n    this.canvasElement.width = this.canvasElement.clientWidth;\n    this.canvasElement.height = this.canvasElement.clientHeight;\n    this.boundary = [\n      this.canvasElement.offsetLeft,\n      this.canvasElement.offsetTop,\n      this.canvasElement.clientWidth,\n      this.canvasElement.clientHeight,\n    ];\n\n    // Publish canvasElement size and position changes on each scene tick\n\n    let lastWindowWidth = 0;\n    let lastWindowHeight = 0;\n    let lastViewWidth = 0;\n    let lastViewHeight = 0;\n    let lastViewOffsetLeft = 0;\n    let lastViewOffsetTop = 0;\n    let lastParent: null | HTMLElement = null;\n\n    let lastResolutionScale: null | number = null;\n\n    this.#onTick = this.viewer.onTick.subscribe(() => {\n      const canvasElement = this.canvasElement;\n      const newResolutionScale = this.#resolutionScale !== lastResolutionScale;\n      const newWindowSize =\n        window.innerWidth !== lastWindowWidth ||\n        window.innerHeight !== lastWindowHeight;\n      const newViewSize =\n        canvasElement.clientWidth !== lastViewWidth ||\n        canvasElement.clientHeight !== lastViewHeight;\n      const newViewPos =\n        canvasElement.offsetLeft !== lastViewOffsetLeft ||\n        canvasElement.offsetTop !== lastViewOffsetTop;\n      const parent = canvasElement.parentElement;\n      const newParent = parent !== lastParent;\n\n      if (\n        newResolutionScale ||\n        newWindowSize ||\n        newViewSize ||\n        newViewPos ||\n        newParent\n      ) {\n        //   this._spinner._adjustPosition();\n        if (newResolutionScale || newViewSize || newViewPos) {\n          const newWidth = canvasElement.clientWidth;\n          const newHeight = canvasElement.clientHeight;\n          if (newResolutionScale || newViewSize) {\n            canvasElement.width = Math.round(\n              canvasElement.clientWidth * this.#resolutionScale\n            );\n            canvasElement.height = Math.round(\n              canvasElement.clientHeight * this.#resolutionScale\n            );\n          }\n          const boundary = this.boundary;\n          boundary[0] = canvasElement.offsetLeft;\n          boundary[1] = canvasElement.offsetTop;\n          boundary[2] = newWidth;\n          boundary[3] = newHeight;\n          if (!newResolutionScale || newViewSize) {\n            this.onBoundary.dispatch(this, boundary);\n          }\n          lastViewWidth = newWidth;\n          lastViewHeight = newHeight;\n        }\n\n        if (newResolutionScale) {\n          lastResolutionScale = this.#resolutionScale;\n        }\n        if (newWindowSize) {\n          lastWindowWidth = window.innerWidth;\n          lastWindowHeight = window.innerHeight;\n        }\n        if (newViewPos) {\n          lastViewOffsetLeft = canvasElement.offsetLeft;\n          lastViewOffsetTop = canvasElement.offsetTop;\n        }\n        lastParent = parent;\n      }\n    });\n\n    this.camera = new Camera(this);\n\n    this.sao = new SAO(this, {});\n\n    this.cameraFlight = new CameraFlightAnimation(this, {\n      duration: 0.5,\n    });\n\n    this.metrics = new Metrics(this, {\n      units: options.units,\n      scale: options.scale,\n      origin: options.origin,\n    });\n\n    this.xrayMaterial = new EmphasisMaterial(this, {\n      fill: true,\n      fillColor: [0.9, 0.7, 0.6],\n      fillAlpha: 0.4,\n      edges: true,\n      edgeColor: [0.5, 0.4, 0.4],\n      edgeAlpha: 1.0,\n      edgeWidth: 1,\n    });\n\n    this.highlightMaterial = new EmphasisMaterial(this, {\n      fill: true,\n      fillColor: [1.0, 1.0, 0.0],\n      fillAlpha: 0.5,\n      edges: true,\n      edgeColor: [0.5, 0.4, 0.4],\n      edgeAlpha: 1.0,\n      edgeWidth: 1,\n    });\n\n    this.selectedMaterial = new EmphasisMaterial(this, {\n      fill: true,\n      fillColor: [0.0, 1.0, 0.0],\n      fillAlpha: 0.5,\n      edges: true,\n      edgeColor: [0.4, 0.5, 0.4],\n      edgeAlpha: 1.0,\n      edgeWidth: 1,\n    });\n\n    this.edgeMaterial = new EdgeMaterial(this, {\n      edgeColor: [0.0, 0.0, 0.0],\n      edgeAlpha: 1.0,\n      edgeWidth: 1,\n      edges: true,\n      renderModes: [QualityRender],\n    });\n\n    this.pointsMaterial = new PointsMaterial(this, {\n      pointSize: 1,\n      roundPoints: true,\n      perspectivePoints: true,\n      minPerspectivePointSize: 1,\n      maxPerspectivePointSize: 6,\n      filterIntensity: false,\n      minIntensity: 0,\n      maxIntensity: 1,\n    });\n\n    this.linesMaterial = new LinesMaterial(this, {\n      lineWidth: 1,\n    });\n\n    this.lights = {};\n\n    this.#qualityRender = !!options.qualityRender;\n\n    this.autoLayers = options.autoLayers !== false;\n\n    this.logarithmicDepthBufferEnabled =\n      !!options.logarithmicDepthBufferEnabled;\n\n    this.onObjectVisibility = new EventEmitter(\n      new EventDispatcher<View, ViewObject>()\n    );\n    this.onObjectXRayed = new EventEmitter(\n      new EventDispatcher<View, ViewObject>()\n    );\n    this.onLayerCreated = new EventEmitter(\n      new EventDispatcher<View, ViewLayer>()\n    );\n    this.onLayerDestroyed = new EventEmitter(\n      new EventDispatcher<View, ViewLayer>()\n    );\n    this.onSectionPlaneCreated = new EventEmitter(\n      new EventDispatcher<View, SectionPlane>()\n    );\n    this.onSectionPlaneDestroyed = new EventEmitter(\n      new EventDispatcher<View, SectionPlane>()\n    );\n\n    this.#initObjects();\n  }\n\n  /**\n   *\n   */\n  get aabb(): FloatArrayParam {\n    return this.viewer.scene.aabb;\n  }\n\n  /**\n   * Gets the canvas clear color.\n   *\n   * Default value is ````[1, 1, 1]````.\n   */\n  get backgroundColor(): FloatArrayParam {\n    return this.#backgroundColor;\n  }\n\n  /**\n   * Sets the canvas clear color.\n   *\n   * Default value is ````[1, 1, 1]````.\n   */\n  set backgroundColor(value: FloatArrayParam) {\n    if (value) {\n      this.#backgroundColor[0] = value[0];\n      this.#backgroundColor[1] = value[1];\n      this.#backgroundColor[2] = value[2];\n    } else {\n      this.#backgroundColor[0] = 1.0;\n      this.#backgroundColor[1] = 1.0;\n      this.#backgroundColor[2] = 1.0;\n    }\n    this.redraw();\n  }\n\n  /**\n   * Gets whether the canvas clear color will be derived from {@link AmbientLight} or {@link View#backgroundColor}\n   * when {@link View#transparent} is ```true```.\n   *\n   * When {@link View#transparent} is ```true``` and this is ````true````, then the canvas clear color will\n   * be taken from the ambient light color.\n   *\n   * When {@link View#transparent} is ```true``` and this is ````false````, then the canvas clear color will\n   * be taken from {@link View#backgroundColor}.\n   *\n   * Default value is ````true````.\n   */\n  get backgroundColorFromAmbientLight(): boolean {\n    return this.#backgroundColorFromAmbientLight;\n  }\n\n  /**\n   * Sets if the canvas background color is derived from an {@link AmbientLight}.\n   *\n   * This only has effect when the canvas is not transparent. When not enabled, the background color\n   * will be the canvas element's HTML/CSS background color.\n   *\n   * Default value is ````true````.\n   */\n  set backgroundColorFromAmbientLight(\n    backgroundColorFromAmbientLight: boolean\n  ) {\n    this.#backgroundColorFromAmbientLight =\n      backgroundColorFromAmbientLight !== false;\n  }\n\n  /**\n   * Gets the scale of the canvas back buffer relative to the CSS-defined size of the canvas.\n   *\n   * This is a kdtree3 way to trade off rendering quality for speed. If the canvas size is defined in CSS, then\n   * setting this to a value between ````[0..1]```` (eg ````0.5````) will render into a smaller back buffer, giving\n   * a performance boost.\n   *\n   * @returns  The resolution scale.\n   */\n  get resolutionScale(): number {\n    return this.#resolutionScale;\n  }\n\n  /**\n   * Sets the scale of the canvas back buffer relative to the CSS-defined size of the canvas.\n   *\n   * This is a kdtree3 way to trade off rendering quality for speed. If the canvas size is defined in CSS, then\n   * setting this to a value between ````[0..1]```` (eg ````0.5````) will render into a smaller back buffer, giving\n   * a performance boost.\n   *\n   * @param resolutionScale The resolution scale.\n   */\n  set resolutionScale(resolutionScale: number) {\n    resolutionScale = resolutionScale || 1.0;\n    if (resolutionScale === this.#resolutionScale) {\n      return;\n    }\n    this.#resolutionScale = resolutionScale;\n    const canvasElement = this.canvasElement;\n    canvasElement.width = Math.round(\n      canvasElement.clientWidth * this.#resolutionScale\n    );\n    canvasElement.height = Math.round(\n      canvasElement.clientHeight * this.#resolutionScale\n    );\n    this.redraw();\n  }\n\n  /**\n   * Gets the gamma factor.\n   */\n  get gammaFactor() {\n    // TODO\n    return 1.0;\n  }\n\n  /**\n   * Gets whether quality rendering is enabled for this View.\n   *\n   * Default is ````false````.\n   */\n  get qualityRender(): boolean {\n    return this.#qualityRender;\n  }\n\n  /**\n   * Sets whether quality rendering is enabled for this View.\n   *\n   * Default is ````false````.\n   */\n  set qualityRender(value: boolean) {\n    if (this.#qualityRender === value) {\n      return;\n    }\n    this.#qualityRender = value;\n    this.redraw();\n  }\n\n  /**\n   * Gets the number of {@link ViewObject | ViewObjects} in this View.\n   */\n  get numObjects(): number {\n    return this.#numObjects;\n  }\n\n  /**\n   * Gets the IDs of the {@link ViewObject | ViewObjects} in this View.\n   */\n  get objectIds(): string[] {\n    if (!this.#objectIds) {\n      this.#objectIds = Object.keys(this.objects);\n    }\n    return this.#objectIds;\n  }\n\n  /**\n   * Gets the number of visible {@link ViewObject | ViewObjects} in this View.\n   */\n  get numVisibleObjects(): number {\n    return this.#numVisibleObjects;\n  }\n\n  /**\n   * Gets the IDs of the visible {@link ViewObject | ViewObjects} in this View.\n   */\n  get visibleObjectIds(): string[] {\n    if (!this.#visibleObjectIds) {\n      this.#visibleObjectIds = Object.keys(this.visibleObjects);\n    }\n    return this.#visibleObjectIds;\n  }\n\n  /**\n   * Gets the number of X-rayed {@link ViewObject | ViewObjects} in this View.\n   */\n  get numXRayedObjects(): number {\n    return this.#numXRayedObjects;\n  }\n\n  /**\n   * Gets the IDs of the X-rayed {@link ViewObject | ViewObjects} in this View.\n   */\n  get xrayedObjectIds(): string[] {\n    if (!this.#xrayedObjectIds) {\n      this.#xrayedObjectIds = Object.keys(this.xrayedObjects);\n    }\n    return this.#xrayedObjectIds;\n  }\n\n  /**\n   * Gets the number of highlighted {@link ViewObject | ViewObjects} in this View.\n   */\n  get numHighlightedObjects(): number {\n    return this.#numHighlightedObjects;\n  }\n\n  /**\n   * Gets the IDs of the highlighted {@link ViewObject | ViewObjects} in this View.\n   */\n  get highlightedObjectIds(): string[] {\n    if (!this.#highlightedObjectIds) {\n      this.#highlightedObjectIds = Object.keys(this.highlightedObjects);\n    }\n    return this.#highlightedObjectIds;\n  }\n\n  /**\n   * Gets the number of selected {@link ViewObject | ViewObjects} in this View.\n   */\n  get numSelectedObjects(): number {\n    return this.#numSelectedObjects;\n  }\n\n  /**\n   * Gets the IDs of the selected {@link ViewObject | ViewObjects} in this View.\n   */\n  get selectedObjectIds(): string[] {\n    if (!this.#selectedObjectIds) {\n      this.#selectedObjectIds = Object.keys(this.selectedObjects);\n    }\n    return this.#selectedObjectIds;\n  }\n\n  /**\n   * Gets the number of colorized {@link ViewObject | ViewObjects} in this View.\n   */\n  get numColorizedObjects(): number {\n    return this.#numColorizedObjects;\n  }\n\n  /**\n   * Gets the IDs of the colorized {@link ViewObject | ViewObjects} in this View.\n   */\n  get colorizedObjectIds(): string[] {\n    if (!this.#colorizedObjectIds) {\n      this.#colorizedObjectIds = Object.keys(this.colorizedObjects);\n    }\n    return this.#colorizedObjectIds;\n  }\n\n  /**\n   * Gets the IDs of the {@link ViewObject | ViewObjects} in this View that have updated opacities.\n   */\n  get opacityObjectIds(): string[] {\n    if (!this.#opacityObjectIds) {\n      this.#opacityObjectIds = Object.keys(this.opacityObjects);\n    }\n    return this.#opacityObjectIds;\n  }\n\n  /**\n   * Gets the number of {@link ViewObject | ViewObjects} in this View that have updated opacities.\n   */\n  get numOpacityObjects(): number {\n    return this.#numOpacityObjects;\n  }\n\n  /**\n   * @private\n   */\n  registerViewObject(viewObject: ViewObject) {\n    this.objects[viewObject.id] = viewObject;\n    this.#numObjects++;\n    this.#objectIds = null; // Lazy regenerate\n  }\n\n  /**\n   * @private\n   */\n  deregisterViewObject(viewObject: ViewObject) {\n    delete this.objects[viewObject.id];\n    delete this.visibleObjects[viewObject.id];\n    delete this.xrayedObjects[viewObject.id];\n    delete this.highlightedObjects[viewObject.id];\n    delete this.selectedObjects[viewObject.id];\n    delete this.colorizedObjects[viewObject.id];\n    delete this.opacityObjects[viewObject.id];\n    this.#numObjects--;\n    this.#objectIds = null; // Lazy regenerate\n  }\n\n  /**\n   * @private\n   */\n  objectVisibilityUpdated(\n    viewObject: ViewObject,\n    visible: boolean,\n    notify: boolean = true\n  ) {\n    if (visible) {\n      this.visibleObjects[viewObject.id] = viewObject;\n      this.#numVisibleObjects++;\n    } else {\n      delete this.visibleObjects[viewObject.id];\n      this.#numVisibleObjects--;\n    }\n    this.#visibleObjectIds = null; // Lazy regenerate\n    if (notify) {\n      this.onObjectVisibility.dispatch(this, viewObject);\n    }\n  }\n\n  /**\n   * @private\n   */\n  objectXRayedUpdated(\n    viewObject: ViewObject,\n    xrayed: boolean,\n    notify: boolean = true\n  ) {\n    if (xrayed) {\n      this.xrayedObjects[viewObject.id] = viewObject;\n      this.#numXRayedObjects++;\n    } else {\n      delete this.xrayedObjects[viewObject.id];\n      this.#numXRayedObjects--;\n    }\n    this.#xrayedObjectIds = null; // Lazy regenerate\n    if (notify) {\n      this.onObjectXRayed.dispatch(this, viewObject);\n    }\n  }\n\n  /**\n   * @private\n   */\n  objectHighlightedUpdated(viewObject: ViewObject, highlighted: boolean) {\n    if (highlighted) {\n      this.highlightedObjects[viewObject.id] = viewObject;\n      this.#numHighlightedObjects++;\n    } else {\n      delete this.highlightedObjects[viewObject.id];\n      this.#numHighlightedObjects--;\n    }\n    this.#highlightedObjectIds = null; // Lazy regenerate\n  }\n\n  /**\n   * @private\n   */\n  objectSelectedUpdated(viewObject: ViewObject, selected: boolean) {\n    if (selected) {\n      this.selectedObjects[viewObject.id] = viewObject;\n      this.#numSelectedObjects++;\n    } else {\n      delete this.selectedObjects[viewObject.id];\n      this.#numSelectedObjects--;\n    }\n    this.#selectedObjectIds = null; // Lazy regenerate\n  }\n\n  /**\n   * @private\n   */\n  objectColorizeUpdated(viewObject: ViewObject, colorized: boolean) {\n    if (colorized) {\n      this.colorizedObjects[viewObject.id] = viewObject;\n      this.#numColorizedObjects++;\n    } else {\n      delete this.colorizedObjects[viewObject.id];\n      this.#numColorizedObjects--;\n    }\n    this.#colorizedObjectIds = null; // Lazy regenerate\n  }\n\n  /**\n   * @private\n   */\n  objectOpacityUpdated(viewObject: ViewObject, opacityUpdated: boolean) {\n    if (opacityUpdated) {\n      this.opacityObjects[viewObject.id] = viewObject;\n      this.#numOpacityObjects++;\n    } else {\n      delete this.opacityObjects[viewObject.id];\n      this.#numOpacityObjects--;\n    }\n    this.#opacityObjectIds = null; // Lazy regenerate\n  }\n\n  /**\n   * Creates a {@link SectionPlane} in this View.\n   *\n   * @param sectionPlaneParams\n   */\n  createSectionPlane(sectionPlaneParams: SectionPlaneParams): SectionPlane {\n    let id = sectionPlaneParams.id || createUUID();\n    if (this.sectionPlanes[id]) {\n      this.error(\n        `SectionPlane with ID \"${id}\" already exists - will randomly-generate ID`\n      );\n      id = createUUID();\n    }\n    const sectionPlane = new SectionPlane(this, sectionPlaneParams);\n    this.#registerSectionPlane(sectionPlane);\n    sectionPlane.onDestroyed.one(() => {\n      this.#deregisterSectionPlane(sectionPlane);\n    });\n    return sectionPlane;\n  }\n\n  /**\n   * Destroys the {@link SectionPlane}s in this View.\n   */\n  clearSectionPlanes(): void {\n    const objectIds = Object.keys(this.sectionPlanes);\n    for (let i = 0, len = objectIds.length; i < len; i++) {\n      this.sectionPlanes[objectIds[i]].destroy();\n    }\n    this.sectionPlanesList.length = 0;\n    this.#sectionPlanesHash = null;\n  }\n\n  /**\n   * @private\n   */\n  getSectionPlanesHash() {\n    if (this.#sectionPlanesHash) {\n      return this.#sectionPlanesHash;\n    }\n    if (this.sectionPlanesList.length === 0) {\n      return (this.#sectionPlanesHash = \";\");\n    }\n    let sectionPlane;\n    const hashParts = [];\n    for (let i = 0, len = this.sectionPlanesList.length; i < len; i++) {\n      sectionPlane = this.sectionPlanesList[i];\n      hashParts.push(\"cp\");\n    }\n    hashParts.push(\";\");\n    this.#sectionPlanesHash = hashParts.join(\"\");\n    return this.#sectionPlanesHash;\n  }\n\n  /**\n   * @private\n   */\n  registerLight(light: PointLight | DirLight | AmbientLight) {\n    this.lightsList.push(light);\n    this.lights[light.id] = light;\n    this.#lightsHash = null;\n    this.rebuild();\n  }\n\n  /**\n   * @private\n   */\n  deregisterLight(light: PointLight | DirLight | AmbientLight) {\n    for (let i = 0, len = this.lightsList.length; i < len; i++) {\n      if (this.lightsList[i].id === light.id) {\n        this.lightsList.splice(i, 1);\n        this.#lightsHash = null;\n        delete this.lights[light.id];\n        this.rebuild();\n        return;\n      }\n    }\n  }\n\n  /**\n   * Destroys the light sources in this View.\n   */\n  clearLights(): void {\n    const objectIds = Object.keys(this.lights);\n    for (let i = 0, len = objectIds.length; i < len; i++) {\n      this.lights[objectIds[i]].destroy();\n    }\n  }\n\n  /**\n   * @private\n   */\n  getLightsHash() {\n    if (this.#lightsHash) {\n      return this.#lightsHash;\n    }\n    if (this.lightsList.length === 0) {\n      return (this.#lightsHash = \";\");\n    }\n    const hashParts = [];\n    const lights = this.lightsList;\n    for (let i = 0, len = lights.length; i < len; i++) {\n      const light: any = lights[i];\n      hashParts.push(\"/\");\n      hashParts.push(light.type);\n      hashParts.push(light.space === \"world\" ? \"w\" : \"v\");\n      if (light.castsShadow) {\n        hashParts.push(\"sh\");\n      }\n    }\n    // if (this.lightMaps.length > 0) {\n    //     hashParts.push(\"/lm\");\n    // }\n    // if (this.reflectionMaps.length > 0) {\n    //     hashParts.push(\"/rm\");\n    // }\n    hashParts.push(\";\");\n    this.#lightsHash = hashParts.join(\"\");\n    return this.#lightsHash;\n  }\n\n  //createLight(lightParams) {\n  //\n  // }\n\n  /**\n   * @private\n   */\n  rebuild() {\n    this.viewer.renderer.needsRebuild(this.viewIndex);\n  }\n\n  /**\n   * @private\n   */\n  redraw() {\n    this.viewer.renderer.setImageDirty(this.viewIndex);\n  }\n\n  /**\n   * Destroys this View.\n   *\n   * Causes {@link @xeokit/viewer!Viewer} to fire a \"viewDestroyed\" event.\n   */\n  destroy() {\n    this.viewer.onTick.unsubscribe(this.#onTick);\n    super.destroy();\n    this.onObjectVisibility.clear();\n    this.onObjectXRayed.clear();\n    this.onLayerCreated.clear();\n    this.onLayerDestroyed.clear();\n    this.onSectionPlaneCreated.clear();\n    this.onSectionPlaneDestroyed.clear();\n  }\n\n  /**\n   * @private\n   */\n  getAmbientColorAndIntensity(): FloatArrayParam {\n    return [0, 0, 0, 1];\n  }\n\n  /**\n   * Updates the visibility of the given {@link ViewObject | ViewObjects} in this View.\n   *\n   * - Updates {@link ViewObject.visible} on the Objects with the given IDs.\n   * - Updates {@link View.visibleObjects} and {@link View.numVisibleObjects}.\n   *\n   * @param {String[]} objectIds Array of {@link ViewObject.id} values.\n   * @param visible Whether or not to cull.\n   * @returns True if any {@link ViewObject | ViewObjects} were updated, else false if all updates were redundant and not applied.\n   */\n  setObjectsVisible(objectIds: string[], visible: boolean): boolean {\n    return this.withObjects(objectIds, (viewObject: ViewObject) => {\n      const changed = viewObject.visible !== visible;\n      viewObject.visible = visible;\n      return changed;\n    });\n  }\n\n  /**\n   * Updates the collidability of the given {@link ViewObject | ViewObjects} in this View.\n   *\n   * Updates {@link ViewObject.collidable} on the Objects with the given IDs.\n   *\n   * @param {String[]} objectIds Array of {@link ViewObject.id} values.\n   * @param collidable Whether or not to cull.\n   * @returns True if any {@link ViewObject | ViewObjects} were updated, else false if all updates were redundant and not applied.\n   */\n  setObjectsCollidable(objectIds: string[], collidable: boolean): boolean {\n    return this.withObjects(objectIds, (viewObject: ViewObject) => {\n      const changed = viewObject.collidable !== collidable;\n      viewObject.collidable = collidable;\n      return changed;\n    });\n  }\n\n  /**\n   * Updates the culled status of the given {@link ViewObject | ViewObjects} in this View.\n   *\n   * Updates {@link ViewObject.culled} on the Objects with the given IDs.\n   *\n   * @param {String[]} objectIds Array of {@link ViewObject.id} values.\n   * @param culled Whether or not to cull.\n   * @returns True if any {@link ViewObject | ViewObjects} were updated, else false if all updates were redundant and not applied.\n   */\n  setObjectsCulled(objectIds: string[], culled: boolean): boolean {\n    return this.withObjects(objectIds, (viewObject: ViewObject) => {\n      const changed = viewObject.culled !== culled;\n      viewObject.culled = culled;\n      return changed;\n    });\n  }\n\n  /**\n   * Selects or deselects the given {@link ViewObject | ViewObjects} in this View.\n   *\n   * - Updates {@link ViewObject.selected} on the Objects with the given IDs.\n   * - Updates {@link View.selectedObjects} and {@link View.numSelectedObjects}.\n   *\n   * @param  objectIds One or more {@link ViewObject.id} values.\n   * @param selected Whether or not to select.\n   * @returns True if any {@link ViewObject | ViewObjects} were updated, else false if all updates were redundant and not applied.\n   */\n  setObjectsSelected(objectIds: string[], selected: boolean): boolean {\n    return this.withObjects(objectIds, (viewObject: ViewObject) => {\n      const changed = viewObject.selected !== selected;\n      viewObject.selected = selected;\n      return changed;\n    });\n  }\n\n  /**\n   * Highlights or un-highlights the given {@link ViewObject | ViewObjects} in this View.\n   *\n   * - Updates {@link ViewObject.highlighted} on the Objects with the given IDs.\n   * - Updates {@link View.highlightedObjects} and {@link View.numHighlightedObjects}.\n   *\n   * @param  objectIds One or more {@link ViewObject.id} values.\n   * @param highlighted Whether or not to highlight.\n   * @returns True if any {@link ViewObject | ViewObjects} were updated, else false if all updates were redundant and not applied.\n   */\n  setObjectsHighlighted(objectIds: string[], highlighted: boolean): boolean {\n    return this.withObjects(objectIds, (viewObject: ViewObject) => {\n      const changed = viewObject.highlighted !== highlighted;\n      viewObject.highlighted = highlighted;\n      return changed;\n    });\n  }\n\n  /**\n   * Applies or removes X-ray rendering for the given {@link ViewObject | ViewObjects} in this View.\n   *\n   * - Updates {@link ViewObject.xrayed} on the Objects with the given IDs.\n   * - Updates {@link View.xrayedObjects} and {@link View.numXRayedObjects}.\n   *\n   * @param  objectIds One or more {@link ViewObject.id} values.\n   * @param xrayed Whether or not to xray.\n   * @returns True if any {@link ViewObject | ViewObjects} were updated, else false if all updates were redundant and not applied.\n   */\n  setObjectsXRayed(objectIds: string[], xrayed: boolean): boolean {\n    return this.withObjects(objectIds, (viewObject: ViewObject) => {\n      const changed = viewObject.xrayed !== xrayed;\n      if (changed) {\n        viewObject.xrayed = xrayed;\n      }\n      return changed;\n    });\n  }\n\n  /**\n   * Colorizes the given {@link ViewObject | ViewObjects} in this View.\n   *\n   * - Updates {@link ViewObject.colorize} on the Objects with the given IDs.\n   * - Updates {@link View.colorizedObjects} and {@link View.numColorizedObjects}.\n   *\n   * @param  objectIds One or more {@link ViewObject.id} values.\n   * @param colorize - RGB colorize factors in range ````[0..1,0..1,0..1]````.\n   * @returns True if any {@link ViewObject | ViewObjects} changed opacity, else false if all updates were redundant and not applied.\n   */\n  setObjectsColorized(objectIds: string[], colorize: number[]) {\n    return this.withObjects(objectIds, (viewObject: ViewObject) => {\n      viewObject.colorize = colorize;\n    });\n  }\n\n  /**\n   * Sets the opacity of the given {@link ViewObject | ViewObjects} in this View.\n   *\n   * - Updates {@link ViewObject.opacity} on the Objects with the given IDs.\n   * - Updates {@link View.opacityObjects} and {@link View.numOpacityObjects}.\n   *\n   * @param  objectIds - One or more {@link ViewObject.id} values.\n   * @param opacity - Opacity factor in range ````[0..1]````.\n   * @returns True if any {@link ViewObject | ViewObjects} changed opacity, else false if all updates were redundant and not applied.\n   */\n  setObjectsOpacity(objectIds: string[], opacity: number): boolean {\n    return this.withObjects(objectIds, (viewObject: ViewObject) => {\n      const changed = viewObject.opacity !== opacity;\n      if (changed) {\n        viewObject.opacity = opacity;\n      }\n      return changed;\n    });\n  }\n\n  /**\n   * Sets the pickability of the given {@link ViewObject | ViewObjects} in this View.\n   *\n   * - Updates {@link ViewObject.pickable} on the Objects with the given IDs.\n   * - Enables or disables the ability to pick the given Objects with {@link View.pick}.\n   *\n   * @param {String[]} objectIds Array of {@link ViewObject.id} values.\n   * @param pickable Whether or not to set pickable.\n   * @returns True if any {@link ViewObject | ViewObjects} were updated, else false if all updates were redundant and not applied.\n   */\n  setObjectsPickable(objectIds: string[], pickable: boolean): boolean {\n    return this.withObjects(objectIds, (viewObject: ViewObject) => {\n      const changed = viewObject.pickable !== pickable;\n      if (changed) {\n        viewObject.pickable = pickable;\n      }\n      return changed;\n    });\n  }\n\n  /**\n   * Sets the clippability of the given {@link ViewObject | ViewObjects} in this View.\n   *\n   * - Updates {@link ViewObject.clippable} on the Objects with the given IDs.\n   * - Enables or disables the ability to clip the given Objects with {@link SectionPlane}.\n   *\n   * @param {String[]} objectIds Array of {@link ViewObject.id} values.\n   * @param clippable Whether or not to set clippable.\n   * @returns True if any {@link ViewObject | ViewObjects} were updated, else false if all updates were redundant and not applied.\n   */\n  setObjectsClippable(objectIds: string[], clippable: boolean): boolean {\n    return this.withObjects(objectIds, (viewObject: ViewObject) => {\n      const changed = viewObject.clippable !== clippable;\n      if (changed) {\n        viewObject.clippable = clippable;\n      }\n      return changed;\n    });\n  }\n\n  /**\n   * Iterates with a callback over the given {@link ViewObject | ViewObjects} in this View.\n   *\n   * @param  objectIds One or more {@link ViewObject.id} values.\n   * @param callback Callback to execute on each {@link ViewObject}.\n   * @returns True if any {@link ViewObject | ViewObjects} were updated, else false if all updates were redundant and not applied.\n   */\n  withObjects(objectIds: string[], callback: Function): boolean {\n    let changed = false;\n    for (let i = 0, len = objectIds.length; i < len; i++) {\n      const id = objectIds[i];\n      let viewObject = this.objects[id];\n      if (viewObject) {\n        changed = callback(viewObject) || changed;\n      }\n    }\n    return changed;\n  }\n\n  /**\n   * Creates a {@link ViewLayer} in this View.\n   *\n   * The ViewLayer is then registered in {@link View.layers}.\n   *\n   * Since the ViewLayer is created explicitly by this method, the ViewLayer will persist until {@link ViewLayer.destroy}\n   * is called, or the {@link @xeokit/viewer!View} itself is destroyed. If a ViewLayer with the given ID already exists, then the method\n   * returns that existing ViewLayer. The method will also ensure that the existing ViewLayer likewise persists.\n   *\n   * @param viewLayerParams\n   * @returns The new ViewLayer\n   */\n  createLayer(viewLayerParams: ViewLayerParams): ViewLayer {\n    let viewLayer = this.layers[viewLayerParams.id];\n    if (!viewLayer) {\n      viewLayer = new ViewLayer({\n        // Automatically creates ViewObjects\n        id: viewLayerParams.id,\n        view: this,\n        viewer: this.viewer,\n      });\n      this.layers[viewLayerParams.id] = viewLayer;\n      this.onLayerCreated.dispatch(this, viewLayer);\n      viewLayer.onDestroyed.one(() => {\n        delete this.layers[viewLayer.id];\n        this.onLayerDestroyed.dispatch(this, viewLayer);\n      });\n    }\n    viewLayer.autoDestroy = false;\n    return viewLayer;\n  }\n\n  #registerSectionPlane(sectionPlane: SectionPlane) {\n    this.sectionPlanesList.push(sectionPlane);\n    this.sectionPlanes[sectionPlane.id] = sectionPlane;\n    this.#sectionPlanesHash = null;\n    this.rebuild();\n    this.onSectionPlaneCreated.dispatch(this, sectionPlane);\n  }\n\n  #deregisterSectionPlane(sectionPlane: SectionPlane) {\n    for (let i = 0, len = this.sectionPlanesList.length; i < len; i++) {\n      if (this.sectionPlanesList[i].id === sectionPlane.id) {\n        this.sectionPlanesList.splice(i, 1);\n        this.#sectionPlanesHash = null;\n        delete this.sectionPlanes[sectionPlane.id];\n        this.rebuild();\n        this.onSectionPlaneDestroyed.dispatch(this, sectionPlane);\n        return;\n      }\n    }\n  }\n\n  #initObjects() {\n    for (const id in this.viewer.scene.models) {\n      this.#createObjects(this.viewer.scene.models[id]);\n    }\n    this.viewer.scene.onModelCreated.subscribe(\n      (scene: Scene, model: SceneModel) => {\n        this.#createObjects(model);\n      }\n    );\n    this.viewer.scene.onModelDestroyed.subscribe(\n      (scene: Scene, model: SceneModel) => {\n        this.#destroyObjects(model);\n      }\n    );\n  }\n\n  #createObjects(model: SceneModel) {\n    const sceneObjects = model.objects;\n    const rendererObjects = this.viewer.renderer.rendererViewObjects;\n    for (let id in sceneObjects) {\n      const sceneObject = sceneObjects[id];\n      const rendererObject = rendererObjects[id];\n      //     const layerId = viewerObject.layerId || \"default\";\n      const layerId = \"default\";\n      let viewLayer = this.layers[layerId];\n      if (!viewLayer) {\n        if (!this.autoLayers) {\n          continue;\n        }\n        viewLayer = new ViewLayer({\n          id: layerId,\n          view: this,\n          viewer: this.viewer,\n        });\n        this.layers[layerId] = viewLayer;\n        viewLayer.onDestroyed.one(() => {\n          delete this.layers[viewLayer.id];\n          this.onLayerDestroyed.dispatch(this, viewLayer);\n        });\n        this.onLayerCreated.dispatch(this, viewLayer);\n      }\n      const viewObject = new ViewObject(viewLayer, sceneObject, rendererObject);\n      viewLayer.registerViewObject(viewObject);\n      this.registerViewObject(viewObject);\n    }\n  }\n\n  #destroyObjects(model: SceneModel) {\n    const objects = model.objects;\n    for (let id in objects) {\n      const object = objects[id];\n      //     const layerId = object.layerId || \"main\";\n      const layerId = \"default\";\n      let viewLayer = this.layers[layerId];\n      const viewObject = this.objects[object.id];\n      this.deregisterViewObject(viewObject);\n      if (viewLayer) {\n        viewLayer.deregisterViewObject(viewObject);\n        if (viewLayer.autoDestroy && viewLayer.numObjects === 0) {\n          viewLayer.destroy();\n        }\n      }\n    }\n  }\n}\n\nexport { View };\n","import {apply, createUUID, inQuotes} from \"@xeokit/utils\";\nimport {Capabilities, Component, EventEmitter, SDKError} from \"@xeokit/core\";\nimport {EventDispatcher} from \"strongly-typed-events\";\nimport type {FloatArrayParam} from \"@xeokit/math\";\nimport {Scene} from \"@xeokit/scene\";\n\nimport {View} from \"./View\";\nimport {scheduler} from \"./scheduler\";\nimport type {Renderer} from \"./Renderer\";\n\nimport type {ViewParams} from \"./ViewParams\";\n\nclass TickParams {\n}\n\n/**\n * A Browser-based 2D/3D model viewer.\n *\n * See {@link @xeokit/viewer} for usage.\n */\nexport class Viewer extends Component {\n\n    /**\n     ID of this Viewer.\n     */\n    declare readonly id: string;\n\n    /**\n     True once this Viewer has been destroyed.\n\n     Don't use this Viewer if this is ````true````.\n     */\n    declare readonly destroyed: boolean;\n\n    /**\n     * Indicates the capabilities of this Viewer.\n     */\n    readonly capabilities: Capabilities;\n\n    /**\n     * Emits an event each time a Viewer \"tick\" occurs (~10-60 times per second).\n     *\n     * @event\n     */\n    readonly onTick: EventEmitter<Viewer, TickParams>;\n\n    /**\n     * Emits an event each time a {@link @xeokit/viewer!View} is created.\n     *\n     * @event\n     */\n    readonly onViewCreated: EventEmitter<Viewer, View>;\n\n    /**\n     * Emits an event each time a {@link @xeokit/viewer!View} is destroyed.\n     *\n     * @event\n     */\n    readonly onViewDestroyed: EventEmitter<Viewer, View>;\n\n    /**\n     * The Viewer's scene representation.\n     */\n    readonly scene: Scene;\n\n    /**\n     * Map of all the Views in this Viewer.\n     *\n     * Each {@link @xeokit/viewer!View} is an independently configurable view of the Viewer's models, with its own canvas, camera position, section planes, lights, and object visual states.\n     */\n    readonly views: { [key: string]: View };\n\n    /**\n     * List of all the Views in this Viewer.\n     *\n     * Each {@link @xeokit/viewer!View} is an independently configurable view of the Viewer's models, with its own canvas, camera position, section planes, lights, and object visual states.\n     */\n    readonly viewList: View[];\n\n    /**\n     *  The number of {@link View | Views} belonging to this Viewer.\n     */\n    numViews: number;\n\n    /**\n     The time that this Viewer was created.\n     */\n    readonly startTime: number = (new Date()).getTime();\n\n    /**\n     * @private\n     */\n    readonly renderer: Renderer;\n\n    /**\n     Creates a Viewer.\n\n     @param params - Viewer configuration.\n     @param params.scene - Contains model representations.\n     @param params.renderer - Manages rendering of models.\n     @param params.id - ID for this Viewer, automatically generated by default.\n     @param params.units - The measurement unit type. Accepted values are ````\"meters\"````, ````\"metres\"````, , ````\"centimeters\"````, ````\"centimetres\"````, ````\"millimeters\"````,  ````\"millimetres\"````, ````\"yards\"````, ````\"feet\"```` and ````\"inches\"````.\n     @param params.scale - The number of Real-space units in each World-space coordinate system unit.\n     @param params.origin - The Real-space 3D origin, in current measurement units, at which the World-space coordinate origin ````[0,0,0]```` sits.\n     @param params.localeService - Locale-based translation service.\n\n     */\n    constructor(params: {\n        scene?: Scene,\n        renderer: Renderer,\n        id?: string,\n        units?: string,\n        scale?: number,\n        origin?: FloatArrayParam,\n    }) {\n        super(null, {});\n\n        this.onTick = new EventEmitter(new EventDispatcher<Viewer, TickParams>());\n        this.onViewCreated = new EventEmitter(new EventDispatcher<Viewer, View>());\n        this.onViewDestroyed = new EventEmitter(new EventDispatcher<Viewer, View>());\n\n        this.id = params.id || createUUID();\n\n        this.viewList = [];\n        this.numViews = 0;\n        this.views = {};\n        this.destroyed = false;\n\n        this.capabilities = {\n            maxViews: 0,\n            astcSupported: false,\n            etc1Supported: false,\n            etc2Supported: false,\n            dxtSupported: false,\n            bptcSupported: false,\n            pvrtcSupported: false\n        };\n\n        this.scene = params.scene || new Scene();\n\n        this.renderer = params.renderer;\n        this.renderer.getCapabilities(this.capabilities);\n        this.renderer.init(this);\n\n        scheduler.registerViewer(this);\n    }\n\n    /**\n     * Creates a new {@link @xeokit/viewer!View} within this Viewer.\n     *\n     * * The maximum number of views you're allowed to create is provided in {@link Capabilities.maxViews}. This\n     * will be determined by the {@link Renderer} implementation the Viewer is configured with.\n     * * To destroy the View after use, call {@link View.destroy}.\n     * * You must add a View to the Viewer before you can create or load content into the Viewer's Viewer.\n     *\n     * ### Usage\n     *\n     * ````javascript\n     * const view1 = myViewer.createView({\n     *      id: \"myView\",\n     *      canvasId: \"myView1\"\n     *  });\n     *\n     * if (view1 instanceof SDKError) {\n     *      console.log(view1.message);\n     * } else {\n     *      view1.camera.eye = [-3.933, 2.855, 27.018];\n     *      view1.camera.look = [4.400, 3.724, 8.899];\n     *      view1.camera.up = [-0.018, 0.999, 0.039];\n     *\n     *      //...\n     * }\n     * ````\n     *\n     * @param params View configuration.\n     * @returns *{@link View}*\n     * * On success.\n     * @returns *{@link @xeokit/core!SDKError}*\n     * * If View already exists with the given ID.\n     * * Attempted to create too many Views - see {@link Capabilities.maxViews | Capabilities.maxViews}.\n     */\n    createView(params: ViewParams): View | SDKError {\n        if (this.viewList.length >= this.capabilities.maxViews) {\n            return new SDKError(`Attempted to create too many Views with View.createView() - maximum of ${this.capabilities.maxViews} is allowed`);\n        }\n        let viewId = params.id || createUUID();\n        if (this.views[viewId]) {\n            return new SDKError(`View with ID \"${viewId}\" already exists`);\n        }\n        // @ts-ignore\n        const canvasElement = params.canvasElement || document.getElementById(params.canvasId);\n        if (!(canvasElement instanceof HTMLCanvasElement)) {\n            return new SDKError(\"Mandatory View config expected: valid canvasId or canvasElement\");\n        }\n        const view = new View(apply({viewId, viewer: this}, params));\n        this.#registerView(view);\n        view.viewIndex = this.renderer.registerView(view);\n        view.onDestroyed.one(() => {\n            this.#deregisterView(view);\n            this.renderer.deregisterView(view.viewIndex);\n            this.onViewDestroyed.dispatch(this, view);\n        });\n        this.onViewCreated.dispatch(this, view);\n        this.log(`View created: ${view.viewId}`);\n        return view;\n    }\n\n\n    /**\n     Trigger redraw of all {@link View | Views} belonging to this Viewer.\n\n     @private\n     */\n    redraw(): void {\n        for (let viewId in this.views) {\n            this.views[viewId].redraw();\n        }\n    }\n\n    /**\n     Logs a console debugging message for this Viewer.\n\n     The console message will have this format: *````[LOG] [<component type> <component id>: <message>````*\n\n     @private\n     @param message - The message to log\n     */\n    log(message: string): void {\n        message = `[LOG] ${this.#prefixMessageWithID(message)}`;\n        window.console.log(message);\n    }\n\n    /**\n     Logs a warning for this Viewer to the JavaScript console.\n\n     The console message will have this format: *````[WARN] [<component type> =<component id>: <message>````*\n\n     @private\n     @param message - The warning message to log\n     */\n    warn(message: string): void {\n        message = `[WARN] ${this.#prefixMessageWithID(message)}`;\n        window.console.warn(message);\n    }\n\n    /**\n     Logs an error for this Viewer to the JavaScript console.\n\n     The console message will have this format: *````[ERROR] [<component type> =<component id>: <message>````*\n\n     @private\n     @param message The error message to log\n     */\n    error(message: string): void {\n        message = `[ERROR] ${this.#prefixMessageWithID(message)}`;\n        window.console.error(message);\n    }\n\n    /**\n     * Destroys this Viewer and all {@link View | Views} and {@link Plugin}s we've created within it.\n     */\n    destroy(): void {\n        if (this.destroyed) {\n            return;\n        }\n        scheduler.deregisterViewer(this);\n        for (let id in this.views) {\n            this.views[id].destroy();\n        }\n        this.onTick.clear();\n        this.onViewCreated.clear();\n        this.onViewDestroyed.clear();\n\n    }\n\n    /**\n     * @private\n     * @param params\n     */\n    render(params: any) {\n        for (let viewIndex = 0; viewIndex < this.viewList.length; viewIndex++) {\n            this.renderer.render(viewIndex, {force: true});\n        }\n    }\n\n    #prefixMessageWithID(message: string): string {\n        return ` [${this.constructor.name} \"${inQuotes(this.id)}\"]: ${message}`;\n    }\n\n    #registerView(view: View): void {\n        if (this.views[view.id]) {\n            return;\n        }\n        this.views[view.id] = view;\n        for (let viewIndex = 0; ; viewIndex++) {\n            if (!this.viewList[viewIndex]) {\n                this.viewList[viewIndex] = view;\n                this.numViews++;\n                view.viewIndex = viewIndex;\n                return;\n            }\n        }\n    }\n\n    #deregisterView(view: View): void {\n        if (!this.views[view.id]) {\n            return;\n        }\n        delete this.views[view.id];\n        delete this.viewList[view.viewIndex];\n        this.numViews--;\n    }\n}","import {EventDispatcher} from \"strongly-typed-events\";\n\nimport type {Camera} from \"./Camera\";\nimport {Component, EventEmitter} from \"@xeokit/core\";\nimport {FrustumProjectionType} from \"@xeokit/constants\";\nimport type {FloatArrayParam} from \"@xeokit/math\";\nimport {createMat4, frustumMat4, inverseMat4, mulMat4v4, mulVec3Scalar, transposeMat4} from \"@xeokit/matrix\";\n\n/**\n *  FrustumProjection-based perspective projection configuration for a {@link @xeokit/viewer!Camera} .\n *\n * * Located at {@link Camera.frustumProjection}.\n * * Allows to explicitly set the positions of the left, right, top, bottom, near and far planes, which is useful for asymmetrical view volumes, such as for stereo viewing.\n * * {@link FrustumProjection.near} and {@link FrustumProjection.far} specify the distances to the clipping planes.\n * * {@link FrustumProjection.onProjMatrix} will fire an event whenever {@link FrustumProjection.projMatrix} updates, which indicates that one or more other properties have updated.\n */\nexport class FrustumProjection extends Component {\n\n    /**\n     * The type of this projection.\n     */\n    static readonly type: number = FrustumProjectionType;\n    /**\n     * The Camera this FrustumProjection belongs to.\n     */\n    public readonly camera: Camera;\n    /**\n     * Emits an event each time {@link FrustumProjection.projMatrix} updates.\n     *\n     * @event\n     */\n    readonly onProjMatrix: EventEmitter<FrustumProjection, FloatArrayParam>;\n    #state: {\n        far: number;\n        near: number;\n        left: number;\n        right: number;\n        bottom: number;\n        top: number;\n        projMatrix: FloatArrayParam;\n        inverseProjMatrix: FloatArrayParam;\n        transposedProjMatrix: FloatArrayParam;\n    };\n\n    #inverseMatrixDirty: boolean;\n    #transposedProjMatrixDirty: boolean;\n\n    /**\n     * @private\n     */\n    constructor(camera: Camera, cfg: {\n        far?: number;\n        near?: number;\n        top?: number;\n        bottom?: number;\n        right?: number;\n        left?: number;\n    } = {}) {\n\n        super(camera, cfg);\n\n        this.camera = camera;\n\n        this.#state = {\n            projMatrix: createMat4(),\n            inverseProjMatrix: createMat4(),\n            transposedProjMatrix: createMat4(),\n            near: 0.1,\n            far: 10000.0,\n            left: (cfg.left !== undefined && cfg.left !== null) ? cfg.left : -1.0,\n            right: (cfg.right !== undefined && cfg.right !== null) ? cfg.right : 1.0,\n            bottom: (cfg.bottom !== undefined && cfg.bottom !== null) ? cfg.bottom : -1.0,\n            top: (cfg.top !== undefined && cfg.top !== null) ? cfg.top : 1.0\n        };\n\n        this.onProjMatrix = new EventEmitter(new EventDispatcher<FrustumProjection, FloatArrayParam>());\n\n        this.#inverseMatrixDirty = true;\n        this.#transposedProjMatrixDirty = true;\n    }\n\n    /**\n     * Gets the position of the FrustumProjection's left plane on the View-space X-axis.\n     *\n     * @return {Number} Left frustum plane position.\n     */\n    get left(): number {\n        return this.#state.left;\n    }\n\n    /**\n     * Sets the position of the FrustumProjection's left plane on the View-space X-axis.\n     *\n     * @param value New left frustum plane position.\n     */\n    set left(value: number) {\n        this.#state.left = value;\n        this.setDirty();\n    }\n\n    /**\n     * Gets the position of the FrustumProjection's right plane on the View-space X-axis.\n     *\n     * @return {Number} Right frustum plane position.\n     */\n    get right(): number {\n        return this.#state.right;\n    }\n\n    /**\n     * Sets the position of the FrustumProjection's right plane on the View-space X-axis.\n     *\n     * @param value New right frustum plane position.\n     */\n    set right(value: number) {\n        this.#state.right = value\n        this.setDirty();\n    }\n\n    /**\n     * Gets the position of the FrustumProjection's top plane on the View-space Y-axis.\n     *\n     * @return {Number} Top frustum plane position.\n     */\n    get top(): number {\n        return this.#state.top;\n    }\n\n    /**\n     * Sets the position of the FrustumProjection's top plane on the View-space Y-axis.\n     *\n     * @param value New top frustum plane position.\n     */\n    set top(value: number) {\n        this.#state.top = value\n        this.setDirty();\n    }\n\n    /**\n     * Gets the position of the FrustumProjection's bottom plane on the View-space Y-axis.\n     *\n     * @return {Number} Bottom frustum plane position.\n     */\n    get bottom(): number {\n        return this.#state.bottom;\n    }\n\n    /**\n     * Sets the position of the FrustumProjection's bottom plane on the View-space Y-axis.\n     *\n     * @param value New bottom frustum plane position.\n     */\n    set bottom(value: number) {\n        this.#state.bottom = value\n        this.setDirty();\n    }\n\n    /**\n     * Gets the position of the FrustumProjection's near plane on the positive View-space Z-axis.\n     *\n     * Default value is ````0.1````.\n     *\n     * @return {Number} Near frustum plane position.\n     */\n    get near(): number {\n        return this.#state.near;\n    }\n\n    /**\n     * Sets the position of the FrustumProjection's near plane on the positive View-space Z-axis.\n     *\n     * Default value is ````0.1````.\n     *\n     * @param value New FrustumProjection near plane position.\n     */\n    set near(value: number) {\n        this.#state.near = value\n        this.setDirty();\n    }\n\n    /**\n     * Gets the position of the FrustumProjection's far plane on the positive View-space Z-axis.\n     *\n     * Default value is ````10000.0````.\n     *\n     * @return {Number} Far frustum plane position.\n     */\n    get far(): number {\n        return this.#state.far;\n    }\n\n    /**\n     * Sets the position of the FrustumProjection's far plane on the positive View-space Z-axis.\n     *\n     * Default value is ````10000.0````.\n     *\n     * @param value New far frustum plane position.\n     */\n    set far(value: number) {\n        this.#state.far = value\n        this.setDirty();\n    }\n\n    /**\n     * Gets the FrustumProjection's projection transform matrix.\n     *\n     * Default value is ````[1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1]````.\n     *\n     * @returns The FrustumProjection's projection matrix\n     */\n    get projMatrix(): FloatArrayParam {\n        if (this.dirty) {\n            this.cleanIfDirty();\n        }\n        return this.#state.projMatrix;\n    }\n\n    /**\n     * Gets the inverse of {@link FrustumProjection.projMatrix}.\n     *\n     * @returns  The inverse orthographic projection projMatrix.\n     */\n    get inverseProjMatrix(): FloatArrayParam {\n        if (this.dirty) {\n            this.cleanIfDirty();\n        }\n        if (this.#inverseMatrixDirty) {\n            inverseMat4(this.#state.projMatrix, this.#state.inverseProjMatrix);\n            this.#inverseMatrixDirty = false;\n        }\n        return this.#state.inverseProjMatrix;\n    }\n\n    /**\n     * Gets the transpose of {@link FrustumProjection.projMatrix}.\n     *\n     * @returns The transpose of {@link FrustumProjection.projMatrix}.\n     */\n    get transposedProjMatrix(): FloatArrayParam {\n        if (this.dirty) {\n            this.cleanIfDirty();\n        }\n        if (this.#transposedProjMatrixDirty) {\n            transposeMat4(this.#state.projMatrix, this.#state.transposedProjMatrix);\n            this.#transposedProjMatrixDirty = false;\n        }\n        return this.#state.transposedProjMatrix;\n    }\n\n    /**\n     * @private\n     */\n    clean() {\n        frustumMat4(this.#state.left, this.#state.right, this.#state.bottom, this.#state.top, this.#state.near, this.#state.far, this.#state.projMatrix);\n        this.#inverseMatrixDirty = true;\n        this.#transposedProjMatrixDirty = true;\n        this.camera.view.redraw();\n        this.onProjMatrix.dispatch(this, this.#state.projMatrix);\n    }\n\n    /**\n     * Un-projects the given View-space coordinates, using this FrustumProjection projection.\n     *\n     * @param canvasPos Inputs 2D View-space coordinates.\n     * @param screenZ Inputs Screen-space Z coordinate.\n     * @param screenPos Outputs 3D Screen/Clip-space coordinates.\n     * @param viewPos Outputs un-projected 3D View-space coordinates.\n     * @param worldPos Outputs un-projected 3D World-space coordinates.\n     */\n    unproject(\n        canvasPos: FloatArrayParam,\n        screenZ: number,\n        screenPos: FloatArrayParam,\n        viewPos: FloatArrayParam,\n        worldPos: FloatArrayParam): FloatArrayParam {\n\n        const canvasElement = this.camera.view.canvasElement;\n\n        const halfViewWidth = canvasElement.offsetWidth / 2.0;\n        const halfViewHeight = canvasElement.offsetHeight / 2.0;\n\n        screenPos[0] = (canvasPos[0] - halfViewWidth) / halfViewWidth;\n        screenPos[1] = (canvasPos[1] - halfViewHeight) / halfViewHeight;\n        screenPos[2] = screenZ;\n        screenPos[3] = 1.0;\n\n        mulMat4v4(this.inverseProjMatrix, screenPos, viewPos);\n        mulVec3Scalar(viewPos, 1.0 / viewPos[3]);\n\n        viewPos[3] = 1.0;\n        viewPos[1] *= -1;\n\n        mulMat4v4(this.camera.inverseViewMatrix, viewPos, worldPos);\n\n        return worldPos;\n    }\n\n    /** @private\n     *\n     */\n    destroy() {\n        super.destroy();\n        this.onProjMatrix.clear();\n    }\n}\n","import {Component} from \"@xeokit/core\";\nimport type {View} from \"./View\";\nimport type {FloatArrayParam} from \"@xeokit/math\";\n\n\n/**\n * An ambient light source within a {@link @xeokit/viewer!View}.\n *\n * ## Summary\n *\n * * Has fixed color and intensity that illuminates all objects equally.\n * * {@link AmbientLight}s, {@link DirLight}s and {@link PointLight}s are registered by their {@link Component.id} on {@link View.lights}.\n */\nclass AmbientLight extends Component {\n\n    /**\n     ID of this AmbientLight, unique within the {@link @xeokit/viewer!View}.\n     */\n    declare public id: string;\n\n    /**\n     * The View to which this AmbientLight belongs.\n     */\n    public readonly view: View;\n\n    #state: {\n        intensity: number;\n        color: Float32Array;\n        type: string\n    };\n\n    /**\n     * @param view Owner component. When destroyed, the owner will destroy this AmbientLight as well.\n     * @param cfg AmbientLight configuration\n     */\n    constructor(view: View, cfg: {\n        /** Optional ID, generated automatically when omitted.*/\n        id?: string;\n        /** Intensity factor in range ````[0..1]````.  Default is ````1````.*/\n        intensity?: number;\n        /** RGB color in range ````[0..1,0..1,0..1]````. Default is ````[0.7, 0.7, 0.7]````.*/\n        color?: FloatArrayParam\n    } = {}) {\n        super(view, cfg);\n        this.view = view;\n        this.#state = {\n            type: \"ambient\",\n            color: new Float32Array(cfg.color || [0.7, 0.7, 0.7]),\n            intensity: (cfg.intensity !== undefined && cfg.intensity !== null) ? cfg.intensity : 1.0\n        };\n        this.view.registerLight(this);\n    }\n\n    /**\n     * Sets the RGB color of this AmbientLight.\n     *\n     * Default value is ````[0.7, 0.7, 0.7]````.\n     *\n     * @param color The AmbientLight's RGB color.\n     */\n    set color(color: FloatArrayParam) {\n        this.#state.color.set(color);\n        this.view.redraw();\n    }\n\n    /**\n     * Gets the RGB color of this AmbientLight.\n     *\n     * Default value is ````[0.7, 0.7, 0.7]````.\n     */\n    get color(): FloatArrayParam {\n        return this.#state.color;\n    }\n\n    /**\n     * Sets the intensity of this AmbientLight.\n     *\n     * Default value is ````1.0```` for maximum intensity.\n     *\n     * @param intensity The AmbientLight's intensity.\n     */\n    set intensity(intensity: number) {\n        this.#state.intensity = intensity !== undefined ? intensity : 1.0;\n        this.view.redraw();\n    }\n\n    /**\n     * Gets the intensity of this AmbientLight.\n     *\n     * Default value is ````1.0```` for maximum intensity.\n     *\n     * @returns {Number} The AmbientLight's intensity.\n     */\n    get intensity(): number {\n        return this.#state.intensity;\n    }\n\n    /**\n     * Destroys this AmbientLight.\n     */\n    destroy() {\n        super.destroy();\n        this.view.deregisterLight(this);\n    }\n}\n\nexport {AmbientLight};\n","import {Component} from \"@xeokit/core\";\n\n\nimport type {View} from \"./View\";\nimport type {FloatArrayParam} from \"@xeokit/math\";\n\n/**\n * A directional light source within a {@link @xeokit/viewer!View}.\n *\n * ## Summary\n *\n * * Illuminates all objects equally from a given direction.\n * * Has an emission direction vector in {@link DirLight.dir}, but no position.\n * * Defined in either *World* or *View* coordinate space. When in World-space, {@link DirLight.dir} is relative to the\n * World coordinate system, and will appear to move as the {@link @xeokit/viewer!Camera}  moves. When in View-space, {@link DirLight.dir} is\n * relative to the View coordinate system, and will behave as if fixed to the viewer's head.\n * * {@link AmbientLight}s, {@link DirLight}s and {@link PointLight}s are registered by their {@link Component.id} on {@link View.lights}.\n */\nclass DirLight extends Component {\n\n    /**\n     ID of this DirLight, unique within the {@link @xeokit/viewer!View}.\n     */\n    declare public id: string;\n\n    /**\n     * The View to which this DirLight belongs.\n     */\n    public readonly view: View;\n\n    #state: {\n        type: \"dir\";\n        dir: Float32Array;\n        color: Float32Array;\n        intensity: number;\n        space: \"world\" | \"view\"\n    };\n\n    /**\n     * @param view View that owns this DirLight. When destroyed, the View will destroy this DirLight as well.\n     * @param options The DirLight configuration\n     * @param [options.id] Optional ID, unique among all components in the parent {@link Scene}, generated automatically when omitted.\n     * @param [options.dir=[1.0, 1.0, 1.0]]  A unit vector indicating the direction that the light is shining,  given in either World or View space, depending on the value of the ````space```` parameter.\n     * @param [options.color=[0.7, 0.7, 0.8 ]] The color of this DirLight.\n     * @param [options.intensity=1.0] The intensity of this DirLight, as a factor in range ````[0..1]````.\n     * @param [options.space=\"view\"] The coordinate system the DirLight is defined in - ````\"view\"```` or ````\"space\"````.\n     */\n    constructor(view: View, options: {\n        intensity?: number; color?: FloatArrayParam;\n        dir?: FloatArrayParam; space?: \"world\" | \"view\"\n    } = {}) {\n        super(view, options);\n        this.view = view;\n        this.#state = {\n            type: \"dir\",\n            dir: new Float32Array(options.dir || [1.0, 1.0, 1.0]),\n            color: new Float32Array(options.color || [0.7, 0.7, 0.8]),\n            intensity: (options.intensity !== undefined && options.intensity !== null) ? options.intensity : 1.0,\n            space: options.space || \"view\"\n        };\n        this.view.registerLight(this);\n    }\n\n    /**\n     * Gets the direction in which the DirLight is shining.\n     *\n     * Default value is ````[1.0, 1.0, 1.0]````.\n     *\n     * @returns {Number[]} The direction vector.\n     */\n    get dir(): FloatArrayParam {\n        return this.#state.dir;\n    }\n\n    /**\n     * Sets the direction in which the DirLight is shining.\n     *\n     * Default value is ````[1.0, 1.0, 1.0]````.\n     *\n     * @param value The direction vector.\n     */\n    set dir(value: FloatArrayParam) {\n        this.#state.dir.set(value);\n        this.view.redraw();\n    }\n\n    /**\n     * Gets the RGB color of this DirLight.\n     *\n     * Default value is ````[0.7, 0.7, 0.8]````.\n     *\n     * @returns {Number[]} The DirLight's RGB color.\n     */\n    get color(): FloatArrayParam {\n        return this.#state.color;\n    }\n\n    /**\n     * Sets the RGB color of this DirLight.\n     *\n     * Default value is ````[0.7, 0.7, 0.8]````.\n     *\n     * @param color The DirLight's RGB color.\n     */\n    set color(color: FloatArrayParam) {\n        this.#state.color.set(color);\n        this.view.redraw();\n    }\n\n    /**\n     * Gets the intensity of this DirLight.\n     *\n     * Default value is ````1.0```` for maximum intensity.\n     *\n     * @returns {Number} The DirLight's intensity.\n     */\n    get intensity(): number {\n        return this.#state.intensity;\n    }\n\n    /**\n     * Sets the intensity of this DirLight.\n     *\n     * Default intensity is ````1.0```` for maximum intensity.\n     *\n     * @param intensity The DirLight's intensity\n     */\n    set intensity(intensity: number) {\n        this.#state.intensity = intensity;\n        this.view.redraw();\n    }\n\n    /**\n     * Destroys this DirLight.\n     */\n    destroy() {\n        super.destroy();\n        this.view.deregisterLight(this);\n        this.view.redraw();\n    }\n}\n\nexport {DirLight};\n","import {Component} from \"@xeokit/core\";\n\n\nimport type {View} from \"./View\";\nimport type {FloatArrayParam} from \"@xeokit/math\";\n\n\n/**\n * A positional light source within a {@link @xeokit/viewer!View}.\n *\n * ## Summary\n *\n * * Originates from a single point and spreads outward in all directions, with optional attenuation over distance.\n * * Has a position in {@link PointLight.pos}, but no direction.\n * * Defined in either *World* or *View* coordinate space. When in World-space, {@link PointLight.pos} is relative to\n * the World coordinate system, and will appear to move as the {@link @xeokit/viewer!Camera}  moves. When in View-space,\n * {@link PointLight.pos} is relative to the View coordinate system, and will behave as if fixed to the viewer's head.\n * * Has {@link PointLight.constantAttenuation}, {@link PointLight.linearAttenuation} and {@link PointLight.quadraticAttenuation}\n * factors, which indicate how intensity attenuates over distance.\n * * {@link AmbientLight}s, {@link PointLight}s and {@link PointLight}s are registered by their {@link Component.id} on {@link View.lights}.\n */\nclass PointLight extends Component {\n\n    /**\n     ID of this PointLight, unique within the {@link @xeokit/viewer!View}.\n     */\n    declare public id: string;\n\n    /**\n     * The View to which this PointLight belongs.\n     */\n    public readonly view: View;\n\n    #state: {\n        intensity: number;\n        attenuation: Float32Array;\n        color: Float32Array;\n        pos: Float64Array;\n        type: string;\n        space: string\n    };\n\n    /**\n     * @param view View that owns this PointLight. When destroyed, the View will destroy this PointLight as well.\n     * @param cfg The PointLight configuration\n     * @param [cfg.id] Optional ID, unique among all components in the parent {@link Scene}, generated automatically when omitted.\n     * @param [cfg.pos=[ 1.0, 1.0, 1.0 ]] Position, in either World or View space, depending on the value of the **space** parameter.\n     * @param [cfg.color=[0.7, 0.7, 0.8 ]] Color of this PointLight.\n     * @param [cfg.intensity=1.0] Intensity of this PointLight, as a factor in range ````[0..1]````.\n     * @param [cfg.constantAttenuation=0] Constant attenuation factor.\n     * @param [cfg.linearAttenuation=0] Linear attenuation factor.\n     * @param [cfg.quadraticAttenuation=0] Quadratic attenuation factor.\n     * @param [cfg.space=\"view\"] The coordinate system this PointLight is defined in - \"view\" or \"world\".\n     * @param [cfg.castsShadow=false] Flag which indicates if this PointLight casts a castsShadow.\n     */\n    constructor(view: View, cfg: {\n        /** Optional ID, unique among all components in the parent {@link Scene}, generated automatically when omitted.*/\n        id?: string;\n        /** Intensity of this PointLight, as a factor in range ````[0..1]````. */\n        intensity?: number;\n        /** RGB color */\n        color?: FloatArrayParam;\n        /** World-space position */\n        pos?: FloatArrayParam;\n        /** Quadratic attenuation factor. */\n        quadraticAttenuation?: number;\n        /** Constant attenuation factor */\n        constantAttenuation?: number;\n        /** The coordinate system this PointLight is defined in - \"view\" or \"world\". */\n        space?: string;\n        /** Linear attenuation factor */\n        linearAttenuation?: number\n    } = {}) {\n\n        super(view, cfg);\n\n        this.view = view;\n\n\n        this.#state = {\n            type: \"point\",\n            pos: new Float64Array(cfg.pos || [1.0, 1.0, 1.0]),\n            color: new Float32Array(cfg.color || [0.7, 0.7, 0.8]),\n            intensity: 1.0,\n            // @ts-ignore\n            attenuation: new Float32Array([cfg.constantAttenuation, cfg.linearAttenuation, cfg.quadraticAttenuation]),\n            space: cfg.space || \"view\"\n        };\n\n        this.view.registerLight(this);\n    }\n\n    /**\n     * Gets the position of this PointLight.\n     *\n     * This will be either World- or View-space, depending on the value of {@link PointLight.space}.\n     *\n     * Default value is ````[1.0, 1.0, 1.0]````.\n     *\n     * @returns {Number[]} The position.\n     */\n    get pos(): FloatArrayParam {\n        return this.#state.pos;\n    }\n\n    /**\n     * Sets the position of this PointLight.\n     *\n     * This will be either World- or View-space, depending on the value of {@link PointLight.space}.\n     *\n     * Default value is ````[1.0, 1.0, 1.0]````.\n     *\n     * @param pos The position.\n     */\n    set pos(pos: FloatArrayParam) {\n        this.#state.pos.set(pos || [1.0, 1.0, 1.0]);\n        this.view.redraw();\n    }\n\n    /**\n     * Gets the RGB color of this PointLight.\n     *\n     * Default value is ````[0.7, 0.7, 0.8]````.\n     *\n     * @returns {Number[]} The PointLight's RGB color.\n     */\n    get color(): FloatArrayParam {\n        return this.#state.color;\n    }\n\n    /**\n     * Sets the RGB color of this PointLight.\n     *\n     * Default value is ````[0.7, 0.7, 0.8]````.\n     *\n     * @param color The PointLight's RGB color.\n     */\n    set color(color: FloatArrayParam) {\n        this.#state.color.set(color || [0.7, 0.7, 0.8]);\n        this.view.redraw();\n    }\n\n    /**\n     * Gets the intensity of this PointLight.\n     *\n     * Default value is ````1.0```` for maximum intensity.\n     *\n     * @returns {Number} The PointLight's intensity.\n     */\n    get intensity(): number {\n        return this.#state.intensity;\n    }\n\n    /**\n     * Sets the intensity of this PointLight.\n     *\n     * Default intensity is ````1.0```` for maximum intensity.\n     *\n     * @param intensity The PointLight's intensity\n     */\n    set intensity(intensity: number) {\n        if (intensity === this.#state.intensity) {\n            return;\n        }\n        this.#state.intensity = intensity;\n        this.view.redraw();\n    }\n\n    /**\n     * Gets the constant attenuation factor for this PointLight.\n     *\n     * Default value is ````0````.\n     *\n     * @returns {Number} The constant attenuation factor.\n     */\n    get constantAttenuation(): number {\n        return this.#state.attenuation[0];\n    }\n\n    /**\n     * Sets the constant attenuation factor for this PointLight.\n     *\n     * Default value is ````0````.\n     *\n     * @param value The constant attenuation factor.\n     */\n    set constantAttenuation(value: number) {\n        this.#state.attenuation[0] = value;\n        this.view.redraw();\n    }\n\n    /**\n     * Gets the linear attenuation factor for this PointLight.\n     *\n     * Default value is ````0````.\n     *\n     * @returns {Number} The linear attenuation factor.\n     */\n    get linearAttenuation(): number {\n        return this.#state.attenuation[1];\n    }\n\n    /**\n     * Sets the linear attenuation factor for this PointLight.\n     *\n     * Default value is ````0````.\n     *\n     * @param value The linear attenuation factor.\n     */\n    set linearAttenuation(value: number) {\n        this.#state.attenuation[1] = value;\n        this.view.redraw();\n    }\n\n    /**\n     * Gets the quadratic attenuation factor for this PointLight.\n     *\n     * Default value is ````0````.\n     *\n     * @returns {Number} The quadratic attenuation factor.\n     */\n    get quadraticAttenuation(): number {\n        return this.#state.attenuation[2];\n    }\n\n    /**\n     * Sets the quadratic attenuation factor for this PointLight.\n     *\n     * Default value is ````0````.\n     *\n     * @param value The quadratic attenuation factor.\n     */\n    set quadraticAttenuation(value: number) {\n        this.#state.attenuation[2] = value;\n        this.view.redraw();\n    }\n\n    /**\n     * Destroys this PointLight.\n     */\n    destroy() {\n        super.destroy();\n        this.view.deregisterLight(this);\n        this.view.redraw();\n    }\n}\n\nexport {PointLight};\n","\nimport type {ViewObject} from \"./ViewObject\";\nimport type {FloatArrayParam} from \"@xeokit/math\";\n\n\n/**\n * Results of a pick attempted with {@link View.pick}.\n */\nclass PickResult {\n\n    #viewObject?: ViewObject | null | undefined;\n    #gotCanvasPos: boolean;\n    #gotOrigin: boolean;\n    #gotDirection: boolean;\n    #gotIndices: boolean;\n    #gotLocalPos: boolean;\n    #gotWorldPos: boolean;\n    #gotViewPos: boolean;\n    #gotWorldNormal: boolean;\n    #gotUV: boolean;\n    #canvasPos: Int16Array;\n    #origin: FloatArrayParam;\n    #direction: FloatArrayParam;\n    #indices: Int32Array;\n    #localPos: FloatArrayParam;\n    #worldPos: FloatArrayParam;\n    #viewPos: FloatArrayParam;\n    #worldNormal: FloatArrayParam;\n    #uv: FloatArrayParam;\n\n    constructor() {\n\n        this.#viewObject = null;\n        this.#canvasPos = new Int16Array([0, 0]);\n        this.#origin = new Float64Array([0, 0, 0]);\n        this.#direction = new Float64Array([0, 0, 0]);\n        this.#indices = new Int32Array(3);\n        this.#localPos = new Float64Array([0, 0, 0]);\n        this.#worldPos = new Float64Array([0, 0, 0]);\n        this.#viewPos = new Float64Array([0, 0, 0]);\n        this.#worldNormal = new Float64Array([0, 0, 0]);\n        this.#uv = new Float64Array([0, 0]);\n        this.#gotOrigin = false;\n        this.#gotDirection = false;\n        this.#gotIndices = false;\n        this.#gotCanvasPos = false;\n        this.#gotLocalPos = false;\n        this.#gotWorldPos = false;\n        this.#gotViewPos = false;\n        this.#gotWorldNormal = false;\n        this.#gotUV = false;\n\n        this.reset();\n    }\n\n    /**\n     * The picked {@link ViewObject}.\n     */\n    get viewObject(): ViewObject | null | undefined {\n        return this.#viewObject;\n    }\n\n    /**\n     * @private\n     */\n    set viewObject(value: ViewObject | null | undefined) {\n        this.#viewObject = value;\n    }\n\n    /**\n     * Canvas coordinates when picking with a 2D pointer.\n     */\n    get canvasPos(): Int16Array | undefined {\n        return this.#gotCanvasPos ? this.#canvasPos : undefined;\n    }\n\n    /**\n     * @private\n     */\n    set canvasPos(value: FloatArrayParam | Int16Array | undefined) {\n        if (value) {\n            this.#canvasPos[0] = value[0];\n            this.#canvasPos[1] = value[1];\n            this.#gotCanvasPos = true;\n        } else {\n            this.#gotCanvasPos = false;\n        }\n    }\n\n    /**\n     * World-space 3D ray origin when raypicked.\n     */\n    get origin(): FloatArrayParam | null {\n        return this.#gotOrigin ? this.#origin : null;\n    }\n\n    /**\n     * @private\n     */\n    set origin(value: any) {\n        if (value) {\n            this.#origin[0] = value[0];\n            this.#origin[1] = value[1];\n            this.#origin[2] = value[2];\n            this.#gotOrigin = true;\n        } else {\n            this.#gotOrigin = false;\n        }\n    }\n\n    /**\n     * World-space 3D ray direction when raypicked.\n     */\n    get direction(): FloatArrayParam | null {\n        return this.#gotDirection ? this.#direction : null;\n    }\n\n    /**\n     * @private\n     */\n    set direction(value: any) {\n        if (value) {\n            this.#direction[0] = value[0];\n            this.#direction[1] = value[1];\n            this.#direction[2] = value[2];\n            this.#gotDirection = true;\n        } else {\n            this.#gotDirection = false;\n        }\n    }\n\n    /**\n     * Picked triangle's vertex indices.\n     * Only defined when an object and triangle was picked.\n     */\n    get indices(): Int32Array | null {\n        return this.#viewObject && this.#gotIndices ? this.#indices : null;\n    }\n\n    /**\n     * @private\n     */\n    set indices(value: any) {\n        if (value) {\n            this.#indices[0] = value[0];\n            this.#indices[1] = value[1];\n            this.#indices[2] = value[2];\n            this.#gotIndices = true;\n        } else {\n            this.#gotIndices = false;\n        }\n    }\n\n    /**\n     * Picked Local-space point on surface.\n     * Only defined when an object and a point on its surface was picked.\n     */\n    get localPos(): FloatArrayParam | null {\n        return this.#viewObject && this.#gotLocalPos ? this.#localPos : null;\n    }\n\n    /**\n     * @private\n     */\n    set localPos(value: any) {\n        if (value) {\n            this.#localPos[0] = value[0];\n            this.#localPos[1] = value[1];\n            this.#localPos[2] = value[2];\n            this.#gotLocalPos = true;\n        } else {\n            this.#gotLocalPos = false;\n        }\n    }\n\n    /**\n     * Picked World-space point on surface.\n     * Only defined when an object and a point on its surface was picked.\n     */\n    get worldPos(): FloatArrayParam | null {\n        return this.#viewObject && this.#gotWorldPos ? this.#worldPos : null;\n    }\n\n    /**\n     * @private\n     */\n    set worldPos(value: any) {\n        if (value) {\n            this.#worldPos[0] = value[0];\n            this.#worldPos[1] = value[1];\n            this.#worldPos[2] = value[2];\n            this.#gotWorldPos = true;\n        } else {\n            this.#gotWorldPos = false;\n        }\n    }\n\n    /**\n     * Picked View-space point on surface.\n     * Only defined when an object and a point on its surface was picked.\n     */\n    get viewPos(): FloatArrayParam | null {\n        return this.#viewObject && this.#gotViewPos ? this.#viewPos : null;\n    }\n\n    /**\n     * @private\n     */\n    set viewPos(value: any) {\n        if (value) {\n            this.#viewPos[0] = value[0];\n            this.#viewPos[1] = value[1];\n            this.#viewPos[2] = value[2];\n            this.#gotViewPos = true;\n        } else {\n            this.#gotViewPos = false;\n        }\n    }\n\n    /**\n     * Normal vector at picked position on surface.\n     * Only defined when an object and a point on its surface was picked.\n     */\n    get worldNormal(): FloatArrayParam | null {\n        return this.#viewObject && this.#gotWorldNormal ? this.#worldNormal : null;\n    }\n\n    /**\n     * @private\n     */\n    set worldNormal(value: any) {\n        if (value) {\n            this.#worldNormal[0] = value[0];\n            this.#worldNormal[1] = value[1];\n            this.#worldNormal[2] = value[2];\n            this.#gotWorldNormal = true;\n        } else {\n            this.#gotWorldNormal = false;\n        }\n    }\n\n    /**\n     * UV coordinates at picked position on surface.\n     * Only defined when an object and a point on its surface was picked.\n     */\n    get uv(): FloatArrayParam | null {\n        return this.#viewObject && this.#gotUV ? this.#uv : null;\n    }\n\n    /**\n     * @private\n     */\n    set uv(value: any) {\n        if (value) {\n            this.#uv[0] = value[0];\n            this.#uv[1] = value[1];\n            this.#gotUV = true;\n        } else {\n            this.#gotUV = false;\n        }\n    }\n\n    /**\n     * @private\n     */\n    reset() {\n        this.#viewObject = null;\n        this.#gotCanvasPos = false;\n        this.#gotOrigin = false;\n        this.#gotDirection = false;\n        this.#gotIndices = false;\n        this.#gotLocalPos = false;\n        this.#gotWorldPos = false;\n        this.#gotViewPos = false;\n        this.#gotWorldNormal = false;\n        this.#gotUV = false;\n    }\n}\n\nexport {PickResult};"],"names":["s","t","e","Object","defineProperty","i","writable","value","o","n","this","prototype","addItem","arguments","length","r","removeItem","me","qe","Ae","Be","Ce","De","v","M","Float64Array","FloatArrayClass","Z","g","p","J","u","a","c","Q","Math","sqrt","O","U","_","cn","fn","vn","qn","Zn","f","Y","H","K","L","$","sin","h","cos","l","d","bn","q","X","b","y","gn","w","A","F","m","x","C","k","yn","wn","An","j","z","B","D","Fn","_rendererViewObject","_classPrivateFieldLooseKey","_state","ViewObject","constructor","layer","sceneObject","rendererViewObject","id","_classPrivateFieldLooseBase","visible","culled","pickable","clippable","collidable","xrayed","selected","highlighted","edges","colorize","Float32Array","colorized","opacityUpdated","setVisible","view","viewIndex","objectVisibilityUpdated","aabb","redraw","setXRayed","objectXRayedUpdated","setEdges","setHighlighted","objectHighlightedUpdated","setSelected","objectSelectedUpdated","objectColorizeUpdated","opacity","objectOpacityUpdated","_destroy","SectionPlane","Component","cfg","super","onPos","onDir","onActive","active","pos","dir","dist","EventEmitter","EventDispatcher","dispatch","set","matrix","flipDir","destroy","clear","unitsInfo","MetersUnit","abbrev","_units","_scale","_origin","Metrics","units","scale","origin","onUnits","onScale","onOrigin","createVec3","error","worldToRealPos","worldPos","realPos","realToWorldPos","SAO","params","renderModes","QualityRender","enabled","kernelRadius","intensity","undefined","bias","minResolution","numSamples","blur","blendCutoff","blendCutff","blendFactor","supported","viewer","renderer","getSAOSupported","possible","projectionType","camera","CustomProjectionType","FrustumProjectionType","LinesMaterial","options","lineWidth","_numObjects","_objectIds","_numVisibleObjects","_visibleObjectIds","_numXRayedObjects","_xrayedObjectIds","_numHighlightedObjects","_highlightedObjectIds","_numSelectedObjects","_selectedObjectIds","_numColorizedObjects","_colorizedObjectIds","_numOpacityObjects","_opacityObjectIds","_qualityRender","_initObjects","_createObjects","_destroyObjects","ViewLayer","_destroyObjects2","_createObjects2","_initObjects2","objects","visibleObjects","xrayedObjects","highlightedObjects","selectedObjects","colorizedObjects","opacityObjects","autoDestroy","onObjectVisibility","gammaOutput","qualityRender","gammaFactor","numObjects","objectIds","keys","numVisibleObjects","visibleObjectIds","numXRayedObjects","xrayedObjectIds","numHighlightedObjects","highlightedObjectIds","numSelectedObjects","selectedObjectIds","numColorizedObjects","colorizedObjectIds","opacityObjectIds","numOpacityObjects","registerViewObject","viewObject","deregisterViewObject","setImageDirty","notify","setObjectsVisible","withObjects","changed","setObjectsCollidable","setObjectsCulled","setObjectsSelected","setObjectsHighlighted","setObjectsXRayed","setObjectsColorized","setObjectsOpacity","setObjectsPickable","setObjectsClippable","callback","len","models","scene","model","onModelCreated","subscribe","onModelDestroyed","sceneObjects","rendererViewObjects","layerId","viewerObjects","EmphasisMaterial","fill","fillColor","fillAlpha","edgeColor","edgeAlpha","edgeWidth","backfaces","hash","EdgeMaterial","PointsMaterial","pointSize","roundPoints","perspectivePoints","minPerspectivePointSize","maxPerspectivePointSize","filterIntensity","minIntensity","maxIntensity","rebuild","state","_inverseMatrixDirty","_transposedProjMatrixDirty","_onViewBoundary","PerspectiveProjection","onProjMatrix","near","far","fov","fovAxis","projMatrix","createMat4","inverseProjMatrix","transposedProjMatrix","onBoundary","setDirty","dirty","cleanIfDirty","inverseMat4","transposeMat4","clean","boundary","aspect","min","tan","sn","perspectiveMat4","PI","unproject","canvasPos","screenZ","screenPos","viewPos","canvasElement","halfViewWidth","offsetWidth","halfViewHeight","offsetHeight","mulMat4v4","mulVec3Scalar","inverseViewMatrix","unsubscribe","type","PerspectiveProjectionType","OrthoProjection","halfSize","boundaryWidth","boundaryHeight","left","right","top","bottom","orthoMat4c","canvas","OrthoProjectionType","_inverseProjMatrixDirty","CustomProjection","identityMat4","abs","I","R","testVertex","offset","normal","W","planes","tempVec3","tempVec3b","tempVec3c","tempVec3d","tempVec3e","tempVec3f","tempMat","tempMatb","eyeLookVec","eyeLookVecNorm","eyeLookOffset","offsetEye","_frustum","_activeProjection","Camera","perspectiveProjection","orthoProjection","frustumProjection","customProjection","onProjectionType","onViewMatrix","onWorldAxis","onFrustum","eye","look","up","worldUp","worldRight","worldForward","worldAxis","gimbalLock","constrainPitch","deviceMatrix","hasDeviceMatrix","viewMatrix","viewNormalMatrix","Frustum3","project","axis","xUp","yUp","zUp","eyeLookDist","lenVec3","subVec3","frustum","normalizeVec3","addVec3","lookAtMat4v","mulMat4","V","setFrustum3","orbitYaw","angleInc","lookEyeVec","rotationMat4v","transformPoint3","orbitPitch","dotVec3","DEGTORAD","eye2","cross3Vec3","yaw","look2","pitch","pan","vec","zoom","delta","lenLook","newLenLook","tickEvent","viewerId","time","startTime","prevTime","deltaTime","_viewersRenderInfo","_viewerIDMap","_taskQueue","_taskBudget","_lastTime","_elapsedTime","_runTasks","_runTasksUntil","_fireTickEvents","_renderViewers","_runTasks2","getNumTasks","_runTasksUntil2","until","Date","getTime","tasksRun","shift","scope","call","_fireTickEvents2","scheduler","viewers","hasOwnProperty","onTick","_renderViewers2","renderInfo","render","Map","Queue","frame","now","requestAnimationFrame","registerViewer","console","inQuotes","deregisterViewer","scheduleTask","push","newLook","newEye","newUp","newLookEyeVec","_duration","_look","_eye","_up","_look2","_eye2","_up2","_orthoScale","_orthoScale2","_fit","_trail","_flying","_flyEyeLookUp","_flyingEye","_flyingLook","_callback","_callbackScope","_time","_time2","_flyingEyeLookUp","_fitFOV","_projection","_projMatrix","_projMatrix2","_jumpTo","_update","_ease","_easeInCubic","_easeOutExpo","CameraFlightAnimation","_update2","_jumpTo2","easing","onStarted","onStopped","onCancelled","flyTo","stop","flyToProjection","projection","orthoScale","poi","slice","aabbCenter","getAABB3Center","diag","getAABB3DiagPoint","getAABB3Diag","fitFOV","sca","duration","jumpTo","cancel","fit","trail","stopping","tFlight","lerpVec3","tProj","lerpMat4","pow","_onTick","_backgroundColor","_backgroundColorFromAmbientLight","_resolutionScale","_lightsHash","_sectionPlanesHash","_registerSectionPlane","_deregisterSectionPlane","View","_deregisterSectionPlane2","_registerSectionPlane2","transparent","logarithmicDepthBufferEnabled","sao","cameraFlight","metrics","xrayMaterial","highlightMaterial","selectedMaterial","edgeMaterial","pointsMaterial","linesMaterial","sectionPlanes","sectionPlanesList","lights","lightsList","layers","autoLayers","onObjectXRayed","onLayerCreated","onLayerDestroyed","onSectionPlaneCreated","onSectionPlaneDestroyed","document","getElementById","canvasId","HTMLCanvasElement","backgroundColor","backgroundColorFromAmbientLight","width","clientWidth","height","clientHeight","offsetLeft","offsetTop","lastWindowWidth","lastWindowHeight","lastViewWidth","lastViewHeight","lastViewOffsetLeft","lastViewOffsetTop","lastParent","lastResolutionScale","newResolutionScale","newWindowSize","window","innerWidth","innerHeight","newViewSize","newViewPos","parent","parentElement","newWidth","newHeight","round","resolutionScale","createSectionPlane","sectionPlaneParams","createUUID","sectionPlane","onDestroyed","one","clearSectionPlanes","getSectionPlanesHash","hashParts","join","registerLight","light","deregisterLight","splice","clearLights","getLightsHash","space","castsShadow","needsRebuild","getAmbientColorAndIntensity","createLayer","viewLayerParams","viewLayer","rendererObjects","rendererObject","_prefixMessageWithID","_registerView","_deregisterView","Viewer","_deregisterView2","_registerView2","_prefixMessageWithID2","capabilities","onViewCreated","onViewDestroyed","views","viewList","numViews","destroyed","maxViews","astcSupported","etc1Supported","etc2Supported","dxtSupported","bptcSupported","pvrtcSupported","Scene","getCapabilities","init","createView","SDKError","viewId","apply","registerView","deregisterView","log","message","warn","force","name","FrustumProjection","frustumMat4","AmbientLight","color","DirLight","PointLight","attenuation","constantAttenuation","linearAttenuation","quadraticAttenuation","PickResult","_viewObject","_gotCanvasPos","_gotOrigin","_gotDirection","_gotIndices","_gotLocalPos","_gotWorldPos","_gotViewPos","_gotWorldNormal","_gotUV","_canvasPos","_direction","_indices","_localPos","_worldPos","_viewPos","_worldNormal","_uv","Int16Array","Int32Array","reset","direction","indices","localPos","worldNormal","uv"],"mappings":"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"}