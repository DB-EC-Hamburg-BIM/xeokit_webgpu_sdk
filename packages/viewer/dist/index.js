var t=require("@xeokit/core"),e=require("strongly-typed-events"),i=require("@xeokit/scene"),r=require("@xeokit/math");function n(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,"symbol"==typeof(n=function(t,e){if("object"!=typeof t||null===t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(r.key))?n:String(n),r)}var n}function s(t,e,i){return e&&n(t.prototype,e),i&&n(t,i),Object.defineProperty(t,"prototype",{writable:!1}),t}function o(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,a(t,e)}function a(t,e){return a=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},a(t,e)}function h(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}require("@xeokit/compression");var c=0;function l(t){return"__private_"+c+++"_"+t}function d(t,e){if(!Object.prototype.hasOwnProperty.call(t,e))throw new TypeError("attempted to use private field on non-instance");return t}var u=0;function v(t){return"__private_"+u+++"_"+t}function f(t,e){if(!Object.prototype.hasOwnProperty.call(t,e))throw new TypeError("attempted to use private field on non-instance");return t}var p=/*#__PURE__*/v("items"),y=/*#__PURE__*/v("lastUniqueId"),b=/*#__PURE__*/function(){function t(t,e){Object.defineProperty(this,p,{writable:!0,value:void 0}),Object.defineProperty(this,y,{writable:!0,value:void 0}),f(this,p)[p]=t||[],f(this,y)[y]=(e||0)+1}var e=t.prototype;return e.addItem=function(){var t;if(2===arguments.length){var e=arguments[0];if(t=arguments[1],f(this,p)[p][e])throw"ID clash: '"+e+"'";return f(this,p)[p][e]=t,e}for(t=arguments[0]||{};;){var i=f(this,y)[y]++;if(!f(this,p)[p][i])return f(this,p)[p][i]=t,i}},e.removeItem=function(t){var e=f(this,p)[p][t];return delete f(this,p)[p][t],e},t}(),w=/*#__PURE__*/function(){function t(){this._head=void 0,this._headLength=void 0,this._tail=void 0,this._index=void 0,this._length=void 0,this._head=[],this._headLength=0,this._tail=[],this._index=0,this._length=0}var e,i,r=t.prototype;return r.shift=function(){if(this._index>=this._headLength){var t=this._head;if(t.length=0,this._head=this._tail,this._tail=t,this._index=0,this._headLength=this._head.length,!this._headLength)return}var e=this._head[this._index];return this._index<0?delete this._head[this._index++]:this._head[this._index++]=void 0,this._length--,e},r.push=function(t){return this._length++,this._tail.push(t),this},r.unshift=function(t){return this._head[--this._index]=t,this._length++,this},r.clear=function(){this._head=[],this._headLength=0,this._tail=[],this._index=0,this._length=0},e=t,(i=[{key:"length",get:function(){return this._length}}])&&function(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,"symbol"==typeof(n=function(t,e){if("object"!=typeof t||null===t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(r.key))?n:String(n),r)}var n}(e.prototype,i),Object.defineProperty(e,"prototype",{writable:!1}),t}();function j(t){return function(t){return!isNaN(parseFloat(t))&&isFinite(t)}(t)?""+t:"'"+t+"'"}[["0",10],["A",26],["a",26],["_",1],["$",1]].map(function(t){for(var e=[],i=t[0].charCodeAt(0),r=i+t[1],n=i;n<r;++n)e.push(n);return String.fromCharCode.apply(null,e)}).join("");var g=function(){for(var t=[],e=0;e<256;e++)t[e]=(e<16?"0":"")+e.toString(16);return function(){var e=4294967295*Math.random()|0,i=4294967295*Math.random()|0,r=4294967295*Math.random()|0,n=4294967295*Math.random()|0;return t[255&e]+t[e>>8&255]+t[e>>16&255]+t[e>>24&255]+"-"+t[255&i]+t[i>>8&255]+"-"+t[i>>16&15|64]+t[i>>24&255]+"-"+t[63&r|128]+t[r>>8&255]+"-"+t[r>>16&255]+t[r>>24&255]+t[255&n]+t[n>>8&255]+t[n>>16&255]+t[n>>24&255]}}(),O=3e4,P=4e5,m=5e5,k=500001,x=500002,M=500003;function E(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function D(t){return new Float64Array(t||3)}function A(t){return new FloatArrayClass(t||4)}function I(t,e,i){return i||(i=t),i[0]=t[0]*e,i[1]=t[1]*e,i[2]=t[2]*e,i}function C(t,e,i){return i||(i=t),i[0]=t[0]+e[0],i[1]=t[1]+e[1],i[2]=t[2]+e[2],i}function S(t,e,i){return i||(i=t),i[0]=t[0]-e[0],i[1]=t[1]-e[1],i[2]=t[2]-e[2],i}function V(t,e,i){i||(i=t);var r=t[0],n=t[1],s=t[2],o=e[0],a=e[1],h=e[2];return i[0]=n*h-s*a,i[1]=s*o-r*h,i[2]=r*a-n*o,i}function L(t){return Math.sqrt(function(t){return E(t,t)}(t))}function T(t,e,i,r,n,s){var o=s||D(),a=(t-e)/(i-e);return o[0]=r[0]+a*(n[0]-r[0]),o[1]=r[1]+a*(n[1]-r[1]),o[2]=r[2]+a*(n[2]-r[2]),o}function U(t,e){return I(t,1/L(t),e)}function z(t){return r.newFloatArray(t||16)}A(),A(),new FloatArrayClass(2);var F=z(),R=z();function _(t){return t||(t=z()),t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function W(t,e,i){i||(i=z());var r,n,s,o,a,h,c=function(t,e){return function(t,e,i){return i||(i=t),i[0]=t[0]*e,i[1]=t[1]*e,i[2]=t[2]*e,i[3]=t[3]*e,i}(t,1/function(t){return Math.sqrt(function(t){return function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]}(t,t)}(t))}(t),[])}([e[0],e[1],e[2],0]),l=Math.sin(t),d=Math.cos(t),u=1-d,v=c[0],f=c[1],p=c[2];return r=v*f,n=f*p,s=p*v,o=v*l,a=f*l,h=p*l,i[0]=u*v*v+d,i[1]=u*r+h,i[2]=u*s-a,i[3]=0,i[4]=u*r-h,i[5]=u*f*f+d,i[6]=u*n+o,i[7]=0,i[8]=u*s+a,i[9]=u*n-o,i[10]=u*p*p+d,i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,i}function H(t,e,i,r){r||(r=z());var n,s,o,a,h,c,l,d,u,v,f=t[0],p=t[1],y=t[2],b=i[0],w=i[1],j=i[2],g=e[0],O=e[1],P=e[2];return f===g&&p===O&&y===P?_():(n=f-g,s=p-O,o=y-P,a=w*(o*=v=1/Math.sqrt(n*n+s*s+o*o))-j*(s*=v),h=j*(n*=v)-b*o,c=b*s-w*n,(v=Math.sqrt(a*a+h*h+c*c))?(a*=v=1/v,h*=v,c*=v):(a=0,h=0,c=0),l=s*c-o*h,d=o*a-n*c,u=n*h-s*a,(v=Math.sqrt(l*l+d*d+u*u))?(l*=v=1/v,d*=v,u*=v):(l=0,d=0,u=0),r[0]=a,r[1]=l,r[2]=n,r[3]=0,r[4]=h,r[5]=d,r[6]=s,r[7]=0,r[8]=c,r[9]=u,r[10]=o,r[11]=0,r[12]=-(a*f+h*p+c*y),r[13]=-(l*f+d*p+u*y),r[14]=-(n*f+s*p+o*y),r[15]=1,r)}function q(t,e){e||(e=t);var i=t[0],r=t[1],n=t[2],s=t[3],o=t[4],a=t[5],h=t[6],c=t[7],l=t[8],d=t[9],u=t[10],v=t[11],f=t[12],p=t[13],y=t[14],b=t[15],w=i*a-r*o,j=i*h-n*o,g=i*c-s*o,O=r*h-n*a,P=r*c-s*a,m=n*c-s*h,k=l*p-d*f,x=l*y-u*f,M=l*b-v*f,E=d*y-u*p,D=d*b-v*p,A=u*b-v*y,I=1/(w*A-j*D+g*E+O*M-P*x+m*k);return e[0]=(a*A-h*D+c*E)*I,e[1]=(-r*A+n*D-s*E)*I,e[2]=(p*m-y*P+b*O)*I,e[3]=(-d*m+u*P-v*O)*I,e[4]=(-o*A+h*M-c*x)*I,e[5]=(i*A-n*M+s*x)*I,e[6]=(-f*m+y*g-b*j)*I,e[7]=(l*m-u*g+v*j)*I,e[8]=(o*D-a*M+c*k)*I,e[9]=(-i*D+r*M-s*k)*I,e[10]=(f*P-p*g+b*w)*I,e[11]=(-l*P+d*g-v*w)*I,e[12]=(-o*E+a*x-h*k)*I,e[13]=(i*E-r*x+n*k)*I,e[14]=(-f*O+p*j-y*w)*I,e[15]=(l*O-d*j+u*w)*I,e}function X(t,e){var i=t[4],r=t[14],n=t[8],s=t[13],o=t[12],a=t[9];if(!e||t===e){var h=t[1],c=t[2],l=t[3],d=t[6],u=t[7],v=t[11];return t[1]=i,t[2]=n,t[3]=o,t[4]=h,t[6]=a,t[7]=s,t[8]=c,t[9]=d,t[11]=r,t[12]=l,t[13]=u,t[14]=v,t}return e[0]=t[0],e[1]=i,e[2]=n,e[3]=o,e[4]=t[1],e[5]=t[5],e[6]=a,e[7]=s,e[8]=t[2],e[9]=t[6],e[10]=t[10],e[11]=r,e[12]=t[3],e[13]=t[7],e[14]=t[11],e[15]=t[15],e}function B(t,e,i){i||(i=t);var r=e[0],n=e[1],s=e[2],o=e[3];return i[0]=t[0]*r+t[4]*n+t[8]*s+t[12]*o,i[1]=t[1]*r+t[5]*n+t[9]*s+t[13]*o,i[2]=t[2]*r+t[6]*n+t[10]*s+t[14]*o,i[3]=t[3]*r+t[7]*n+t[11]*s+t[15]*o,i}function N(t,e,i){i||(i=t);var r=t[0],n=t[1],s=t[2],o=t[3],a=t[4],h=t[5],c=t[6],l=t[7],d=t[8],u=t[9],v=t[10],f=t[11],p=t[12],y=t[13],b=t[14],w=t[15],j=e[0],g=e[1],O=e[2],P=e[3],m=e[4],k=e[5],x=e[6],M=e[7],E=e[8],D=e[9],A=e[10],I=e[11],C=e[12],S=e[13],V=e[14],L=e[15];return i[0]=j*r+g*a+O*d+P*p,i[1]=j*n+g*h+O*u+P*y,i[2]=j*s+g*c+O*v+P*b,i[3]=j*o+g*l+O*f+P*w,i[4]=m*r+k*a+x*d+M*p,i[5]=m*n+k*h+x*u+M*y,i[6]=m*s+k*c+x*v+M*b,i[7]=m*o+k*l+x*f+M*w,i[8]=E*r+D*a+A*d+I*p,i[9]=E*n+D*h+A*u+I*y,i[10]=E*s+D*c+A*v+I*b,i[11]=E*o+D*l+A*f+I*w,i[12]=C*r+S*a+V*d+L*p,i[13]=C*n+S*h+V*u+L*y,i[14]=C*s+S*c+V*v+L*b,i[15]=C*o+S*l+V*f+L*w,i}function G(t,e,i){i||(i=e);var r=e[0],n=e[1],s=e[2];return i[0]=t[0]*r+t[4]*n+t[8]*s+t[12],i[1]=t[1]*r+t[5]*n+t[9]*s+t[13],i[2]=t[2]*r+t[6]*n+t[10]*s+t[14],i}r.newFloatArray(3),D(),z(),r.newFloatArray(3);var K,Q=/*#__PURE__*/l("rendererViewObject"),Y=/*#__PURE__*/l("state"),$=/*#__PURE__*/function(){function t(t,e,i){this.id=void 0,this.layer=void 0,this.sceneObject=void 0,Object.defineProperty(this,Q,{writable:!0,value:void 0}),Object.defineProperty(this,Y,{writable:!0,value:void 0}),this.id=e.id,this.layer=t,this.sceneObject=e,d(this,Q)[Q]=i,d(this,Y)[Y]={visible:!0,culled:!1,pickable:!0,clippable:!0,collidable:!0,xrayed:!1,selected:!1,highlighted:!1,edges:!1,colorize:new Float32Array(4),colorized:!1,opacityUpdated:!1},d(this,Q)[Q].setVisible(this.layer.view.viewIndex,d(this,Y)[Y].visible),this.layer.objectVisibilityUpdated(this,d(this,Y)[Y].visible,!0)}return t.prototype._destroy=function(){d(this,Y)[Y].visible&&this.layer.objectVisibilityUpdated(this,!1,!1),d(this,Y)[Y].xrayed&&this.layer.objectXRayedUpdated(this,!1),d(this,Y)[Y].selected&&this.layer.objectSelectedUpdated(this,!1),d(this,Y)[Y].highlighted&&this.layer.objectHighlightedUpdated(this,!1),d(this,Y)[Y].colorized&&this.layer.objectColorizeUpdated(this,!1),d(this,Y)[Y].opacityUpdated&&this.layer.objectOpacityUpdated(this,!1),this.layer.redraw()},s(t,[{key:"aabb",get:function(){return this.sceneObject.aabb}},{key:"visible",get:function(){return d(this,Y)[Y].visible},set:function(t){t!==d(this,Y)[Y].visible&&(d(this,Y)[Y].visible=t,d(this,Q)[Q].setVisible(this.layer.view.viewIndex,t),this.layer.objectVisibilityUpdated(this,t,!0),this.layer.redraw())}},{key:"xrayed",get:function(){return d(this,Y)[Y].xrayed},set:function(t){d(this,Y)[Y].xrayed!==t&&(d(this,Y)[Y].xrayed=t,d(this,Q)[Q].setXRayed(this.layer.view.viewIndex,t),this.layer.objectXRayedUpdated(this,t),this.layer.redraw())}},{key:"edges",get:function(){return d(this,Y)[Y].edges},set:function(t){d(this,Y)[Y].edges!==t&&(d(this,Y)[Y].edges=t,d(this,Q)[Q].setEdges(this.layer.view.viewIndex,t),this.layer.redraw())}},{key:"highlighted",get:function(){return d(this,Y)[Y].highlighted},set:function(t){t!==d(this,Y)[Y].highlighted&&(d(this,Y)[Y].highlighted=t,d(this,Q)[Q].setHighlighted(this.layer.view.viewIndex,t),this.layer.objectHighlightedUpdated(this,t),this.layer.redraw())}},{key:"selected",get:function(){return d(this,Y)[Y].selected},set:function(t){t!==d(this,Y)[Y].selected&&(d(this,Y)[Y].selected=t,d(this,Q)[Q].setSelected(this.layer.view.viewIndex,t),this.layer.objectSelectedUpdated(this,t),this.layer.redraw())}},{key:"culled",get:function(){return d(this,Y)[Y].culled},set:function(t){t!==d(this,Y)[Y].culled&&(d(this,Y)[Y].culled=t,this.layer.redraw())}},{key:"clippable",get:function(){return d(this,Y)[Y].clippable},set:function(t){t!==d(this,Y)[Y].clippable&&(d(this,Y)[Y].clippable=t,this.layer.redraw())}},{key:"collidable",get:function(){return d(this,Y)[Y].collidable},set:function(t){t!==d(this,Y)[Y].collidable&&(d(this,Y)[Y].collidable=t)}},{key:"pickable",get:function(){return d(this,Y)[Y].pickable},set:function(t){d(this,Y)[Y].pickable!==t&&(d(this,Y)[Y].pickable=t)}},{key:"colorize",get:function(){return d(this,Y)[Y].colorize},set:function(t){var e=d(this,Y)[Y].colorize;t?(e[0]=t[0],e[1]=t[1],e[2]=t[2]):(e[0]=1,e[1]=1,e[2]=1),d(this,Y)[Y].colorized=!!t,this.layer.objectColorizeUpdated(this,d(this,Y)[Y].colorized),this.layer.redraw()}},{key:"opacity",get:function(){return d(this,Y)[Y].colorize[3]},set:function(t){var e=d(this,Y)[Y].colorize;d(this,Y)[Y].opacityUpdated=null!=t,e[3]=d(this,Y)[Y].opacityUpdated?t:1,this.layer.objectOpacityUpdated(this,d(this,Y)[Y].opacityUpdated),this.layer.redraw()}}]),t}(),J=/*#__PURE__*/l("state"),Z=/*#__PURE__*/function(i){function r(r,n){var s;return void 0===n&&(n={}),(s=i.call(this,r,n)||this).view=void 0,s.onPos=void 0,s.onDir=void 0,s.onActive=void 0,Object.defineProperty(h(s),J,{writable:!0,value:void 0}),s.view=r,d(h(s),J)[J]={active:!1!==n.active,pos:new Float64Array(n.pos||[0,0,0]),dir:new Float32Array(n.pos||[0,0,-1]),dist:0},s.onPos=new t.EventEmitter(new e.EventDispatcher),s.onDir=new t.EventEmitter(new e.EventDispatcher),s.onActive=new t.EventEmitter(new e.EventDispatcher),s}o(r,i);var n=r.prototype;return n.flipDir=function(){var t=d(this,J)[J].dir;t[0]*=-1,t[1]*=-1,t[2]*=-1,d(this,J)[J].dist=-E(d(this,J)[J].pos,d(this,J)[J].dir),this.onDir.dispatch(this,d(this,J)[J].dir),this.view.redraw()},n.destroy=function(){this.onPos.clear(),this.onDir.clear(),i.prototype.destroy.call(this)},s(r,[{key:"active",get:function(){return d(this,J)[J].active},set:function(t){d(this,J)[J].active!==t&&(d(this,J)[J].active=t,this.view.redraw(),this.onActive.dispatch(this,d(this,J)[J].active))}},{key:"pos",get:function(){return d(this,J)[J].pos},set:function(t){d(this,J)[J].pos.set(t),d(this,J)[J].dist=-E(d(this,J)[J].pos,d(this,J)[J].dir),this.onPos.dispatch(this,d(this,J)[J].pos)}},{key:"dir",get:function(){return d(this,J)[J].dir},set:function(t){d(this,J)[J].dir.set(t),d(this,J)[J].dist=-E(d(this,J)[J].pos,d(this,J)[J].dir),this.view.redraw(),this.onDir.dispatch(this,d(this,J)[J].dir)}},{key:"dist",get:function(){return d(this,J)[J].dist}}]),r}(t.Component),tt=((K={})[P]={abbrev:"m"},K[400001]={abbrev:"cm"},K[400002]={abbrev:"mm"},K[400003]={abbrev:"yd"},K[400004]={abbrev:"ft"},K[400005]={abbrev:"in"},K),et=/*#__PURE__*/l("units"),it=/*#__PURE__*/l("scale"),rt=/*#__PURE__*/l("origin"),nt=/*#__PURE__*/function(i){function r(r,n){var s;return void 0===n&&(n={units:P,scale:1,origin:[1,1,1]}),s=i.call(this,r,n)||this,Object.defineProperty(h(s),et,{writable:!0,value:void 0}),Object.defineProperty(h(s),it,{writable:!0,value:void 0}),Object.defineProperty(h(s),rt,{writable:!0,value:void 0}),s.onUnits=void 0,s.onScale=void 0,s.onOrigin=void 0,s.onUnits=new t.EventEmitter(new e.EventDispatcher),s.onScale=new t.EventEmitter(new e.EventDispatcher),s.onOrigin=new t.EventEmitter(new e.EventDispatcher),d(h(s),et)[et]=P,d(h(s),it)[it]=1,d(h(s),rt)[rt]=D([0,0,0]),s.units=n.units,s.scale=n.scale,s.origin=n.origin,s}o(r,i);var n=r.prototype;return n.worldToRealPos=function(t,e){return void 0===e&&(e=D()),e[0]=d(this,rt)[rt][0]+d(this,it)[it]*t[0],e[1]=d(this,rt)[rt][1]+d(this,it)[it]*t[1],e[2]=d(this,rt)[rt][2]+d(this,it)[it]*t[2],e},n.realToWorldPos=function(t,e){return void 0===e&&(e=D()),e[0]=(t[0]-d(this,rt)[rt][0])/d(this,it)[it],e[1]=(t[1]-d(this,rt)[rt][1])/d(this,it)[it],e[2]=(t[2]-d(this,rt)[rt][2])/d(this,it)[it],e},n.destroy=function(){i.prototype.destroy.call(this),this.onUnits.clear(),this.onScale.clear(),this.onOrigin.clear()},s(r,[{key:"unitsInfo",get:function(){return tt}},{key:"units",get:function(){return d(this,et)[et]},set:function(t){t||(t=P),tt[t]||(this.error("Unsupported value for 'units': "+t+" defaulting to MetersUnit"),t=P),d(this,et)[et]=t,this.onUnits.dispatch(this,d(this,et)[et])}},{key:"scale",get:function(){return d(this,it)[it]},set:function(t){(t=t||1)<=0?this.error("scale value should be larger than zero"):(d(this,it)[it]=t,this.onScale.dispatch(this,d(this,it)[it]))}},{key:"origin",get:function(){return d(this,rt)[rt]},set:function(t){if(!t)return d(this,rt)[rt][0]=0,d(this,rt)[rt][1]=0,void(d(this,rt)[rt][2]=0);d(this,rt)[rt][0]=t[0],d(this,rt)[rt][1]=t[1],d(this,rt)[rt][2]=t[2],this.onOrigin.dispatch(this,d(this,rt)[rt])}}]),r}(t.Component),st=/*#__PURE__*/l("state"),ot=/*#__PURE__*/function(t){function e(e,i){var r;return(r=t.call(this,e,i)||this).view=void 0,Object.defineProperty(h(r),st,{writable:!0,value:void 0}),r.view=e,d(h(r),st)[st]={renderModes:[O],enabled:!1!==i.enabled,kernelRadius:i.kernelRadius||100,intensity:void 0!==i.intensity?i.intensity:.15,bias:void 0!==i.bias?i.bias:.5,scale:void 0!==i.scale?i.scale:1,minResolution:void 0!==i.minResolution?i.minResolution:0,numSamples:void 0!==i.numSamples?i.numSamples:10,blur:!!i.blur,blendCutoff:void 0!==i.blendCutff?i.blendCutoff:.3,blendFactor:void 0!==i.blendFactor?i.blendFactor:1},r}return o(e,t),e.prototype.destroy=function(){t.prototype.destroy.call(this)},s(e,[{key:"renderModes",get:function(){return d(this,st)[st].renderModes},set:function(t){d(this,st)[st].renderModes=t,this.view.redraw()}},{key:"supported",get:function(){return this.view.viewer.renderer.getSAOSupported()}},{key:"enabled",get:function(){return d(this,st)[st].enabled},set:function(t){t=!!t,d(this,st)[st].enabled!==t&&(d(this,st)[st].enabled=t,this.view.redraw())}},{key:"possible",get:function(){if(!this.supported)return!1;if(!d(this,st)[st].enabled)return!1;var t=this.view.camera.projectionType;return t!==M&&t!==x}},{key:"kernelRadius",get:function(){return d(this,st)[st].kernelRadius},set:function(t){null==t&&(t=100),d(this,st)[st].kernelRadius!==t&&(d(this,st)[st].kernelRadius=t,this.view.redraw())}},{key:"intensity",get:function(){return d(this,st)[st].intensity},set:function(t){null==t&&(t=.15),d(this,st)[st].intensity!==t&&(d(this,st)[st].intensity=t,this.view.redraw())}},{key:"bias",get:function(){return d(this,st)[st].bias},set:function(t){null==t&&(t=.5),d(this,st)[st].bias!==t&&(d(this,st)[st].bias=t,this.view.redraw())}},{key:"scale",get:function(){return d(this,st)[st].scale},set:function(t){null==t&&(t=1),d(this,st)[st].scale!==t&&(d(this,st)[st].scale=t,this.view.redraw())}},{key:"minResolution",get:function(){return d(this,st)[st].minResolution},set:function(t){null==t&&(t=0),d(this,st)[st].minResolution!==t&&(d(this,st)[st].minResolution=t,this.view.redraw())}},{key:"numSamples",get:function(){return d(this,st)[st].numSamples},set:function(t){null==t&&(t=10),d(this,st)[st].numSamples!==t&&(d(this,st)[st].numSamples=t,this.view.redraw())}},{key:"blur",get:function(){return d(this,st)[st].blur},set:function(t){t=!1!==t,d(this,st)[st].blur!==t&&(d(this,st)[st].blur=t,this.view.redraw())}},{key:"blendCutoff",get:function(){return d(this,st)[st].blendCutoff},set:function(t){null==t&&(t=.3),d(this,st)[st].blendCutoff!==t&&(d(this,st)[st].blendCutoff=t,this.view.redraw())}},{key:"blendFactor",get:function(){return d(this,st)[st].blendFactor},set:function(t){null==t&&(t=1),d(this,st)[st].blendFactor!==t&&(d(this,st)[st].blendFactor=t,this.view.redraw())}}]),e}(t.Component),at=/*#__PURE__*/l("state"),ht=/*#__PURE__*/function(t){function e(e,i){var r;return void 0===i&&(i={lineWidth:1}),(r=t.call(this,e,i)||this).view=void 0,Object.defineProperty(h(r),at,{writable:!0,value:void 0}),r.view=e,d(h(r),at)[at]={lineWidth:null!=i.lineWidth?i.lineWidth:1},r}return o(e,t),s(e,[{key:"lineWidth",get:function(){return d(this,at)[at].lineWidth},set:function(t){d(this,at)[at].lineWidth=t||1,this.view.redraw()}}]),e}(t.Component),ct=/*#__PURE__*/l("numObjects"),lt=/*#__PURE__*/l("objectIds"),dt=/*#__PURE__*/l("numVisibleObjects"),ut=/*#__PURE__*/l("visibleObjectIds"),vt=/*#__PURE__*/l("numXRayedObjects"),ft=/*#__PURE__*/l("xrayedObjectIds"),pt=/*#__PURE__*/l("numHighlightedObjects"),yt=/*#__PURE__*/l("highlightedObjectIds"),bt=/*#__PURE__*/l("numSelectedObjects"),wt=/*#__PURE__*/l("selectedObjectIds"),jt=/*#__PURE__*/l("numColorizedObjects"),gt=/*#__PURE__*/l("colorizedObjectIds"),Ot=/*#__PURE__*/l("numOpacityObjects"),Pt=/*#__PURE__*/l("opacityObjectIds"),mt=/*#__PURE__*/l("qualityRender"),kt=/*#__PURE__*/l("initObjects"),xt=/*#__PURE__*/l("createObjects"),Mt=/*#__PURE__*/l("destroyObjects"),Et=/*#__PURE__*/function(i){function r(r){var n;return n=i.call(this,r.view,r)||this,Object.defineProperty(h(n),Mt,{value:It}),Object.defineProperty(h(n),xt,{value:At}),Object.defineProperty(h(n),kt,{value:Dt}),n.objects=void 0,n.visibleObjects=void 0,n.xrayedObjects=void 0,n.highlightedObjects=void 0,n.selectedObjects=void 0,n.colorizedObjects=void 0,n.opacityObjects=void 0,n.autoDestroy=void 0,n.onObjectVisibility=void 0,Object.defineProperty(h(n),ct,{writable:!0,value:void 0}),Object.defineProperty(h(n),lt,{writable:!0,value:void 0}),Object.defineProperty(h(n),dt,{writable:!0,value:void 0}),Object.defineProperty(h(n),ut,{writable:!0,value:void 0}),Object.defineProperty(h(n),vt,{writable:!0,value:void 0}),Object.defineProperty(h(n),ft,{writable:!0,value:void 0}),Object.defineProperty(h(n),pt,{writable:!0,value:void 0}),Object.defineProperty(h(n),yt,{writable:!0,value:void 0}),Object.defineProperty(h(n),bt,{writable:!0,value:void 0}),Object.defineProperty(h(n),wt,{writable:!0,value:void 0}),Object.defineProperty(h(n),jt,{writable:!0,value:void 0}),Object.defineProperty(h(n),gt,{writable:!0,value:void 0}),Object.defineProperty(h(n),Ot,{writable:!0,value:void 0}),Object.defineProperty(h(n),Pt,{writable:!0,value:void 0}),Object.defineProperty(h(n),mt,{writable:!0,value:void 0}),n.gammaOutput=void 0,n.id=r.id,n.viewer=r.viewer,n.view=r.view,n.objects={},n.visibleObjects={},n.xrayedObjects={},n.highlightedObjects={},n.selectedObjects={},n.colorizedObjects={},n.opacityObjects={},n.autoDestroy=!1!==r.autoDestroy,d(h(n),ct)[ct]=0,d(h(n),dt)[dt]=0,d(h(n),vt)[vt]=0,d(h(n),pt)[pt]=0,d(h(n),bt)[bt]=0,d(h(n),jt)[jt]=0,d(h(n),Ot)[Ot]=0,d(h(n),mt)[mt]=!!r.qualityRender,n.onObjectVisibility=new t.EventEmitter(new e.EventDispatcher),d(h(n),kt)[kt](),n}o(r,i);var n=r.prototype;return n.registerViewObject=function(t){this.objects[t.id]=t,d(this,ct)[ct]++,d(this,lt)[lt]=null},n.deregisterViewObject=function(t){delete this.objects[t.id],delete this.visibleObjects[t.id],delete this.xrayedObjects[t.id],delete this.highlightedObjects[t.id],delete this.selectedObjects[t.id],delete this.colorizedObjects[t.id],delete this.opacityObjects[t.id],d(this,ct)[ct]--,d(this,lt)[lt]=null},n.redraw=function(){this.viewer.renderer.setImageDirty(this.view.viewIndex)},n.objectVisibilityUpdated=function(t,e,i){void 0===i&&(i=!0),e?(this.visibleObjects[t.id]=t,d(this,dt)[dt]++):(delete this.visibleObjects[t.id],d(this,dt)[dt]--),d(this,ut)[ut]=null,i&&this.onObjectVisibility.dispatch(this,t),this.view.objectVisibilityUpdated(t,e,i)},n.objectXRayedUpdated=function(t,e){e?(this.xrayedObjects[t.id]=t,d(this,vt)[vt]++):(delete this.xrayedObjects[t.id],d(this,vt)[vt]--),d(this,ft)[ft]=null,this.view.objectXRayedUpdated(t,e)},n.objectHighlightedUpdated=function(t,e){e?(this.highlightedObjects[t.id]=t,d(this,pt)[pt]++):(delete this.highlightedObjects[t.id],d(this,pt)[pt]--),d(this,yt)[yt]=null,this.view.objectHighlightedUpdated(t,e)},n.objectSelectedUpdated=function(t,e){e?(this.selectedObjects[t.id]=t,d(this,bt)[bt]++):(delete this.selectedObjects[t.id],d(this,bt)[bt]--),d(this,wt)[wt]=null,this.view.objectSelectedUpdated(t,e)},n.objectColorizeUpdated=function(t,e){e?(this.colorizedObjects[t.id]=t,d(this,jt)[jt]++):(delete this.colorizedObjects[t.id],d(this,jt)[jt]--),d(this,gt)[gt]=null,this.view.objectColorizeUpdated(t,e)},n.objectOpacityUpdated=function(t,e){e?(this.opacityObjects[t.id]=t,d(this,Ot)[Ot]++):(delete this.opacityObjects[t.id],d(this,Ot)[Ot]--),d(this,Pt)[Pt]=null,this.view.objectOpacityUpdated(t,e)},n.setObjectsVisible=function(t,e){return this.withObjects(t,function(t){var i=t.visible!==e;return t.visible=e,i})},n.setObjectsCollidable=function(t,e){return this.withObjects(t,function(t){var i=t.collidable!==e;return t.collidable=e,i})},n.setObjectsCulled=function(t,e){return this.withObjects(t,function(t){var i=t.culled!==e;return t.culled=e,i})},n.setObjectsSelected=function(t,e){return this.withObjects(t,function(t){var i=t.selected!==e;return t.selected=e,i})},n.setObjectsHighlighted=function(t,e){return this.withObjects(t,function(t){var i=t.highlighted!==e;return t.highlighted=e,i})},n.setObjectsXRayed=function(t,e){return this.withObjects(t,function(t){var i=t.xrayed!==e;return i&&(t.xrayed=e),i})},n.setObjectsColorized=function(t,e){return this.withObjects(t,function(t){t.colorize=e})},n.setObjectsOpacity=function(t,e){return this.withObjects(t,function(t){var i=t.opacity!==e;return i&&(t.opacity=e),i})},n.setObjectsPickable=function(t,e){return this.withObjects(t,function(t){var i=t.pickable!==e;return i&&(t.pickable=e),i})},n.setObjectsClippable=function(t,e){return this.withObjects(t,function(t){var i=t.clippable!==e;return i&&(t.clippable=e),i})},n.withObjects=function(t,e){for(var i=!1,r=0,n=t.length;r<n;r++){var s=this.objects[t[r]];s&&(i=e(s)||i)}return i},n.destroy=function(){i.prototype.destroy.call(this)},s(r,[{key:"gammaFactor",get:function(){return 1}},{key:"qualityRender",get:function(){return d(this,mt)[mt]},set:function(t){d(this,mt)[mt]!==t&&(d(this,mt)[mt]=t,this.redraw())}},{key:"numObjects",get:function(){return d(this,ct)[ct]}},{key:"objectIds",get:function(){return d(this,lt)[lt]||(d(this,lt)[lt]=Object.keys(this.objects)),d(this,lt)[lt]}},{key:"numVisibleObjects",get:function(){return d(this,dt)[dt]}},{key:"visibleObjectIds",get:function(){return d(this,ut)[ut]||(d(this,ut)[ut]=Object.keys(this.visibleObjects)),d(this,ut)[ut]}},{key:"numXRayedObjects",get:function(){return d(this,vt)[vt]}},{key:"xrayedObjectIds",get:function(){return d(this,ft)[ft]||(d(this,ft)[ft]=Object.keys(this.xrayedObjects)),d(this,ft)[ft]}},{key:"numHighlightedObjects",get:function(){return d(this,pt)[pt]}},{key:"highlightedObjectIds",get:function(){return d(this,yt)[yt]||(d(this,yt)[yt]=Object.keys(this.highlightedObjects)),d(this,yt)[yt]}},{key:"numSelectedObjects",get:function(){return d(this,bt)[bt]}},{key:"selectedObjectIds",get:function(){return d(this,wt)[wt]||(d(this,wt)[wt]=Object.keys(this.selectedObjects)),d(this,wt)[wt]}},{key:"numColorizedObjects",get:function(){return d(this,jt)[jt]}},{key:"colorizedObjectIds",get:function(){return d(this,gt)[gt]||(d(this,gt)[gt]=Object.keys(this.colorizedObjects)),d(this,gt)[gt]}},{key:"opacityObjectIds",get:function(){return d(this,Pt)[Pt]||(d(this,Pt)[Pt]=Object.keys(this.opacityObjects)),d(this,Pt)[Pt]}},{key:"numOpacityObjects",get:function(){return d(this,Ot)[Ot]}}]),r}(t.Component);function Dt(){var t=this,e=this.viewer.scene.models;for(var i in e){var r=e[i];d(this,xt)[xt](r)}this.viewer.scene.onModelCreated.subscribe(function(e,i){d(t,xt)[xt](i)}),this.viewer.scene.onModelDestroyed.subscribe(function(e,i){d(t,Mt)[Mt](i)})}function At(t){var e=t.objects;for(var i in e){var r=this.viewer.renderer.rendererViewObjects[i];if(r.layerId==this.id){var n=new $(this,e[i],r);this.objects[n.id]=n,d(this,ct)[ct]++,d(this,lt)[lt]=null}}}function It(t){var e=t.objects;for(var i in e)this.objects[e[i].id]._destroy(),d(this,ct)[ct]--,d(this,lt)[lt]=null}var Ct=/*#__PURE__*/l("state"),St=/*#__PURE__*/function(t){function e(e,i){var r;return void 0===i&&(i={}),(r=t.call(this,e,i)||this).view=void 0,Object.defineProperty(h(r),Ct,{writable:!0,value:void 0}),r.view=e,d(h(r),Ct)[Ct]={fill:!!i.fill,fillColor:new Float32Array(i.fillColor||[.4,.4,.4]),fillAlpha:null!=i.fillAlpha?i.fillAlpha:.2,edges:!1!==i.edges,edgeColor:new Float32Array(i.edgeColor||[.2,.2,.2]),edgeAlpha:null!=i.edgeAlpha?i.edgeAlpha:.5,edgeWidth:null!=i.edgeWidth?i.edgeWidth:1,backfaces:!!i.backfaces},r}return o(e,t),e.prototype.destroy=function(){t.prototype.destroy.call(this)},s(e,[{key:"fill",get:function(){return d(this,Ct)[Ct].fill},set:function(t){d(this,Ct)[Ct].fill!==t&&(d(this,Ct)[Ct].fill=t,this.view.redraw())}},{key:"fillColor",get:function(){return d(this,Ct)[Ct].fillColor},set:function(t){var e=d(this,Ct)[Ct].fillColor;e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]||(e[0]=.4,e[1]=.4,e[2]=.4,this.view.redraw())}},{key:"fillAlpha",get:function(){return d(this,Ct)[Ct].fillAlpha},set:function(t){d(this,Ct)[Ct].fillAlpha!==t&&(d(this,Ct)[Ct].fillAlpha=t,this.view.redraw())}},{key:"edges",get:function(){return d(this,Ct)[Ct].edges},set:function(t){d(this,Ct)[Ct].edges!==t&&(d(this,Ct)[Ct].edges=t,this.view.redraw())}},{key:"edgeColor",get:function(){return d(this,Ct)[Ct].edgeColor},set:function(t){var e=d(this,Ct)[Ct].edgeColor;e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]||(e[0]=.2,e[1]=.2,e[2]=.2,this.view.redraw())}},{key:"edgeAlpha",get:function(){return d(this,Ct)[Ct].edgeAlpha},set:function(t){d(this,Ct)[Ct].edgeAlpha!==t&&(d(this,Ct)[Ct].edgeAlpha=t,this.view.redraw())}},{key:"edgeWidth",get:function(){return d(this,Ct)[Ct].edgeWidth},set:function(t){d(this,Ct)[Ct].edgeWidth=t,this.view.redraw()}},{key:"backfaces",get:function(){return d(this,Ct)[Ct].backfaces},set:function(t){d(this,Ct)[Ct].backfaces!==t&&(d(this,Ct)[Ct].backfaces=t,this.view.redraw())}},{key:"hash",get:function(){return""}}]),e}(t.Component),Vt=/*#__PURE__*/l("state"),Lt=/*#__PURE__*/function(t){function e(e,i){var r;return void 0===i&&(i={}),(r=t.call(this,e,i)||this).view=void 0,Object.defineProperty(h(r),Vt,{writable:!0,value:void 0}),r.view=e,d(h(r),Vt)[Vt]={renderModes:i.renderModes||[O],edges:!1!==i.edges,edgeColor:new Float32Array(i.edgeColor||[.2,.2,.2]),edgeAlpha:null!=i.edgeAlpha?i.edgeAlpha:.5,edgeWidth:null!=i.edgeWidth?i.edgeWidth:1},r}return o(e,t),e.prototype.destroy=function(){t.prototype.destroy.call(this)},s(e,[{key:"renderModes",get:function(){return d(this,Vt)[Vt].renderModes},set:function(t){d(this,Vt)[Vt].renderModes=t,this.view.redraw()}},{key:"edges",get:function(){return d(this,Vt)[Vt].edges},set:function(t){d(this,Vt)[Vt].edges!==t&&(d(this,Vt)[Vt].edges=t,this.view.redraw())}},{key:"edgeColor",get:function(){return d(this,Vt)[Vt].edgeColor},set:function(t){var e=d(this,Vt)[Vt].edgeColor;t&&e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]||(e[0]=.2,e[1]=.2,e[2]=.2,this.view.redraw())}},{key:"edgeAlpha",get:function(){return d(this,Vt)[Vt].edgeAlpha},set:function(t){d(this,Vt)[Vt].edgeAlpha!==t&&(d(this,Vt)[Vt].edgeAlpha=t,this.view.redraw())}},{key:"edgeWidth",get:function(){return d(this,Vt)[Vt].edgeWidth},set:function(t){d(this,Vt)[Vt].edgeWidth!==t&&(d(this,Vt)[Vt].edgeWidth=t,this.view.redraw())}}]),e}(t.Component),Tt=/*#__PURE__*/l("state"),Ut=/*#__PURE__*/function(t){function e(e,i){var r;return void 0===i&&(i={}),(r=t.call(this,e,i)||this).view=void 0,Object.defineProperty(h(r),Tt,{writable:!0,value:void 0}),r.view=e,d(h(r),Tt)[Tt]={pointSize:null!=i.pointSize?i.pointSize:1,roundPoints:!1!==i.roundPoints,perspectivePoints:!1!==i.perspectivePoints,minPerspectivePointSize:null!=i.minPerspectivePointSize?i.minPerspectivePointSize:1,maxPerspectivePointSize:null!=i.maxPerspectivePointSize?i.maxPerspectivePointSize:6,filterIntensity:!!i.filterIntensity,minIntensity:null!=i.minIntensity?i.minIntensity:0,maxIntensity:null!=i.maxIntensity?i.maxIntensity:1},r}return o(e,t),e.prototype.destroy=function(){t.prototype.destroy.call(this)},s(e,[{key:"pointSize",get:function(){return d(this,Tt)[Tt].pointSize},set:function(t){d(this,Tt)[Tt].pointSize=t,this.view.redraw()}},{key:"roundPoints",get:function(){return d(this,Tt)[Tt].roundPoints},set:function(t){d(this,Tt)[Tt].roundPoints!==t&&(d(this,Tt)[Tt].roundPoints=t,this.view.rebuild())}},{key:"perspectivePoints",get:function(){return d(this,Tt)[Tt].perspectivePoints},set:function(t){d(this,Tt)[Tt].perspectivePoints!==t&&(d(this,Tt)[Tt].perspectivePoints=t,this.view.rebuild())}},{key:"minPerspectivePointSize",get:function(){return d(this,Tt)[Tt].minPerspectivePointSize},set:function(t){d(this,Tt)[Tt].minPerspectivePointSize!==t&&(d(this,Tt)[Tt].minPerspectivePointSize=t,this.view.rebuild())}},{key:"maxPerspectivePointSize",get:function(){return d(this,Tt)[Tt].maxPerspectivePointSize},set:function(t){d(this,Tt)[Tt].maxPerspectivePointSize!==t&&(d(this,Tt)[Tt].maxPerspectivePointSize=t,this.view.rebuild())}},{key:"filterIntensity",get:function(){return d(this,Tt)[Tt].filterIntensity},set:function(t){d(this,Tt)[Tt].filterIntensity!==t&&(d(this,Tt)[Tt].filterIntensity=t,this.view.rebuild())}},{key:"minIntensity",get:function(){return d(this,Tt)[Tt].minIntensity},set:function(t){d(this,Tt)[Tt].minIntensity!==t&&(d(this,Tt)[Tt].minIntensity=t,this.view.redraw())}},{key:"maxIntensity",get:function(){return d(this,Tt)[Tt].maxIntensity},set:function(t){d(this,Tt)[Tt].maxIntensity!==t&&(d(this,Tt)[Tt].maxIntensity=t,this.view.redraw())}},{key:"hash",get:function(){var t=d(this,Tt)[Tt];return t.pointSize+";\n        "+t.roundPoints+";\n        "+t.perspectivePoints+";\n        "+t.minPerspectivePointSize+";\n        "+t.maxPerspectivePointSize+";\n        "+t.filterIntensity}}]),e}(t.Component),zt=/*#__PURE__*/l("state"),Ft=/*#__PURE__*/l("inverseMatrixDirty"),Rt=/*#__PURE__*/l("transposedProjMatrixDirty"),_t=/*#__PURE__*/l("onViewBoundary"),Wt=/*#__PURE__*/function(i){function r(r,n){var s;return void 0===n&&(n={}),(s=i.call(this,r,n)||this).camera=void 0,s.onProjMatrix=void 0,Object.defineProperty(h(s),zt,{writable:!0,value:void 0}),Object.defineProperty(h(s),Ft,{writable:!0,value:void 0}),Object.defineProperty(h(s),Rt,{writable:!0,value:void 0}),Object.defineProperty(h(s),_t,{writable:!0,value:void 0}),s.camera=r,d(h(s),zt)[zt]={near:n.near||.1,far:n.far||2e3,fov:n.fov||60,fovAxis:n.fovAxis||"min",projMatrix:z(),inverseProjMatrix:z(),transposedProjMatrix:z()},d(h(s),Ft)[Ft]=!0,d(h(s),Rt)[Rt]=!0,d(h(s),_t)[_t]=s.camera.view.onBoundary.subscribe(function(){s.setDirty()}),s.onProjMatrix=new t.EventEmitter(new e.EventDispatcher),s}o(r,i);var n=r.prototype;return n.clean=function(){var t=this.camera.view.boundary,e=t[2]/t[3],i=d(this,zt)[zt].fovAxis,r=d(this,zt)[zt].fov;("x"===i||"min"===i&&e<1||"max"===i&&e>1)&&(r/=e),function(t,e,i,r,n){var s=[],o=[];s[2]=i,o[2]=r,o[1]=s[2]*Math.tan(t/2),s[1]=-o[1],o[0]=o[1]*e,s[0]=-o[0],function(t,e,i){i||(i=z());var r=[t[0],t[1],t[2],0],n=[e[0],e[1],e[2],0];(function(t,e,i){i||(i=t),i[0]=t[0]+e[0],i[1]=t[1]+e[1],i[2]=t[2]+e[2],i[3]=t[3]+e[3]})(n,r,F),function(t,e,i){i||(i=t),i[0]=t[0]-e[0],i[1]=t[1]-e[1],i[2]=t[2]-e[2],i[3]=t[3]-e[3]}(n,r,R);var s=2*r[2],o=R[0],a=R[1],h=R[2];i[0]=s/o,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=s/a,i[6]=0,i[7]=0,i[8]=F[0]/o,i[9]=F[1]/a,i[10]=-F[2]/h,i[11]=-1,i[12]=0,i[13]=0,i[14]=-s*n[2]/h,i[15]=0}(s,o,n)}((r=Math.min(r,120))*(Math.PI/180),e,d(this,zt)[zt].near,d(this,zt)[zt].far,d(this,zt)[zt].projMatrix),d(this,Ft)[Ft]=!0,d(this,Rt)[Rt]=!0,this.camera.view.redraw(),this.onProjMatrix.dispatch(this,d(this,zt)[zt].projMatrix)},n.unproject=function(t,e,i,r,n){var s=this.camera.view.canvasElement,o=s.offsetWidth/2,a=s.offsetHeight/2;return i[0]=(t[0]-o)/o,i[1]=(t[1]-a)/a,i[2]=e,i[3]=1,B(this.inverseProjMatrix,i,r),I(r,1/r[3]),r[3]=1,r[1]*=-1,B(this.camera.inverseViewMatrix,r,n),n},n.destroy=function(){i.prototype.destroy.call(this),this.camera.view.onBoundary.unsubscribe(d(this,_t)[_t]),this.onProjMatrix.clear()},s(r,[{key:"fov",get:function(){return d(this,zt)[zt].fov},set:function(t){t!==d(this,zt)[zt].fov&&(d(this,zt)[zt].fov=t,this.setDirty())}},{key:"fovAxis",get:function(){return d(this,zt)[zt].fovAxis},set:function(t){t=t||"min",d(this,zt)[zt].fovAxis!==t&&("x"!==t&&"y"!==t&&"min"!==t&&(this.error("Unsupported value for 'fovAxis': "+t+" - defaulting to 'min'"),t="min"),d(this,zt)[zt].fovAxis=t,this.setDirty())}},{key:"near",get:function(){return d(this,zt)[zt].near},set:function(t){d(this,zt)[zt].near!==t&&(d(this,zt)[zt].near=t,this.setDirty())}},{key:"far",get:function(){return d(this,zt)[zt].far},set:function(t){d(this,zt)[zt].far!==t&&(d(this,zt)[zt].far=t,this.setDirty())}},{key:"projMatrix",get:function(){return this.dirty&&this.cleanIfDirty(),d(this,zt)[zt].projMatrix}},{key:"inverseProjMatrix",get:function(){return this.dirty&&this.cleanIfDirty(),d(this,Ft)[Ft]&&(q(d(this,zt)[zt].projMatrix,d(this,zt)[zt].inverseProjMatrix),d(this,Ft)[Ft]=!1),d(this,zt)[zt].inverseProjMatrix}},{key:"transposedProjMatrix",get:function(){return this.dirty&&this.cleanIfDirty(),d(this,Rt)[Rt]&&(X(d(this,zt)[zt].projMatrix,d(this,zt)[zt].transposedProjMatrix),d(this,Rt)[Rt]=!1),d(this,zt)[zt].transposedProjMatrix}}]),r}(t.Component);Wt.type=m;var Ht=/*#__PURE__*/l("state"),qt=/*#__PURE__*/l("inverseMatrixDirty"),Xt=/*#__PURE__*/l("transposedProjMatrixDirty"),Bt=/*#__PURE__*/l("onViewBoundary"),Nt=/*#__PURE__*/function(i){function r(r,n){var s;return void 0===n&&(n={}),(s=i.call(this,r,n)||this).camera=void 0,s.onProjMatrix=void 0,Object.defineProperty(h(s),Ht,{writable:!0,value:void 0}),Object.defineProperty(h(s),qt,{writable:!0,value:void 0}),Object.defineProperty(h(s),Xt,{writable:!0,value:void 0}),Object.defineProperty(h(s),Bt,{writable:!0,value:void 0}),s.camera=r,d(h(s),Ht)[Ht]={near:n.near||.1,far:n.far||2e3,scale:n.scale||1,projMatrix:z(),inverseProjMatrix:z(),transposedProjMatrix:z()},s.onProjMatrix=new t.EventEmitter(new e.EventDispatcher),d(h(s),qt)[qt]=!0,d(h(s),Xt)[Xt]=!0,d(h(s),Bt)[Bt]=s.camera.view.onBoundary.subscribe(function(){s.setDirty()}),s}o(r,i);var n=r.prototype;return n.clean=function(){var t,e,i,r,n=this.camera.view,s=.5*d(this,Ht)[Ht].scale,o=n.boundary,a=o[2],h=o[3],c=a/h;a>h?(t=-s,e=s,i=s/c,r=-s/c):(t=-s*c,e=s*c,i=s,r=-s),function(t,e,i,r,n,s,o){o||(o=z());var a=e-t,h=r-i,c=s-n;o[0]=2/a,o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[5]=2/h,o[6]=0,o[7]=0,o[8]=0,o[9]=0,o[10]=-2/c,o[11]=0,o[12]=-(t+e)/a,o[13]=-(r+i)/h,o[14]=-(s+n)/c,o[15]=1}(t,e,r,i,d(this,Ht)[Ht].near,d(this,Ht)[Ht].far,d(this,Ht)[Ht].projMatrix),d(this,qt)[qt]=!0,d(this,Xt)[Xt]=!0,this.camera.view.redraw(),this.onProjMatrix.dispatch(this,d(this,Ht)[Ht].projMatrix)},n.unproject=function(t,e,i,r,n){var s=this.camera.view.canvasElement,o=s.offsetWidth/2,a=s.offsetHeight/2;return i[0]=(t[0]-o)/o,i[1]=(t[1]-a)/a,i[2]=e,i[3]=1,B(this.inverseProjMatrix,i,r),I(r,1/r[3]),r[3]=1,r[1]*=-1,B(this.camera.inverseViewMatrix,r,n),n},n.destroy=function(){i.prototype.destroy.call(this),this.camera.view.onBoundary.unsubscribe(d(this,Bt)[Bt]),this.onProjMatrix.clear()},s(r,[{key:"scale",get:function(){return d(this,Ht)[Ht].scale},set:function(t){t<=0&&(t=.01),d(this,Ht)[Ht].scale=t,this.setDirty()}},{key:"near",get:function(){return d(this,Ht)[Ht].near},set:function(t){d(this,Ht)[Ht].near!==t&&(d(this,Ht)[Ht].near=t,this.setDirty())}},{key:"far",get:function(){return d(this,Ht)[Ht].far},set:function(t){d(this,Ht)[Ht].far!==t&&(d(this,Ht)[Ht].far=t,this.setDirty())}},{key:"projMatrix",get:function(){return this.dirty&&this.cleanIfDirty(),d(this,Ht)[Ht].projMatrix}},{key:"inverseProjMatrix",get:function(){return this.dirty&&this.cleanIfDirty(),d(this,qt)[qt]&&(q(d(this,Ht)[Ht].projMatrix,d(this,Ht)[Ht].inverseProjMatrix),d(this,qt)[qt]=!1),d(this,Ht)[Ht].inverseProjMatrix}},{key:"transposedProjMatrix",get:function(){return this.dirty&&this.cleanIfDirty(),d(this,Xt)[Xt]&&(X(d(this,Ht)[Ht].projMatrix,d(this,Ht)[Ht].transposedProjMatrix),d(this,Xt)[Xt]=!1),d(this,Ht)[Ht].transposedProjMatrix}}]),r}(t.Component);Nt.type=k;var Gt=/*#__PURE__*/l("state"),Kt=/*#__PURE__*/l("inverseProjMatrixDirty"),Qt=/*#__PURE__*/l("transposedProjMatrixDirty"),Yt=/*#__PURE__*/function(i){function r(r,n){var s;return void 0===n&&(n={}),(s=i.call(this,r,n)||this).camera=void 0,s.onProjMatrix=void 0,Object.defineProperty(h(s),Gt,{writable:!0,value:void 0}),Object.defineProperty(h(s),Kt,{writable:!0,value:void 0}),Object.defineProperty(h(s),Qt,{writable:!0,value:void 0}),s.camera=r,d(h(s),Gt)[Gt]={projMatrix:z(n.projMatrix||_()),inverseProjMatrix:z(),transposedProjMatrix:z()},s.onProjMatrix=new t.EventEmitter(new e.EventDispatcher),d(h(s),Kt)[Kt]=!0,d(h(s),Qt)[Qt]=!1,s}o(r,i);var n=r.prototype;return n.unproject=function(t,e,i,r,n){var s=this.camera.view.canvasElement,o=s.offsetWidth/2,a=s.offsetHeight/2;return i[0]=(t[0]-o)/o,i[1]=(t[1]-a)/a,i[2]=e,i[3]=1,B(this.inverseProjMatrix,i,r),I(r,1/r[3]),r[3]=1,r[1]*=-1,B(this.camera.inverseViewMatrix,r,n),n},n.destroy=function(){i.prototype.destroy.call(this),this.onProjMatrix.clear()},s(r,[{key:"projMatrix",get:function(){return d(this,Gt)[Gt].projMatrix},set:function(t){d(this,Gt)[Gt].projMatrix.set(t),d(this,Kt)[Kt]=!0,d(this,Qt)[Qt]=!0,this.setDirty(),this.camera.view.redraw(),this.onProjMatrix.dispatch(this,d(this,Gt)[Gt].projMatrix)}},{key:"inverseProjMatrix",get:function(){return this.dirty&&this.cleanIfDirty(),d(this,Kt)[Kt]&&(q(d(this,Gt)[Gt].projMatrix,d(this,Gt)[Gt].inverseProjMatrix),d(this,Kt)[Kt]=!1),d(this,Gt)[Gt].inverseProjMatrix}},{key:"transposedProjMatrix",get:function(){return this.dirty&&this.cleanIfDirty(),d(this,Qt)[Qt]&&(X(d(this,Gt)[Gt].projMatrix,d(this,Gt)[Gt].transposedProjMatrix),d(this,Qt)[Qt]=!1),d(this,Gt)[Gt].transposedProjMatrix}}]),r}(t.Component);Yt.type=M;var $t,Jt,Zt,te=z(),ee=($t=r.newFloatArray(3),Jt=r.newFloatArray(3),Zt=r.newFloatArray(3),function(t){return $t[0]=t[0],$t[1]=t[1],$t[2]=t[2],Jt[0]=t[3],Jt[1]=t[4],Jt[2]=t[5],S(Jt,$t,Zt),Math.abs(L(Zt))}),ie=function(){var t=r.newFloatArray(3),e=r.newFloatArray(3),i=r.newFloatArray(3);return function(r,n){t[0]=r[0],t[1]=r[1],t[2]=r[2],e[0]=r[3],e[1]=r[4],e[2]=r[5];var s=S(e,t,i),o=n[0]-r[0],a=r[3]-n[0],h=n[1]-r[1],c=r[4]-n[1],l=n[2]-r[2],d=r[5]-n[2];return s[0]+=o>a?o:a,s[1]+=h>c?h:c,s[2]+=l>d?l:d,Math.abs(L(s))}}();function re(t,e){return void 0===e&&(e=D()),e[0]=(t[0]+t[3])/2,e[1]=(t[1]+t[4])/2,e[2]=(t[2]+t[5])/2,e}r.newFloatArray(3);var ne=/*#__PURE__*/function(){function t(){this.testVertex=void 0,this.offset=void 0,this.normal=void 0,this.normal=D(),this.offset=0,this.testVertex=D()}return t.prototype.set=function(t,e,i,r){var n=1/Math.sqrt(t*t+e*e+i*i);this.normal[0]=t*n,this.normal[1]=e*n,this.normal[2]=i*n,this.offset=r*n,this.testVertex[0]=this.normal[0]>=0?1:0,this.testVertex[1]=this.normal[1]>=0?1:0,this.testVertex[2]=this.normal[2]>=0?1:0},t}(),se=function(){this.planes=void 0,this.planes=[new ne,new ne,new ne,new ne,new ne,new ne]},oe=D(),ae=D(),he=D(),ce=D(),le=D(),de=D(),ue=z(),ve=z(),fe=D(),pe=D(),ye=D(),be=D(),we=/*#__PURE__*/l("state"),je=/*#__PURE__*/l("frustum"),ge=/*#__PURE__*/l("activeProjection"),Oe=/*#__PURE__*/function(i){function n(r,n){var s;return void 0===n&&(n={}),(s=i.call(this,r,n)||this).view=void 0,s.perspectiveProjection=void 0,s.orthoProjection=void 0,s.frustumProjection=void 0,s.customProjection=void 0,s.onProjectionType=void 0,s.onViewMatrix=void 0,s.onProjMatrix=void 0,s.onWorldAxis=void 0,s.onFrustum=void 0,Object.defineProperty(h(s),we,{writable:!0,value:void 0}),Object.defineProperty(h(s),je,{writable:!0,value:void 0}),Object.defineProperty(h(s),ge,{writable:!0,value:void 0}),s.onProjectionType=new t.EventEmitter(new e.EventDispatcher),s.onViewMatrix=new t.EventEmitter(new e.EventDispatcher),s.onProjMatrix=new t.EventEmitter(new e.EventDispatcher),s.onWorldAxis=new t.EventEmitter(new e.EventDispatcher),s.onFrustum=new t.EventEmitter(new e.EventDispatcher),s.view=r,d(h(s),we)[we]={eye:D(n.eye||[0,0,10]),look:D(n.look||[0,0,0]),up:D(n.up||[0,1,0]),worldUp:D([0,1,0]),worldRight:D([1,0,0]),worldForward:D([0,0,-1]),worldAxis:new Float32Array(n.worldAxis||[1,0,0,0,1,0,0,0,1]),gimbalLock:!1!==n.gimbalLock,constrainPitch:!0===n.constrainPitch,projectionType:n.projectionType||m,deviceMatrix:n.deviceMatrix?z(n.deviceMatrix):_(),hasDeviceMatrix:!!n.deviceMatrix,viewMatrix:z(),viewNormalMatrix:z(),inverseViewMatrix:z()},d(h(s),je)[je]=new se,s.perspectiveProjection=new Wt(h(s)),s.orthoProjection=new Nt(h(s)),s.customProjection=new Yt(h(s)),d(h(s),ge)[ge]=s.perspectiveProjection,s.perspectiveProjection.onProjMatrix.subscribe(function(){d(h(s),we)[we].projectionType===m&&s.onProjMatrix.dispatch(h(s),s.perspectiveProjection.projMatrix)}),s.orthoProjection.onProjMatrix.subscribe(function(){d(h(s),we)[we].projectionType===k&&s.onProjMatrix.dispatch(h(s),s.orthoProjection.projMatrix)}),s.frustumProjection.onProjMatrix.subscribe(function(){d(h(s),we)[we].projectionType===x&&s.onProjMatrix.dispatch(h(s),s.frustumProjection.projMatrix)}),s.customProjection.onProjMatrix.subscribe(function(){d(h(s),we)[we].projectionType===M&&s.onProjMatrix.dispatch(h(s),s.customProjection.projMatrix)}),s}o(n,i);var a=n.prototype;return a.clean=function(){var t,e=d(this,we)[we];this.projectionType===k?(S(d(this,we)[we].eye,d(this,we)[we].look,fe),U(fe,pe),I(pe,1e3,ye),C(d(this,we)[we].look,ye,be),t=be):t=d(this,we)[we].eye,e.hasDeviceMatrix?(H(t,d(this,we)[we].look,d(this,we)[we].up,ve),N(e.deviceMatrix,ve,e.viewMatrix)):H(t,d(this,we)[we].look,d(this,we)[we].up,e.viewMatrix),q(d(this,we)[we].viewMatrix,d(this,we)[we].inverseViewMatrix),X(d(this,we)[we].inverseViewMatrix,d(this,we)[we].viewNormalMatrix),this.view.redraw(),function(t,e,i){var r=N(e,t,te),n=r[0],s=r[1],o=r[2],a=r[3],h=r[4],c=r[5],l=r[6],d=r[7],u=r[8],v=r[9],f=r[10],p=r[11],y=r[12],b=r[13],w=r[14],j=r[15];(i=i||new se).planes[0].set(a-n,d-h,p-u,j-y),i.planes[1].set(a+n,d+h,p+u,j+y),i.planes[2].set(a-s,d-c,p-v,j-b),i.planes[3].set(a+s,d+c,p+v,j+b),i.planes[4].set(a-o,d-l,p-f,j-w),i.planes[5].set(a+o,d+l,p+f,j+w)}(d(this,we)[we].viewMatrix,d(this,ge)[ge].projMatrix,d(this,je)[je]),this.onViewMatrix.dispatch(this,d(this,we)[we].viewMatrix),this.onFrustum.dispatch(this,d(this,je)[je])},a.orbitYaw=function(t){var e=S(d(this,we)[we].eye,d(this,we)[we].look,oe);W(.0174532925*t,d(this,we)[we].gimbalLock?d(this,we)[we].worldUp:d(this,we)[we].up,ue),e=G(ue,e,ae),this.eye=C(d(this,we)[we].look,e,he),this.up=G(ue,d(this,we)[we].up,ce)},a.orbitPitch=function(t){if(!(d(this,we)[we].constrainPitch&&(t=E(d(this,we)[we].up,d(this,we)[we].worldUp)/r.DEGTORAD)<1)){var e=S(d(this,we)[we].eye,d(this,we)[we].look,oe);W(.0174532925*t,V(U(e,ae),U(d(this,we)[we].up,he)),ue),e=G(ue,e,ce),this.up=G(ue,d(this,we)[we].up,le),this.eye=C(e,d(this,we)[we].look,de)}},a.yaw=function(t){var e=S(d(this,we)[we].look,d(this,we)[we].eye,oe);W(.0174532925*t,d(this,we)[we].gimbalLock?d(this,we)[we].worldUp:d(this,we)[we].up,ue),e=G(ue,e,ae),this.look=C(e,d(this,we)[we].eye,he),d(this,we)[we].gimbalLock&&(this.up=G(ue,d(this,we)[we].up,ce))},a.pitch=function(t){if(!(d(this,we)[we].constrainPitch&&(t=E(d(this,we)[we].up,d(this,we)[we].worldUp)/r.DEGTORAD)<1)){var e=S(d(this,we)[we].look,d(this,we)[we].eye,oe);W(.0174532925*t,V(U(e,ae),U(d(this,we)[we].up,he)),ue),this.up=G(ue,d(this,we)[we].up,de),e=G(ue,e,ce),this.look=C(e,d(this,we)[we].eye,le)}},a.pan=function(t){var e,i=S(d(this,we)[we].eye,d(this,we)[we].look,oe),r=[0,0,0];0!==t[0]&&(e=I(V(U(i,[]),U(d(this,we)[we].up,ae)),t[0]),r[0]+=e[0],r[1]+=e[1],r[2]+=e[2]),0!==t[1]&&(e=I(U(d(this,we)[we].up,he),t[1]),r[0]+=e[0],r[1]+=e[1],r[2]+=e[2]),0!==t[2]&&(e=I(U(i,ce),t[2]),r[0]+=e[0],r[1]+=e[1],r[2]+=e[2]),this.eye=C(d(this,we)[we].eye,r,le),this.look=C(d(this,we)[we].look,r,de)},a.zoom=function(t){var e=S(d(this,we)[we].eye,d(this,we)[we].look,oe),i=Math.abs(L(e)),r=Math.abs(i+t);if(!(r<.5)){var n=U(e,he);this.eye=C(d(this,we)[we].look,I(n,r),ce)}},a.destroy=function(){i.prototype.destroy.call(this),this.onProjectionType.clear(),this.onViewMatrix.clear(),this.onProjMatrix.clear(),this.onWorldAxis.clear()},s(n,[{key:"project",get:function(){return d(this,ge)[ge]}},{key:"eye",get:function(){return d(this,we)[we].eye},set:function(t){d(this,we)[we].eye.set(t),this.setDirty()}},{key:"look",get:function(){return d(this,we)[we].look},set:function(t){d(this,we)[we].look.set(t),this.setDirty()}},{key:"up",get:function(){return d(this,we)[we].up},set:function(t){d(this,we)[we].up.set(t),this.setDirty()}},{key:"worldUp",get:function(){return d(this,we)[we].worldUp}},{key:"worldRight",get:function(){return d(this,we)[we].worldRight}},{key:"worldForward",get:function(){return d(this,we)[we].worldForward}},{key:"constrainPitch",get:function(){return d(this,we)[we].constrainPitch},set:function(t){d(this,we)[we].constrainPitch=t}},{key:"gimbalLock",get:function(){return d(this,we)[we].gimbalLock},set:function(t){d(this,we)[we].gimbalLock=t}},{key:"worldAxis",get:function(){return d(this,we)[we].worldAxis},set:function(t){var e=d(this,we)[we];e.worldAxis.set(t),e.worldRight[0]=e.worldAxis[0],e.worldRight[1]=e.worldAxis[1],e.worldRight[2]=e.worldAxis[2],e.worldUp[0]=e.worldAxis[3],e.worldUp[1]=e.worldAxis[4],e.worldUp[2]=e.worldAxis[5],e.worldForward[0]=e.worldAxis[6],e.worldForward[1]=e.worldAxis[7],e.worldForward[2]=e.worldAxis[8],this.onWorldAxis.dispatch(this,e.worldAxis)}},{key:"deviceMatrix",get:function(){return d(this,we)[we].deviceMatrix},set:function(t){d(this,we)[we].deviceMatrix.set(t||[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),d(this,we)[we].hasDeviceMatrix=!!t,this.setDirty()}},{key:"xUp",get:function(){return d(this,we)[we].worldUp[0]>d(this,we)[we].worldUp[1]&&d(this,we)[we].worldUp[0]>d(this,we)[we].worldUp[2]}},{key:"yUp",get:function(){return d(this,we)[we].worldUp[1]>d(this,we)[we].worldUp[0]&&d(this,we)[we].worldUp[1]>d(this,we)[we].worldUp[2]}},{key:"zUp",get:function(){return d(this,we)[we].worldUp[2]>d(this,we)[we].worldUp[0]&&d(this,we)[we].worldUp[2]>d(this,we)[we].worldUp[1]}},{key:"eyeLookDist",get:function(){return L(S(d(this,we)[we].look,d(this,we)[we].eye,oe))}},{key:"viewMatrix",get:function(){return this.dirty&&this.cleanIfDirty(),d(this,we)[we].viewMatrix}},{key:"inverseViewMatrix",get:function(){return this.dirty&&this.cleanIfDirty(),d(this,we)[we].inverseViewMatrix}},{key:"projMatrix",get:function(){return d(this,ge)[ge].projMatrix}},{key:"frustum",get:function(){return this.dirty&&this.cleanIfDirty(),d(this,je)[je]}},{key:"projectionType",get:function(){return d(this,we)[we].projectionType},set:function(t){t=t||m,d(this,we)[we].projectionType!==t&&(t===m?d(this,ge)[ge]=this.perspectiveProjection:t===k?d(this,ge)[ge]=this.orthoProjection:t===x?d(this,ge)[ge]=this.frustumProjection:t===M?d(this,ge)[ge]=this.customProjection:(this.error("Unsupported value for 'projection': "+t+" defaulting to PerspectiveProjectionType"),d(this,ge)[ge]=this.perspectiveProjection,t=m),d(this,ge)[ge].clean(),d(this,we)[we].projectionType=t,this.clean(),this.onProjectionType.dispatch(this,d(this,we)[we].projectionType),this.onProjMatrix.dispatch(this,d(this,ge)[ge].projMatrix))}}]),n}(t.Component),Pe={viewerId:"",time:0,startTime:0,prevTime:0,deltaTime:0},me=/*#__PURE__*/l("viewersRenderInfo"),ke=/*#__PURE__*/l("viewerIDMap"),xe=/*#__PURE__*/l("taskQueue"),Me=/*#__PURE__*/l("taskBudget"),Ee=/*#__PURE__*/l("lastTime"),De=/*#__PURE__*/l("elapsedTime"),Ae=/*#__PURE__*/l("runTasks"),Ie=/*#__PURE__*/l("runTasksUntil"),Ce=/*#__PURE__*/l("fireTickEvents"),Se=/*#__PURE__*/l("renderViewers");function Ve(t){d(this,Ie)[Ie](t+d(this,Me)[Me]),this.getNumTasks(),d(this,Me)}function Le(t){void 0===t&&(t=-1);for(var e=(new Date).getTime(),i=0;d(this,xe)[xe].length>0&&(t<0||e<t);){var r=d(this,xe)[xe].shift(),n=d(this,xe)[xe].shift();n?r.call(n):r(),e=(new Date).getTime(),i++}return i}function Te(t){for(var e in Pe.time=t,ze.viewers)if(this.viewers.hasOwnProperty(e)){var i=this.viewers[e];Pe.viewerId=e,Pe.startTime=i.startTime,Pe.deltaTime=null!=Pe.prevTime?Pe.time-Pe.prevTime:0,i.onTick.dispatch(i,Pe)}Pe.prevTime=t}function Ue(){for(var t in this.viewers)if(this.viewers.hasOwnProperty(t)){var e=this.viewers[t],i=d(this,me)[me][t];i||(i=d(this,me)[me][t]={}),e.render({})}}var ze=new(/*#__PURE__*/function(){function t(){var t=this;Object.defineProperty(this,Se,{value:Ue}),Object.defineProperty(this,Ce,{value:Te}),Object.defineProperty(this,Ie,{value:Le}),Object.defineProperty(this,Ae,{value:Ve}),this.viewers=void 0,Object.defineProperty(this,me,{writable:!0,value:{}}),Object.defineProperty(this,ke,{writable:!0,value:new b}),Object.defineProperty(this,xe,{writable:!0,value:new w}),Object.defineProperty(this,Me,{writable:!0,value:10}),Object.defineProperty(this,Ee,{writable:!0,value:0}),Object.defineProperty(this,De,{writable:!0,value:0}),this.viewers={},requestAnimationFrame(function e(){var i=Date.now();d(t,Ee)[Ee]>0&&(d(t,De)[De]=i-d(t,Ee)[Ee]),d(t,Ae)[Ae](i),d(t,Ce)[Ce](i),d(t,Se)[Se](),d(t,Ee)[Ee]=i,requestAnimationFrame(e)})}var e=t.prototype;return e.registerViewer=function(t){if(t.id){if(this.viewers[t.id])return void console.error("[ERROR] Viewer "+j(t.id)+" already exists")}else t.id=d(this,ke)[ke].addItem({});this.viewers[t.id]=t,d(this,me)[me][t.id]={}},e.deregisterViewer=function(t){this.viewers[t.id]&&(d(this,ke)[ke].removeItem(t.id),delete this.viewers[t.id],delete d(this,me)[me][t.id])},e.scheduleTask=function(t,e){d(this,xe)[xe].push(t),d(this,xe)[xe].push(e)},e.getNumTasks=function(){return d(this,xe)[xe].length},t}()),Fe=D(),Re=D(),_e=D(),We=D(),He=D(),qe=/*#__PURE__*/l("duration"),Xe=/*#__PURE__*/l("look1"),Be=/*#__PURE__*/l("eye1"),Ne=/*#__PURE__*/l("up1"),Ge=/*#__PURE__*/l("look2"),Ke=/*#__PURE__*/l("eye2"),Qe=/*#__PURE__*/l("up2"),Ye=/*#__PURE__*/l("orthoScale1"),$e=/*#__PURE__*/l("orthoScale2"),Je=/*#__PURE__*/l("fit"),Ze=/*#__PURE__*/l("trail"),ti=/*#__PURE__*/l("flying"),ei=/*#__PURE__*/l("flyEyeLookUp"),ii=/*#__PURE__*/l("flyingEye"),ri=/*#__PURE__*/l("flyingLook"),ni=/*#__PURE__*/l("callback"),si=/*#__PURE__*/l("callbackScope"),oi=/*#__PURE__*/l("time1"),ai=/*#__PURE__*/l("time2"),hi=/*#__PURE__*/l("flyingEyeLookUp"),ci=/*#__PURE__*/l("fitFOV"),li=/*#__PURE__*/l("projection2"),di=/*#__PURE__*/l("projMatrix1"),ui=/*#__PURE__*/l("projMatrix2"),vi=/*#__PURE__*/l("jumpTo"),fi=/*#__PURE__*/l("update"),pi=/*#__PURE__*/l("ease"),yi=/*#__PURE__*/l("easeInCubic"),bi=/*#__PURE__*/l("easeOutExpo"),wi=/*#__PURE__*/function(i){function n(r,n){var s;return s=i.call(this,r,n)||this,Object.defineProperty(h(s),fi,{value:gi}),Object.defineProperty(h(s),vi,{value:ji}),s.view=void 0,s.camera=void 0,Object.defineProperty(h(s),qe,{writable:!0,value:void 0}),Object.defineProperty(h(s),Xe,{writable:!0,value:void 0}),Object.defineProperty(h(s),Be,{writable:!0,value:void 0}),Object.defineProperty(h(s),Ne,{writable:!0,value:void 0}),Object.defineProperty(h(s),Ge,{writable:!0,value:void 0}),Object.defineProperty(h(s),Ke,{writable:!0,value:void 0}),Object.defineProperty(h(s),Qe,{writable:!0,value:void 0}),Object.defineProperty(h(s),Ye,{writable:!0,value:void 0}),Object.defineProperty(h(s),$e,{writable:!0,value:void 0}),Object.defineProperty(h(s),Je,{writable:!0,value:void 0}),Object.defineProperty(h(s),Ze,{writable:!0,value:void 0}),Object.defineProperty(h(s),ti,{writable:!0,value:void 0}),Object.defineProperty(h(s),ei,{writable:!0,value:void 0}),Object.defineProperty(h(s),ii,{writable:!0,value:void 0}),Object.defineProperty(h(s),ri,{writable:!0,value:void 0}),Object.defineProperty(h(s),ni,{writable:!0,value:void 0}),Object.defineProperty(h(s),si,{writable:!0,value:void 0}),Object.defineProperty(h(s),oi,{writable:!0,value:void 0}),Object.defineProperty(h(s),ai,{writable:!0,value:void 0}),s.easing=void 0,Object.defineProperty(h(s),hi,{writable:!0,value:void 0}),Object.defineProperty(h(s),ci,{writable:!0,value:void 0}),Object.defineProperty(h(s),li,{writable:!0,value:void 0}),Object.defineProperty(h(s),di,{writable:!0,value:void 0}),Object.defineProperty(h(s),ui,{writable:!0,value:void 0}),s.onStarted=void 0,s.onStopped=void 0,s.onCancelled=void 0,s.view=r,s.camera=r.camera,d(h(s),Xe)[Xe]=D(),d(h(s),Be)[Be]=D(),d(h(s),Ne)[Ne]=D(),d(h(s),Ge)[Ge]=D(),d(h(s),Ke)[Ke]=D(),d(h(s),Qe)[Qe]=D(),d(h(s),Ye)[Ye]=1,d(h(s),$e)[$e]=1,d(h(s),ti)[ti]=!1,d(h(s),ei)[ei]=!1,d(h(s),ii)[ii]=!1,d(h(s),ri)[ri]=!1,d(h(s),ni)[ni]=null,d(h(s),si)[si]=null,d(h(s),oi)[oi]=null,d(h(s),ai)[ai]=null,s.easing=!0,d(h(s),Ze)[Ze]=!1,d(h(s),Je)[Je]=!0,d(h(s),qe)[qe]=500,s.onStarted=new t.EventEmitter(new e.EventDispatcher),s.onStopped=new t.EventEmitter(new e.EventDispatcher),s.onCancelled=new t.EventEmitter(new e.EventDispatcher),s}o(n,i);var a=n.prototype;return a.flyTo=function(t,e){void 0===t&&(t={}),d(this,ti)[ti]&&this.stop(),d(this,ti)[ti]=!1,d(this,ii)[ii]=!1,d(this,ri)[ri]=!1,d(this,hi)[hi]=!1,d(this,ni)[ni]=e;var i,n,s,o,a=this.camera,h=!!t.projection&&t.projection!==a.projectionType;d(this,Be)[Be][0]=a.eye[0],d(this,Be)[Be][1]=a.eye[1],d(this,Be)[Be][2]=a.eye[2],d(this,Xe)[Xe][0]=a.look[0],d(this,Xe)[Xe][1]=a.look[1],d(this,Xe)[Xe][2]=a.look[2],d(this,Ne)[Ne][0]=a.up[0],d(this,Ne)[Ne][1]=a.up[1],d(this,Ne)[Ne][2]=a.up[2],d(this,Ye)[Ye]=a.orthoProjection.scale,d(this,$e)[$e]=t.orthoScale||d(this,Ye)[Ye],t.aabb?i=t.aabb:t.eye&&t.look||t.up?(n=t.eye,s=t.look,o=t.up):t.eye?n=t.eye:t.look?s=t.look:h||(i=this.view.aabb);var c=t.poi;if(i){if(i[3]<i[0]||i[4]<i[1]||i[5]<i[2])return;if(i[3]===i[0]&&i[4]===i[1]&&i[5]===i[2])return;var l=re(i=i.slice());d(this,Ge)[Ge]=c||l;var u=U(S(d(this,Be)[Be],d(this,Xe)[Xe],Fe)),v=c?ie(i,c):ee(i),f=t.fitFOV||d(this,ci)[ci],p=Math.abs(v/Math.tan(f*r.DEGTORAD));d(this,$e)[$e]=1.1*v,d(this,Ke)[Ke][0]=d(this,Ge)[Ge][0]+u[0]*p,d(this,Ke)[Ke][1]=d(this,Ge)[Ge][1]+u[1]*p,d(this,Ke)[Ke][2]=d(this,Ge)[Ge][2]+u[2]*p,d(this,Qe)[Qe][0]=d(this,Ne)[Ne][0],d(this,Qe)[Qe][1]=d(this,Ne)[Ne][1],d(this,Qe)[Qe][2]=d(this,Ne)[Ne][2],d(this,hi)[hi]=!0}else(n||s||o)&&(d(this,hi)[hi]=!!n&&!!s&&!!o,d(this,ii)[ii]=!!n&&!s,d(this,ri)[ri]=!!s&&!n,n&&(d(this,Ke)[Ke][0]=n[0],d(this,Ke)[Ke][1]=n[1],d(this,Ke)[Ke][2]=n[2]),s&&(d(this,Ge)[Ge][0]=s[0],d(this,Ge)[Ge][1]=s[1],d(this,Ge)[Ge][2]=s[2]),o&&(d(this,Qe)[Qe][0]=o[0],d(this,Qe)[Qe][1]=o[1],d(this,Qe)[Qe][2]=o[2]));h?(t.projection===k&&a.projectionType!==k&&(d(this,li)[li]=k,d(this,di)[di]=a.projMatrix.slice(),d(this,ui)[ui]=a.orthoProjection.projMatrix.slice(),a.projectionType=M),t.projection===m&&a.projectionType!==m&&(d(this,li)[li]=m,d(this,di)[di]=a.projMatrix.slice(),d(this,ui)[ui]=a.perspectiveProjection.projMatrix.slice(),a.projectionType=M)):d(this,li)[li]=null,this.onStarted.dispatch(this,null),d(this,oi)[oi]=Date.now(),d(this,ai)[ai]=d(this,oi)[oi]+(t.duration?1e3*t.duration:d(this,qe)[qe]),d(this,ti)[ti]=!0,ze.scheduleTask(d(this,fi)[fi],this)},a.jumpTo=function(t){d(this,vi)[vi](t)},a.stop=function(){if(d(this,ti)[ti]){d(this,ti)[ti]=!1,d(this,oi)[oi]=null,d(this,ai)[ai]=null,d(this,li)[li]&&(this.camera.projectionType=d(this,li)[li]);var t=d(this,ni)[ni];t&&(d(this,ni)[ni]=null,t()),this.onStopped.dispatch(this,null)}},a.cancel=function(){d(this,ti)[ti]&&(d(this,ti)[ti]=!1,d(this,oi)[oi]=null,d(this,ai)[ai]=null,d(this,ni)[ni]&&(d(this,ni)[ni]=null),this.onCancelled.dispatch(this,null))},a.destroy=function(){this.stop(),i.prototype.destroy.call(this),this.onStarted.clear(),this.onStopped.clear(),this.onCancelled.clear()},s(n,[{key:"duration",get:function(){return d(this,qe)[qe]/1e3},set:function(t){d(this,qe)[qe]=t?1e3*t:500,this.stop()}},{key:"fit",get:function(){return d(this,Je)[Je]},set:function(t){d(this,Je)[Je]=t}},{key:"fitFOV",get:function(){return d(this,ci)[ci]},set:function(t){d(this,ci)[ci]=t}},{key:"trail",get:function(){return d(this,Ze)[Ze]},set:function(t){d(this,Ze)[Ze]=t}}]),n}(t.Component);function ji(t){d(this,ti)[ti]&&this.stop();var e,i,n,s,o=this.camera;t.aabb?e=t.aabb:t.eye||t.look||t.up?(i=t.eye,n=t.look,s=t.up):e=this.view.aabb;var a=t.poi;if(e){if(e[3]<=e[0]||e[4]<=e[1]||e[5]<=e[2])return;var h,c=a?ie(e,a):ee(e);n=a||re(e,n),d(this,Ze)[Ze]?S(o.look,n,He):S(o.eye,o.look,He),U(He),h=(void 0!==t.fit?t.fit:d(this,Je)[Je])?Math.abs(c/Math.tan((t.fitFOV||d(this,ci)[ci])*r.DEGTORAD)):L(S(o.eye,o.look,Fe)),I(He,h),o.eye=C(n,He,Fe),o.look=n,this.camera.orthoProjection.scale=1.1*c}else(i||n||s)&&(i&&(o.eye=i),n&&(o.look=n),s&&(o.up=s));t.projection&&(o.projectionType=t.projection)}function gi(){if(d(this,ti)[ti]){var t=(Date.now()-d(this,oi)[oi])/(d(this,ai)[ai]-d(this,oi)[oi]),e=t>=1;t>1&&(t=1);var i=this.easing?d(wi,pi)[pi](t,0,1,1):t,r=this.camera;if(d(this,ii)[ii]||d(this,ri)[ri]?d(this,ii)[ii]?(S(r.eye,r.look,He),r.eye=T(i,0,1,d(this,Be)[Be],d(this,Ke)[Ke],_e),r.look=S(_e,He,Re)):d(this,ri)[ri]&&(r.look=T(i,0,1,d(this,Xe)[Xe],d(this,Ge)[Ge],Re),r.up=T(i,0,1,d(this,Ne)[Ne],d(this,Qe)[Qe],We)):d(this,hi)[hi]&&(r.eye=T(i,0,1,d(this,Be)[Be],d(this,Ke)[Ke],_e),r.look=T(i,0,1,d(this,Xe)[Xe],d(this,Ge)[Ge],Re),r.up=T(i,0,1,d(this,Ne)[Ne],d(this,Qe)[Qe],We)),d(this,li)[li]){var n=d(this,li)[li]===k?d(wi,bi)[bi](t,0,1,1):d(wi,yi)[yi](t,0,1,1);r.customProjection.projMatrix=function(t,e,i,r,n,s){var o=z(),a=(t-0)/1;return o[0]=r[0]+a*(n[0]-r[0]),o[1]=r[1]+a*(n[1]-r[1]),o[2]=r[2]+a*(n[2]-r[2]),o[3]=r[3]+a*(n[3]-r[3]),o[4]=r[4]+a*(n[4]-r[4]),o[5]=r[5]+a*(n[5]-r[5]),o[6]=r[6]+a*(n[6]-r[6]),o[7]=r[7]+a*(n[7]-r[7]),o[8]=r[8]+a*(n[8]-r[8]),o[9]=r[9]+a*(n[9]-r[9]),o[10]=r[10]+a*(n[10]-r[10]),o[11]=r[11]+a*(n[11]-r[11]),o[12]=r[12]+a*(n[12]-r[12]),o[13]=r[13]+a*(n[13]-r[13]),o[14]=r[14]+a*(n[14]-r[14]),o[15]=r[15]+a*(n[15]-r[15]),o}(n,0,0,d(this,di)[di],d(this,ui)[ui])}else r.orthoProjection.scale=d(this,Ye)[Ye]+t*(d(this,$e)[$e]-d(this,Ye)[Ye]);if(e)return r.orthoProjection.scale=d(this,$e)[$e],void this.stop();ze.scheduleTask(d(this,fi)[fi],this)}}Object.defineProperty(wi,bi,{value:function(t,e,i,r){return i*(1-Math.pow(2,-10*t/r))+e}}),Object.defineProperty(wi,yi,{value:function(t,e,i,r){return i*(t/=r)*t*t+e}}),Object.defineProperty(wi,pi,{value:function(t,e,i,r){return-i*(t/=r)*(t-2)+e}});var Oi=/*#__PURE__*/l("onTick"),Pi=/*#__PURE__*/l("backgroundColor"),mi=/*#__PURE__*/l("backgroundColorFromAmbientLight"),ki=/*#__PURE__*/l("resolutionScale"),xi=/*#__PURE__*/l("numObjects"),Mi=/*#__PURE__*/l("objectIds"),Ei=/*#__PURE__*/l("numVisibleObjects"),Di=/*#__PURE__*/l("visibleObjectIds"),Ai=/*#__PURE__*/l("numXRayedObjects"),Ii=/*#__PURE__*/l("xrayedObjectIds"),Ci=/*#__PURE__*/l("numHighlightedObjects"),Si=/*#__PURE__*/l("highlightedObjectIds"),Vi=/*#__PURE__*/l("numSelectedObjects"),Li=/*#__PURE__*/l("selectedObjectIds"),Ti=/*#__PURE__*/l("numColorizedObjects"),Ui=/*#__PURE__*/l("colorizedObjectIds"),zi=/*#__PURE__*/l("numOpacityObjects"),Fi=/*#__PURE__*/l("opacityObjectIds"),Ri=/*#__PURE__*/l("qualityRender"),_i=/*#__PURE__*/l("lightsHash"),Wi=/*#__PURE__*/l("sectionPlanesHash"),Hi=/*#__PURE__*/l("registerSectionPlane"),qi=/*#__PURE__*/l("deregisterSectionPlane"),Xi=/*#__PURE__*/l("initObjects"),Bi=/*#__PURE__*/l("createObjects"),Ni=/*#__PURE__*/l("destroyObjects"),Gi=/*#__PURE__*/function(i){function r(r){var n;if(n=i.call(this,null,r)||this,Object.defineProperty(h(n),Ni,{value:Ji}),Object.defineProperty(h(n),Bi,{value:$i}),Object.defineProperty(h(n),Xi,{value:Yi}),Object.defineProperty(h(n),qi,{value:Qi}),Object.defineProperty(h(n),Hi,{value:Ki}),n.viewIndex=void 0,n.camera=void 0,n.canvasElement=void 0,n.transparent=void 0,n.boundary=void 0,n.logarithmicDepthBufferEnabled=void 0,n.sao=void 0,n.cameraFlight=void 0,n.metrics=void 0,n.xrayMaterial=void 0,n.highlightMaterial=void 0,n.selectedMaterial=void 0,n.edgeMaterial=void 0,n.pointsMaterial=void 0,n.linesMaterial=void 0,n.objects=void 0,n.visibleObjects=void 0,n.xrayedObjects=void 0,n.highlightedObjects=void 0,n.selectedObjects=void 0,n.colorizedObjects=void 0,n.opacityObjects=void 0,n.sectionPlanes=void 0,n.sectionPlanesList=[],n.lights=void 0,n.lightsList=[],n.gammaOutput=void 0,n.layers=void 0,n.autoLayers=void 0,n.onBoundary=void 0,n.onObjectVisibility=void 0,n.onObjectXRayed=void 0,n.onLayerCreated=void 0,n.onLayerDestroyed=void 0,n.onSectionPlaneCreated=void 0,n.onSectionPlaneDestroyed=void 0,Object.defineProperty(h(n),Oi,{writable:!0,value:void 0}),Object.defineProperty(h(n),Pi,{writable:!0,value:void 0}),Object.defineProperty(h(n),mi,{writable:!0,value:void 0}),Object.defineProperty(h(n),ki,{writable:!0,value:void 0}),Object.defineProperty(h(n),xi,{writable:!0,value:void 0}),Object.defineProperty(h(n),Mi,{writable:!0,value:void 0}),Object.defineProperty(h(n),Ei,{writable:!0,value:void 0}),Object.defineProperty(h(n),Di,{writable:!0,value:void 0}),Object.defineProperty(h(n),Ai,{writable:!0,value:void 0}),Object.defineProperty(h(n),Ii,{writable:!0,value:void 0}),Object.defineProperty(h(n),Ci,{writable:!0,value:void 0}),Object.defineProperty(h(n),Si,{writable:!0,value:void 0}),Object.defineProperty(h(n),Vi,{writable:!0,value:void 0}),Object.defineProperty(h(n),Li,{writable:!0,value:void 0}),Object.defineProperty(h(n),Ti,{writable:!0,value:void 0}),Object.defineProperty(h(n),Ui,{writable:!0,value:void 0}),Object.defineProperty(h(n),zi,{writable:!0,value:void 0}),Object.defineProperty(h(n),Fi,{writable:!0,value:void 0}),Object.defineProperty(h(n),Ri,{writable:!0,value:void 0}),Object.defineProperty(h(n),_i,{writable:!0,value:null}),Object.defineProperty(h(n),Wi,{writable:!0,value:null}),n.viewer=r.viewer,!((r.canvasElement||document.getElementById(r.canvasId))instanceof HTMLCanvasElement))throw"Mandatory View config expected: valid canvasId or canvasElement";n.viewIndex=0,n.objects={},n.visibleObjects={},n.xrayedObjects={},n.highlightedObjects={},n.selectedObjects={},n.colorizedObjects={},n.opacityObjects={},n.sectionPlanes={},n.sectionPlanesList=[],n.lights={},n.lightsList=[],n.layers={},d(h(n),xi)[xi]=0,d(h(n),Mi)[Mi]=null,d(h(n),Ei)[Ei]=0,d(h(n),Di)[Di]=null,d(h(n),Ai)[Ai]=0,d(h(n),Ii)[Ii]=null,d(h(n),Ci)[Ci]=0,d(h(n),Si)[Si]=null,d(h(n),Vi)[Vi]=0,d(h(n),Li)[Li]=null,d(h(n),Ti)[Ti]=0,d(h(n),Ui)[Ui]=null,d(h(n),zi)[zi]=0,d(h(n),Fi)[Fi]=null,d(h(n),Ri)[Ri]=!!r.qualityRender,n.gammaOutput=!0,d(h(n),Wi)[Wi]=null,d(h(n),_i)[_i]=null,n.onBoundary=new t.EventEmitter(new e.EventDispatcher),d(h(n),ki)[ki]=1,d(h(n),Pi)[Pi]=D([r.backgroundColor?r.backgroundColor[0]:1,r.backgroundColor?r.backgroundColor[1]:1,r.backgroundColor?r.backgroundColor[2]:1]),d(h(n),mi)[mi]=!!r.backgroundColorFromAmbientLight,n.canvasElement=r.canvasElement,n.transparent=!!r.transparent,n.canvasElement.width=n.canvasElement.clientWidth,n.canvasElement.height=n.canvasElement.clientHeight,n.boundary=[n.canvasElement.offsetLeft,n.canvasElement.offsetTop,n.canvasElement.clientWidth,n.canvasElement.clientHeight];var s=0,o=0,a=0,c=0,l=0,u=0,v=null,f=null;return d(h(n),Oi)[Oi]=n.viewer.onTick.subscribe(function(){var t=n.canvasElement,e=d(h(n),ki)[ki]!==f,i=window.innerWidth!==s||window.innerHeight!==o,r=t.clientWidth!==a||t.clientHeight!==c,p=t.offsetLeft!==l||t.offsetTop!==u,y=t.parentElement;if(e||i||r||p||y!==v){if(e||r||p){var b=t.clientWidth,w=t.clientHeight;(e||r)&&(t.width=Math.round(t.clientWidth*d(h(n),ki)[ki]),t.height=Math.round(t.clientHeight*d(h(n),ki)[ki]));var j=n.boundary;j[0]=t.offsetLeft,j[1]=t.offsetTop,j[2]=b,j[3]=w,e&&!r||n.onBoundary.dispatch(h(n),j),a=b,c=w}e&&(f=d(h(n),ki)[ki]),i&&(s=window.innerWidth,o=window.innerHeight),p&&(l=t.offsetLeft,u=t.offsetTop),v=y}}),n.camera=new Oe(h(n)),n.sao=new ot(h(n),{}),n.cameraFlight=new wi(h(n),{duration:.5}),n.metrics=new nt(h(n),{units:r.units,scale:r.scale,origin:r.origin}),n.xrayMaterial=new St(h(n),{fill:!0,fillColor:[.9,.7,.6],fillAlpha:.4,edges:!0,edgeColor:[.5,.4,.4],edgeAlpha:1,edgeWidth:1}),n.highlightMaterial=new St(h(n),{fill:!0,fillColor:[1,1,0],fillAlpha:.5,edges:!0,edgeColor:[.5,.4,.4],edgeAlpha:1,edgeWidth:1}),n.selectedMaterial=new St(h(n),{fill:!0,fillColor:[0,1,0],fillAlpha:.5,edges:!0,edgeColor:[.4,.5,.4],edgeAlpha:1,edgeWidth:1}),n.edgeMaterial=new Lt(h(n),{edgeColor:[0,0,0],edgeAlpha:1,edgeWidth:1,edges:!0,renderModes:[O]}),n.pointsMaterial=new Ut(h(n),{pointSize:1,roundPoints:!0,perspectivePoints:!0,minPerspectivePointSize:1,maxPerspectivePointSize:6,filterIntensity:!1,minIntensity:0,maxIntensity:1}),n.linesMaterial=new ht(h(n),{lineWidth:1}),n.lights={},d(h(n),Ri)[Ri]=!!r.qualityRender,n.autoLayers=!1!==r.autoLayers,n.logarithmicDepthBufferEnabled=!!r.logarithmicDepthBufferEnabled,n.onObjectVisibility=new t.EventEmitter(new e.EventDispatcher),n.onObjectXRayed=new t.EventEmitter(new e.EventDispatcher),n.onLayerCreated=new t.EventEmitter(new e.EventDispatcher),n.onLayerDestroyed=new t.EventEmitter(new e.EventDispatcher),n.onSectionPlaneCreated=new t.EventEmitter(new e.EventDispatcher),n.onSectionPlaneDestroyed=new t.EventEmitter(new e.EventDispatcher),d(h(n),Xi)[Xi](),n}o(r,i);var n=r.prototype;return n.registerViewObject=function(t){this.objects[t.id]=t,d(this,xi)[xi]++,d(this,Mi)[Mi]=null},n.deregisterViewObject=function(t){delete this.objects[t.id],delete this.visibleObjects[t.id],delete this.xrayedObjects[t.id],delete this.highlightedObjects[t.id],delete this.selectedObjects[t.id],delete this.colorizedObjects[t.id],delete this.opacityObjects[t.id],d(this,xi)[xi]--,d(this,Mi)[Mi]=null},n.objectVisibilityUpdated=function(t,e,i){void 0===i&&(i=!0),e?(this.visibleObjects[t.id]=t,d(this,Ei)[Ei]++):(delete this.visibleObjects[t.id],d(this,Ei)[Ei]--),d(this,Di)[Di]=null,i&&this.onObjectVisibility.dispatch(this,t)},n.objectXRayedUpdated=function(t,e,i){void 0===i&&(i=!0),e?(this.xrayedObjects[t.id]=t,d(this,Ai)[Ai]++):(delete this.xrayedObjects[t.id],d(this,Ai)[Ai]--),d(this,Ii)[Ii]=null,i&&this.onObjectXRayed.dispatch(this,t)},n.objectHighlightedUpdated=function(t,e){e?(this.highlightedObjects[t.id]=t,d(this,Ci)[Ci]++):(delete this.highlightedObjects[t.id],d(this,Ci)[Ci]--),d(this,Si)[Si]=null},n.objectSelectedUpdated=function(t,e){e?(this.selectedObjects[t.id]=t,d(this,Vi)[Vi]++):(delete this.selectedObjects[t.id],d(this,Vi)[Vi]--),d(this,Li)[Li]=null},n.objectColorizeUpdated=function(t,e){e?(this.colorizedObjects[t.id]=t,d(this,Ti)[Ti]++):(delete this.colorizedObjects[t.id],d(this,Ti)[Ti]--),d(this,Ui)[Ui]=null},n.objectOpacityUpdated=function(t,e){e?(this.opacityObjects[t.id]=t,d(this,zi)[zi]++):(delete this.opacityObjects[t.id],d(this,zi)[zi]--),d(this,Fi)[Fi]=null},n.createSectionPlane=function(t){var e=this,i=t.id||g();this.sectionPlanes[i]&&(this.error('SectionPlane with ID "'+i+'" already exists - will randomly-generate ID'),i=g());var r=new Z(this,t);return d(this,Hi)[Hi](r),r.onDestroyed.one(function(){d(e,qi)[qi](r)}),r},n.clearSectionPlanes=function(){for(var t=Object.keys(this.sectionPlanes),e=0,i=t.length;e<i;e++)this.sectionPlanes[t[e]].destroy();this.sectionPlanesList.length=0,d(this,Wi)[Wi]=null},n.getSectionPlanesHash=function(){if(d(this,Wi)[Wi])return d(this,Wi)[Wi];if(0===this.sectionPlanesList.length)return d(this,Wi)[Wi]=";";for(var t=[],e=0,i=this.sectionPlanesList.length;e<i;e++)t.push("cp");return t.push(";"),d(this,Wi)[Wi]=t.join(""),d(this,Wi)[Wi]},n.registerLight=function(t){this.lightsList.push(t),this.lights[t.id]=t,d(this,_i)[_i]=null,this.rebuild()},n.deregisterLight=function(t){for(var e=0,i=this.lightsList.length;e<i;e++)if(this.lightsList[e].id===t.id)return this.lightsList.splice(e,1),d(this,_i)[_i]=null,delete this.lights[t.id],void this.rebuild()},n.clearLights=function(){for(var t=Object.keys(this.lights),e=0,i=t.length;e<i;e++)this.lights[t[e]].destroy()},n.getLightsHash=function(){if(d(this,_i)[_i])return d(this,_i)[_i];if(0===this.lightsList.length)return d(this,_i)[_i]=";";for(var t=[],e=this.lightsList,i=0,r=e.length;i<r;i++){var n=e[i];t.push("/"),t.push(n.type),t.push("world"===n.space?"w":"v"),n.castsShadow&&t.push("sh")}return t.push(";"),d(this,_i)[_i]=t.join(""),d(this,_i)[_i]},n.rebuild=function(){this.viewer.renderer.needsRebuild(this.viewIndex)},n.redraw=function(){this.viewer.renderer.setImageDirty(this.viewIndex)},n.destroy=function(){this.viewer.onTick.unsubscribe(d(this,Oi)[Oi]),i.prototype.destroy.call(this),this.onObjectVisibility.clear(),this.onObjectXRayed.clear(),this.onLayerCreated.clear(),this.onLayerDestroyed.clear(),this.onSectionPlaneCreated.clear(),this.onSectionPlaneDestroyed.clear()},n.getAmbientColorAndIntensity=function(){return[0,0,0,1]},n.setObjectsVisible=function(t,e){return this.withObjects(t,function(t){var i=t.visible!==e;return t.visible=e,i})},n.setObjectsCollidable=function(t,e){return this.withObjects(t,function(t){var i=t.collidable!==e;return t.collidable=e,i})},n.setObjectsCulled=function(t,e){return this.withObjects(t,function(t){var i=t.culled!==e;return t.culled=e,i})},n.setObjectsSelected=function(t,e){return this.withObjects(t,function(t){var i=t.selected!==e;return t.selected=e,i})},n.setObjectsHighlighted=function(t,e){return this.withObjects(t,function(t){var i=t.highlighted!==e;return t.highlighted=e,i})},n.setObjectsXRayed=function(t,e){return this.withObjects(t,function(t){var i=t.xrayed!==e;return i&&(t.xrayed=e),i})},n.setObjectsColorized=function(t,e){return this.withObjects(t,function(t){t.colorize=e})},n.setObjectsOpacity=function(t,e){return this.withObjects(t,function(t){var i=t.opacity!==e;return i&&(t.opacity=e),i})},n.setObjectsPickable=function(t,e){return this.withObjects(t,function(t){var i=t.pickable!==e;return i&&(t.pickable=e),i})},n.setObjectsClippable=function(t,e){return this.withObjects(t,function(t){var i=t.clippable!==e;return i&&(t.clippable=e),i})},n.withObjects=function(t,e){for(var i=!1,r=0,n=t.length;r<n;r++){var s=this.objects[t[r]];s&&(i=e(s)||i)}return i},n.createLayer=function(t){var e=this,i=this.layers[t.id];return i||(i=new Et({id:t.id,view:this,viewer:this.viewer}),this.layers[t.id]=i,this.onLayerCreated.dispatch(this,i),i.onDestroyed.one(function(){delete e.layers[i.id],e.onLayerDestroyed.dispatch(e,i)})),i.autoDestroy=!1,i},s(r,[{key:"aabb",get:function(){return this.viewer.scene.aabb}},{key:"backgroundColor",get:function(){return d(this,Pi)[Pi]},set:function(t){t?(d(this,Pi)[Pi][0]=t[0],d(this,Pi)[Pi][1]=t[1],d(this,Pi)[Pi][2]=t[2]):(d(this,Pi)[Pi][0]=1,d(this,Pi)[Pi][1]=1,d(this,Pi)[Pi][2]=1),this.redraw()}},{key:"backgroundColorFromAmbientLight",get:function(){return d(this,mi)[mi]},set:function(t){d(this,mi)[mi]=!1!==t}},{key:"resolutionScale",get:function(){return d(this,ki)[ki]},set:function(t){if((t=t||1)!==d(this,ki)[ki]){d(this,ki)[ki]=t;var e=this.canvasElement;e.width=Math.round(e.clientWidth*d(this,ki)[ki]),e.height=Math.round(e.clientHeight*d(this,ki)[ki]),this.redraw()}}},{key:"gammaFactor",get:function(){return 1}},{key:"qualityRender",get:function(){return d(this,Ri)[Ri]},set:function(t){d(this,Ri)[Ri]!==t&&(d(this,Ri)[Ri]=t,this.redraw())}},{key:"numObjects",get:function(){return d(this,xi)[xi]}},{key:"objectIds",get:function(){return d(this,Mi)[Mi]||(d(this,Mi)[Mi]=Object.keys(this.objects)),d(this,Mi)[Mi]}},{key:"numVisibleObjects",get:function(){return d(this,Ei)[Ei]}},{key:"visibleObjectIds",get:function(){return d(this,Di)[Di]||(d(this,Di)[Di]=Object.keys(this.visibleObjects)),d(this,Di)[Di]}},{key:"numXRayedObjects",get:function(){return d(this,Ai)[Ai]}},{key:"xrayedObjectIds",get:function(){return d(this,Ii)[Ii]||(d(this,Ii)[Ii]=Object.keys(this.xrayedObjects)),d(this,Ii)[Ii]}},{key:"numHighlightedObjects",get:function(){return d(this,Ci)[Ci]}},{key:"highlightedObjectIds",get:function(){return d(this,Si)[Si]||(d(this,Si)[Si]=Object.keys(this.highlightedObjects)),d(this,Si)[Si]}},{key:"numSelectedObjects",get:function(){return d(this,Vi)[Vi]}},{key:"selectedObjectIds",get:function(){return d(this,Li)[Li]||(d(this,Li)[Li]=Object.keys(this.selectedObjects)),d(this,Li)[Li]}},{key:"numColorizedObjects",get:function(){return d(this,Ti)[Ti]}},{key:"colorizedObjectIds",get:function(){return d(this,Ui)[Ui]||(d(this,Ui)[Ui]=Object.keys(this.colorizedObjects)),d(this,Ui)[Ui]}},{key:"opacityObjectIds",get:function(){return d(this,Fi)[Fi]||(d(this,Fi)[Fi]=Object.keys(this.opacityObjects)),d(this,Fi)[Fi]}},{key:"numOpacityObjects",get:function(){return d(this,zi)[zi]}}]),r}(t.Component);function Ki(t){this.sectionPlanesList.push(t),this.sectionPlanes[t.id]=t,d(this,Wi)[Wi]=null,this.rebuild(),this.onSectionPlaneCreated.dispatch(this,t)}function Qi(t){for(var e=0,i=this.sectionPlanesList.length;e<i;e++)if(this.sectionPlanesList[e].id===t.id)return this.sectionPlanesList.splice(e,1),d(this,Wi)[Wi]=null,delete this.sectionPlanes[t.id],this.rebuild(),void this.onSectionPlaneDestroyed.dispatch(this,t)}function Yi(){var t=this;for(var e in this.viewer.scene.models)d(this,Bi)[Bi](this.viewer.scene.models[e]);this.viewer.scene.onModelCreated.subscribe(function(e,i){d(t,Bi)[Bi](i)}),this.viewer.scene.onModelDestroyed.subscribe(function(e,i){d(t,Ni)[Ni](i)})}function $i(t){var e=this,i=t.objects,r=this.viewer.renderer.rendererViewObjects,n=function(){var t=i[s],n=r[s],o="default",a=e.layers[o];if(!a){if(!e.autoLayers)return"continue";a=new Et({id:o,view:e,viewer:e.viewer}),e.layers[o]=a,a.onDestroyed.one(function(){delete e.layers[a.id],e.onLayerDestroyed.dispatch(e,a)}),e.onLayerCreated.dispatch(e,a)}var h=new $(a,t,n);a.registerViewObject(h),e.registerViewObject(h)};for(var s in i)n()}function Ji(t){var e=t.objects;for(var i in e){var r=this.layers.default,n=this.objects[e[i].id];this.deregisterViewObject(n),r&&(r.deregisterViewObject(n),r.autoDestroy&&0===r.numObjects&&r.destroy())}}var Zi=/*#__PURE__*/l("prefixMessageWithID"),tr=/*#__PURE__*/l("registerView"),er=/*#__PURE__*/l("deregisterView"),ir=/*#__PURE__*/function(r){function n(n){var s;return s=r.call(this,null,{})||this,Object.defineProperty(h(s),er,{value:sr}),Object.defineProperty(h(s),tr,{value:nr}),Object.defineProperty(h(s),Zi,{value:rr}),s.capabilities=void 0,s.onTick=void 0,s.onViewCreated=void 0,s.onViewDestroyed=void 0,s.scene=void 0,s.views=void 0,s.viewList=void 0,s.numViews=void 0,s.startTime=(new Date).getTime(),s.renderer=void 0,s.onTick=new t.EventEmitter(new e.EventDispatcher),s.onViewCreated=new t.EventEmitter(new e.EventDispatcher),s.onViewDestroyed=new t.EventEmitter(new e.EventDispatcher),s.id=n.id||g(),s.viewList=[],s.numViews=0,s.views={},s.destroyed=!1,s.capabilities={maxViews:0,astcSupported:!1,etc1Supported:!1,etc2Supported:!1,dxtSupported:!1,bptcSupported:!1,pvrtcSupported:!1},s.scene=n.scene||new i.Scene,s.renderer=n.renderer,s.renderer.getCapabilities(s.capabilities),s.renderer.init(h(s)),ze.registerViewer(h(s)),s}o(n,r);var s=n.prototype;return s.createView=function(e){var i=this;if(this.viewList.length>=this.capabilities.maxViews)return new t.SDKError("Attempted to create too many Views with View.createView() - maximum of "+this.capabilities.maxViews+" is allowed");var r=e.id||g();if(this.views[r])return new t.SDKError('View with ID "'+r+'" already exists');if(!((e.canvasElement||document.getElementById(e.canvasId))instanceof HTMLCanvasElement))return new t.SDKError("Mandatory View config expected: valid canvasId or canvasElement");var n=new Gi(function(t,e){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);return e}({viewId:r,viewer:this},e));return d(this,tr)[tr](n),n.viewIndex=this.renderer.registerView(n),n.onDestroyed.one(function(){d(i,er)[er](n),i.renderer.deregisterView(n.viewIndex),i.onViewDestroyed.dispatch(i,n)}),this.onViewCreated.dispatch(this,n),this.log("View created: "+n.viewId),n},s.redraw=function(){for(var t in this.views)this.views[t].redraw()},s.log=function(t){t="[LOG] "+d(this,Zi)[Zi](t),window.console.log(t)},s.warn=function(t){t="[WARN] "+d(this,Zi)[Zi](t),window.console.warn(t)},s.error=function(t){t="[ERROR] "+d(this,Zi)[Zi](t),window.console.error(t)},s.destroy=function(){if(!this.destroyed){for(var t in ze.deregisterViewer(this),this.views)this.views[t].destroy();this.onTick.clear(),this.onViewCreated.clear(),this.onViewDestroyed.clear()}},s.render=function(t){for(var e=0;e<this.viewList.length;e++)this.renderer.render(e,{force:!0})},n}(t.Component);function rr(t){return" ["+this.constructor.name+' "'+j(this.id)+'"]: '+t}function nr(t){if(!this.views[t.id]){this.views[t.id]=t;for(var e=0;;e++)if(!this.viewList[e])return this.viewList[e]=t,this.numViews++,void(t.viewIndex=e)}}function sr(t){this.views[t.id]&&(delete this.views[t.id],delete this.viewList[t.viewIndex],this.numViews--)}var or=/*#__PURE__*/l("state"),ar=/*#__PURE__*/l("inverseMatrixDirty"),hr=/*#__PURE__*/l("transposedProjMatrixDirty"),cr=/*#__PURE__*/function(i){function r(r,n){var s;return void 0===n&&(n={}),(s=i.call(this,r,n)||this).camera=void 0,s.onProjMatrix=void 0,Object.defineProperty(h(s),or,{writable:!0,value:void 0}),Object.defineProperty(h(s),ar,{writable:!0,value:void 0}),Object.defineProperty(h(s),hr,{writable:!0,value:void 0}),s.camera=r,d(h(s),or)[or]={projMatrix:z(),inverseProjMatrix:z(),transposedProjMatrix:z(),near:.1,far:1e4,left:null!=n.left?n.left:-1,right:null!=n.right?n.right:1,bottom:null!=n.bottom?n.bottom:-1,top:null!=n.top?n.top:1},s.onProjMatrix=new t.EventEmitter(new e.EventDispatcher),d(h(s),ar)[ar]=!0,d(h(s),hr)[hr]=!0,s}o(r,i);var n=r.prototype;return n.clean=function(){!function(t,e,i,r,n,s,o){o||(o=z());var a=e-t,h=r-i,c=s-n;o[0]=2*n/a,o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[5]=2*n/h,o[6]=0,o[7]=0,o[8]=(e+t)/a,o[9]=(r+i)/h,o[10]=-(s+n)/c,o[11]=-1,o[12]=0,o[13]=0,o[14]=-s*n*2/c,o[15]=0}(d(this,or)[or].left,d(this,or)[or].right,d(this,or)[or].bottom,d(this,or)[or].top,d(this,or)[or].near,d(this,or)[or].far,d(this,or)[or].projMatrix),d(this,ar)[ar]=!0,d(this,hr)[hr]=!0,this.camera.view.redraw(),this.onProjMatrix.dispatch(this,d(this,or)[or].projMatrix)},n.unproject=function(t,e,i,r,n){var s=this.camera.view.canvasElement,o=s.offsetWidth/2,a=s.offsetHeight/2;return i[0]=(t[0]-o)/o,i[1]=(t[1]-a)/a,i[2]=e,i[3]=1,B(this.inverseProjMatrix,i,r),I(r,1/r[3]),r[3]=1,r[1]*=-1,B(this.camera.inverseViewMatrix,r,n),n},n.destroy=function(){i.prototype.destroy.call(this),this.onProjMatrix.clear()},s(r,[{key:"left",get:function(){return d(this,or)[or].left},set:function(t){d(this,or)[or].left=t,this.setDirty()}},{key:"right",get:function(){return d(this,or)[or].right},set:function(t){d(this,or)[or].right=t,this.setDirty()}},{key:"top",get:function(){return d(this,or)[or].top},set:function(t){d(this,or)[or].top=t,this.setDirty()}},{key:"bottom",get:function(){return d(this,or)[or].bottom},set:function(t){d(this,or)[or].bottom=t,this.setDirty()}},{key:"near",get:function(){return d(this,or)[or].near},set:function(t){d(this,or)[or].near=t,this.setDirty()}},{key:"far",get:function(){return d(this,or)[or].far},set:function(t){d(this,or)[or].far=t,this.setDirty()}},{key:"projMatrix",get:function(){return this.dirty&&this.cleanIfDirty(),d(this,or)[or].projMatrix}},{key:"inverseProjMatrix",get:function(){return this.dirty&&this.cleanIfDirty(),d(this,ar)[ar]&&(q(d(this,or)[or].projMatrix,d(this,or)[or].inverseProjMatrix),d(this,ar)[ar]=!1),d(this,or)[or].inverseProjMatrix}},{key:"transposedProjMatrix",get:function(){return this.dirty&&this.cleanIfDirty(),d(this,hr)[hr]&&(X(d(this,or)[or].projMatrix,d(this,or)[or].transposedProjMatrix),d(this,hr)[hr]=!1),d(this,or)[or].transposedProjMatrix}}]),r}(t.Component);cr.type=x;var lr=/*#__PURE__*/l("state"),dr=/*#__PURE__*/function(t){function e(e,i){var r;return void 0===i&&(i={}),(r=t.call(this,e,i)||this).view=void 0,Object.defineProperty(h(r),lr,{writable:!0,value:void 0}),r.view=e,d(h(r),lr)[lr]={type:"ambient",color:new Float32Array(i.color||[.7,.7,.7]),intensity:null!=i.intensity?i.intensity:1},r.view.registerLight(h(r)),r}return o(e,t),e.prototype.destroy=function(){t.prototype.destroy.call(this),this.view.deregisterLight(this)},s(e,[{key:"color",get:function(){return d(this,lr)[lr].color},set:function(t){d(this,lr)[lr].color.set(t),this.view.redraw()}},{key:"intensity",get:function(){return d(this,lr)[lr].intensity},set:function(t){d(this,lr)[lr].intensity=void 0!==t?t:1,this.view.redraw()}}]),e}(t.Component),ur=/*#__PURE__*/l("state"),vr=/*#__PURE__*/function(t){function e(e,i){var r;return void 0===i&&(i={}),(r=t.call(this,e,i)||this).view=void 0,Object.defineProperty(h(r),ur,{writable:!0,value:void 0}),r.view=e,d(h(r),ur)[ur]={type:"dir",dir:new Float32Array(i.dir||[1,1,1]),color:new Float32Array(i.color||[.7,.7,.8]),intensity:null!=i.intensity?i.intensity:1,space:i.space||"view"},r.view.registerLight(h(r)),r}return o(e,t),e.prototype.destroy=function(){t.prototype.destroy.call(this),this.view.deregisterLight(this),this.view.redraw()},s(e,[{key:"dir",get:function(){return d(this,ur)[ur].dir},set:function(t){d(this,ur)[ur].dir.set(t),this.view.redraw()}},{key:"color",get:function(){return d(this,ur)[ur].color},set:function(t){d(this,ur)[ur].color.set(t),this.view.redraw()}},{key:"intensity",get:function(){return d(this,ur)[ur].intensity},set:function(t){d(this,ur)[ur].intensity=t,this.view.redraw()}}]),e}(t.Component),fr=/*#__PURE__*/l("state"),pr=/*#__PURE__*/function(t){function e(e,i){var r;return void 0===i&&(i={}),(r=t.call(this,e,i)||this).view=void 0,Object.defineProperty(h(r),fr,{writable:!0,value:void 0}),r.view=e,d(h(r),fr)[fr]={type:"point",pos:new Float64Array(i.pos||[1,1,1]),color:new Float32Array(i.color||[.7,.7,.8]),intensity:1,attenuation:new Float32Array([i.constantAttenuation,i.linearAttenuation,i.quadraticAttenuation]),space:i.space||"view"},r.view.registerLight(h(r)),r}return o(e,t),e.prototype.destroy=function(){t.prototype.destroy.call(this),this.view.deregisterLight(this),this.view.redraw()},s(e,[{key:"pos",get:function(){return d(this,fr)[fr].pos},set:function(t){d(this,fr)[fr].pos.set(t||[1,1,1]),this.view.redraw()}},{key:"color",get:function(){return d(this,fr)[fr].color},set:function(t){d(this,fr)[fr].color.set(t||[.7,.7,.8]),this.view.redraw()}},{key:"intensity",get:function(){return d(this,fr)[fr].intensity},set:function(t){t!==d(this,fr)[fr].intensity&&(d(this,fr)[fr].intensity=t,this.view.redraw())}},{key:"constantAttenuation",get:function(){return d(this,fr)[fr].attenuation[0]},set:function(t){d(this,fr)[fr].attenuation[0]=t,this.view.redraw()}},{key:"linearAttenuation",get:function(){return d(this,fr)[fr].attenuation[1]},set:function(t){d(this,fr)[fr].attenuation[1]=t,this.view.redraw()}},{key:"quadraticAttenuation",get:function(){return d(this,fr)[fr].attenuation[2]},set:function(t){d(this,fr)[fr].attenuation[2]=t,this.view.redraw()}}]),e}(t.Component),yr=/*#__PURE__*/l("viewObject"),br=/*#__PURE__*/l("gotCanvasPos"),wr=/*#__PURE__*/l("gotOrigin"),jr=/*#__PURE__*/l("gotDirection"),gr=/*#__PURE__*/l("gotIndices"),Or=/*#__PURE__*/l("gotLocalPos"),Pr=/*#__PURE__*/l("gotWorldPos"),mr=/*#__PURE__*/l("gotViewPos"),kr=/*#__PURE__*/l("gotWorldNormal"),xr=/*#__PURE__*/l("gotUV"),Mr=/*#__PURE__*/l("canvasPos"),Er=/*#__PURE__*/l("origin"),Dr=/*#__PURE__*/l("direction"),Ar=/*#__PURE__*/l("indices"),Ir=/*#__PURE__*/l("localPos"),Cr=/*#__PURE__*/l("worldPos"),Sr=/*#__PURE__*/l("viewPos"),Vr=/*#__PURE__*/l("worldNormal"),Lr=/*#__PURE__*/l("uv"),Tr=/*#__PURE__*/function(){function t(){Object.defineProperty(this,yr,{writable:!0,value:void 0}),Object.defineProperty(this,br,{writable:!0,value:void 0}),Object.defineProperty(this,wr,{writable:!0,value:void 0}),Object.defineProperty(this,jr,{writable:!0,value:void 0}),Object.defineProperty(this,gr,{writable:!0,value:void 0}),Object.defineProperty(this,Or,{writable:!0,value:void 0}),Object.defineProperty(this,Pr,{writable:!0,value:void 0}),Object.defineProperty(this,mr,{writable:!0,value:void 0}),Object.defineProperty(this,kr,{writable:!0,value:void 0}),Object.defineProperty(this,xr,{writable:!0,value:void 0}),Object.defineProperty(this,Mr,{writable:!0,value:void 0}),Object.defineProperty(this,Er,{writable:!0,value:void 0}),Object.defineProperty(this,Dr,{writable:!0,value:void 0}),Object.defineProperty(this,Ar,{writable:!0,value:void 0}),Object.defineProperty(this,Ir,{writable:!0,value:void 0}),Object.defineProperty(this,Cr,{writable:!0,value:void 0}),Object.defineProperty(this,Sr,{writable:!0,value:void 0}),Object.defineProperty(this,Vr,{writable:!0,value:void 0}),Object.defineProperty(this,Lr,{writable:!0,value:void 0}),d(this,yr)[yr]=null,d(this,Mr)[Mr]=new Int16Array([0,0]),d(this,Er)[Er]=new Float64Array([0,0,0]),d(this,Dr)[Dr]=new Float64Array([0,0,0]),d(this,Ar)[Ar]=new Int32Array(3),d(this,Ir)[Ir]=new Float64Array([0,0,0]),d(this,Cr)[Cr]=new Float64Array([0,0,0]),d(this,Sr)[Sr]=new Float64Array([0,0,0]),d(this,Vr)[Vr]=new Float64Array([0,0,0]),d(this,Lr)[Lr]=new Float64Array([0,0]),d(this,wr)[wr]=!1,d(this,jr)[jr]=!1,d(this,gr)[gr]=!1,d(this,br)[br]=!1,d(this,Or)[Or]=!1,d(this,Pr)[Pr]=!1,d(this,mr)[mr]=!1,d(this,kr)[kr]=!1,d(this,xr)[xr]=!1,this.reset()}return t.prototype.reset=function(){d(this,yr)[yr]=null,d(this,br)[br]=!1,d(this,wr)[wr]=!1,d(this,jr)[jr]=!1,d(this,gr)[gr]=!1,d(this,Or)[Or]=!1,d(this,Pr)[Pr]=!1,d(this,mr)[mr]=!1,d(this,kr)[kr]=!1,d(this,xr)[xr]=!1},s(t,[{key:"viewObject",get:function(){return d(this,yr)[yr]},set:function(t){d(this,yr)[yr]=t}},{key:"canvasPos",get:function(){return d(this,br)[br]?d(this,Mr)[Mr]:void 0},set:function(t){t?(d(this,Mr)[Mr][0]=t[0],d(this,Mr)[Mr][1]=t[1],d(this,br)[br]=!0):d(this,br)[br]=!1}},{key:"origin",get:function(){return d(this,wr)[wr]?d(this,Er)[Er]:null},set:function(t){t?(d(this,Er)[Er][0]=t[0],d(this,Er)[Er][1]=t[1],d(this,Er)[Er][2]=t[2],d(this,wr)[wr]=!0):d(this,wr)[wr]=!1}},{key:"direction",get:function(){return d(this,jr)[jr]?d(this,Dr)[Dr]:null},set:function(t){t?(d(this,Dr)[Dr][0]=t[0],d(this,Dr)[Dr][1]=t[1],d(this,Dr)[Dr][2]=t[2],d(this,jr)[jr]=!0):d(this,jr)[jr]=!1}},{key:"indices",get:function(){return d(this,yr)[yr]&&d(this,gr)[gr]?d(this,Ar)[Ar]:null},set:function(t){t?(d(this,Ar)[Ar][0]=t[0],d(this,Ar)[Ar][1]=t[1],d(this,Ar)[Ar][2]=t[2],d(this,gr)[gr]=!0):d(this,gr)[gr]=!1}},{key:"localPos",get:function(){return d(this,yr)[yr]&&d(this,Or)[Or]?d(this,Ir)[Ir]:null},set:function(t){t?(d(this,Ir)[Ir][0]=t[0],d(this,Ir)[Ir][1]=t[1],d(this,Ir)[Ir][2]=t[2],d(this,Or)[Or]=!0):d(this,Or)[Or]=!1}},{key:"worldPos",get:function(){return d(this,yr)[yr]&&d(this,Pr)[Pr]?d(this,Cr)[Cr]:null},set:function(t){t?(d(this,Cr)[Cr][0]=t[0],d(this,Cr)[Cr][1]=t[1],d(this,Cr)[Cr][2]=t[2],d(this,Pr)[Pr]=!0):d(this,Pr)[Pr]=!1}},{key:"viewPos",get:function(){return d(this,yr)[yr]&&d(this,mr)[mr]?d(this,Sr)[Sr]:null},set:function(t){t?(d(this,Sr)[Sr][0]=t[0],d(this,Sr)[Sr][1]=t[1],d(this,Sr)[Sr][2]=t[2],d(this,mr)[mr]=!0):d(this,mr)[mr]=!1}},{key:"worldNormal",get:function(){return d(this,yr)[yr]&&d(this,kr)[kr]?d(this,Vr)[Vr]:null},set:function(t){t?(d(this,Vr)[Vr][0]=t[0],d(this,Vr)[Vr][1]=t[1],d(this,Vr)[Vr][2]=t[2],d(this,kr)[kr]=!0):d(this,kr)[kr]=!1}},{key:"uv",get:function(){return d(this,yr)[yr]&&d(this,xr)[xr]?d(this,Lr)[Lr]:null},set:function(t){t?(d(this,Lr)[Lr][0]=t[0],d(this,Lr)[Lr][1]=t[1],d(this,xr)[xr]=!0):d(this,xr)[xr]=!1}}]),t}();exports.AmbientLight=dr,exports.Camera=Oe,exports.CameraFlightAnimation=wi,exports.CustomProjection=Yt,exports.DirLight=vr,exports.EdgeMaterial=Lt,exports.EmphasisMaterial=St,exports.FrustumProjection=cr,exports.Metrics=nt,exports.OrthoProjection=Nt,exports.PerspectiveProjection=Wt,exports.PickResult=Tr,exports.PointLight=pr,exports.PointsMaterial=Ut,exports.SAO=ot,exports.SectionPlane=Z,exports.View=Gi,exports.ViewLayer=Et,exports.ViewObject=$,exports.Viewer=ir;
//# sourceMappingURL=index.js.map
