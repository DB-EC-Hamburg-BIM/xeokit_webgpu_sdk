import{Component as t,EventEmitter as e,SDKError as i}from"@xeokit/core";import{EventDispatcher as r}from"strongly-typed-events";import{Scene as n}from"@xeokit/scene";import{newFloatArray as s,MAX_DOUBLE as o,MIN_DOUBLE as h,DEGTORAD as a}from"@xeokit/math";import{decompressPoint3 as c}from"@xeokit/compression";function l(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,"symbol"==typeof(n=function(t,e){if("object"!=typeof t||null===t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(r.key))?n:String(n),r)}var n}function d(t,e,i){return e&&l(t.prototype,e),i&&l(t,i),Object.defineProperty(t,"prototype",{writable:!1}),t}function u(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,v(t,e)}function v(t,e){return v=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},v(t,e)}function f(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}var y=0;function p(t){return"__private_"+y+++"_"+t}function b(t,e){if(!Object.prototype.hasOwnProperty.call(t,e))throw new TypeError("attempted to use private field on non-instance");return t}var w=0;function j(t){return"__private_"+w+++"_"+t}function g(t,e){if(!Object.prototype.hasOwnProperty.call(t,e))throw new TypeError("attempted to use private field on non-instance");return t}var O=/*#__PURE__*/j("items"),P=/*#__PURE__*/j("lastUniqueId"),m=/*#__PURE__*/function(){function t(t,e){Object.defineProperty(this,O,{writable:!0,value:void 0}),Object.defineProperty(this,P,{writable:!0,value:void 0}),g(this,O)[O]=t||[],g(this,P)[P]=(e||0)+1}var e=t.prototype;return e.addItem=function(){var t;if(2===arguments.length){var e=arguments[0];if(t=arguments[1],g(this,O)[O][e])throw"ID clash: '"+e+"'";return g(this,O)[O][e]=t,e}for(t=arguments[0]||{};;){var i=g(this,P)[P]++;if(!g(this,O)[O][i])return g(this,O)[O][i]=t,i}},e.removeItem=function(t){var e=g(this,O)[O][t];return delete g(this,O)[O][t],e},t}(),k=/*#__PURE__*/function(){function t(){this._head=void 0,this._headLength=void 0,this._tail=void 0,this._index=void 0,this._length=void 0,this._head=[],this._headLength=0,this._tail=[],this._index=0,this._length=0}var e,i,r=t.prototype;return r.shift=function(){if(this._index>=this._headLength){var t=this._head;if(t.length=0,this._head=this._tail,this._tail=t,this._index=0,this._headLength=this._head.length,!this._headLength)return}var e=this._head[this._index];return this._index<0?delete this._head[this._index++]:this._head[this._index++]=void 0,this._length--,e},r.push=function(t){return this._length++,this._tail.push(t),this},r.unshift=function(t){return this._head[--this._index]=t,this._length++,this},r.clear=function(){this._head=[],this._headLength=0,this._tail=[],this._index=0,this._length=0},e=t,(i=[{key:"length",get:function(){return this._length}}])&&function(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,"symbol"==typeof(n=function(t,e){if("object"!=typeof t||null===t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(r.key))?n:String(n),r)}var n}(e.prototype,i),Object.defineProperty(e,"prototype",{writable:!1}),t}();function x(t){return function(t){return!isNaN(parseFloat(t))&&isFinite(t)}(t)?""+t:"'"+t+"'"}[["0",10],["A",26],["a",26],["_",1],["$",1]].map(function(t){for(var e=[],i=t[0].charCodeAt(0),r=i+t[1],n=i;n<r;++n)e.push(n);return String.fromCharCode.apply(null,e)}).join("");var M=function(){for(var t=[],e=0;e<256;e++)t[e]=(e<16?"0":"")+e.toString(16);return function(){var e=4294967295*Math.random()|0,i=4294967295*Math.random()|0,r=4294967295*Math.random()|0,n=4294967295*Math.random()|0;return t[255&e]+t[e>>8&255]+t[e>>16&255]+t[e>>24&255]+"-"+t[255&i]+t[i>>8&255]+"-"+t[i>>16&15|64]+t[i>>24&255]+"-"+t[63&r|128]+t[r>>8&255]+"-"+t[r>>16&255]+t[r>>24&255]+t[255&n]+t[n>>8&255]+t[n>>16&255]+t[n>>24&255]}}(),I=3e4,A=4e5,D=5e5,S=500001,V=500002,C=500003;function L(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function U(t){return new Float64Array(t||3)}function T(t){return new FloatArrayClass(t||4)}function z(t,e,i){return i||(i=t),i[0]=t[0]*e,i[1]=t[1]*e,i[2]=t[2]*e,i}function F(t,e,i){return i||(i=t),i[0]=t[0]+e[0],i[1]=t[1]+e[1],i[2]=t[2]+e[2],i}function _(t,e,i){return i||(i=t),i[0]=t[0]-e[0],i[1]=t[1]-e[1],i[2]=t[2]-e[2],i}function R(t,e,i){i||(i=t);var r=t[0],n=t[1],s=t[2],o=e[0],h=e[1],a=e[2];return i[0]=n*a-s*h,i[1]=s*o-r*a,i[2]=r*h-n*o,i}function W(t){return Math.sqrt(function(t){return L(t,t)}(t))}function E(t,e,i,r,n,s){var o=s||U(),h=(t-e)/(i-e);return o[0]=r[0]+h*(n[0]-r[0]),o[1]=r[1]+h*(n[1]-r[1]),o[2]=r[2]+h*(n[2]-r[2]),o}function H(t,e){return z(t,1/W(t),e)}function q(t){return s(t||16)}T(),T(),new FloatArrayClass(2);var X=q(),B=q();function N(t){return t||(t=q()),t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function G(t,e,i){i||(i=q());var r,n,s,o,h,a,c=function(t,e){return function(t,e,i){return i||(i=t),i[0]=t[0]*e,i[1]=t[1]*e,i[2]=t[2]*e,i[3]=t[3]*e,i}(t,1/function(t){return Math.sqrt(function(t){return function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]}(t,t)}(t))}(t),[])}([e[0],e[1],e[2],0]),l=Math.sin(t),d=Math.cos(t),u=1-d,v=c[0],f=c[1],y=c[2];return r=v*f,n=f*y,s=y*v,o=v*l,h=f*l,a=y*l,i[0]=u*v*v+d,i[1]=u*r+a,i[2]=u*s-h,i[3]=0,i[4]=u*r-a,i[5]=u*f*f+d,i[6]=u*n+o,i[7]=0,i[8]=u*s+h,i[9]=u*n-o,i[10]=u*y*y+d,i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,i}function Q(t,e,i,r){r||(r=q());var n,s,o,h,a,c,l,d,u,v,f=t[0],y=t[1],p=t[2],b=i[0],w=i[1],j=i[2],g=e[0],O=e[1],P=e[2];return f===g&&y===O&&p===P?N():(n=f-g,s=y-O,o=p-P,h=w*(o*=v=1/Math.sqrt(n*n+s*s+o*o))-j*(s*=v),a=j*(n*=v)-b*o,c=b*s-w*n,(v=Math.sqrt(h*h+a*a+c*c))?(h*=v=1/v,a*=v,c*=v):(h=0,a=0,c=0),l=s*c-o*a,d=o*h-n*c,u=n*a-s*h,(v=Math.sqrt(l*l+d*d+u*u))?(l*=v=1/v,d*=v,u*=v):(l=0,d=0,u=0),r[0]=h,r[1]=l,r[2]=n,r[3]=0,r[4]=a,r[5]=d,r[6]=s,r[7]=0,r[8]=c,r[9]=u,r[10]=o,r[11]=0,r[12]=-(h*f+a*y+c*p),r[13]=-(l*f+d*y+u*p),r[14]=-(n*f+s*y+o*p),r[15]=1,r)}function Y(t,e){e||(e=t);var i=t[0],r=t[1],n=t[2],s=t[3],o=t[4],h=t[5],a=t[6],c=t[7],l=t[8],d=t[9],u=t[10],v=t[11],f=t[12],y=t[13],p=t[14],b=t[15],w=i*h-r*o,j=i*a-n*o,g=i*c-s*o,O=r*a-n*h,P=r*c-s*h,m=n*c-s*a,k=l*y-d*f,x=l*p-u*f,M=l*b-v*f,I=d*p-u*y,A=d*b-v*y,D=u*b-v*p,S=1/(w*D-j*A+g*I+O*M-P*x+m*k);return e[0]=(h*D-a*A+c*I)*S,e[1]=(-r*D+n*A-s*I)*S,e[2]=(y*m-p*P+b*O)*S,e[3]=(-d*m+u*P-v*O)*S,e[4]=(-o*D+a*M-c*x)*S,e[5]=(i*D-n*M+s*x)*S,e[6]=(-f*m+p*g-b*j)*S,e[7]=(l*m-u*g+v*j)*S,e[8]=(o*A-h*M+c*k)*S,e[9]=(-i*A+r*M-s*k)*S,e[10]=(f*P-y*g+b*w)*S,e[11]=(-l*P+d*g-v*w)*S,e[12]=(-o*I+h*x-a*k)*S,e[13]=(i*I-r*x+n*k)*S,e[14]=(-f*O+y*j-p*w)*S,e[15]=(l*O-d*j+u*w)*S,e}function $(t,e){var i=t[4],r=t[14],n=t[8],s=t[13],o=t[12],h=t[9];if(!e||t===e){var a=t[1],c=t[2],l=t[3],d=t[6],u=t[7],v=t[11];return t[1]=i,t[2]=n,t[3]=o,t[4]=a,t[6]=h,t[7]=s,t[8]=c,t[9]=d,t[11]=r,t[12]=l,t[13]=u,t[14]=v,t}return e[0]=t[0],e[1]=i,e[2]=n,e[3]=o,e[4]=t[1],e[5]=t[5],e[6]=h,e[7]=s,e[8]=t[2],e[9]=t[6],e[10]=t[10],e[11]=r,e[12]=t[3],e[13]=t[7],e[14]=t[11],e[15]=t[15],e}function J(t,e,i){i||(i=t);var r=e[0],n=e[1],s=e[2],o=e[3];return i[0]=t[0]*r+t[4]*n+t[8]*s+t[12]*o,i[1]=t[1]*r+t[5]*n+t[9]*s+t[13]*o,i[2]=t[2]*r+t[6]*n+t[10]*s+t[14]*o,i[3]=t[3]*r+t[7]*n+t[11]*s+t[15]*o,i}function K(t,e,i){i||(i=t);var r=t[0],n=t[1],s=t[2],o=t[3],h=t[4],a=t[5],c=t[6],l=t[7],d=t[8],u=t[9],v=t[10],f=t[11],y=t[12],p=t[13],b=t[14],w=t[15],j=e[0],g=e[1],O=e[2],P=e[3],m=e[4],k=e[5],x=e[6],M=e[7],I=e[8],A=e[9],D=e[10],S=e[11],V=e[12],C=e[13],L=e[14],U=e[15];return i[0]=j*r+g*h+O*d+P*y,i[1]=j*n+g*a+O*u+P*p,i[2]=j*s+g*c+O*v+P*b,i[3]=j*o+g*l+O*f+P*w,i[4]=m*r+k*h+x*d+M*y,i[5]=m*n+k*a+x*u+M*p,i[6]=m*s+k*c+x*v+M*b,i[7]=m*o+k*l+x*f+M*w,i[8]=I*r+A*h+D*d+S*y,i[9]=I*n+A*a+D*u+S*p,i[10]=I*s+A*c+D*v+S*b,i[11]=I*o+A*l+D*f+S*w,i[12]=V*r+C*h+L*d+U*y,i[13]=V*n+C*a+L*u+U*p,i[14]=V*s+C*c+L*v+U*b,i[15]=V*o+C*l+L*f+U*w,i}function Z(t,e,i){i||(i=e);var r=e[0],n=e[1],s=e[2];return i[0]=t[0]*r+t[4]*n+t[8]*s+t[12],i[1]=t[1]*r+t[5]*n+t[9]*s+t[13],i[2]=t[2]*r+t[6]*n+t[10]*s+t[14],i}s(3),U(),q(),s(3);var tt,et=/*#__PURE__*/p("rendererViewObject"),it=/*#__PURE__*/p("state"),rt=/*#__PURE__*/function(){function t(t,e,i){this.id=void 0,this.layer=void 0,this.sceneObject=void 0,Object.defineProperty(this,et,{writable:!0,value:void 0}),Object.defineProperty(this,it,{writable:!0,value:void 0}),this.id=e.id,this.layer=t,this.sceneObject=e,b(this,et)[et]=i,b(this,it)[it]={visible:!0,culled:!1,pickable:!0,clippable:!0,collidable:!0,xrayed:!1,selected:!1,highlighted:!1,edges:!1,colorize:new Float32Array(4),colorized:!1,opacityUpdated:!1},b(this,et)[et].setVisible(this.layer.view.viewIndex,b(this,it)[it].visible),this.layer.objectVisibilityUpdated(this,b(this,it)[it].visible,!0)}return t.prototype._destroy=function(){b(this,it)[it].visible&&this.layer.objectVisibilityUpdated(this,!1,!1),b(this,it)[it].xrayed&&this.layer.objectXRayedUpdated(this,!1),b(this,it)[it].selected&&this.layer.objectSelectedUpdated(this,!1),b(this,it)[it].highlighted&&this.layer.objectHighlightedUpdated(this,!1),b(this,it)[it].colorized&&this.layer.objectColorizeUpdated(this,!1),b(this,it)[it].opacityUpdated&&this.layer.objectOpacityUpdated(this,!1),this.layer.redraw()},d(t,[{key:"aabb",get:function(){return this.sceneObject.aabb}},{key:"visible",get:function(){return b(this,it)[it].visible},set:function(t){t!==b(this,it)[it].visible&&(b(this,it)[it].visible=t,b(this,et)[et].setVisible(this.layer.view.viewIndex,t),this.layer.objectVisibilityUpdated(this,t,!0),this.layer.redraw())}},{key:"xrayed",get:function(){return b(this,it)[it].xrayed},set:function(t){b(this,it)[it].xrayed!==t&&(b(this,it)[it].xrayed=t,b(this,et)[et].setXRayed(this.layer.view.viewIndex,t),this.layer.objectXRayedUpdated(this,t),this.layer.redraw())}},{key:"edges",get:function(){return b(this,it)[it].edges},set:function(t){b(this,it)[it].edges!==t&&(b(this,it)[it].edges=t,b(this,et)[et].setEdges(this.layer.view.viewIndex,t),this.layer.redraw())}},{key:"highlighted",get:function(){return b(this,it)[it].highlighted},set:function(t){t!==b(this,it)[it].highlighted&&(b(this,it)[it].highlighted=t,b(this,et)[et].setHighlighted(this.layer.view.viewIndex,t),this.layer.objectHighlightedUpdated(this,t),this.layer.redraw())}},{key:"selected",get:function(){return b(this,it)[it].selected},set:function(t){t!==b(this,it)[it].selected&&(b(this,it)[it].selected=t,b(this,et)[et].setSelected(this.layer.view.viewIndex,t),this.layer.objectSelectedUpdated(this,t),this.layer.redraw())}},{key:"culled",get:function(){return b(this,it)[it].culled},set:function(t){t!==b(this,it)[it].culled&&(b(this,it)[it].culled=t,this.layer.redraw())}},{key:"clippable",get:function(){return b(this,it)[it].clippable},set:function(t){t!==b(this,it)[it].clippable&&(b(this,it)[it].clippable=t,this.layer.redraw())}},{key:"collidable",get:function(){return b(this,it)[it].collidable},set:function(t){t!==b(this,it)[it].collidable&&(b(this,it)[it].collidable=t)}},{key:"pickable",get:function(){return b(this,it)[it].pickable},set:function(t){b(this,it)[it].pickable!==t&&(b(this,it)[it].pickable=t)}},{key:"colorize",get:function(){return b(this,it)[it].colorize},set:function(t){var e=b(this,it)[it].colorize;t?(e[0]=t[0],e[1]=t[1],e[2]=t[2]):(e[0]=1,e[1]=1,e[2]=1),b(this,it)[it].colorized=!!t,this.layer.objectColorizeUpdated(this,b(this,it)[it].colorized),this.layer.redraw()}},{key:"opacity",get:function(){return b(this,it)[it].colorize[3]},set:function(t){var e=b(this,it)[it].colorize;b(this,it)[it].opacityUpdated=null!=t,e[3]=b(this,it)[it].opacityUpdated?t:1,this.layer.objectOpacityUpdated(this,b(this,it)[it].opacityUpdated),this.layer.redraw()}}]),t}(),nt=/*#__PURE__*/p("state"),st=/*#__PURE__*/function(t){function i(i,n){var s;return void 0===n&&(n={}),(s=t.call(this,i,n)||this).view=void 0,s.onPos=void 0,s.onDir=void 0,s.onActive=void 0,Object.defineProperty(f(s),nt,{writable:!0,value:void 0}),s.view=i,b(f(s),nt)[nt]={active:!1!==n.active,pos:new Float64Array(n.pos||[0,0,0]),dir:new Float32Array(n.pos||[0,0,-1]),dist:0},s.onPos=new e(new r),s.onDir=new e(new r),s.onActive=new e(new r),s}u(i,t);var n=i.prototype;return n.flipDir=function(){var t=b(this,nt)[nt].dir;t[0]*=-1,t[1]*=-1,t[2]*=-1,b(this,nt)[nt].dist=-L(b(this,nt)[nt].pos,b(this,nt)[nt].dir),this.onDir.dispatch(this,b(this,nt)[nt].dir),this.view.redraw()},n.destroy=function(){this.onPos.clear(),this.onDir.clear(),t.prototype.destroy.call(this)},d(i,[{key:"active",get:function(){return b(this,nt)[nt].active},set:function(t){b(this,nt)[nt].active!==t&&(b(this,nt)[nt].active=t,this.view.redraw(),this.onActive.dispatch(this,b(this,nt)[nt].active))}},{key:"pos",get:function(){return b(this,nt)[nt].pos},set:function(t){b(this,nt)[nt].pos.set(t),b(this,nt)[nt].dist=-L(b(this,nt)[nt].pos,b(this,nt)[nt].dir),this.onPos.dispatch(this,b(this,nt)[nt].pos)}},{key:"dir",get:function(){return b(this,nt)[nt].dir},set:function(t){b(this,nt)[nt].dir.set(t),b(this,nt)[nt].dist=-L(b(this,nt)[nt].pos,b(this,nt)[nt].dir),this.view.redraw(),this.onDir.dispatch(this,b(this,nt)[nt].dir)}},{key:"dist",get:function(){return b(this,nt)[nt].dist}}]),i}(t),ot=((tt={})[A]={abbrev:"m"},tt[400001]={abbrev:"cm"},tt[400002]={abbrev:"mm"},tt[400003]={abbrev:"yd"},tt[400004]={abbrev:"ft"},tt[400005]={abbrev:"in"},tt),ht=/*#__PURE__*/p("units"),at=/*#__PURE__*/p("scale"),ct=/*#__PURE__*/p("origin"),lt=/*#__PURE__*/function(t){function i(i,n){var s;return void 0===n&&(n={units:A,scale:1,origin:[1,1,1]}),s=t.call(this,i,n)||this,Object.defineProperty(f(s),ht,{writable:!0,value:void 0}),Object.defineProperty(f(s),at,{writable:!0,value:void 0}),Object.defineProperty(f(s),ct,{writable:!0,value:void 0}),s.onUnits=void 0,s.onScale=void 0,s.onOrigin=void 0,s.onUnits=new e(new r),s.onScale=new e(new r),s.onOrigin=new e(new r),b(f(s),ht)[ht]=A,b(f(s),at)[at]=1,b(f(s),ct)[ct]=U([0,0,0]),s.units=n.units,s.scale=n.scale,s.origin=n.origin,s}u(i,t);var n=i.prototype;return n.worldToRealPos=function(t,e){return void 0===e&&(e=U()),e[0]=b(this,ct)[ct][0]+b(this,at)[at]*t[0],e[1]=b(this,ct)[ct][1]+b(this,at)[at]*t[1],e[2]=b(this,ct)[ct][2]+b(this,at)[at]*t[2],e},n.realToWorldPos=function(t,e){return void 0===e&&(e=U()),e[0]=(t[0]-b(this,ct)[ct][0])/b(this,at)[at],e[1]=(t[1]-b(this,ct)[ct][1])/b(this,at)[at],e[2]=(t[2]-b(this,ct)[ct][2])/b(this,at)[at],e},n.destroy=function(){t.prototype.destroy.call(this),this.onUnits.clear(),this.onScale.clear(),this.onOrigin.clear()},d(i,[{key:"unitsInfo",get:function(){return ot}},{key:"units",get:function(){return b(this,ht)[ht]},set:function(t){t||(t=A),ot[t]||(this.error("Unsupported value for 'units': "+t+" defaulting to MetersUnit"),t=A),b(this,ht)[ht]=t,this.onUnits.dispatch(this,b(this,ht)[ht])}},{key:"scale",get:function(){return b(this,at)[at]},set:function(t){(t=t||1)<=0?this.error("scale value should be larger than zero"):(b(this,at)[at]=t,this.onScale.dispatch(this,b(this,at)[at]))}},{key:"origin",get:function(){return b(this,ct)[ct]},set:function(t){if(!t)return b(this,ct)[ct][0]=0,b(this,ct)[ct][1]=0,void(b(this,ct)[ct][2]=0);b(this,ct)[ct][0]=t[0],b(this,ct)[ct][1]=t[1],b(this,ct)[ct][2]=t[2],this.onOrigin.dispatch(this,b(this,ct)[ct])}}]),i}(t),dt=/*#__PURE__*/p("state"),ut=/*#__PURE__*/function(t){function e(e,i){var r;return(r=t.call(this,e,i)||this).view=void 0,Object.defineProperty(f(r),dt,{writable:!0,value:void 0}),r.view=e,b(f(r),dt)[dt]={renderModes:[I],enabled:!1!==i.enabled,kernelRadius:i.kernelRadius||100,intensity:void 0!==i.intensity?i.intensity:.15,bias:void 0!==i.bias?i.bias:.5,scale:void 0!==i.scale?i.scale:1,minResolution:void 0!==i.minResolution?i.minResolution:0,numSamples:void 0!==i.numSamples?i.numSamples:10,blur:!!i.blur,blendCutoff:void 0!==i.blendCutff?i.blendCutoff:.3,blendFactor:void 0!==i.blendFactor?i.blendFactor:1},r}return u(e,t),e.prototype.destroy=function(){t.prototype.destroy.call(this)},d(e,[{key:"renderModes",get:function(){return b(this,dt)[dt].renderModes},set:function(t){b(this,dt)[dt].renderModes=t,this.view.redraw()}},{key:"supported",get:function(){return this.view.viewer.renderer.getSAOSupported()}},{key:"enabled",get:function(){return b(this,dt)[dt].enabled},set:function(t){t=!!t,b(this,dt)[dt].enabled!==t&&(b(this,dt)[dt].enabled=t,this.view.redraw())}},{key:"possible",get:function(){if(!this.supported)return!1;if(!b(this,dt)[dt].enabled)return!1;var t=this.view.camera.projectionType;return t!==C&&t!==V}},{key:"kernelRadius",get:function(){return b(this,dt)[dt].kernelRadius},set:function(t){null==t&&(t=100),b(this,dt)[dt].kernelRadius!==t&&(b(this,dt)[dt].kernelRadius=t,this.view.redraw())}},{key:"intensity",get:function(){return b(this,dt)[dt].intensity},set:function(t){null==t&&(t=.15),b(this,dt)[dt].intensity!==t&&(b(this,dt)[dt].intensity=t,this.view.redraw())}},{key:"bias",get:function(){return b(this,dt)[dt].bias},set:function(t){null==t&&(t=.5),b(this,dt)[dt].bias!==t&&(b(this,dt)[dt].bias=t,this.view.redraw())}},{key:"scale",get:function(){return b(this,dt)[dt].scale},set:function(t){null==t&&(t=1),b(this,dt)[dt].scale!==t&&(b(this,dt)[dt].scale=t,this.view.redraw())}},{key:"minResolution",get:function(){return b(this,dt)[dt].minResolution},set:function(t){null==t&&(t=0),b(this,dt)[dt].minResolution!==t&&(b(this,dt)[dt].minResolution=t,this.view.redraw())}},{key:"numSamples",get:function(){return b(this,dt)[dt].numSamples},set:function(t){null==t&&(t=10),b(this,dt)[dt].numSamples!==t&&(b(this,dt)[dt].numSamples=t,this.view.redraw())}},{key:"blur",get:function(){return b(this,dt)[dt].blur},set:function(t){t=!1!==t,b(this,dt)[dt].blur!==t&&(b(this,dt)[dt].blur=t,this.view.redraw())}},{key:"blendCutoff",get:function(){return b(this,dt)[dt].blendCutoff},set:function(t){null==t&&(t=.3),b(this,dt)[dt].blendCutoff!==t&&(b(this,dt)[dt].blendCutoff=t,this.view.redraw())}},{key:"blendFactor",get:function(){return b(this,dt)[dt].blendFactor},set:function(t){null==t&&(t=1),b(this,dt)[dt].blendFactor!==t&&(b(this,dt)[dt].blendFactor=t,this.view.redraw())}}]),e}(t),vt=/*#__PURE__*/p("state"),ft=/*#__PURE__*/function(t){function e(e,i){var r;return void 0===i&&(i={lineWidth:1}),(r=t.call(this,e,i)||this).view=void 0,Object.defineProperty(f(r),vt,{writable:!0,value:void 0}),r.view=e,b(f(r),vt)[vt]={lineWidth:null!=i.lineWidth?i.lineWidth:1},r}return u(e,t),d(e,[{key:"lineWidth",get:function(){return b(this,vt)[vt].lineWidth},set:function(t){b(this,vt)[vt].lineWidth=t||1,this.view.redraw()}}]),e}(t),yt=/*#__PURE__*/p("numObjects"),pt=/*#__PURE__*/p("objectIds"),bt=/*#__PURE__*/p("numVisibleObjects"),wt=/*#__PURE__*/p("visibleObjectIds"),jt=/*#__PURE__*/p("numXRayedObjects"),gt=/*#__PURE__*/p("xrayedObjectIds"),Ot=/*#__PURE__*/p("numHighlightedObjects"),Pt=/*#__PURE__*/p("highlightedObjectIds"),mt=/*#__PURE__*/p("numSelectedObjects"),kt=/*#__PURE__*/p("selectedObjectIds"),xt=/*#__PURE__*/p("numColorizedObjects"),Mt=/*#__PURE__*/p("colorizedObjectIds"),It=/*#__PURE__*/p("numOpacityObjects"),At=/*#__PURE__*/p("opacityObjectIds"),Dt=/*#__PURE__*/p("qualityRender"),St=/*#__PURE__*/p("initObjects"),Vt=/*#__PURE__*/p("createObjects"),Ct=/*#__PURE__*/p("destroyObjects"),Lt=/*#__PURE__*/function(t){function i(i){var n;return n=t.call(this,i.view,i)||this,Object.defineProperty(f(n),Ct,{value:zt}),Object.defineProperty(f(n),Vt,{value:Tt}),Object.defineProperty(f(n),St,{value:Ut}),n.objects=void 0,n.visibleObjects=void 0,n.xrayedObjects=void 0,n.highlightedObjects=void 0,n.selectedObjects=void 0,n.colorizedObjects=void 0,n.opacityObjects=void 0,n.autoDestroy=void 0,n.onObjectVisibility=void 0,Object.defineProperty(f(n),yt,{writable:!0,value:void 0}),Object.defineProperty(f(n),pt,{writable:!0,value:void 0}),Object.defineProperty(f(n),bt,{writable:!0,value:void 0}),Object.defineProperty(f(n),wt,{writable:!0,value:void 0}),Object.defineProperty(f(n),jt,{writable:!0,value:void 0}),Object.defineProperty(f(n),gt,{writable:!0,value:void 0}),Object.defineProperty(f(n),Ot,{writable:!0,value:void 0}),Object.defineProperty(f(n),Pt,{writable:!0,value:void 0}),Object.defineProperty(f(n),mt,{writable:!0,value:void 0}),Object.defineProperty(f(n),kt,{writable:!0,value:void 0}),Object.defineProperty(f(n),xt,{writable:!0,value:void 0}),Object.defineProperty(f(n),Mt,{writable:!0,value:void 0}),Object.defineProperty(f(n),It,{writable:!0,value:void 0}),Object.defineProperty(f(n),At,{writable:!0,value:void 0}),Object.defineProperty(f(n),Dt,{writable:!0,value:void 0}),n.gammaOutput=void 0,n.id=i.id,n.viewer=i.viewer,n.view=i.view,n.objects={},n.visibleObjects={},n.xrayedObjects={},n.highlightedObjects={},n.selectedObjects={},n.colorizedObjects={},n.opacityObjects={},n.autoDestroy=!1!==i.autoDestroy,b(f(n),yt)[yt]=0,b(f(n),bt)[bt]=0,b(f(n),jt)[jt]=0,b(f(n),Ot)[Ot]=0,b(f(n),mt)[mt]=0,b(f(n),xt)[xt]=0,b(f(n),It)[It]=0,b(f(n),Dt)[Dt]=!!i.qualityRender,n.onObjectVisibility=new e(new r),b(f(n),St)[St](),n}u(i,t);var n=i.prototype;return n.registerViewObject=function(t){this.objects[t.id]=t,b(this,yt)[yt]++,b(this,pt)[pt]=null},n.deregisterViewObject=function(t){delete this.objects[t.id],delete this.visibleObjects[t.id],delete this.xrayedObjects[t.id],delete this.highlightedObjects[t.id],delete this.selectedObjects[t.id],delete this.colorizedObjects[t.id],delete this.opacityObjects[t.id],b(this,yt)[yt]--,b(this,pt)[pt]=null},n.redraw=function(){this.viewer.renderer.setImageDirty(this.view.viewIndex)},n.objectVisibilityUpdated=function(t,e,i){void 0===i&&(i=!0),e?(this.visibleObjects[t.id]=t,b(this,bt)[bt]++):(delete this.visibleObjects[t.id],b(this,bt)[bt]--),b(this,wt)[wt]=null,i&&this.onObjectVisibility.dispatch(this,t),this.view.objectVisibilityUpdated(t,e,i)},n.objectXRayedUpdated=function(t,e){e?(this.xrayedObjects[t.id]=t,b(this,jt)[jt]++):(delete this.xrayedObjects[t.id],b(this,jt)[jt]--),b(this,gt)[gt]=null,this.view.objectXRayedUpdated(t,e)},n.objectHighlightedUpdated=function(t,e){e?(this.highlightedObjects[t.id]=t,b(this,Ot)[Ot]++):(delete this.highlightedObjects[t.id],b(this,Ot)[Ot]--),b(this,Pt)[Pt]=null,this.view.objectHighlightedUpdated(t,e)},n.objectSelectedUpdated=function(t,e){e?(this.selectedObjects[t.id]=t,b(this,mt)[mt]++):(delete this.selectedObjects[t.id],b(this,mt)[mt]--),b(this,kt)[kt]=null,this.view.objectSelectedUpdated(t,e)},n.objectColorizeUpdated=function(t,e){e?(this.colorizedObjects[t.id]=t,b(this,xt)[xt]++):(delete this.colorizedObjects[t.id],b(this,xt)[xt]--),b(this,Mt)[Mt]=null,this.view.objectColorizeUpdated(t,e)},n.objectOpacityUpdated=function(t,e){e?(this.opacityObjects[t.id]=t,b(this,It)[It]++):(delete this.opacityObjects[t.id],b(this,It)[It]--),b(this,At)[At]=null,this.view.objectOpacityUpdated(t,e)},n.setObjectsVisible=function(t,e){return this.withObjects(t,function(t){var i=t.visible!==e;return t.visible=e,i})},n.setObjectsCollidable=function(t,e){return this.withObjects(t,function(t){var i=t.collidable!==e;return t.collidable=e,i})},n.setObjectsCulled=function(t,e){return this.withObjects(t,function(t){var i=t.culled!==e;return t.culled=e,i})},n.setObjectsSelected=function(t,e){return this.withObjects(t,function(t){var i=t.selected!==e;return t.selected=e,i})},n.setObjectsHighlighted=function(t,e){return this.withObjects(t,function(t){var i=t.highlighted!==e;return t.highlighted=e,i})},n.setObjectsXRayed=function(t,e){return this.withObjects(t,function(t){var i=t.xrayed!==e;return i&&(t.xrayed=e),i})},n.setObjectsColorized=function(t,e){return this.withObjects(t,function(t){t.colorize=e})},n.setObjectsOpacity=function(t,e){return this.withObjects(t,function(t){var i=t.opacity!==e;return i&&(t.opacity=e),i})},n.setObjectsPickable=function(t,e){return this.withObjects(t,function(t){var i=t.pickable!==e;return i&&(t.pickable=e),i})},n.setObjectsClippable=function(t,e){return this.withObjects(t,function(t){var i=t.clippable!==e;return i&&(t.clippable=e),i})},n.withObjects=function(t,e){for(var i=!1,r=0,n=t.length;r<n;r++){var s=this.objects[t[r]];s&&(i=e(s)||i)}return i},n.destroy=function(){t.prototype.destroy.call(this)},d(i,[{key:"gammaFactor",get:function(){return 1}},{key:"qualityRender",get:function(){return b(this,Dt)[Dt]},set:function(t){b(this,Dt)[Dt]!==t&&(b(this,Dt)[Dt]=t,this.redraw())}},{key:"numObjects",get:function(){return b(this,yt)[yt]}},{key:"objectIds",get:function(){return b(this,pt)[pt]||(b(this,pt)[pt]=Object.keys(this.objects)),b(this,pt)[pt]}},{key:"numVisibleObjects",get:function(){return b(this,bt)[bt]}},{key:"visibleObjectIds",get:function(){return b(this,wt)[wt]||(b(this,wt)[wt]=Object.keys(this.visibleObjects)),b(this,wt)[wt]}},{key:"numXRayedObjects",get:function(){return b(this,jt)[jt]}},{key:"xrayedObjectIds",get:function(){return b(this,gt)[gt]||(b(this,gt)[gt]=Object.keys(this.xrayedObjects)),b(this,gt)[gt]}},{key:"numHighlightedObjects",get:function(){return b(this,Ot)[Ot]}},{key:"highlightedObjectIds",get:function(){return b(this,Pt)[Pt]||(b(this,Pt)[Pt]=Object.keys(this.highlightedObjects)),b(this,Pt)[Pt]}},{key:"numSelectedObjects",get:function(){return b(this,mt)[mt]}},{key:"selectedObjectIds",get:function(){return b(this,kt)[kt]||(b(this,kt)[kt]=Object.keys(this.selectedObjects)),b(this,kt)[kt]}},{key:"numColorizedObjects",get:function(){return b(this,xt)[xt]}},{key:"colorizedObjectIds",get:function(){return b(this,Mt)[Mt]||(b(this,Mt)[Mt]=Object.keys(this.colorizedObjects)),b(this,Mt)[Mt]}},{key:"opacityObjectIds",get:function(){return b(this,At)[At]||(b(this,At)[At]=Object.keys(this.opacityObjects)),b(this,At)[At]}},{key:"numOpacityObjects",get:function(){return b(this,It)[It]}}]),i}(t);function Ut(){var t=this,e=this.viewer.scene.models;for(var i in e){var r=e[i];b(this,Vt)[Vt](r)}this.viewer.scene.onModelCreated.subscribe(function(e,i){b(t,Vt)[Vt](i)}),this.viewer.scene.onModelDestroyed.subscribe(function(e,i){b(t,Ct)[Ct](i)})}function Tt(t){var e=t.objects;for(var i in e){var r=this.viewer.renderer.rendererViewObjects[i];if(r.layerId==this.id){var n=new rt(this,e[i],r);this.objects[n.id]=n,b(this,yt)[yt]++,b(this,pt)[pt]=null}}}function zt(t){var e=t.objects;for(var i in e)this.objects[e[i].id]._destroy(),b(this,yt)[yt]--,b(this,pt)[pt]=null}var Ft=/*#__PURE__*/p("state"),_t=/*#__PURE__*/function(t){function e(e,i){var r;return void 0===i&&(i={}),(r=t.call(this,e,i)||this).view=void 0,Object.defineProperty(f(r),Ft,{writable:!0,value:void 0}),r.view=e,b(f(r),Ft)[Ft]={fill:!!i.fill,fillColor:new Float32Array(i.fillColor||[.4,.4,.4]),fillAlpha:null!=i.fillAlpha?i.fillAlpha:.2,edges:!1!==i.edges,edgeColor:new Float32Array(i.edgeColor||[.2,.2,.2]),edgeAlpha:null!=i.edgeAlpha?i.edgeAlpha:.5,edgeWidth:null!=i.edgeWidth?i.edgeWidth:1,backfaces:!!i.backfaces},r}return u(e,t),e.prototype.destroy=function(){t.prototype.destroy.call(this)},d(e,[{key:"fill",get:function(){return b(this,Ft)[Ft].fill},set:function(t){b(this,Ft)[Ft].fill!==t&&(b(this,Ft)[Ft].fill=t,this.view.redraw())}},{key:"fillColor",get:function(){return b(this,Ft)[Ft].fillColor},set:function(t){var e=b(this,Ft)[Ft].fillColor;e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]||(e[0]=.4,e[1]=.4,e[2]=.4,this.view.redraw())}},{key:"fillAlpha",get:function(){return b(this,Ft)[Ft].fillAlpha},set:function(t){b(this,Ft)[Ft].fillAlpha!==t&&(b(this,Ft)[Ft].fillAlpha=t,this.view.redraw())}},{key:"edges",get:function(){return b(this,Ft)[Ft].edges},set:function(t){b(this,Ft)[Ft].edges!==t&&(b(this,Ft)[Ft].edges=t,this.view.redraw())}},{key:"edgeColor",get:function(){return b(this,Ft)[Ft].edgeColor},set:function(t){var e=b(this,Ft)[Ft].edgeColor;e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]||(e[0]=.2,e[1]=.2,e[2]=.2,this.view.redraw())}},{key:"edgeAlpha",get:function(){return b(this,Ft)[Ft].edgeAlpha},set:function(t){b(this,Ft)[Ft].edgeAlpha!==t&&(b(this,Ft)[Ft].edgeAlpha=t,this.view.redraw())}},{key:"edgeWidth",get:function(){return b(this,Ft)[Ft].edgeWidth},set:function(t){b(this,Ft)[Ft].edgeWidth=t,this.view.redraw()}},{key:"backfaces",get:function(){return b(this,Ft)[Ft].backfaces},set:function(t){b(this,Ft)[Ft].backfaces!==t&&(b(this,Ft)[Ft].backfaces=t,this.view.redraw())}},{key:"hash",get:function(){return""}}]),e}(t),Rt=/*#__PURE__*/p("state"),Wt=/*#__PURE__*/function(t){function e(e,i){var r;return void 0===i&&(i={}),(r=t.call(this,e,i)||this).view=void 0,Object.defineProperty(f(r),Rt,{writable:!0,value:void 0}),r.view=e,b(f(r),Rt)[Rt]={renderModes:i.renderModes||[I],edges:!1!==i.edges,edgeColor:new Float32Array(i.edgeColor||[.2,.2,.2]),edgeAlpha:null!=i.edgeAlpha?i.edgeAlpha:.5,edgeWidth:null!=i.edgeWidth?i.edgeWidth:1},r}return u(e,t),e.prototype.destroy=function(){t.prototype.destroy.call(this)},d(e,[{key:"renderModes",get:function(){return b(this,Rt)[Rt].renderModes},set:function(t){b(this,Rt)[Rt].renderModes=t,this.view.redraw()}},{key:"edges",get:function(){return b(this,Rt)[Rt].edges},set:function(t){b(this,Rt)[Rt].edges!==t&&(b(this,Rt)[Rt].edges=t,this.view.redraw())}},{key:"edgeColor",get:function(){return b(this,Rt)[Rt].edgeColor},set:function(t){var e=b(this,Rt)[Rt].edgeColor;t&&e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]||(e[0]=.2,e[1]=.2,e[2]=.2,this.view.redraw())}},{key:"edgeAlpha",get:function(){return b(this,Rt)[Rt].edgeAlpha},set:function(t){b(this,Rt)[Rt].edgeAlpha!==t&&(b(this,Rt)[Rt].edgeAlpha=t,this.view.redraw())}},{key:"edgeWidth",get:function(){return b(this,Rt)[Rt].edgeWidth},set:function(t){b(this,Rt)[Rt].edgeWidth!==t&&(b(this,Rt)[Rt].edgeWidth=t,this.view.redraw())}}]),e}(t),Et=/*#__PURE__*/p("state"),Ht=/*#__PURE__*/function(t){function e(e,i){var r;return void 0===i&&(i={}),(r=t.call(this,e,i)||this).view=void 0,Object.defineProperty(f(r),Et,{writable:!0,value:void 0}),r.view=e,b(f(r),Et)[Et]={pointSize:null!=i.pointSize?i.pointSize:1,roundPoints:!1!==i.roundPoints,perspectivePoints:!1!==i.perspectivePoints,minPerspectivePointSize:null!=i.minPerspectivePointSize?i.minPerspectivePointSize:1,maxPerspectivePointSize:null!=i.maxPerspectivePointSize?i.maxPerspectivePointSize:6,filterIntensity:!!i.filterIntensity,minIntensity:null!=i.minIntensity?i.minIntensity:0,maxIntensity:null!=i.maxIntensity?i.maxIntensity:1},r}return u(e,t),e.prototype.destroy=function(){t.prototype.destroy.call(this)},d(e,[{key:"pointSize",get:function(){return b(this,Et)[Et].pointSize},set:function(t){b(this,Et)[Et].pointSize=t,this.view.redraw()}},{key:"roundPoints",get:function(){return b(this,Et)[Et].roundPoints},set:function(t){b(this,Et)[Et].roundPoints!==t&&(b(this,Et)[Et].roundPoints=t,this.view.rebuild())}},{key:"perspectivePoints",get:function(){return b(this,Et)[Et].perspectivePoints},set:function(t){b(this,Et)[Et].perspectivePoints!==t&&(b(this,Et)[Et].perspectivePoints=t,this.view.rebuild())}},{key:"minPerspectivePointSize",get:function(){return b(this,Et)[Et].minPerspectivePointSize},set:function(t){b(this,Et)[Et].minPerspectivePointSize!==t&&(b(this,Et)[Et].minPerspectivePointSize=t,this.view.rebuild())}},{key:"maxPerspectivePointSize",get:function(){return b(this,Et)[Et].maxPerspectivePointSize},set:function(t){b(this,Et)[Et].maxPerspectivePointSize!==t&&(b(this,Et)[Et].maxPerspectivePointSize=t,this.view.rebuild())}},{key:"filterIntensity",get:function(){return b(this,Et)[Et].filterIntensity},set:function(t){b(this,Et)[Et].filterIntensity!==t&&(b(this,Et)[Et].filterIntensity=t,this.view.rebuild())}},{key:"minIntensity",get:function(){return b(this,Et)[Et].minIntensity},set:function(t){b(this,Et)[Et].minIntensity!==t&&(b(this,Et)[Et].minIntensity=t,this.view.redraw())}},{key:"maxIntensity",get:function(){return b(this,Et)[Et].maxIntensity},set:function(t){b(this,Et)[Et].maxIntensity!==t&&(b(this,Et)[Et].maxIntensity=t,this.view.redraw())}},{key:"hash",get:function(){var t=b(this,Et)[Et];return t.pointSize+";\n        "+t.roundPoints+";\n        "+t.perspectivePoints+";\n        "+t.minPerspectivePointSize+";\n        "+t.maxPerspectivePointSize+";\n        "+t.filterIntensity}}]),e}(t),qt=/*#__PURE__*/p("state"),Xt=/*#__PURE__*/p("inverseMatrixDirty"),Bt=/*#__PURE__*/p("transposedProjMatrixDirty"),Nt=/*#__PURE__*/p("onViewBoundary"),Gt=/*#__PURE__*/function(t){function i(i,n){var s;return void 0===n&&(n={}),(s=t.call(this,i,n)||this).camera=void 0,s.onProjMatrix=void 0,Object.defineProperty(f(s),qt,{writable:!0,value:void 0}),Object.defineProperty(f(s),Xt,{writable:!0,value:void 0}),Object.defineProperty(f(s),Bt,{writable:!0,value:void 0}),Object.defineProperty(f(s),Nt,{writable:!0,value:void 0}),s.camera=i,b(f(s),qt)[qt]={near:n.near||.1,far:n.far||2e3,fov:n.fov||60,fovAxis:n.fovAxis||"min",projMatrix:q(),inverseProjMatrix:q(),transposedProjMatrix:q()},b(f(s),Xt)[Xt]=!0,b(f(s),Bt)[Bt]=!0,b(f(s),Nt)[Nt]=s.camera.view.onBoundary.subscribe(function(){s.setDirty()}),s.onProjMatrix=new e(new r),s}u(i,t);var n=i.prototype;return n.clean=function(){var t=this.camera.view.boundary,e=t[2]/t[3],i=b(this,qt)[qt].fovAxis,r=b(this,qt)[qt].fov;("x"===i||"min"===i&&e<1||"max"===i&&e>1)&&(r/=e),function(t,e,i,r,n){var s=[],o=[];s[2]=i,o[2]=r,o[1]=s[2]*Math.tan(t/2),s[1]=-o[1],o[0]=o[1]*e,s[0]=-o[0],function(t,e,i){i||(i=q());var r=[t[0],t[1],t[2],0],n=[e[0],e[1],e[2],0];(function(t,e,i){i||(i=t),i[0]=t[0]+e[0],i[1]=t[1]+e[1],i[2]=t[2]+e[2],i[3]=t[3]+e[3]})(n,r,X),function(t,e,i){i||(i=t),i[0]=t[0]-e[0],i[1]=t[1]-e[1],i[2]=t[2]-e[2],i[3]=t[3]-e[3]}(n,r,B);var s=2*r[2],o=B[0],h=B[1],a=B[2];i[0]=s/o,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=s/h,i[6]=0,i[7]=0,i[8]=X[0]/o,i[9]=X[1]/h,i[10]=-X[2]/a,i[11]=-1,i[12]=0,i[13]=0,i[14]=-s*n[2]/a,i[15]=0}(s,o,n)}((r=Math.min(r,120))*(Math.PI/180),e,b(this,qt)[qt].near,b(this,qt)[qt].far,b(this,qt)[qt].projMatrix),b(this,Xt)[Xt]=!0,b(this,Bt)[Bt]=!0,this.camera.view.redraw(),this.onProjMatrix.dispatch(this,b(this,qt)[qt].projMatrix)},n.unproject=function(t,e,i,r,n){var s=this.camera.view.canvasElement,o=s.offsetWidth/2,h=s.offsetHeight/2;return i[0]=(t[0]-o)/o,i[1]=(t[1]-h)/h,i[2]=e,i[3]=1,J(this.inverseProjMatrix,i,r),z(r,1/r[3]),r[3]=1,r[1]*=-1,J(this.camera.inverseViewMatrix,r,n),n},n.destroy=function(){t.prototype.destroy.call(this),this.camera.view.onBoundary.unsubscribe(b(this,Nt)[Nt]),this.onProjMatrix.clear()},d(i,[{key:"fov",get:function(){return b(this,qt)[qt].fov},set:function(t){t!==b(this,qt)[qt].fov&&(b(this,qt)[qt].fov=t,this.setDirty())}},{key:"fovAxis",get:function(){return b(this,qt)[qt].fovAxis},set:function(t){t=t||"min",b(this,qt)[qt].fovAxis!==t&&("x"!==t&&"y"!==t&&"min"!==t&&(this.error("Unsupported value for 'fovAxis': "+t+" - defaulting to 'min'"),t="min"),b(this,qt)[qt].fovAxis=t,this.setDirty())}},{key:"near",get:function(){return b(this,qt)[qt].near},set:function(t){b(this,qt)[qt].near!==t&&(b(this,qt)[qt].near=t,this.setDirty())}},{key:"far",get:function(){return b(this,qt)[qt].far},set:function(t){b(this,qt)[qt].far!==t&&(b(this,qt)[qt].far=t,this.setDirty())}},{key:"projMatrix",get:function(){return this.dirty&&this.cleanIfDirty(),b(this,qt)[qt].projMatrix}},{key:"inverseProjMatrix",get:function(){return this.dirty&&this.cleanIfDirty(),b(this,Xt)[Xt]&&(Y(b(this,qt)[qt].projMatrix,b(this,qt)[qt].inverseProjMatrix),b(this,Xt)[Xt]=!1),b(this,qt)[qt].inverseProjMatrix}},{key:"transposedProjMatrix",get:function(){return this.dirty&&this.cleanIfDirty(),b(this,Bt)[Bt]&&($(b(this,qt)[qt].projMatrix,b(this,qt)[qt].transposedProjMatrix),b(this,Bt)[Bt]=!1),b(this,qt)[qt].transposedProjMatrix}}]),i}(t);Gt.type=D;var Qt=/*#__PURE__*/p("state"),Yt=/*#__PURE__*/p("inverseMatrixDirty"),$t=/*#__PURE__*/p("transposedProjMatrixDirty"),Jt=/*#__PURE__*/p("onViewBoundary"),Kt=/*#__PURE__*/function(t){function i(i,n){var s;return void 0===n&&(n={}),(s=t.call(this,i,n)||this).camera=void 0,s.onProjMatrix=void 0,Object.defineProperty(f(s),Qt,{writable:!0,value:void 0}),Object.defineProperty(f(s),Yt,{writable:!0,value:void 0}),Object.defineProperty(f(s),$t,{writable:!0,value:void 0}),Object.defineProperty(f(s),Jt,{writable:!0,value:void 0}),s.camera=i,b(f(s),Qt)[Qt]={near:n.near||.1,far:n.far||2e3,scale:n.scale||1,projMatrix:q(),inverseProjMatrix:q(),transposedProjMatrix:q()},s.onProjMatrix=new e(new r),b(f(s),Yt)[Yt]=!0,b(f(s),$t)[$t]=!0,b(f(s),Jt)[Jt]=s.camera.view.onBoundary.subscribe(function(){s.setDirty()}),s}u(i,t);var n=i.prototype;return n.clean=function(){var t,e,i,r,n=this.camera.view,s=.5*b(this,Qt)[Qt].scale,o=n.boundary,h=o[2],a=o[3],c=h/a;h>a?(t=-s,e=s,i=s/c,r=-s/c):(t=-s*c,e=s*c,i=s,r=-s),function(t,e,i,r,n,s,o){o||(o=q());var h=e-t,a=r-i,c=s-n;o[0]=2/h,o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[5]=2/a,o[6]=0,o[7]=0,o[8]=0,o[9]=0,o[10]=-2/c,o[11]=0,o[12]=-(t+e)/h,o[13]=-(r+i)/a,o[14]=-(s+n)/c,o[15]=1}(t,e,r,i,b(this,Qt)[Qt].near,b(this,Qt)[Qt].far,b(this,Qt)[Qt].projMatrix),b(this,Yt)[Yt]=!0,b(this,$t)[$t]=!0,this.camera.view.redraw(),this.onProjMatrix.dispatch(this,b(this,Qt)[Qt].projMatrix)},n.unproject=function(t,e,i,r,n){var s=this.camera.view.canvasElement,o=s.offsetWidth/2,h=s.offsetHeight/2;return i[0]=(t[0]-o)/o,i[1]=(t[1]-h)/h,i[2]=e,i[3]=1,J(this.inverseProjMatrix,i,r),z(r,1/r[3]),r[3]=1,r[1]*=-1,J(this.camera.inverseViewMatrix,r,n),n},n.destroy=function(){t.prototype.destroy.call(this),this.camera.view.onBoundary.unsubscribe(b(this,Jt)[Jt]),this.onProjMatrix.clear()},d(i,[{key:"scale",get:function(){return b(this,Qt)[Qt].scale},set:function(t){t<=0&&(t=.01),b(this,Qt)[Qt].scale=t,this.setDirty()}},{key:"near",get:function(){return b(this,Qt)[Qt].near},set:function(t){b(this,Qt)[Qt].near!==t&&(b(this,Qt)[Qt].near=t,this.setDirty())}},{key:"far",get:function(){return b(this,Qt)[Qt].far},set:function(t){b(this,Qt)[Qt].far!==t&&(b(this,Qt)[Qt].far=t,this.setDirty())}},{key:"projMatrix",get:function(){return this.dirty&&this.cleanIfDirty(),b(this,Qt)[Qt].projMatrix}},{key:"inverseProjMatrix",get:function(){return this.dirty&&this.cleanIfDirty(),b(this,Yt)[Yt]&&(Y(b(this,Qt)[Qt].projMatrix,b(this,Qt)[Qt].inverseProjMatrix),b(this,Yt)[Yt]=!1),b(this,Qt)[Qt].inverseProjMatrix}},{key:"transposedProjMatrix",get:function(){return this.dirty&&this.cleanIfDirty(),b(this,$t)[$t]&&($(b(this,Qt)[Qt].projMatrix,b(this,Qt)[Qt].transposedProjMatrix),b(this,$t)[$t]=!1),b(this,Qt)[Qt].transposedProjMatrix}}]),i}(t);Kt.type=S;var Zt=/*#__PURE__*/p("state"),te=/*#__PURE__*/p("inverseProjMatrixDirty"),ee=/*#__PURE__*/p("transposedProjMatrixDirty"),ie=/*#__PURE__*/function(t){function i(i,n){var s;return void 0===n&&(n={}),(s=t.call(this,i,n)||this).camera=void 0,s.onProjMatrix=void 0,Object.defineProperty(f(s),Zt,{writable:!0,value:void 0}),Object.defineProperty(f(s),te,{writable:!0,value:void 0}),Object.defineProperty(f(s),ee,{writable:!0,value:void 0}),s.camera=i,b(f(s),Zt)[Zt]={projMatrix:q(n.projMatrix||N()),inverseProjMatrix:q(),transposedProjMatrix:q()},s.onProjMatrix=new e(new r),b(f(s),te)[te]=!0,b(f(s),ee)[ee]=!1,s}u(i,t);var n=i.prototype;return n.unproject=function(t,e,i,r,n){var s=this.camera.view.canvasElement,o=s.offsetWidth/2,h=s.offsetHeight/2;return i[0]=(t[0]-o)/o,i[1]=(t[1]-h)/h,i[2]=e,i[3]=1,J(this.inverseProjMatrix,i,r),z(r,1/r[3]),r[3]=1,r[1]*=-1,J(this.camera.inverseViewMatrix,r,n),n},n.destroy=function(){t.prototype.destroy.call(this),this.onProjMatrix.clear()},d(i,[{key:"projMatrix",get:function(){return b(this,Zt)[Zt].projMatrix},set:function(t){b(this,Zt)[Zt].projMatrix.set(t),b(this,te)[te]=!0,b(this,ee)[ee]=!0,this.setDirty(),this.camera.view.redraw(),this.onProjMatrix.dispatch(this,b(this,Zt)[Zt].projMatrix)}},{key:"inverseProjMatrix",get:function(){return this.dirty&&this.cleanIfDirty(),b(this,te)[te]&&(Y(b(this,Zt)[Zt].projMatrix,b(this,Zt)[Zt].inverseProjMatrix),b(this,te)[te]=!1),b(this,Zt)[Zt].inverseProjMatrix}},{key:"transposedProjMatrix",get:function(){return this.dirty&&this.cleanIfDirty(),b(this,ee)[ee]&&($(b(this,Zt)[Zt].projMatrix,b(this,Zt)[Zt].transposedProjMatrix),b(this,ee)[ee]=!1),b(this,Zt)[Zt].transposedProjMatrix}}]),i}(t);ie.type=C;var re,ne,se,oe=q(),he=(re=s(3),ne=s(3),se=s(3),function(t){return re[0]=t[0],re[1]=t[1],re[2]=t[2],ne[0]=t[3],ne[1]=t[4],ne[2]=t[5],_(ne,re,se),Math.abs(W(se))}),ae=function(){var t=s(3),e=s(3),i=s(3);return function(r,n){t[0]=r[0],t[1]=r[1],t[2]=r[2],e[0]=r[3],e[1]=r[4],e[2]=r[5];var s=_(e,t,i),o=n[0]-r[0],h=r[3]-n[0],a=n[1]-r[1],c=r[4]-n[1],l=n[2]-r[2],d=r[5]-n[2];return s[0]+=o>h?o:h,s[1]+=a>c?a:c,s[2]+=l>d?l:d,Math.abs(W(s))}}();function ce(t,e){return void 0===e&&(e=U()),e[0]=(t[0]+t[3])/2,e[1]=(t[1]+t[4])/2,e[2]=(t[2]+t[5])/2,e}s(3);var le=/*#__PURE__*/function(){function t(){this.testVertex=void 0,this.offset=void 0,this.normal=void 0,this.normal=U(),this.offset=0,this.testVertex=U()}return t.prototype.set=function(t,e,i,r){var n=1/Math.sqrt(t*t+e*e+i*i);this.normal[0]=t*n,this.normal[1]=e*n,this.normal[2]=i*n,this.offset=r*n,this.testVertex[0]=this.normal[0]>=0?1:0,this.testVertex[1]=this.normal[1]>=0?1:0,this.testVertex[2]=this.normal[2]>=0?1:0},t}(),de=function(){this.planes=void 0,this.planes=[new le,new le,new le,new le,new le,new le]},ue=U(),ve=U(),fe=U(),ye=U(),pe=U(),be=U(),we=q(),je=q(),ge=U(),Oe=U(),Pe=U(),me=U(),ke=/*#__PURE__*/p("state"),xe=/*#__PURE__*/p("frustum"),Me=/*#__PURE__*/p("activeProjection"),Ie=/*#__PURE__*/function(t){function i(i,n){var s;return void 0===n&&(n={}),(s=t.call(this,i,n)||this).view=void 0,s.perspectiveProjection=void 0,s.orthoProjection=void 0,s.frustumProjection=void 0,s.customProjection=void 0,s.onProjectionType=void 0,s.onViewMatrix=void 0,s.onProjMatrix=void 0,s.onWorldAxis=void 0,s.onFrustum=void 0,Object.defineProperty(f(s),ke,{writable:!0,value:void 0}),Object.defineProperty(f(s),xe,{writable:!0,value:void 0}),Object.defineProperty(f(s),Me,{writable:!0,value:void 0}),s.onProjectionType=new e(new r),s.onViewMatrix=new e(new r),s.onProjMatrix=new e(new r),s.onWorldAxis=new e(new r),s.onFrustum=new e(new r),s.view=i,b(f(s),ke)[ke]={eye:U(n.eye||[0,0,10]),look:U(n.look||[0,0,0]),up:U(n.up||[0,1,0]),worldUp:U([0,1,0]),worldRight:U([1,0,0]),worldForward:U([0,0,-1]),worldAxis:new Float32Array(n.worldAxis||[1,0,0,0,1,0,0,0,1]),gimbalLock:!1!==n.gimbalLock,constrainPitch:!0===n.constrainPitch,projectionType:n.projectionType||D,deviceMatrix:n.deviceMatrix?q(n.deviceMatrix):N(),hasDeviceMatrix:!!n.deviceMatrix,viewMatrix:q(),viewNormalMatrix:q(),inverseViewMatrix:q()},b(f(s),xe)[xe]=new de,s.perspectiveProjection=new Gt(f(s)),s.orthoProjection=new Kt(f(s)),s.customProjection=new ie(f(s)),b(f(s),Me)[Me]=s.perspectiveProjection,s.perspectiveProjection.onProjMatrix.subscribe(function(){b(f(s),ke)[ke].projectionType===D&&s.onProjMatrix.dispatch(f(s),s.perspectiveProjection.projMatrix)}),s.orthoProjection.onProjMatrix.subscribe(function(){b(f(s),ke)[ke].projectionType===S&&s.onProjMatrix.dispatch(f(s),s.orthoProjection.projMatrix)}),s.frustumProjection.onProjMatrix.subscribe(function(){b(f(s),ke)[ke].projectionType===V&&s.onProjMatrix.dispatch(f(s),s.frustumProjection.projMatrix)}),s.customProjection.onProjMatrix.subscribe(function(){b(f(s),ke)[ke].projectionType===C&&s.onProjMatrix.dispatch(f(s),s.customProjection.projMatrix)}),s}u(i,t);var n=i.prototype;return n.clean=function(){var t,e=b(this,ke)[ke];this.projectionType===S?(_(b(this,ke)[ke].eye,b(this,ke)[ke].look,ge),H(ge,Oe),z(Oe,1e3,Pe),F(b(this,ke)[ke].look,Pe,me),t=me):t=b(this,ke)[ke].eye,e.hasDeviceMatrix?(Q(t,b(this,ke)[ke].look,b(this,ke)[ke].up,je),K(e.deviceMatrix,je,e.viewMatrix)):Q(t,b(this,ke)[ke].look,b(this,ke)[ke].up,e.viewMatrix),Y(b(this,ke)[ke].viewMatrix,b(this,ke)[ke].inverseViewMatrix),$(b(this,ke)[ke].inverseViewMatrix,b(this,ke)[ke].viewNormalMatrix),this.view.redraw(),function(t,e,i){var r=K(e,t,oe),n=r[0],s=r[1],o=r[2],h=r[3],a=r[4],c=r[5],l=r[6],d=r[7],u=r[8],v=r[9],f=r[10],y=r[11],p=r[12],b=r[13],w=r[14],j=r[15];(i=i||new de).planes[0].set(h-n,d-a,y-u,j-p),i.planes[1].set(h+n,d+a,y+u,j+p),i.planes[2].set(h-s,d-c,y-v,j-b),i.planes[3].set(h+s,d+c,y+v,j+b),i.planes[4].set(h-o,d-l,y-f,j-w),i.planes[5].set(h+o,d+l,y+f,j+w)}(b(this,ke)[ke].viewMatrix,b(this,Me)[Me].projMatrix,b(this,xe)[xe]),this.onViewMatrix.dispatch(this,b(this,ke)[ke].viewMatrix),this.onFrustum.dispatch(this,b(this,xe)[xe])},n.orbitYaw=function(t){var e=_(b(this,ke)[ke].eye,b(this,ke)[ke].look,ue);G(.0174532925*t,b(this,ke)[ke].gimbalLock?b(this,ke)[ke].worldUp:b(this,ke)[ke].up,we),e=Z(we,e,ve),this.eye=F(b(this,ke)[ke].look,e,fe),this.up=Z(we,b(this,ke)[ke].up,ye)},n.orbitPitch=function(t){if(!(b(this,ke)[ke].constrainPitch&&(t=L(b(this,ke)[ke].up,b(this,ke)[ke].worldUp)/a)<1)){var e=_(b(this,ke)[ke].eye,b(this,ke)[ke].look,ue);G(.0174532925*t,R(H(e,ve),H(b(this,ke)[ke].up,fe)),we),e=Z(we,e,ye),this.up=Z(we,b(this,ke)[ke].up,pe),this.eye=F(e,b(this,ke)[ke].look,be)}},n.yaw=function(t){var e=_(b(this,ke)[ke].look,b(this,ke)[ke].eye,ue);G(.0174532925*t,b(this,ke)[ke].gimbalLock?b(this,ke)[ke].worldUp:b(this,ke)[ke].up,we),e=Z(we,e,ve),this.look=F(e,b(this,ke)[ke].eye,fe),b(this,ke)[ke].gimbalLock&&(this.up=Z(we,b(this,ke)[ke].up,ye))},n.pitch=function(t){if(!(b(this,ke)[ke].constrainPitch&&(t=L(b(this,ke)[ke].up,b(this,ke)[ke].worldUp)/a)<1)){var e=_(b(this,ke)[ke].look,b(this,ke)[ke].eye,ue);G(.0174532925*t,R(H(e,ve),H(b(this,ke)[ke].up,fe)),we),this.up=Z(we,b(this,ke)[ke].up,be),e=Z(we,e,ye),this.look=F(e,b(this,ke)[ke].eye,pe)}},n.pan=function(t){var e,i=_(b(this,ke)[ke].eye,b(this,ke)[ke].look,ue),r=[0,0,0];0!==t[0]&&(e=z(R(H(i,[]),H(b(this,ke)[ke].up,ve)),t[0]),r[0]+=e[0],r[1]+=e[1],r[2]+=e[2]),0!==t[1]&&(e=z(H(b(this,ke)[ke].up,fe),t[1]),r[0]+=e[0],r[1]+=e[1],r[2]+=e[2]),0!==t[2]&&(e=z(H(i,ye),t[2]),r[0]+=e[0],r[1]+=e[1],r[2]+=e[2]),this.eye=F(b(this,ke)[ke].eye,r,pe),this.look=F(b(this,ke)[ke].look,r,be)},n.zoom=function(t){var e=_(b(this,ke)[ke].eye,b(this,ke)[ke].look,ue),i=Math.abs(W(e)),r=Math.abs(i+t);if(!(r<.5)){var n=H(e,fe);this.eye=F(b(this,ke)[ke].look,z(n,r),ye)}},n.destroy=function(){t.prototype.destroy.call(this),this.onProjectionType.clear(),this.onViewMatrix.clear(),this.onProjMatrix.clear(),this.onWorldAxis.clear()},d(i,[{key:"project",get:function(){return b(this,Me)[Me]}},{key:"eye",get:function(){return b(this,ke)[ke].eye},set:function(t){b(this,ke)[ke].eye.set(t),this.setDirty()}},{key:"look",get:function(){return b(this,ke)[ke].look},set:function(t){b(this,ke)[ke].look.set(t),this.setDirty()}},{key:"up",get:function(){return b(this,ke)[ke].up},set:function(t){b(this,ke)[ke].up.set(t),this.setDirty()}},{key:"worldUp",get:function(){return b(this,ke)[ke].worldUp}},{key:"worldRight",get:function(){return b(this,ke)[ke].worldRight}},{key:"worldForward",get:function(){return b(this,ke)[ke].worldForward}},{key:"constrainPitch",get:function(){return b(this,ke)[ke].constrainPitch},set:function(t){b(this,ke)[ke].constrainPitch=t}},{key:"gimbalLock",get:function(){return b(this,ke)[ke].gimbalLock},set:function(t){b(this,ke)[ke].gimbalLock=t}},{key:"worldAxis",get:function(){return b(this,ke)[ke].worldAxis},set:function(t){var e=b(this,ke)[ke];e.worldAxis.set(t),e.worldRight[0]=e.worldAxis[0],e.worldRight[1]=e.worldAxis[1],e.worldRight[2]=e.worldAxis[2],e.worldUp[0]=e.worldAxis[3],e.worldUp[1]=e.worldAxis[4],e.worldUp[2]=e.worldAxis[5],e.worldForward[0]=e.worldAxis[6],e.worldForward[1]=e.worldAxis[7],e.worldForward[2]=e.worldAxis[8],this.onWorldAxis.dispatch(this,e.worldAxis)}},{key:"deviceMatrix",get:function(){return b(this,ke)[ke].deviceMatrix},set:function(t){b(this,ke)[ke].deviceMatrix.set(t||[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),b(this,ke)[ke].hasDeviceMatrix=!!t,this.setDirty()}},{key:"xUp",get:function(){return b(this,ke)[ke].worldUp[0]>b(this,ke)[ke].worldUp[1]&&b(this,ke)[ke].worldUp[0]>b(this,ke)[ke].worldUp[2]}},{key:"yUp",get:function(){return b(this,ke)[ke].worldUp[1]>b(this,ke)[ke].worldUp[0]&&b(this,ke)[ke].worldUp[1]>b(this,ke)[ke].worldUp[2]}},{key:"zUp",get:function(){return b(this,ke)[ke].worldUp[2]>b(this,ke)[ke].worldUp[0]&&b(this,ke)[ke].worldUp[2]>b(this,ke)[ke].worldUp[1]}},{key:"eyeLookDist",get:function(){return W(_(b(this,ke)[ke].look,b(this,ke)[ke].eye,ue))}},{key:"viewMatrix",get:function(){return this.dirty&&this.cleanIfDirty(),b(this,ke)[ke].viewMatrix}},{key:"inverseViewMatrix",get:function(){return this.dirty&&this.cleanIfDirty(),b(this,ke)[ke].inverseViewMatrix}},{key:"projMatrix",get:function(){return b(this,Me)[Me].projMatrix}},{key:"frustum",get:function(){return this.dirty&&this.cleanIfDirty(),b(this,xe)[xe]}},{key:"projectionType",get:function(){return b(this,ke)[ke].projectionType},set:function(t){t=t||D,b(this,ke)[ke].projectionType!==t&&(t===D?b(this,Me)[Me]=this.perspectiveProjection:t===S?b(this,Me)[Me]=this.orthoProjection:t===V?b(this,Me)[Me]=this.frustumProjection:t===C?b(this,Me)[Me]=this.customProjection:(this.error("Unsupported value for 'projection': "+t+" defaulting to PerspectiveProjectionType"),b(this,Me)[Me]=this.perspectiveProjection,t=D),b(this,Me)[Me].clean(),b(this,ke)[ke].projectionType=t,this.clean(),this.onProjectionType.dispatch(this,b(this,ke)[ke].projectionType),this.onProjMatrix.dispatch(this,b(this,Me)[Me].projMatrix))}}]),i}(t),Ae={viewerId:"",time:0,startTime:0,prevTime:0,deltaTime:0},De=/*#__PURE__*/p("viewersRenderInfo"),Se=/*#__PURE__*/p("viewerIDMap"),Ve=/*#__PURE__*/p("taskQueue"),Ce=/*#__PURE__*/p("taskBudget"),Le=/*#__PURE__*/p("lastTime"),Ue=/*#__PURE__*/p("elapsedTime"),Te=/*#__PURE__*/p("runTasks"),ze=/*#__PURE__*/p("runTasksUntil"),Fe=/*#__PURE__*/p("fireTickEvents"),_e=/*#__PURE__*/p("renderViewers");function Re(t){b(this,ze)[ze](t+b(this,Ce)[Ce]),this.getNumTasks(),b(this,Ce)}function We(t){void 0===t&&(t=-1);for(var e=(new Date).getTime(),i=0;b(this,Ve)[Ve].length>0&&(t<0||e<t);){var r=b(this,Ve)[Ve].shift(),n=b(this,Ve)[Ve].shift();n?r.call(n):r(),e=(new Date).getTime(),i++}return i}function Ee(t){for(var e in Ae.time=t,qe.viewers)if(this.viewers.hasOwnProperty(e)){var i=this.viewers[e];Ae.viewerId=e,Ae.startTime=i.startTime,Ae.deltaTime=null!=Ae.prevTime?Ae.time-Ae.prevTime:0,i.onTick.dispatch(i,Ae)}Ae.prevTime=t}function He(){for(var t in this.viewers)if(this.viewers.hasOwnProperty(t)){var e=this.viewers[t],i=b(this,De)[De][t];i||(i=b(this,De)[De][t]={}),e.render({})}}var qe=new(/*#__PURE__*/function(){function t(){var t=this;Object.defineProperty(this,_e,{value:He}),Object.defineProperty(this,Fe,{value:Ee}),Object.defineProperty(this,ze,{value:We}),Object.defineProperty(this,Te,{value:Re}),this.viewers=void 0,Object.defineProperty(this,De,{writable:!0,value:{}}),Object.defineProperty(this,Se,{writable:!0,value:new m}),Object.defineProperty(this,Ve,{writable:!0,value:new k}),Object.defineProperty(this,Ce,{writable:!0,value:10}),Object.defineProperty(this,Le,{writable:!0,value:0}),Object.defineProperty(this,Ue,{writable:!0,value:0}),this.viewers={},requestAnimationFrame(function e(){var i=Date.now();b(t,Le)[Le]>0&&(b(t,Ue)[Ue]=i-b(t,Le)[Le]),b(t,Te)[Te](i),b(t,Fe)[Fe](i),b(t,_e)[_e](),b(t,Le)[Le]=i,requestAnimationFrame(e)})}var e=t.prototype;return e.registerViewer=function(t){if(t.id){if(this.viewers[t.id])return void console.error("[ERROR] Viewer "+x(t.id)+" already exists")}else t.id=b(this,Se)[Se].addItem({});this.viewers[t.id]=t,b(this,De)[De][t.id]={}},e.deregisterViewer=function(t){this.viewers[t.id]&&(b(this,Se)[Se].removeItem(t.id),delete this.viewers[t.id],delete b(this,De)[De][t.id])},e.scheduleTask=function(t,e){b(this,Ve)[Ve].push(t),b(this,Ve)[Ve].push(e)},e.getNumTasks=function(){return b(this,Ve)[Ve].length},t}()),Xe=U(),Be=U(),Ne=U(),Ge=U(),Qe=U(),Ye=/*#__PURE__*/p("duration"),$e=/*#__PURE__*/p("look1"),Je=/*#__PURE__*/p("eye1"),Ke=/*#__PURE__*/p("up1"),Ze=/*#__PURE__*/p("look2"),ti=/*#__PURE__*/p("eye2"),ei=/*#__PURE__*/p("up2"),ii=/*#__PURE__*/p("orthoScale1"),ri=/*#__PURE__*/p("orthoScale2"),ni=/*#__PURE__*/p("fit"),si=/*#__PURE__*/p("trail"),oi=/*#__PURE__*/p("flying"),hi=/*#__PURE__*/p("flyEyeLookUp"),ai=/*#__PURE__*/p("flyingEye"),ci=/*#__PURE__*/p("flyingLook"),li=/*#__PURE__*/p("callback"),di=/*#__PURE__*/p("callbackScope"),ui=/*#__PURE__*/p("time1"),vi=/*#__PURE__*/p("time2"),fi=/*#__PURE__*/p("flyingEyeLookUp"),yi=/*#__PURE__*/p("fitFOV"),pi=/*#__PURE__*/p("projection2"),bi=/*#__PURE__*/p("projMatrix1"),wi=/*#__PURE__*/p("projMatrix2"),ji=/*#__PURE__*/p("jumpTo"),gi=/*#__PURE__*/p("update"),Oi=/*#__PURE__*/p("ease"),Pi=/*#__PURE__*/p("easeInCubic"),mi=/*#__PURE__*/p("easeOutExpo"),ki=/*#__PURE__*/function(t){function i(i,n){var s;return s=t.call(this,i,n)||this,Object.defineProperty(f(s),gi,{value:Mi}),Object.defineProperty(f(s),ji,{value:xi}),s.view=void 0,s.camera=void 0,Object.defineProperty(f(s),Ye,{writable:!0,value:void 0}),Object.defineProperty(f(s),$e,{writable:!0,value:void 0}),Object.defineProperty(f(s),Je,{writable:!0,value:void 0}),Object.defineProperty(f(s),Ke,{writable:!0,value:void 0}),Object.defineProperty(f(s),Ze,{writable:!0,value:void 0}),Object.defineProperty(f(s),ti,{writable:!0,value:void 0}),Object.defineProperty(f(s),ei,{writable:!0,value:void 0}),Object.defineProperty(f(s),ii,{writable:!0,value:void 0}),Object.defineProperty(f(s),ri,{writable:!0,value:void 0}),Object.defineProperty(f(s),ni,{writable:!0,value:void 0}),Object.defineProperty(f(s),si,{writable:!0,value:void 0}),Object.defineProperty(f(s),oi,{writable:!0,value:void 0}),Object.defineProperty(f(s),hi,{writable:!0,value:void 0}),Object.defineProperty(f(s),ai,{writable:!0,value:void 0}),Object.defineProperty(f(s),ci,{writable:!0,value:void 0}),Object.defineProperty(f(s),li,{writable:!0,value:void 0}),Object.defineProperty(f(s),di,{writable:!0,value:void 0}),Object.defineProperty(f(s),ui,{writable:!0,value:void 0}),Object.defineProperty(f(s),vi,{writable:!0,value:void 0}),s.easing=void 0,Object.defineProperty(f(s),fi,{writable:!0,value:void 0}),Object.defineProperty(f(s),yi,{writable:!0,value:void 0}),Object.defineProperty(f(s),pi,{writable:!0,value:void 0}),Object.defineProperty(f(s),bi,{writable:!0,value:void 0}),Object.defineProperty(f(s),wi,{writable:!0,value:void 0}),s.onStarted=void 0,s.onStopped=void 0,s.onCancelled=void 0,s.view=i,s.camera=i.camera,b(f(s),$e)[$e]=U(),b(f(s),Je)[Je]=U(),b(f(s),Ke)[Ke]=U(),b(f(s),Ze)[Ze]=U(),b(f(s),ti)[ti]=U(),b(f(s),ei)[ei]=U(),b(f(s),ii)[ii]=1,b(f(s),ri)[ri]=1,b(f(s),oi)[oi]=!1,b(f(s),hi)[hi]=!1,b(f(s),ai)[ai]=!1,b(f(s),ci)[ci]=!1,b(f(s),li)[li]=null,b(f(s),di)[di]=null,b(f(s),ui)[ui]=null,b(f(s),vi)[vi]=null,s.easing=!0,b(f(s),si)[si]=!1,b(f(s),ni)[ni]=!0,b(f(s),Ye)[Ye]=500,s.onStarted=new e(new r),s.onStopped=new e(new r),s.onCancelled=new e(new r),s}u(i,t);var n=i.prototype;return n.flyTo=function(t,e){void 0===t&&(t={}),b(this,oi)[oi]&&this.stop(),b(this,oi)[oi]=!1,b(this,ai)[ai]=!1,b(this,ci)[ci]=!1,b(this,fi)[fi]=!1,b(this,li)[li]=e;var i,r,n,s,o=this.camera,h=!!t.projection&&t.projection!==o.projectionType;b(this,Je)[Je][0]=o.eye[0],b(this,Je)[Je][1]=o.eye[1],b(this,Je)[Je][2]=o.eye[2],b(this,$e)[$e][0]=o.look[0],b(this,$e)[$e][1]=o.look[1],b(this,$e)[$e][2]=o.look[2],b(this,Ke)[Ke][0]=o.up[0],b(this,Ke)[Ke][1]=o.up[1],b(this,Ke)[Ke][2]=o.up[2],b(this,ii)[ii]=o.orthoProjection.scale,b(this,ri)[ri]=t.orthoScale||b(this,ii)[ii],t.aabb?i=t.aabb:t.eye&&t.look||t.up?(r=t.eye,n=t.look,s=t.up):t.eye?r=t.eye:t.look?n=t.look:h||(i=this.view.aabb);var c=t.poi;if(i){if(i[3]<i[0]||i[4]<i[1]||i[5]<i[2])return;if(i[3]===i[0]&&i[4]===i[1]&&i[5]===i[2])return;var l=ce(i=i.slice());b(this,Ze)[Ze]=c||l;var d=H(_(b(this,Je)[Je],b(this,$e)[$e],Xe)),u=c?ae(i,c):he(i),v=t.fitFOV||b(this,yi)[yi],f=Math.abs(u/Math.tan(v*a));b(this,ri)[ri]=1.1*u,b(this,ti)[ti][0]=b(this,Ze)[Ze][0]+d[0]*f,b(this,ti)[ti][1]=b(this,Ze)[Ze][1]+d[1]*f,b(this,ti)[ti][2]=b(this,Ze)[Ze][2]+d[2]*f,b(this,ei)[ei][0]=b(this,Ke)[Ke][0],b(this,ei)[ei][1]=b(this,Ke)[Ke][1],b(this,ei)[ei][2]=b(this,Ke)[Ke][2],b(this,fi)[fi]=!0}else(r||n||s)&&(b(this,fi)[fi]=!!r&&!!n&&!!s,b(this,ai)[ai]=!!r&&!n,b(this,ci)[ci]=!!n&&!r,r&&(b(this,ti)[ti][0]=r[0],b(this,ti)[ti][1]=r[1],b(this,ti)[ti][2]=r[2]),n&&(b(this,Ze)[Ze][0]=n[0],b(this,Ze)[Ze][1]=n[1],b(this,Ze)[Ze][2]=n[2]),s&&(b(this,ei)[ei][0]=s[0],b(this,ei)[ei][1]=s[1],b(this,ei)[ei][2]=s[2]));h?(t.projection===S&&o.projectionType!==S&&(b(this,pi)[pi]=S,b(this,bi)[bi]=o.projMatrix.slice(),b(this,wi)[wi]=o.orthoProjection.projMatrix.slice(),o.projectionType=C),t.projection===D&&o.projectionType!==D&&(b(this,pi)[pi]=D,b(this,bi)[bi]=o.projMatrix.slice(),b(this,wi)[wi]=o.perspectiveProjection.projMatrix.slice(),o.projectionType=C)):b(this,pi)[pi]=null,this.onStarted.dispatch(this,null),b(this,ui)[ui]=Date.now(),b(this,vi)[vi]=b(this,ui)[ui]+(t.duration?1e3*t.duration:b(this,Ye)[Ye]),b(this,oi)[oi]=!0,qe.scheduleTask(b(this,gi)[gi],this)},n.jumpTo=function(t){b(this,ji)[ji](t)},n.stop=function(){if(b(this,oi)[oi]){b(this,oi)[oi]=!1,b(this,ui)[ui]=null,b(this,vi)[vi]=null,b(this,pi)[pi]&&(this.camera.projectionType=b(this,pi)[pi]);var t=b(this,li)[li];t&&(b(this,li)[li]=null,t()),this.onStopped.dispatch(this,null)}},n.cancel=function(){b(this,oi)[oi]&&(b(this,oi)[oi]=!1,b(this,ui)[ui]=null,b(this,vi)[vi]=null,b(this,li)[li]&&(b(this,li)[li]=null),this.onCancelled.dispatch(this,null))},n.destroy=function(){this.stop(),t.prototype.destroy.call(this),this.onStarted.clear(),this.onStopped.clear(),this.onCancelled.clear()},d(i,[{key:"duration",get:function(){return b(this,Ye)[Ye]/1e3},set:function(t){b(this,Ye)[Ye]=t?1e3*t:500,this.stop()}},{key:"fit",get:function(){return b(this,ni)[ni]},set:function(t){b(this,ni)[ni]=t}},{key:"fitFOV",get:function(){return b(this,yi)[yi]},set:function(t){b(this,yi)[yi]=t}},{key:"trail",get:function(){return b(this,si)[si]},set:function(t){b(this,si)[si]=t}}]),i}(t);function xi(t){b(this,oi)[oi]&&this.stop();var e,i,r,n,s=this.camera;t.aabb?e=t.aabb:t.eye||t.look||t.up?(i=t.eye,r=t.look,n=t.up):e=this.view.aabb;var o=t.poi;if(e){if(e[3]<=e[0]||e[4]<=e[1]||e[5]<=e[2])return;var h,c=o?ae(e,o):he(e);r=o||ce(e,r),b(this,si)[si]?_(s.look,r,Qe):_(s.eye,s.look,Qe),H(Qe),h=(void 0!==t.fit?t.fit:b(this,ni)[ni])?Math.abs(c/Math.tan((t.fitFOV||b(this,yi)[yi])*a)):W(_(s.eye,s.look,Xe)),z(Qe,h),s.eye=F(r,Qe,Xe),s.look=r,this.camera.orthoProjection.scale=1.1*c}else(i||r||n)&&(i&&(s.eye=i),r&&(s.look=r),n&&(s.up=n));t.projection&&(s.projectionType=t.projection)}function Mi(){if(b(this,oi)[oi]){var t=(Date.now()-b(this,ui)[ui])/(b(this,vi)[vi]-b(this,ui)[ui]),e=t>=1;t>1&&(t=1);var i=this.easing?b(ki,Oi)[Oi](t,0,1,1):t,r=this.camera;if(b(this,ai)[ai]||b(this,ci)[ci]?b(this,ai)[ai]?(_(r.eye,r.look,Qe),r.eye=E(i,0,1,b(this,Je)[Je],b(this,ti)[ti],Ne),r.look=_(Ne,Qe,Be)):b(this,ci)[ci]&&(r.look=E(i,0,1,b(this,$e)[$e],b(this,Ze)[Ze],Be),r.up=E(i,0,1,b(this,Ke)[Ke],b(this,ei)[ei],Ge)):b(this,fi)[fi]&&(r.eye=E(i,0,1,b(this,Je)[Je],b(this,ti)[ti],Ne),r.look=E(i,0,1,b(this,$e)[$e],b(this,Ze)[Ze],Be),r.up=E(i,0,1,b(this,Ke)[Ke],b(this,ei)[ei],Ge)),b(this,pi)[pi]){var n=b(this,pi)[pi]===S?b(ki,mi)[mi](t,0,1,1):b(ki,Pi)[Pi](t,0,1,1);r.customProjection.projMatrix=function(t,e,i,r,n,s){var o=q(),h=(t-0)/1;return o[0]=r[0]+h*(n[0]-r[0]),o[1]=r[1]+h*(n[1]-r[1]),o[2]=r[2]+h*(n[2]-r[2]),o[3]=r[3]+h*(n[3]-r[3]),o[4]=r[4]+h*(n[4]-r[4]),o[5]=r[5]+h*(n[5]-r[5]),o[6]=r[6]+h*(n[6]-r[6]),o[7]=r[7]+h*(n[7]-r[7]),o[8]=r[8]+h*(n[8]-r[8]),o[9]=r[9]+h*(n[9]-r[9]),o[10]=r[10]+h*(n[10]-r[10]),o[11]=r[11]+h*(n[11]-r[11]),o[12]=r[12]+h*(n[12]-r[12]),o[13]=r[13]+h*(n[13]-r[13]),o[14]=r[14]+h*(n[14]-r[14]),o[15]=r[15]+h*(n[15]-r[15]),o}(n,0,0,b(this,bi)[bi],b(this,wi)[wi])}else r.orthoProjection.scale=b(this,ii)[ii]+t*(b(this,ri)[ri]-b(this,ii)[ii]);if(e)return r.orthoProjection.scale=b(this,ri)[ri],void this.stop();qe.scheduleTask(b(this,gi)[gi],this)}}Object.defineProperty(ki,mi,{value:function(t,e,i,r){return i*(1-Math.pow(2,-10*t/r))+e}}),Object.defineProperty(ki,Pi,{value:function(t,e,i,r){return i*(t/=r)*t*t+e}}),Object.defineProperty(ki,Oi,{value:function(t,e,i,r){return-i*(t/=r)*(t-2)+e}});var Ii=/*#__PURE__*/p("onTick"),Ai=/*#__PURE__*/p("backgroundColor"),Di=/*#__PURE__*/p("backgroundColorFromAmbientLight"),Si=/*#__PURE__*/p("resolutionScale"),Vi=/*#__PURE__*/p("numObjects"),Ci=/*#__PURE__*/p("objectIds"),Li=/*#__PURE__*/p("numVisibleObjects"),Ui=/*#__PURE__*/p("visibleObjectIds"),Ti=/*#__PURE__*/p("numXRayedObjects"),zi=/*#__PURE__*/p("xrayedObjectIds"),Fi=/*#__PURE__*/p("numHighlightedObjects"),_i=/*#__PURE__*/p("highlightedObjectIds"),Ri=/*#__PURE__*/p("numSelectedObjects"),Wi=/*#__PURE__*/p("selectedObjectIds"),Ei=/*#__PURE__*/p("numColorizedObjects"),Hi=/*#__PURE__*/p("colorizedObjectIds"),qi=/*#__PURE__*/p("numOpacityObjects"),Xi=/*#__PURE__*/p("opacityObjectIds"),Bi=/*#__PURE__*/p("qualityRender"),Ni=/*#__PURE__*/p("lightsHash"),Gi=/*#__PURE__*/p("sectionPlanesHash"),Qi=/*#__PURE__*/p("registerSectionPlane"),Yi=/*#__PURE__*/p("deregisterSectionPlane"),$i=/*#__PURE__*/p("initObjects"),Ji=/*#__PURE__*/p("createObjects"),Ki=/*#__PURE__*/p("destroyObjects"),Zi=/*#__PURE__*/function(t){function i(i){var n;if(n=t.call(this,null,i)||this,Object.defineProperty(f(n),Ki,{value:nr}),Object.defineProperty(f(n),Ji,{value:rr}),Object.defineProperty(f(n),$i,{value:ir}),Object.defineProperty(f(n),Yi,{value:er}),Object.defineProperty(f(n),Qi,{value:tr}),n.viewIndex=void 0,n.camera=void 0,n.canvasElement=void 0,n.transparent=void 0,n.boundary=void 0,n.logarithmicDepthBufferEnabled=void 0,n.sao=void 0,n.cameraFlight=void 0,n.metrics=void 0,n.xrayMaterial=void 0,n.highlightMaterial=void 0,n.selectedMaterial=void 0,n.edgeMaterial=void 0,n.pointsMaterial=void 0,n.linesMaterial=void 0,n.objects=void 0,n.visibleObjects=void 0,n.xrayedObjects=void 0,n.highlightedObjects=void 0,n.selectedObjects=void 0,n.colorizedObjects=void 0,n.opacityObjects=void 0,n.sectionPlanes=void 0,n.sectionPlanesList=[],n.lights=void 0,n.lightsList=[],n.gammaOutput=void 0,n.layers=void 0,n.autoLayers=void 0,n.onBoundary=void 0,n.onObjectVisibility=void 0,n.onObjectXRayed=void 0,n.onLayerCreated=void 0,n.onLayerDestroyed=void 0,n.onSectionPlaneCreated=void 0,n.onSectionPlaneDestroyed=void 0,Object.defineProperty(f(n),Ii,{writable:!0,value:void 0}),Object.defineProperty(f(n),Ai,{writable:!0,value:void 0}),Object.defineProperty(f(n),Di,{writable:!0,value:void 0}),Object.defineProperty(f(n),Si,{writable:!0,value:void 0}),Object.defineProperty(f(n),Vi,{writable:!0,value:void 0}),Object.defineProperty(f(n),Ci,{writable:!0,value:void 0}),Object.defineProperty(f(n),Li,{writable:!0,value:void 0}),Object.defineProperty(f(n),Ui,{writable:!0,value:void 0}),Object.defineProperty(f(n),Ti,{writable:!0,value:void 0}),Object.defineProperty(f(n),zi,{writable:!0,value:void 0}),Object.defineProperty(f(n),Fi,{writable:!0,value:void 0}),Object.defineProperty(f(n),_i,{writable:!0,value:void 0}),Object.defineProperty(f(n),Ri,{writable:!0,value:void 0}),Object.defineProperty(f(n),Wi,{writable:!0,value:void 0}),Object.defineProperty(f(n),Ei,{writable:!0,value:void 0}),Object.defineProperty(f(n),Hi,{writable:!0,value:void 0}),Object.defineProperty(f(n),qi,{writable:!0,value:void 0}),Object.defineProperty(f(n),Xi,{writable:!0,value:void 0}),Object.defineProperty(f(n),Bi,{writable:!0,value:void 0}),Object.defineProperty(f(n),Ni,{writable:!0,value:null}),Object.defineProperty(f(n),Gi,{writable:!0,value:null}),n.viewer=i.viewer,!((i.canvasElement||document.getElementById(i.canvasId))instanceof HTMLCanvasElement))throw"Mandatory View config expected: valid canvasId or canvasElement";n.viewIndex=0,n.objects={},n.visibleObjects={},n.xrayedObjects={},n.highlightedObjects={},n.selectedObjects={},n.colorizedObjects={},n.opacityObjects={},n.sectionPlanes={},n.sectionPlanesList=[],n.lights={},n.lightsList=[],n.layers={},b(f(n),Vi)[Vi]=0,b(f(n),Ci)[Ci]=null,b(f(n),Li)[Li]=0,b(f(n),Ui)[Ui]=null,b(f(n),Ti)[Ti]=0,b(f(n),zi)[zi]=null,b(f(n),Fi)[Fi]=0,b(f(n),_i)[_i]=null,b(f(n),Ri)[Ri]=0,b(f(n),Wi)[Wi]=null,b(f(n),Ei)[Ei]=0,b(f(n),Hi)[Hi]=null,b(f(n),qi)[qi]=0,b(f(n),Xi)[Xi]=null,b(f(n),Bi)[Bi]=!!i.qualityRender,n.gammaOutput=!0,b(f(n),Gi)[Gi]=null,b(f(n),Ni)[Ni]=null,n.onBoundary=new e(new r),b(f(n),Si)[Si]=1,b(f(n),Ai)[Ai]=U([i.backgroundColor?i.backgroundColor[0]:1,i.backgroundColor?i.backgroundColor[1]:1,i.backgroundColor?i.backgroundColor[2]:1]),b(f(n),Di)[Di]=!!i.backgroundColorFromAmbientLight,n.canvasElement=i.canvasElement,n.transparent=!!i.transparent,n.canvasElement.width=n.canvasElement.clientWidth,n.canvasElement.height=n.canvasElement.clientHeight,n.boundary=[n.canvasElement.offsetLeft,n.canvasElement.offsetTop,n.canvasElement.clientWidth,n.canvasElement.clientHeight];var s=0,o=0,h=0,a=0,c=0,l=0,d=null,u=null;return b(f(n),Ii)[Ii]=n.viewer.onTick.subscribe(function(){var t=n.canvasElement,e=b(f(n),Si)[Si]!==u,i=window.innerWidth!==s||window.innerHeight!==o,r=t.clientWidth!==h||t.clientHeight!==a,v=t.offsetLeft!==c||t.offsetTop!==l,y=t.parentElement;if(e||i||r||v||y!==d){if(e||r||v){var p=t.clientWidth,w=t.clientHeight;(e||r)&&(t.width=Math.round(t.clientWidth*b(f(n),Si)[Si]),t.height=Math.round(t.clientHeight*b(f(n),Si)[Si]));var j=n.boundary;j[0]=t.offsetLeft,j[1]=t.offsetTop,j[2]=p,j[3]=w,e&&!r||n.onBoundary.dispatch(f(n),j),h=p,a=w}e&&(u=b(f(n),Si)[Si]),i&&(s=window.innerWidth,o=window.innerHeight),v&&(c=t.offsetLeft,l=t.offsetTop),d=y}}),n.camera=new Ie(f(n)),n.sao=new ut(f(n),{}),n.cameraFlight=new ki(f(n),{duration:.5}),n.metrics=new lt(f(n),{units:i.units,scale:i.scale,origin:i.origin}),n.xrayMaterial=new _t(f(n),{fill:!0,fillColor:[.9,.7,.6],fillAlpha:.4,edges:!0,edgeColor:[.5,.4,.4],edgeAlpha:1,edgeWidth:1}),n.highlightMaterial=new _t(f(n),{fill:!0,fillColor:[1,1,0],fillAlpha:.5,edges:!0,edgeColor:[.5,.4,.4],edgeAlpha:1,edgeWidth:1}),n.selectedMaterial=new _t(f(n),{fill:!0,fillColor:[0,1,0],fillAlpha:.5,edges:!0,edgeColor:[.4,.5,.4],edgeAlpha:1,edgeWidth:1}),n.edgeMaterial=new Wt(f(n),{edgeColor:[0,0,0],edgeAlpha:1,edgeWidth:1,edges:!0,renderModes:[I]}),n.pointsMaterial=new Ht(f(n),{pointSize:1,roundPoints:!0,perspectivePoints:!0,minPerspectivePointSize:1,maxPerspectivePointSize:6,filterIntensity:!1,minIntensity:0,maxIntensity:1}),n.linesMaterial=new ft(f(n),{lineWidth:1}),n.lights={},b(f(n),Bi)[Bi]=!!i.qualityRender,n.autoLayers=!1!==i.autoLayers,n.logarithmicDepthBufferEnabled=!!i.logarithmicDepthBufferEnabled,n.onObjectVisibility=new e(new r),n.onObjectXRayed=new e(new r),n.onLayerCreated=new e(new r),n.onLayerDestroyed=new e(new r),n.onSectionPlaneCreated=new e(new r),n.onSectionPlaneDestroyed=new e(new r),b(f(n),$i)[$i](),n}u(i,t);var n=i.prototype;return n.registerViewObject=function(t){this.objects[t.id]=t,b(this,Vi)[Vi]++,b(this,Ci)[Ci]=null},n.deregisterViewObject=function(t){delete this.objects[t.id],delete this.visibleObjects[t.id],delete this.xrayedObjects[t.id],delete this.highlightedObjects[t.id],delete this.selectedObjects[t.id],delete this.colorizedObjects[t.id],delete this.opacityObjects[t.id],b(this,Vi)[Vi]--,b(this,Ci)[Ci]=null},n.objectVisibilityUpdated=function(t,e,i){void 0===i&&(i=!0),e?(this.visibleObjects[t.id]=t,b(this,Li)[Li]++):(delete this.visibleObjects[t.id],b(this,Li)[Li]--),b(this,Ui)[Ui]=null,i&&this.onObjectVisibility.dispatch(this,t)},n.objectXRayedUpdated=function(t,e,i){void 0===i&&(i=!0),e?(this.xrayedObjects[t.id]=t,b(this,Ti)[Ti]++):(delete this.xrayedObjects[t.id],b(this,Ti)[Ti]--),b(this,zi)[zi]=null,i&&this.onObjectXRayed.dispatch(this,t)},n.objectHighlightedUpdated=function(t,e){e?(this.highlightedObjects[t.id]=t,b(this,Fi)[Fi]++):(delete this.highlightedObjects[t.id],b(this,Fi)[Fi]--),b(this,_i)[_i]=null},n.objectSelectedUpdated=function(t,e){e?(this.selectedObjects[t.id]=t,b(this,Ri)[Ri]++):(delete this.selectedObjects[t.id],b(this,Ri)[Ri]--),b(this,Wi)[Wi]=null},n.objectColorizeUpdated=function(t,e){e?(this.colorizedObjects[t.id]=t,b(this,Ei)[Ei]++):(delete this.colorizedObjects[t.id],b(this,Ei)[Ei]--),b(this,Hi)[Hi]=null},n.objectOpacityUpdated=function(t,e){e?(this.opacityObjects[t.id]=t,b(this,qi)[qi]++):(delete this.opacityObjects[t.id],b(this,qi)[qi]--),b(this,Xi)[Xi]=null},n.createSectionPlane=function(t){var e=this,i=t.id||M();this.sectionPlanes[i]&&(this.error('SectionPlane with ID "'+i+'" already exists - will randomly-generate ID'),i=M());var r=new st(this,t);return b(this,Qi)[Qi](r),r.onDestroyed.one(function(){b(e,Yi)[Yi](r)}),r},n.clearSectionPlanes=function(){for(var t=Object.keys(this.sectionPlanes),e=0,i=t.length;e<i;e++)this.sectionPlanes[t[e]].destroy();this.sectionPlanesList.length=0,b(this,Gi)[Gi]=null},n.getSectionPlanesHash=function(){if(b(this,Gi)[Gi])return b(this,Gi)[Gi];if(0===this.sectionPlanesList.length)return b(this,Gi)[Gi]=";";for(var t=[],e=0,i=this.sectionPlanesList.length;e<i;e++)t.push("cp");return t.push(";"),b(this,Gi)[Gi]=t.join(""),b(this,Gi)[Gi]},n.registerLight=function(t){this.lightsList.push(t),this.lights[t.id]=t,b(this,Ni)[Ni]=null,this.rebuild()},n.deregisterLight=function(t){for(var e=0,i=this.lightsList.length;e<i;e++)if(this.lightsList[e].id===t.id)return this.lightsList.splice(e,1),b(this,Ni)[Ni]=null,delete this.lights[t.id],void this.rebuild()},n.clearLights=function(){for(var t=Object.keys(this.lights),e=0,i=t.length;e<i;e++)this.lights[t[e]].destroy()},n.getLightsHash=function(){if(b(this,Ni)[Ni])return b(this,Ni)[Ni];if(0===this.lightsList.length)return b(this,Ni)[Ni]=";";for(var t=[],e=this.lightsList,i=0,r=e.length;i<r;i++){var n=e[i];t.push("/"),t.push(n.type),t.push("world"===n.space?"w":"v"),n.castsShadow&&t.push("sh")}return t.push(";"),b(this,Ni)[Ni]=t.join(""),b(this,Ni)[Ni]},n.rebuild=function(){this.viewer.renderer.needsRebuild(this.viewIndex)},n.redraw=function(){this.viewer.renderer.setImageDirty(this.viewIndex)},n.destroy=function(){this.viewer.onTick.unsubscribe(b(this,Ii)[Ii]),t.prototype.destroy.call(this),this.onObjectVisibility.clear(),this.onObjectXRayed.clear(),this.onLayerCreated.clear(),this.onLayerDestroyed.clear(),this.onSectionPlaneCreated.clear(),this.onSectionPlaneDestroyed.clear()},n.getAmbientColorAndIntensity=function(){return[0,0,0,1]},n.setObjectsVisible=function(t,e){return this.withObjects(t,function(t){var i=t.visible!==e;return t.visible=e,i})},n.setObjectsCollidable=function(t,e){return this.withObjects(t,function(t){var i=t.collidable!==e;return t.collidable=e,i})},n.setObjectsCulled=function(t,e){return this.withObjects(t,function(t){var i=t.culled!==e;return t.culled=e,i})},n.setObjectsSelected=function(t,e){return this.withObjects(t,function(t){var i=t.selected!==e;return t.selected=e,i})},n.setObjectsHighlighted=function(t,e){return this.withObjects(t,function(t){var i=t.highlighted!==e;return t.highlighted=e,i})},n.setObjectsXRayed=function(t,e){return this.withObjects(t,function(t){var i=t.xrayed!==e;return i&&(t.xrayed=e),i})},n.setObjectsColorized=function(t,e){return this.withObjects(t,function(t){t.colorize=e})},n.setObjectsOpacity=function(t,e){return this.withObjects(t,function(t){var i=t.opacity!==e;return i&&(t.opacity=e),i})},n.setObjectsPickable=function(t,e){return this.withObjects(t,function(t){var i=t.pickable!==e;return i&&(t.pickable=e),i})},n.setObjectsClippable=function(t,e){return this.withObjects(t,function(t){var i=t.clippable!==e;return i&&(t.clippable=e),i})},n.withObjects=function(t,e){for(var i=!1,r=0,n=t.length;r<n;r++){var s=this.objects[t[r]];s&&(i=e(s)||i)}return i},n.createLayer=function(t){var e=this,i=this.layers[t.id];return i||(i=new Lt({id:t.id,view:this,viewer:this.viewer}),this.layers[t.id]=i,this.onLayerCreated.dispatch(this,i),i.onDestroyed.one(function(){delete e.layers[i.id],e.onLayerDestroyed.dispatch(e,i)})),i.autoDestroy=!1,i},d(i,[{key:"aabb",get:function(){return this.viewer.scene.aabb}},{key:"backgroundColor",get:function(){return b(this,Ai)[Ai]},set:function(t){t?(b(this,Ai)[Ai][0]=t[0],b(this,Ai)[Ai][1]=t[1],b(this,Ai)[Ai][2]=t[2]):(b(this,Ai)[Ai][0]=1,b(this,Ai)[Ai][1]=1,b(this,Ai)[Ai][2]=1),this.redraw()}},{key:"backgroundColorFromAmbientLight",get:function(){return b(this,Di)[Di]},set:function(t){b(this,Di)[Di]=!1!==t}},{key:"resolutionScale",get:function(){return b(this,Si)[Si]},set:function(t){if((t=t||1)!==b(this,Si)[Si]){b(this,Si)[Si]=t;var e=this.canvasElement;e.width=Math.round(e.clientWidth*b(this,Si)[Si]),e.height=Math.round(e.clientHeight*b(this,Si)[Si]),this.redraw()}}},{key:"gammaFactor",get:function(){return 1}},{key:"qualityRender",get:function(){return b(this,Bi)[Bi]},set:function(t){b(this,Bi)[Bi]!==t&&(b(this,Bi)[Bi]=t,this.redraw())}},{key:"numObjects",get:function(){return b(this,Vi)[Vi]}},{key:"objectIds",get:function(){return b(this,Ci)[Ci]||(b(this,Ci)[Ci]=Object.keys(this.objects)),b(this,Ci)[Ci]}},{key:"numVisibleObjects",get:function(){return b(this,Li)[Li]}},{key:"visibleObjectIds",get:function(){return b(this,Ui)[Ui]||(b(this,Ui)[Ui]=Object.keys(this.visibleObjects)),b(this,Ui)[Ui]}},{key:"numXRayedObjects",get:function(){return b(this,Ti)[Ti]}},{key:"xrayedObjectIds",get:function(){return b(this,zi)[zi]||(b(this,zi)[zi]=Object.keys(this.xrayedObjects)),b(this,zi)[zi]}},{key:"numHighlightedObjects",get:function(){return b(this,Fi)[Fi]}},{key:"highlightedObjectIds",get:function(){return b(this,_i)[_i]||(b(this,_i)[_i]=Object.keys(this.highlightedObjects)),b(this,_i)[_i]}},{key:"numSelectedObjects",get:function(){return b(this,Ri)[Ri]}},{key:"selectedObjectIds",get:function(){return b(this,Wi)[Wi]||(b(this,Wi)[Wi]=Object.keys(this.selectedObjects)),b(this,Wi)[Wi]}},{key:"numColorizedObjects",get:function(){return b(this,Ei)[Ei]}},{key:"colorizedObjectIds",get:function(){return b(this,Hi)[Hi]||(b(this,Hi)[Hi]=Object.keys(this.colorizedObjects)),b(this,Hi)[Hi]}},{key:"opacityObjectIds",get:function(){return b(this,Xi)[Xi]||(b(this,Xi)[Xi]=Object.keys(this.opacityObjects)),b(this,Xi)[Xi]}},{key:"numOpacityObjects",get:function(){return b(this,qi)[qi]}}]),i}(t);function tr(t){this.sectionPlanesList.push(t),this.sectionPlanes[t.id]=t,b(this,Gi)[Gi]=null,this.rebuild(),this.onSectionPlaneCreated.dispatch(this,t)}function er(t){for(var e=0,i=this.sectionPlanesList.length;e<i;e++)if(this.sectionPlanesList[e].id===t.id)return this.sectionPlanesList.splice(e,1),b(this,Gi)[Gi]=null,delete this.sectionPlanes[t.id],this.rebuild(),void this.onSectionPlaneDestroyed.dispatch(this,t)}function ir(){var t=this;for(var e in this.viewer.scene.models)b(this,Ji)[Ji](this.viewer.scene.models[e]);this.viewer.scene.onModelCreated.subscribe(function(e,i){b(t,Ji)[Ji](i)}),this.viewer.scene.onModelDestroyed.subscribe(function(e,i){b(t,Ki)[Ki](i)})}function rr(t){var e=this,i=t.objects,r=this.viewer.renderer.rendererViewObjects,n=function(){var t=i[s],n=r[s],o="default",h=e.layers[o];if(!h){if(!e.autoLayers)return"continue";h=new Lt({id:o,view:e,viewer:e.viewer}),e.layers[o]=h,h.onDestroyed.one(function(){delete e.layers[h.id],e.onLayerDestroyed.dispatch(e,h)}),e.onLayerCreated.dispatch(e,h)}var a=new rt(h,t,n);h.registerViewObject(a),e.registerViewObject(a)};for(var s in i)n()}function nr(t){var e=t.objects;for(var i in e){var r=this.layers.default,n=this.objects[e[i].id];this.deregisterViewObject(n),r&&(r.deregisterViewObject(n),r.autoDestroy&&0===r.numObjects&&r.destroy())}}var sr=/*#__PURE__*/p("prefixMessageWithID"),or=/*#__PURE__*/p("registerView"),hr=/*#__PURE__*/p("deregisterView"),ar=/*#__PURE__*/function(t){function s(i){var s;return s=t.call(this,null,{})||this,Object.defineProperty(f(s),hr,{value:dr}),Object.defineProperty(f(s),or,{value:lr}),Object.defineProperty(f(s),sr,{value:cr}),s.capabilities=void 0,s.onTick=void 0,s.onViewCreated=void 0,s.onViewDestroyed=void 0,s.scene=void 0,s.views=void 0,s.viewList=void 0,s.numViews=void 0,s.startTime=(new Date).getTime(),s.renderer=void 0,s.onTick=new e(new r),s.onViewCreated=new e(new r),s.onViewDestroyed=new e(new r),s.id=i.id||M(),s.viewList=[],s.numViews=0,s.views={},s.destroyed=!1,s.capabilities={maxViews:0,astcSupported:!1,etc1Supported:!1,etc2Supported:!1,dxtSupported:!1,bptcSupported:!1,pvrtcSupported:!1},s.scene=i.scene||new n,s.renderer=i.renderer,s.renderer.getCapabilities(s.capabilities),s.renderer.init(f(s)),qe.registerViewer(f(s)),s}u(s,t);var o=s.prototype;return o.createView=function(t){var e=this;if(this.viewList.length>=this.capabilities.maxViews)return new i("Attempted to create too many Views with View.createView() - maximum of "+this.capabilities.maxViews+" is allowed");var r=t.id||M();if(this.views[r])return new i('View with ID "'+r+'" already exists');if(!((t.canvasElement||document.getElementById(t.canvasId))instanceof HTMLCanvasElement))return new i("Mandatory View config expected: valid canvasId or canvasElement");var n=new Zi(function(t,e){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);return e}({viewId:r,viewer:this},t));return b(this,or)[or](n),n.viewIndex=this.renderer.registerView(n),n.onDestroyed.one(function(){b(e,hr)[hr](n),e.renderer.deregisterView(n.viewIndex),e.onViewDestroyed.dispatch(e,n)}),this.onViewCreated.dispatch(this,n),this.log("View created: "+n.viewId),n},o.redraw=function(){for(var t in this.views)this.views[t].redraw()},o.log=function(t){t="[LOG] "+b(this,sr)[sr](t),window.console.log(t)},o.warn=function(t){t="[WARN] "+b(this,sr)[sr](t),window.console.warn(t)},o.error=function(t){t="[ERROR] "+b(this,sr)[sr](t),window.console.error(t)},o.destroy=function(){if(!this.destroyed){for(var t in qe.deregisterViewer(this),this.views)this.views[t].destroy();this.onTick.clear(),this.onViewCreated.clear(),this.onViewDestroyed.clear()}},o.render=function(t){for(var e=0;e<this.viewList.length;e++)this.renderer.render(e,{force:!0})},s}(t);function cr(t){return" ["+this.constructor.name+' "'+x(this.id)+'"]: '+t}function lr(t){if(!this.views[t.id]){this.views[t.id]=t;for(var e=0;;e++)if(!this.viewList[e])return this.viewList[e]=t,this.numViews++,void(t.viewIndex=e)}}function dr(t){this.views[t.id]&&(delete this.views[t.id],delete this.viewList[t.viewIndex],this.numViews--)}var ur=/*#__PURE__*/p("state"),vr=/*#__PURE__*/p("inverseMatrixDirty"),fr=/*#__PURE__*/p("transposedProjMatrixDirty"),yr=/*#__PURE__*/function(t){function i(i,n){var s;return void 0===n&&(n={}),(s=t.call(this,i,n)||this).camera=void 0,s.onProjMatrix=void 0,Object.defineProperty(f(s),ur,{writable:!0,value:void 0}),Object.defineProperty(f(s),vr,{writable:!0,value:void 0}),Object.defineProperty(f(s),fr,{writable:!0,value:void 0}),s.camera=i,b(f(s),ur)[ur]={projMatrix:q(),inverseProjMatrix:q(),transposedProjMatrix:q(),near:.1,far:1e4,left:null!=n.left?n.left:-1,right:null!=n.right?n.right:1,bottom:null!=n.bottom?n.bottom:-1,top:null!=n.top?n.top:1},s.onProjMatrix=new e(new r),b(f(s),vr)[vr]=!0,b(f(s),fr)[fr]=!0,s}u(i,t);var n=i.prototype;return n.clean=function(){!function(t,e,i,r,n,s,o){o||(o=q());var h=e-t,a=r-i,c=s-n;o[0]=2*n/h,o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[5]=2*n/a,o[6]=0,o[7]=0,o[8]=(e+t)/h,o[9]=(r+i)/a,o[10]=-(s+n)/c,o[11]=-1,o[12]=0,o[13]=0,o[14]=-s*n*2/c,o[15]=0}(b(this,ur)[ur].left,b(this,ur)[ur].right,b(this,ur)[ur].bottom,b(this,ur)[ur].top,b(this,ur)[ur].near,b(this,ur)[ur].far,b(this,ur)[ur].projMatrix),b(this,vr)[vr]=!0,b(this,fr)[fr]=!0,this.camera.view.redraw(),this.onProjMatrix.dispatch(this,b(this,ur)[ur].projMatrix)},n.unproject=function(t,e,i,r,n){var s=this.camera.view.canvasElement,o=s.offsetWidth/2,h=s.offsetHeight/2;return i[0]=(t[0]-o)/o,i[1]=(t[1]-h)/h,i[2]=e,i[3]=1,J(this.inverseProjMatrix,i,r),z(r,1/r[3]),r[3]=1,r[1]*=-1,J(this.camera.inverseViewMatrix,r,n),n},n.destroy=function(){t.prototype.destroy.call(this),this.onProjMatrix.clear()},d(i,[{key:"left",get:function(){return b(this,ur)[ur].left},set:function(t){b(this,ur)[ur].left=t,this.setDirty()}},{key:"right",get:function(){return b(this,ur)[ur].right},set:function(t){b(this,ur)[ur].right=t,this.setDirty()}},{key:"top",get:function(){return b(this,ur)[ur].top},set:function(t){b(this,ur)[ur].top=t,this.setDirty()}},{key:"bottom",get:function(){return b(this,ur)[ur].bottom},set:function(t){b(this,ur)[ur].bottom=t,this.setDirty()}},{key:"near",get:function(){return b(this,ur)[ur].near},set:function(t){b(this,ur)[ur].near=t,this.setDirty()}},{key:"far",get:function(){return b(this,ur)[ur].far},set:function(t){b(this,ur)[ur].far=t,this.setDirty()}},{key:"projMatrix",get:function(){return this.dirty&&this.cleanIfDirty(),b(this,ur)[ur].projMatrix}},{key:"inverseProjMatrix",get:function(){return this.dirty&&this.cleanIfDirty(),b(this,vr)[vr]&&(Y(b(this,ur)[ur].projMatrix,b(this,ur)[ur].inverseProjMatrix),b(this,vr)[vr]=!1),b(this,ur)[ur].inverseProjMatrix}},{key:"transposedProjMatrix",get:function(){return this.dirty&&this.cleanIfDirty(),b(this,fr)[fr]&&($(b(this,ur)[ur].projMatrix,b(this,ur)[ur].transposedProjMatrix),b(this,fr)[fr]=!1),b(this,ur)[ur].transposedProjMatrix}}]),i}(t);yr.type=V;var pr=/*#__PURE__*/p("state"),br=/*#__PURE__*/function(t){function e(e,i){var r;return void 0===i&&(i={}),(r=t.call(this,e,i)||this).view=void 0,Object.defineProperty(f(r),pr,{writable:!0,value:void 0}),r.view=e,b(f(r),pr)[pr]={type:"ambient",color:new Float32Array(i.color||[.7,.7,.7]),intensity:null!=i.intensity?i.intensity:1},r.view.registerLight(f(r)),r}return u(e,t),e.prototype.destroy=function(){t.prototype.destroy.call(this),this.view.deregisterLight(this)},d(e,[{key:"color",get:function(){return b(this,pr)[pr].color},set:function(t){b(this,pr)[pr].color.set(t),this.view.redraw()}},{key:"intensity",get:function(){return b(this,pr)[pr].intensity},set:function(t){b(this,pr)[pr].intensity=void 0!==t?t:1,this.view.redraw()}}]),e}(t),wr=/*#__PURE__*/p("state"),jr=/*#__PURE__*/function(t){function e(e,i){var r;return void 0===i&&(i={}),(r=t.call(this,e,i)||this).view=void 0,Object.defineProperty(f(r),wr,{writable:!0,value:void 0}),r.view=e,b(f(r),wr)[wr]={type:"dir",dir:new Float32Array(i.dir||[1,1,1]),color:new Float32Array(i.color||[.7,.7,.8]),intensity:null!=i.intensity?i.intensity:1,space:i.space||"view"},r.view.registerLight(f(r)),r}return u(e,t),e.prototype.destroy=function(){t.prototype.destroy.call(this),this.view.deregisterLight(this),this.view.redraw()},d(e,[{key:"dir",get:function(){return b(this,wr)[wr].dir},set:function(t){b(this,wr)[wr].dir.set(t),this.view.redraw()}},{key:"color",get:function(){return b(this,wr)[wr].color},set:function(t){b(this,wr)[wr].color.set(t),this.view.redraw()}},{key:"intensity",get:function(){return b(this,wr)[wr].intensity},set:function(t){b(this,wr)[wr].intensity=t,this.view.redraw()}}]),e}(t),gr=/*#__PURE__*/p("state"),Or=/*#__PURE__*/function(t){function e(e,i){var r;return void 0===i&&(i={}),(r=t.call(this,e,i)||this).view=void 0,Object.defineProperty(f(r),gr,{writable:!0,value:void 0}),r.view=e,b(f(r),gr)[gr]={type:"point",pos:new Float64Array(i.pos||[1,1,1]),color:new Float32Array(i.color||[.7,.7,.8]),intensity:1,attenuation:new Float32Array([i.constantAttenuation,i.linearAttenuation,i.quadraticAttenuation]),space:i.space||"view"},r.view.registerLight(f(r)),r}return u(e,t),e.prototype.destroy=function(){t.prototype.destroy.call(this),this.view.deregisterLight(this),this.view.redraw()},d(e,[{key:"pos",get:function(){return b(this,gr)[gr].pos},set:function(t){b(this,gr)[gr].pos.set(t||[1,1,1]),this.view.redraw()}},{key:"color",get:function(){return b(this,gr)[gr].color},set:function(t){b(this,gr)[gr].color.set(t||[.7,.7,.8]),this.view.redraw()}},{key:"intensity",get:function(){return b(this,gr)[gr].intensity},set:function(t){t!==b(this,gr)[gr].intensity&&(b(this,gr)[gr].intensity=t,this.view.redraw())}},{key:"constantAttenuation",get:function(){return b(this,gr)[gr].attenuation[0]},set:function(t){b(this,gr)[gr].attenuation[0]=t,this.view.redraw()}},{key:"linearAttenuation",get:function(){return b(this,gr)[gr].attenuation[1]},set:function(t){b(this,gr)[gr].attenuation[1]=t,this.view.redraw()}},{key:"quadraticAttenuation",get:function(){return b(this,gr)[gr].attenuation[2]},set:function(t){b(this,gr)[gr].attenuation[2]=t,this.view.redraw()}}]),e}(t),Pr=/*#__PURE__*/p("viewObject"),mr=/*#__PURE__*/p("gotCanvasPos"),kr=/*#__PURE__*/p("gotOrigin"),xr=/*#__PURE__*/p("gotDirection"),Mr=/*#__PURE__*/p("gotIndices"),Ir=/*#__PURE__*/p("gotLocalPos"),Ar=/*#__PURE__*/p("gotWorldPos"),Dr=/*#__PURE__*/p("gotViewPos"),Sr=/*#__PURE__*/p("gotWorldNormal"),Vr=/*#__PURE__*/p("gotUV"),Cr=/*#__PURE__*/p("canvasPos"),Lr=/*#__PURE__*/p("origin"),Ur=/*#__PURE__*/p("direction"),Tr=/*#__PURE__*/p("indices"),zr=/*#__PURE__*/p("localPos"),Fr=/*#__PURE__*/p("worldPos"),_r=/*#__PURE__*/p("viewPos"),Rr=/*#__PURE__*/p("worldNormal"),Wr=/*#__PURE__*/p("uv"),Er=/*#__PURE__*/function(){function t(){Object.defineProperty(this,Pr,{writable:!0,value:void 0}),Object.defineProperty(this,mr,{writable:!0,value:void 0}),Object.defineProperty(this,kr,{writable:!0,value:void 0}),Object.defineProperty(this,xr,{writable:!0,value:void 0}),Object.defineProperty(this,Mr,{writable:!0,value:void 0}),Object.defineProperty(this,Ir,{writable:!0,value:void 0}),Object.defineProperty(this,Ar,{writable:!0,value:void 0}),Object.defineProperty(this,Dr,{writable:!0,value:void 0}),Object.defineProperty(this,Sr,{writable:!0,value:void 0}),Object.defineProperty(this,Vr,{writable:!0,value:void 0}),Object.defineProperty(this,Cr,{writable:!0,value:void 0}),Object.defineProperty(this,Lr,{writable:!0,value:void 0}),Object.defineProperty(this,Ur,{writable:!0,value:void 0}),Object.defineProperty(this,Tr,{writable:!0,value:void 0}),Object.defineProperty(this,zr,{writable:!0,value:void 0}),Object.defineProperty(this,Fr,{writable:!0,value:void 0}),Object.defineProperty(this,_r,{writable:!0,value:void 0}),Object.defineProperty(this,Rr,{writable:!0,value:void 0}),Object.defineProperty(this,Wr,{writable:!0,value:void 0}),b(this,Pr)[Pr]=null,b(this,Cr)[Cr]=new Int16Array([0,0]),b(this,Lr)[Lr]=new Float64Array([0,0,0]),b(this,Ur)[Ur]=new Float64Array([0,0,0]),b(this,Tr)[Tr]=new Int32Array(3),b(this,zr)[zr]=new Float64Array([0,0,0]),b(this,Fr)[Fr]=new Float64Array([0,0,0]),b(this,_r)[_r]=new Float64Array([0,0,0]),b(this,Rr)[Rr]=new Float64Array([0,0,0]),b(this,Wr)[Wr]=new Float64Array([0,0]),b(this,kr)[kr]=!1,b(this,xr)[xr]=!1,b(this,Mr)[Mr]=!1,b(this,mr)[mr]=!1,b(this,Ir)[Ir]=!1,b(this,Ar)[Ar]=!1,b(this,Dr)[Dr]=!1,b(this,Sr)[Sr]=!1,b(this,Vr)[Vr]=!1,this.reset()}return t.prototype.reset=function(){b(this,Pr)[Pr]=null,b(this,mr)[mr]=!1,b(this,kr)[kr]=!1,b(this,xr)[xr]=!1,b(this,Mr)[Mr]=!1,b(this,Ir)[Ir]=!1,b(this,Ar)[Ar]=!1,b(this,Dr)[Dr]=!1,b(this,Sr)[Sr]=!1,b(this,Vr)[Vr]=!1},d(t,[{key:"viewObject",get:function(){return b(this,Pr)[Pr]},set:function(t){b(this,Pr)[Pr]=t}},{key:"canvasPos",get:function(){return b(this,mr)[mr]?b(this,Cr)[Cr]:void 0},set:function(t){t?(b(this,Cr)[Cr][0]=t[0],b(this,Cr)[Cr][1]=t[1],b(this,mr)[mr]=!0):b(this,mr)[mr]=!1}},{key:"origin",get:function(){return b(this,kr)[kr]?b(this,Lr)[Lr]:null},set:function(t){t?(b(this,Lr)[Lr][0]=t[0],b(this,Lr)[Lr][1]=t[1],b(this,Lr)[Lr][2]=t[2],b(this,kr)[kr]=!0):b(this,kr)[kr]=!1}},{key:"direction",get:function(){return b(this,xr)[xr]?b(this,Ur)[Ur]:null},set:function(t){t?(b(this,Ur)[Ur][0]=t[0],b(this,Ur)[Ur][1]=t[1],b(this,Ur)[Ur][2]=t[2],b(this,xr)[xr]=!0):b(this,xr)[xr]=!1}},{key:"indices",get:function(){return b(this,Pr)[Pr]&&b(this,Mr)[Mr]?b(this,Tr)[Tr]:null},set:function(t){t?(b(this,Tr)[Tr][0]=t[0],b(this,Tr)[Tr][1]=t[1],b(this,Tr)[Tr][2]=t[2],b(this,Mr)[Mr]=!0):b(this,Mr)[Mr]=!1}},{key:"localPos",get:function(){return b(this,Pr)[Pr]&&b(this,Ir)[Ir]?b(this,zr)[zr]:null},set:function(t){t?(b(this,zr)[zr][0]=t[0],b(this,zr)[zr][1]=t[1],b(this,zr)[zr][2]=t[2],b(this,Ir)[Ir]=!0):b(this,Ir)[Ir]=!1}},{key:"worldPos",get:function(){return b(this,Pr)[Pr]&&b(this,Ar)[Ar]?b(this,Fr)[Fr]:null},set:function(t){t?(b(this,Fr)[Fr][0]=t[0],b(this,Fr)[Fr][1]=t[1],b(this,Fr)[Fr][2]=t[2],b(this,Ar)[Ar]=!0):b(this,Ar)[Ar]=!1}},{key:"viewPos",get:function(){return b(this,Pr)[Pr]&&b(this,Dr)[Dr]?b(this,_r)[_r]:null},set:function(t){t?(b(this,_r)[_r][0]=t[0],b(this,_r)[_r][1]=t[1],b(this,_r)[_r][2]=t[2],b(this,Dr)[Dr]=!0):b(this,Dr)[Dr]=!1}},{key:"worldNormal",get:function(){return b(this,Pr)[Pr]&&b(this,Sr)[Sr]?b(this,Rr)[Rr]:null},set:function(t){t?(b(this,Rr)[Rr][0]=t[0],b(this,Rr)[Rr][1]=t[1],b(this,Rr)[Rr][2]=t[2],b(this,Sr)[Sr]=!0):b(this,Sr)[Sr]=!1}},{key:"uv",get:function(){return b(this,Pr)[Pr]&&b(this,Vr)[Vr]?b(this,Wr)[Wr]:null},set:function(t){t?(b(this,Wr)[Wr][0]=t[0],b(this,Wr)[Wr][1]=t[1],b(this,Vr)[Vr]=!0):b(this,Vr)[Vr]=!1}}]),t}();export{br as AmbientLight,Ie as Camera,ki as CameraFlightAnimation,ie as CustomProjection,jr as DirLight,Wt as EdgeMaterial,_t as EmphasisMaterial,yr as FrustumProjection,lt as Metrics,Kt as OrthoProjection,Gt as PerspectiveProjection,Er as PickResult,Or as PointLight,Ht as PointsMaterial,ut as SAO,st as SectionPlane,Zi as View,Lt as ViewLayer,rt as ViewObject,ar as Viewer};
//# sourceMappingURL=index.es.map
