!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("@xeokit/core"),require("strongly-typed-events"),require("@xeokit/scene"),require("@xeokit/math"),require("@xeokit/compression")):"function"==typeof define&&define.amd?define(["exports","@xeokit/core","strongly-typed-events","@xeokit/scene","@xeokit/math","@xeokit/compression"],e):e((t||self).viewer={},t.core,t.stronglyTypedEvents,t.scene,t.math)}(this,function(t,e,i,r,n,s){function o(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,"symbol"==typeof(n=function(t,e){if("object"!=typeof t||null===t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(r.key))?n:String(n),r)}var n}function a(t,e,i){return e&&o(t.prototype,e),i&&o(t,i),Object.defineProperty(t,"prototype",{writable:!1}),t}function h(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,c(t,e)}function c(t,e){return c=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},c(t,e)}function l(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}var d=0;function u(t){return"__private_"+d+++"_"+t}function v(t,e){if(!Object.prototype.hasOwnProperty.call(t,e))throw new TypeError("attempted to use private field on non-instance");return t}var f=0;function p(t){return"__private_"+f+++"_"+t}function y(t,e){if(!Object.prototype.hasOwnProperty.call(t,e))throw new TypeError("attempted to use private field on non-instance");return t}var b=/*#__PURE__*/p("items"),w=/*#__PURE__*/p("lastUniqueId"),j=/*#__PURE__*/function(){function t(t,e){Object.defineProperty(this,b,{writable:!0,value:void 0}),Object.defineProperty(this,w,{writable:!0,value:void 0}),y(this,b)[b]=t||[],y(this,w)[w]=(e||0)+1}var e=t.prototype;return e.addItem=function(){var t;if(2===arguments.length){var e=arguments[0];if(t=arguments[1],y(this,b)[b][e])throw"ID clash: '"+e+"'";return y(this,b)[b][e]=t,e}for(t=arguments[0]||{};;){var i=y(this,w)[w]++;if(!y(this,b)[b][i])return y(this,b)[b][i]=t,i}},e.removeItem=function(t){var e=y(this,b)[b][t];return delete y(this,b)[b][t],e},t}(),g=/*#__PURE__*/function(){function t(){this._head=void 0,this._headLength=void 0,this._tail=void 0,this._index=void 0,this._length=void 0,this._head=[],this._headLength=0,this._tail=[],this._index=0,this._length=0}var e,i,r=t.prototype;return r.shift=function(){if(this._index>=this._headLength){var t=this._head;if(t.length=0,this._head=this._tail,this._tail=t,this._index=0,this._headLength=this._head.length,!this._headLength)return}var e=this._head[this._index];return this._index<0?delete this._head[this._index++]:this._head[this._index++]=void 0,this._length--,e},r.push=function(t){return this._length++,this._tail.push(t),this},r.unshift=function(t){return this._head[--this._index]=t,this._length++,this},r.clear=function(){this._head=[],this._headLength=0,this._tail=[],this._index=0,this._length=0},e=t,(i=[{key:"length",get:function(){return this._length}}])&&function(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,"symbol"==typeof(n=function(t,e){if("object"!=typeof t||null===t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(r.key))?n:String(n),r)}var n}(e.prototype,i),Object.defineProperty(e,"prototype",{writable:!1}),t}();function O(t){return function(t){return!isNaN(parseFloat(t))&&isFinite(t)}(t)?""+t:"'"+t+"'"}[["0",10],["A",26],["a",26],["_",1],["$",1]].map(function(t){for(var e=[],i=t[0].charCodeAt(0),r=i+t[1],n=i;n<r;++n)e.push(n);return String.fromCharCode.apply(null,e)}).join("");var P=function(){for(var t=[],e=0;e<256;e++)t[e]=(e<16?"0":"")+e.toString(16);return function(){var e=4294967295*Math.random()|0,i=4294967295*Math.random()|0,r=4294967295*Math.random()|0,n=4294967295*Math.random()|0;return t[255&e]+t[e>>8&255]+t[e>>16&255]+t[e>>24&255]+"-"+t[255&i]+t[i>>8&255]+"-"+t[i>>16&15|64]+t[i>>24&255]+"-"+t[63&r|128]+t[r>>8&255]+"-"+t[r>>16&255]+t[r>>24&255]+t[255&n]+t[n>>8&255]+t[n>>16&255]+t[n>>24&255]}}(),m=3e4,k=4e5,x=5e5,M=500001,E=500002,D=500003;function A(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function I(t){return new Float64Array(t||3)}function C(t){return new FloatArrayClass(t||4)}function S(t,e,i){return i||(i=t),i[0]=t[0]*e,i[1]=t[1]*e,i[2]=t[2]*e,i}function V(t,e,i){return i||(i=t),i[0]=t[0]+e[0],i[1]=t[1]+e[1],i[2]=t[2]+e[2],i}function L(t,e,i){return i||(i=t),i[0]=t[0]-e[0],i[1]=t[1]-e[1],i[2]=t[2]-e[2],i}function T(t,e,i){i||(i=t);var r=t[0],n=t[1],s=t[2],o=e[0],a=e[1],h=e[2];return i[0]=n*h-s*a,i[1]=s*o-r*h,i[2]=r*a-n*o,i}function U(t){return Math.sqrt(function(t){return A(t,t)}(t))}function z(t,e,i,r,n,s){var o=s||I(),a=(t-e)/(i-e);return o[0]=r[0]+a*(n[0]-r[0]),o[1]=r[1]+a*(n[1]-r[1]),o[2]=r[2]+a*(n[2]-r[2]),o}function F(t,e){return S(t,1/U(t),e)}function R(t){return n.newFloatArray(t||16)}C(),C(),new FloatArrayClass(2);var _=R(),W=R();function H(t){return t||(t=R()),t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function q(t,e,i){i||(i=R());var r,n,s,o,a,h,c=function(t,e){return function(t,e,i){return i||(i=t),i[0]=t[0]*e,i[1]=t[1]*e,i[2]=t[2]*e,i[3]=t[3]*e,i}(t,1/function(t){return Math.sqrt(function(t){return function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]}(t,t)}(t))}(t),[])}([e[0],e[1],e[2],0]),l=Math.sin(t),d=Math.cos(t),u=1-d,v=c[0],f=c[1],p=c[2];return r=v*f,n=f*p,s=p*v,o=v*l,a=f*l,h=p*l,i[0]=u*v*v+d,i[1]=u*r+h,i[2]=u*s-a,i[3]=0,i[4]=u*r-h,i[5]=u*f*f+d,i[6]=u*n+o,i[7]=0,i[8]=u*s+a,i[9]=u*n-o,i[10]=u*p*p+d,i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,i}function X(t,e,i,r){r||(r=R());var n,s,o,a,h,c,l,d,u,v,f=t[0],p=t[1],y=t[2],b=i[0],w=i[1],j=i[2],g=e[0],O=e[1],P=e[2];return f===g&&p===O&&y===P?H():(n=f-g,s=p-O,o=y-P,a=w*(o*=v=1/Math.sqrt(n*n+s*s+o*o))-j*(s*=v),h=j*(n*=v)-b*o,c=b*s-w*n,(v=Math.sqrt(a*a+h*h+c*c))?(a*=v=1/v,h*=v,c*=v):(a=0,h=0,c=0),l=s*c-o*h,d=o*a-n*c,u=n*h-s*a,(v=Math.sqrt(l*l+d*d+u*u))?(l*=v=1/v,d*=v,u*=v):(l=0,d=0,u=0),r[0]=a,r[1]=l,r[2]=n,r[3]=0,r[4]=h,r[5]=d,r[6]=s,r[7]=0,r[8]=c,r[9]=u,r[10]=o,r[11]=0,r[12]=-(a*f+h*p+c*y),r[13]=-(l*f+d*p+u*y),r[14]=-(n*f+s*p+o*y),r[15]=1,r)}function B(t,e){e||(e=t);var i=t[0],r=t[1],n=t[2],s=t[3],o=t[4],a=t[5],h=t[6],c=t[7],l=t[8],d=t[9],u=t[10],v=t[11],f=t[12],p=t[13],y=t[14],b=t[15],w=i*a-r*o,j=i*h-n*o,g=i*c-s*o,O=r*h-n*a,P=r*c-s*a,m=n*c-s*h,k=l*p-d*f,x=l*y-u*f,M=l*b-v*f,E=d*y-u*p,D=d*b-v*p,A=u*b-v*y,I=1/(w*A-j*D+g*E+O*M-P*x+m*k);return e[0]=(a*A-h*D+c*E)*I,e[1]=(-r*A+n*D-s*E)*I,e[2]=(p*m-y*P+b*O)*I,e[3]=(-d*m+u*P-v*O)*I,e[4]=(-o*A+h*M-c*x)*I,e[5]=(i*A-n*M+s*x)*I,e[6]=(-f*m+y*g-b*j)*I,e[7]=(l*m-u*g+v*j)*I,e[8]=(o*D-a*M+c*k)*I,e[9]=(-i*D+r*M-s*k)*I,e[10]=(f*P-p*g+b*w)*I,e[11]=(-l*P+d*g-v*w)*I,e[12]=(-o*E+a*x-h*k)*I,e[13]=(i*E-r*x+n*k)*I,e[14]=(-f*O+p*j-y*w)*I,e[15]=(l*O-d*j+u*w)*I,e}function N(t,e){var i=t[4],r=t[14],n=t[8],s=t[13],o=t[12],a=t[9];if(!e||t===e){var h=t[1],c=t[2],l=t[3],d=t[6],u=t[7],v=t[11];return t[1]=i,t[2]=n,t[3]=o,t[4]=h,t[6]=a,t[7]=s,t[8]=c,t[9]=d,t[11]=r,t[12]=l,t[13]=u,t[14]=v,t}return e[0]=t[0],e[1]=i,e[2]=n,e[3]=o,e[4]=t[1],e[5]=t[5],e[6]=a,e[7]=s,e[8]=t[2],e[9]=t[6],e[10]=t[10],e[11]=r,e[12]=t[3],e[13]=t[7],e[14]=t[11],e[15]=t[15],e}function G(t,e,i){i||(i=t);var r=e[0],n=e[1],s=e[2],o=e[3];return i[0]=t[0]*r+t[4]*n+t[8]*s+t[12]*o,i[1]=t[1]*r+t[5]*n+t[9]*s+t[13]*o,i[2]=t[2]*r+t[6]*n+t[10]*s+t[14]*o,i[3]=t[3]*r+t[7]*n+t[11]*s+t[15]*o,i}function K(t,e,i){i||(i=t);var r=t[0],n=t[1],s=t[2],o=t[3],a=t[4],h=t[5],c=t[6],l=t[7],d=t[8],u=t[9],v=t[10],f=t[11],p=t[12],y=t[13],b=t[14],w=t[15],j=e[0],g=e[1],O=e[2],P=e[3],m=e[4],k=e[5],x=e[6],M=e[7],E=e[8],D=e[9],A=e[10],I=e[11],C=e[12],S=e[13],V=e[14],L=e[15];return i[0]=j*r+g*a+O*d+P*p,i[1]=j*n+g*h+O*u+P*y,i[2]=j*s+g*c+O*v+P*b,i[3]=j*o+g*l+O*f+P*w,i[4]=m*r+k*a+x*d+M*p,i[5]=m*n+k*h+x*u+M*y,i[6]=m*s+k*c+x*v+M*b,i[7]=m*o+k*l+x*f+M*w,i[8]=E*r+D*a+A*d+I*p,i[9]=E*n+D*h+A*u+I*y,i[10]=E*s+D*c+A*v+I*b,i[11]=E*o+D*l+A*f+I*w,i[12]=C*r+S*a+V*d+L*p,i[13]=C*n+S*h+V*u+L*y,i[14]=C*s+S*c+V*v+L*b,i[15]=C*o+S*l+V*f+L*w,i}function Q(t,e,i){i||(i=e);var r=e[0],n=e[1],s=e[2];return i[0]=t[0]*r+t[4]*n+t[8]*s+t[12],i[1]=t[1]*r+t[5]*n+t[9]*s+t[13],i[2]=t[2]*r+t[6]*n+t[10]*s+t[14],i}n.newFloatArray(3),I(),R(),n.newFloatArray(3);var Y,$=/*#__PURE__*/u("rendererViewObject"),J=/*#__PURE__*/u("state"),Z=/*#__PURE__*/function(){function t(t,e,i){this.id=void 0,this.layer=void 0,this.sceneObject=void 0,Object.defineProperty(this,$,{writable:!0,value:void 0}),Object.defineProperty(this,J,{writable:!0,value:void 0}),this.id=e.id,this.layer=t,this.sceneObject=e,v(this,$)[$]=i,v(this,J)[J]={visible:!0,culled:!1,pickable:!0,clippable:!0,collidable:!0,xrayed:!1,selected:!1,highlighted:!1,edges:!1,colorize:new Float32Array(4),colorized:!1,opacityUpdated:!1},v(this,$)[$].setVisible(this.layer.view.viewIndex,v(this,J)[J].visible),this.layer.objectVisibilityUpdated(this,v(this,J)[J].visible,!0)}return t.prototype._destroy=function(){v(this,J)[J].visible&&this.layer.objectVisibilityUpdated(this,!1,!1),v(this,J)[J].xrayed&&this.layer.objectXRayedUpdated(this,!1),v(this,J)[J].selected&&this.layer.objectSelectedUpdated(this,!1),v(this,J)[J].highlighted&&this.layer.objectHighlightedUpdated(this,!1),v(this,J)[J].colorized&&this.layer.objectColorizeUpdated(this,!1),v(this,J)[J].opacityUpdated&&this.layer.objectOpacityUpdated(this,!1),this.layer.redraw()},a(t,[{key:"aabb",get:function(){return this.sceneObject.aabb}},{key:"visible",get:function(){return v(this,J)[J].visible},set:function(t){t!==v(this,J)[J].visible&&(v(this,J)[J].visible=t,v(this,$)[$].setVisible(this.layer.view.viewIndex,t),this.layer.objectVisibilityUpdated(this,t,!0),this.layer.redraw())}},{key:"xrayed",get:function(){return v(this,J)[J].xrayed},set:function(t){v(this,J)[J].xrayed!==t&&(v(this,J)[J].xrayed=t,v(this,$)[$].setXRayed(this.layer.view.viewIndex,t),this.layer.objectXRayedUpdated(this,t),this.layer.redraw())}},{key:"edges",get:function(){return v(this,J)[J].edges},set:function(t){v(this,J)[J].edges!==t&&(v(this,J)[J].edges=t,v(this,$)[$].setEdges(this.layer.view.viewIndex,t),this.layer.redraw())}},{key:"highlighted",get:function(){return v(this,J)[J].highlighted},set:function(t){t!==v(this,J)[J].highlighted&&(v(this,J)[J].highlighted=t,v(this,$)[$].setHighlighted(this.layer.view.viewIndex,t),this.layer.objectHighlightedUpdated(this,t),this.layer.redraw())}},{key:"selected",get:function(){return v(this,J)[J].selected},set:function(t){t!==v(this,J)[J].selected&&(v(this,J)[J].selected=t,v(this,$)[$].setSelected(this.layer.view.viewIndex,t),this.layer.objectSelectedUpdated(this,t),this.layer.redraw())}},{key:"culled",get:function(){return v(this,J)[J].culled},set:function(t){t!==v(this,J)[J].culled&&(v(this,J)[J].culled=t,this.layer.redraw())}},{key:"clippable",get:function(){return v(this,J)[J].clippable},set:function(t){t!==v(this,J)[J].clippable&&(v(this,J)[J].clippable=t,this.layer.redraw())}},{key:"collidable",get:function(){return v(this,J)[J].collidable},set:function(t){t!==v(this,J)[J].collidable&&(v(this,J)[J].collidable=t)}},{key:"pickable",get:function(){return v(this,J)[J].pickable},set:function(t){v(this,J)[J].pickable!==t&&(v(this,J)[J].pickable=t)}},{key:"colorize",get:function(){return v(this,J)[J].colorize},set:function(t){var e=v(this,J)[J].colorize;t?(e[0]=t[0],e[1]=t[1],e[2]=t[2]):(e[0]=1,e[1]=1,e[2]=1),v(this,J)[J].colorized=!!t,this.layer.objectColorizeUpdated(this,v(this,J)[J].colorized),this.layer.redraw()}},{key:"opacity",get:function(){return v(this,J)[J].colorize[3]},set:function(t){var e=v(this,J)[J].colorize;v(this,J)[J].opacityUpdated=null!=t,e[3]=v(this,J)[J].opacityUpdated?t:1,this.layer.objectOpacityUpdated(this,v(this,J)[J].opacityUpdated),this.layer.redraw()}}]),t}(),tt=/*#__PURE__*/u("state"),et=/*#__PURE__*/function(t){function r(r,n){var s;return void 0===n&&(n={}),(s=t.call(this,r,n)||this).view=void 0,s.onPos=void 0,s.onDir=void 0,s.onActive=void 0,Object.defineProperty(l(s),tt,{writable:!0,value:void 0}),s.view=r,v(l(s),tt)[tt]={active:!1!==n.active,pos:new Float64Array(n.pos||[0,0,0]),dir:new Float32Array(n.pos||[0,0,-1]),dist:0},s.onPos=new e.EventEmitter(new i.EventDispatcher),s.onDir=new e.EventEmitter(new i.EventDispatcher),s.onActive=new e.EventEmitter(new i.EventDispatcher),s}h(r,t);var n=r.prototype;return n.flipDir=function(){var t=v(this,tt)[tt].dir;t[0]*=-1,t[1]*=-1,t[2]*=-1,v(this,tt)[tt].dist=-A(v(this,tt)[tt].pos,v(this,tt)[tt].dir),this.onDir.dispatch(this,v(this,tt)[tt].dir),this.view.redraw()},n.destroy=function(){this.onPos.clear(),this.onDir.clear(),t.prototype.destroy.call(this)},a(r,[{key:"active",get:function(){return v(this,tt)[tt].active},set:function(t){v(this,tt)[tt].active!==t&&(v(this,tt)[tt].active=t,this.view.redraw(),this.onActive.dispatch(this,v(this,tt)[tt].active))}},{key:"pos",get:function(){return v(this,tt)[tt].pos},set:function(t){v(this,tt)[tt].pos.set(t),v(this,tt)[tt].dist=-A(v(this,tt)[tt].pos,v(this,tt)[tt].dir),this.onPos.dispatch(this,v(this,tt)[tt].pos)}},{key:"dir",get:function(){return v(this,tt)[tt].dir},set:function(t){v(this,tt)[tt].dir.set(t),v(this,tt)[tt].dist=-A(v(this,tt)[tt].pos,v(this,tt)[tt].dir),this.view.redraw(),this.onDir.dispatch(this,v(this,tt)[tt].dir)}},{key:"dist",get:function(){return v(this,tt)[tt].dist}}]),r}(e.Component),it=((Y={})[k]={abbrev:"m"},Y[400001]={abbrev:"cm"},Y[400002]={abbrev:"mm"},Y[400003]={abbrev:"yd"},Y[400004]={abbrev:"ft"},Y[400005]={abbrev:"in"},Y),rt=/*#__PURE__*/u("units"),nt=/*#__PURE__*/u("scale"),st=/*#__PURE__*/u("origin"),ot=/*#__PURE__*/function(t){function r(r,n){var s;return void 0===n&&(n={units:k,scale:1,origin:[1,1,1]}),s=t.call(this,r,n)||this,Object.defineProperty(l(s),rt,{writable:!0,value:void 0}),Object.defineProperty(l(s),nt,{writable:!0,value:void 0}),Object.defineProperty(l(s),st,{writable:!0,value:void 0}),s.onUnits=void 0,s.onScale=void 0,s.onOrigin=void 0,s.onUnits=new e.EventEmitter(new i.EventDispatcher),s.onScale=new e.EventEmitter(new i.EventDispatcher),s.onOrigin=new e.EventEmitter(new i.EventDispatcher),v(l(s),rt)[rt]=k,v(l(s),nt)[nt]=1,v(l(s),st)[st]=I([0,0,0]),s.units=n.units,s.scale=n.scale,s.origin=n.origin,s}h(r,t);var n=r.prototype;return n.worldToRealPos=function(t,e){return void 0===e&&(e=I()),e[0]=v(this,st)[st][0]+v(this,nt)[nt]*t[0],e[1]=v(this,st)[st][1]+v(this,nt)[nt]*t[1],e[2]=v(this,st)[st][2]+v(this,nt)[nt]*t[2],e},n.realToWorldPos=function(t,e){return void 0===e&&(e=I()),e[0]=(t[0]-v(this,st)[st][0])/v(this,nt)[nt],e[1]=(t[1]-v(this,st)[st][1])/v(this,nt)[nt],e[2]=(t[2]-v(this,st)[st][2])/v(this,nt)[nt],e},n.destroy=function(){t.prototype.destroy.call(this),this.onUnits.clear(),this.onScale.clear(),this.onOrigin.clear()},a(r,[{key:"unitsInfo",get:function(){return it}},{key:"units",get:function(){return v(this,rt)[rt]},set:function(t){t||(t=k),it[t]||(this.error("Unsupported value for 'units': "+t+" defaulting to MetersUnit"),t=k),v(this,rt)[rt]=t,this.onUnits.dispatch(this,v(this,rt)[rt])}},{key:"scale",get:function(){return v(this,nt)[nt]},set:function(t){(t=t||1)<=0?this.error("scale value should be larger than zero"):(v(this,nt)[nt]=t,this.onScale.dispatch(this,v(this,nt)[nt]))}},{key:"origin",get:function(){return v(this,st)[st]},set:function(t){if(!t)return v(this,st)[st][0]=0,v(this,st)[st][1]=0,void(v(this,st)[st][2]=0);v(this,st)[st][0]=t[0],v(this,st)[st][1]=t[1],v(this,st)[st][2]=t[2],this.onOrigin.dispatch(this,v(this,st)[st])}}]),r}(e.Component),at=/*#__PURE__*/u("state"),ht=/*#__PURE__*/function(t){function e(e,i){var r;return(r=t.call(this,e,i)||this).view=void 0,Object.defineProperty(l(r),at,{writable:!0,value:void 0}),r.view=e,v(l(r),at)[at]={renderModes:[m],enabled:!1!==i.enabled,kernelRadius:i.kernelRadius||100,intensity:void 0!==i.intensity?i.intensity:.15,bias:void 0!==i.bias?i.bias:.5,scale:void 0!==i.scale?i.scale:1,minResolution:void 0!==i.minResolution?i.minResolution:0,numSamples:void 0!==i.numSamples?i.numSamples:10,blur:!!i.blur,blendCutoff:void 0!==i.blendCutff?i.blendCutoff:.3,blendFactor:void 0!==i.blendFactor?i.blendFactor:1},r}return h(e,t),e.prototype.destroy=function(){t.prototype.destroy.call(this)},a(e,[{key:"renderModes",get:function(){return v(this,at)[at].renderModes},set:function(t){v(this,at)[at].renderModes=t,this.view.redraw()}},{key:"supported",get:function(){return this.view.viewer.renderer.getSAOSupported()}},{key:"enabled",get:function(){return v(this,at)[at].enabled},set:function(t){t=!!t,v(this,at)[at].enabled!==t&&(v(this,at)[at].enabled=t,this.view.redraw())}},{key:"possible",get:function(){if(!this.supported)return!1;if(!v(this,at)[at].enabled)return!1;var t=this.view.camera.projectionType;return t!==D&&t!==E}},{key:"kernelRadius",get:function(){return v(this,at)[at].kernelRadius},set:function(t){null==t&&(t=100),v(this,at)[at].kernelRadius!==t&&(v(this,at)[at].kernelRadius=t,this.view.redraw())}},{key:"intensity",get:function(){return v(this,at)[at].intensity},set:function(t){null==t&&(t=.15),v(this,at)[at].intensity!==t&&(v(this,at)[at].intensity=t,this.view.redraw())}},{key:"bias",get:function(){return v(this,at)[at].bias},set:function(t){null==t&&(t=.5),v(this,at)[at].bias!==t&&(v(this,at)[at].bias=t,this.view.redraw())}},{key:"scale",get:function(){return v(this,at)[at].scale},set:function(t){null==t&&(t=1),v(this,at)[at].scale!==t&&(v(this,at)[at].scale=t,this.view.redraw())}},{key:"minResolution",get:function(){return v(this,at)[at].minResolution},set:function(t){null==t&&(t=0),v(this,at)[at].minResolution!==t&&(v(this,at)[at].minResolution=t,this.view.redraw())}},{key:"numSamples",get:function(){return v(this,at)[at].numSamples},set:function(t){null==t&&(t=10),v(this,at)[at].numSamples!==t&&(v(this,at)[at].numSamples=t,this.view.redraw())}},{key:"blur",get:function(){return v(this,at)[at].blur},set:function(t){t=!1!==t,v(this,at)[at].blur!==t&&(v(this,at)[at].blur=t,this.view.redraw())}},{key:"blendCutoff",get:function(){return v(this,at)[at].blendCutoff},set:function(t){null==t&&(t=.3),v(this,at)[at].blendCutoff!==t&&(v(this,at)[at].blendCutoff=t,this.view.redraw())}},{key:"blendFactor",get:function(){return v(this,at)[at].blendFactor},set:function(t){null==t&&(t=1),v(this,at)[at].blendFactor!==t&&(v(this,at)[at].blendFactor=t,this.view.redraw())}}]),e}(e.Component),ct=/*#__PURE__*/u("state"),lt=/*#__PURE__*/function(t){function e(e,i){var r;return void 0===i&&(i={lineWidth:1}),(r=t.call(this,e,i)||this).view=void 0,Object.defineProperty(l(r),ct,{writable:!0,value:void 0}),r.view=e,v(l(r),ct)[ct]={lineWidth:null!=i.lineWidth?i.lineWidth:1},r}return h(e,t),a(e,[{key:"lineWidth",get:function(){return v(this,ct)[ct].lineWidth},set:function(t){v(this,ct)[ct].lineWidth=t||1,this.view.redraw()}}]),e}(e.Component),dt=/*#__PURE__*/u("numObjects"),ut=/*#__PURE__*/u("objectIds"),vt=/*#__PURE__*/u("numVisibleObjects"),ft=/*#__PURE__*/u("visibleObjectIds"),pt=/*#__PURE__*/u("numXRayedObjects"),yt=/*#__PURE__*/u("xrayedObjectIds"),bt=/*#__PURE__*/u("numHighlightedObjects"),wt=/*#__PURE__*/u("highlightedObjectIds"),jt=/*#__PURE__*/u("numSelectedObjects"),gt=/*#__PURE__*/u("selectedObjectIds"),Ot=/*#__PURE__*/u("numColorizedObjects"),Pt=/*#__PURE__*/u("colorizedObjectIds"),mt=/*#__PURE__*/u("numOpacityObjects"),kt=/*#__PURE__*/u("opacityObjectIds"),xt=/*#__PURE__*/u("qualityRender"),Mt=/*#__PURE__*/u("initObjects"),Et=/*#__PURE__*/u("createObjects"),Dt=/*#__PURE__*/u("destroyObjects"),At=/*#__PURE__*/function(t){function r(r){var n;return n=t.call(this,r.view,r)||this,Object.defineProperty(l(n),Dt,{value:St}),Object.defineProperty(l(n),Et,{value:Ct}),Object.defineProperty(l(n),Mt,{value:It}),n.objects=void 0,n.visibleObjects=void 0,n.xrayedObjects=void 0,n.highlightedObjects=void 0,n.selectedObjects=void 0,n.colorizedObjects=void 0,n.opacityObjects=void 0,n.autoDestroy=void 0,n.onObjectVisibility=void 0,Object.defineProperty(l(n),dt,{writable:!0,value:void 0}),Object.defineProperty(l(n),ut,{writable:!0,value:void 0}),Object.defineProperty(l(n),vt,{writable:!0,value:void 0}),Object.defineProperty(l(n),ft,{writable:!0,value:void 0}),Object.defineProperty(l(n),pt,{writable:!0,value:void 0}),Object.defineProperty(l(n),yt,{writable:!0,value:void 0}),Object.defineProperty(l(n),bt,{writable:!0,value:void 0}),Object.defineProperty(l(n),wt,{writable:!0,value:void 0}),Object.defineProperty(l(n),jt,{writable:!0,value:void 0}),Object.defineProperty(l(n),gt,{writable:!0,value:void 0}),Object.defineProperty(l(n),Ot,{writable:!0,value:void 0}),Object.defineProperty(l(n),Pt,{writable:!0,value:void 0}),Object.defineProperty(l(n),mt,{writable:!0,value:void 0}),Object.defineProperty(l(n),kt,{writable:!0,value:void 0}),Object.defineProperty(l(n),xt,{writable:!0,value:void 0}),n.gammaOutput=void 0,n.id=r.id,n.viewer=r.viewer,n.view=r.view,n.objects={},n.visibleObjects={},n.xrayedObjects={},n.highlightedObjects={},n.selectedObjects={},n.colorizedObjects={},n.opacityObjects={},n.autoDestroy=!1!==r.autoDestroy,v(l(n),dt)[dt]=0,v(l(n),vt)[vt]=0,v(l(n),pt)[pt]=0,v(l(n),bt)[bt]=0,v(l(n),jt)[jt]=0,v(l(n),Ot)[Ot]=0,v(l(n),mt)[mt]=0,v(l(n),xt)[xt]=!!r.qualityRender,n.onObjectVisibility=new e.EventEmitter(new i.EventDispatcher),v(l(n),Mt)[Mt](),n}h(r,t);var n=r.prototype;return n.registerViewObject=function(t){this.objects[t.id]=t,v(this,dt)[dt]++,v(this,ut)[ut]=null},n.deregisterViewObject=function(t){delete this.objects[t.id],delete this.visibleObjects[t.id],delete this.xrayedObjects[t.id],delete this.highlightedObjects[t.id],delete this.selectedObjects[t.id],delete this.colorizedObjects[t.id],delete this.opacityObjects[t.id],v(this,dt)[dt]--,v(this,ut)[ut]=null},n.redraw=function(){this.viewer.renderer.setImageDirty(this.view.viewIndex)},n.objectVisibilityUpdated=function(t,e,i){void 0===i&&(i=!0),e?(this.visibleObjects[t.id]=t,v(this,vt)[vt]++):(delete this.visibleObjects[t.id],v(this,vt)[vt]--),v(this,ft)[ft]=null,i&&this.onObjectVisibility.dispatch(this,t),this.view.objectVisibilityUpdated(t,e,i)},n.objectXRayedUpdated=function(t,e){e?(this.xrayedObjects[t.id]=t,v(this,pt)[pt]++):(delete this.xrayedObjects[t.id],v(this,pt)[pt]--),v(this,yt)[yt]=null,this.view.objectXRayedUpdated(t,e)},n.objectHighlightedUpdated=function(t,e){e?(this.highlightedObjects[t.id]=t,v(this,bt)[bt]++):(delete this.highlightedObjects[t.id],v(this,bt)[bt]--),v(this,wt)[wt]=null,this.view.objectHighlightedUpdated(t,e)},n.objectSelectedUpdated=function(t,e){e?(this.selectedObjects[t.id]=t,v(this,jt)[jt]++):(delete this.selectedObjects[t.id],v(this,jt)[jt]--),v(this,gt)[gt]=null,this.view.objectSelectedUpdated(t,e)},n.objectColorizeUpdated=function(t,e){e?(this.colorizedObjects[t.id]=t,v(this,Ot)[Ot]++):(delete this.colorizedObjects[t.id],v(this,Ot)[Ot]--),v(this,Pt)[Pt]=null,this.view.objectColorizeUpdated(t,e)},n.objectOpacityUpdated=function(t,e){e?(this.opacityObjects[t.id]=t,v(this,mt)[mt]++):(delete this.opacityObjects[t.id],v(this,mt)[mt]--),v(this,kt)[kt]=null,this.view.objectOpacityUpdated(t,e)},n.setObjectsVisible=function(t,e){return this.withObjects(t,function(t){var i=t.visible!==e;return t.visible=e,i})},n.setObjectsCollidable=function(t,e){return this.withObjects(t,function(t){var i=t.collidable!==e;return t.collidable=e,i})},n.setObjectsCulled=function(t,e){return this.withObjects(t,function(t){var i=t.culled!==e;return t.culled=e,i})},n.setObjectsSelected=function(t,e){return this.withObjects(t,function(t){var i=t.selected!==e;return t.selected=e,i})},n.setObjectsHighlighted=function(t,e){return this.withObjects(t,function(t){var i=t.highlighted!==e;return t.highlighted=e,i})},n.setObjectsXRayed=function(t,e){return this.withObjects(t,function(t){var i=t.xrayed!==e;return i&&(t.xrayed=e),i})},n.setObjectsColorized=function(t,e){return this.withObjects(t,function(t){t.colorize=e})},n.setObjectsOpacity=function(t,e){return this.withObjects(t,function(t){var i=t.opacity!==e;return i&&(t.opacity=e),i})},n.setObjectsPickable=function(t,e){return this.withObjects(t,function(t){var i=t.pickable!==e;return i&&(t.pickable=e),i})},n.setObjectsClippable=function(t,e){return this.withObjects(t,function(t){var i=t.clippable!==e;return i&&(t.clippable=e),i})},n.withObjects=function(t,e){for(var i=!1,r=0,n=t.length;r<n;r++){var s=this.objects[t[r]];s&&(i=e(s)||i)}return i},n.destroy=function(){t.prototype.destroy.call(this)},a(r,[{key:"gammaFactor",get:function(){return 1}},{key:"qualityRender",get:function(){return v(this,xt)[xt]},set:function(t){v(this,xt)[xt]!==t&&(v(this,xt)[xt]=t,this.redraw())}},{key:"numObjects",get:function(){return v(this,dt)[dt]}},{key:"objectIds",get:function(){return v(this,ut)[ut]||(v(this,ut)[ut]=Object.keys(this.objects)),v(this,ut)[ut]}},{key:"numVisibleObjects",get:function(){return v(this,vt)[vt]}},{key:"visibleObjectIds",get:function(){return v(this,ft)[ft]||(v(this,ft)[ft]=Object.keys(this.visibleObjects)),v(this,ft)[ft]}},{key:"numXRayedObjects",get:function(){return v(this,pt)[pt]}},{key:"xrayedObjectIds",get:function(){return v(this,yt)[yt]||(v(this,yt)[yt]=Object.keys(this.xrayedObjects)),v(this,yt)[yt]}},{key:"numHighlightedObjects",get:function(){return v(this,bt)[bt]}},{key:"highlightedObjectIds",get:function(){return v(this,wt)[wt]||(v(this,wt)[wt]=Object.keys(this.highlightedObjects)),v(this,wt)[wt]}},{key:"numSelectedObjects",get:function(){return v(this,jt)[jt]}},{key:"selectedObjectIds",get:function(){return v(this,gt)[gt]||(v(this,gt)[gt]=Object.keys(this.selectedObjects)),v(this,gt)[gt]}},{key:"numColorizedObjects",get:function(){return v(this,Ot)[Ot]}},{key:"colorizedObjectIds",get:function(){return v(this,Pt)[Pt]||(v(this,Pt)[Pt]=Object.keys(this.colorizedObjects)),v(this,Pt)[Pt]}},{key:"opacityObjectIds",get:function(){return v(this,kt)[kt]||(v(this,kt)[kt]=Object.keys(this.opacityObjects)),v(this,kt)[kt]}},{key:"numOpacityObjects",get:function(){return v(this,mt)[mt]}}]),r}(e.Component);function It(){var t=this,e=this.viewer.scene.models;for(var i in e){var r=e[i];v(this,Et)[Et](r)}this.viewer.scene.onModelCreated.subscribe(function(e,i){v(t,Et)[Et](i)}),this.viewer.scene.onModelDestroyed.subscribe(function(e,i){v(t,Dt)[Dt](i)})}function Ct(t){var e=t.objects;for(var i in e){var r=this.viewer.renderer.rendererViewObjects[i];if(r.layerId==this.id){var n=new Z(this,e[i],r);this.objects[n.id]=n,v(this,dt)[dt]++,v(this,ut)[ut]=null}}}function St(t){var e=t.objects;for(var i in e)this.objects[e[i].id]._destroy(),v(this,dt)[dt]--,v(this,ut)[ut]=null}var Vt=/*#__PURE__*/u("state"),Lt=/*#__PURE__*/function(t){function e(e,i){var r;return void 0===i&&(i={}),(r=t.call(this,e,i)||this).view=void 0,Object.defineProperty(l(r),Vt,{writable:!0,value:void 0}),r.view=e,v(l(r),Vt)[Vt]={fill:!!i.fill,fillColor:new Float32Array(i.fillColor||[.4,.4,.4]),fillAlpha:null!=i.fillAlpha?i.fillAlpha:.2,edges:!1!==i.edges,edgeColor:new Float32Array(i.edgeColor||[.2,.2,.2]),edgeAlpha:null!=i.edgeAlpha?i.edgeAlpha:.5,edgeWidth:null!=i.edgeWidth?i.edgeWidth:1,backfaces:!!i.backfaces},r}return h(e,t),e.prototype.destroy=function(){t.prototype.destroy.call(this)},a(e,[{key:"fill",get:function(){return v(this,Vt)[Vt].fill},set:function(t){v(this,Vt)[Vt].fill!==t&&(v(this,Vt)[Vt].fill=t,this.view.redraw())}},{key:"fillColor",get:function(){return v(this,Vt)[Vt].fillColor},set:function(t){var e=v(this,Vt)[Vt].fillColor;e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]||(e[0]=.4,e[1]=.4,e[2]=.4,this.view.redraw())}},{key:"fillAlpha",get:function(){return v(this,Vt)[Vt].fillAlpha},set:function(t){v(this,Vt)[Vt].fillAlpha!==t&&(v(this,Vt)[Vt].fillAlpha=t,this.view.redraw())}},{key:"edges",get:function(){return v(this,Vt)[Vt].edges},set:function(t){v(this,Vt)[Vt].edges!==t&&(v(this,Vt)[Vt].edges=t,this.view.redraw())}},{key:"edgeColor",get:function(){return v(this,Vt)[Vt].edgeColor},set:function(t){var e=v(this,Vt)[Vt].edgeColor;e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]||(e[0]=.2,e[1]=.2,e[2]=.2,this.view.redraw())}},{key:"edgeAlpha",get:function(){return v(this,Vt)[Vt].edgeAlpha},set:function(t){v(this,Vt)[Vt].edgeAlpha!==t&&(v(this,Vt)[Vt].edgeAlpha=t,this.view.redraw())}},{key:"edgeWidth",get:function(){return v(this,Vt)[Vt].edgeWidth},set:function(t){v(this,Vt)[Vt].edgeWidth=t,this.view.redraw()}},{key:"backfaces",get:function(){return v(this,Vt)[Vt].backfaces},set:function(t){v(this,Vt)[Vt].backfaces!==t&&(v(this,Vt)[Vt].backfaces=t,this.view.redraw())}},{key:"hash",get:function(){return""}}]),e}(e.Component),Tt=/*#__PURE__*/u("state"),Ut=/*#__PURE__*/function(t){function e(e,i){var r;return void 0===i&&(i={}),(r=t.call(this,e,i)||this).view=void 0,Object.defineProperty(l(r),Tt,{writable:!0,value:void 0}),r.view=e,v(l(r),Tt)[Tt]={renderModes:i.renderModes||[m],edges:!1!==i.edges,edgeColor:new Float32Array(i.edgeColor||[.2,.2,.2]),edgeAlpha:null!=i.edgeAlpha?i.edgeAlpha:.5,edgeWidth:null!=i.edgeWidth?i.edgeWidth:1},r}return h(e,t),e.prototype.destroy=function(){t.prototype.destroy.call(this)},a(e,[{key:"renderModes",get:function(){return v(this,Tt)[Tt].renderModes},set:function(t){v(this,Tt)[Tt].renderModes=t,this.view.redraw()}},{key:"edges",get:function(){return v(this,Tt)[Tt].edges},set:function(t){v(this,Tt)[Tt].edges!==t&&(v(this,Tt)[Tt].edges=t,this.view.redraw())}},{key:"edgeColor",get:function(){return v(this,Tt)[Tt].edgeColor},set:function(t){var e=v(this,Tt)[Tt].edgeColor;t&&e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]||(e[0]=.2,e[1]=.2,e[2]=.2,this.view.redraw())}},{key:"edgeAlpha",get:function(){return v(this,Tt)[Tt].edgeAlpha},set:function(t){v(this,Tt)[Tt].edgeAlpha!==t&&(v(this,Tt)[Tt].edgeAlpha=t,this.view.redraw())}},{key:"edgeWidth",get:function(){return v(this,Tt)[Tt].edgeWidth},set:function(t){v(this,Tt)[Tt].edgeWidth!==t&&(v(this,Tt)[Tt].edgeWidth=t,this.view.redraw())}}]),e}(e.Component),zt=/*#__PURE__*/u("state"),Ft=/*#__PURE__*/function(t){function e(e,i){var r;return void 0===i&&(i={}),(r=t.call(this,e,i)||this).view=void 0,Object.defineProperty(l(r),zt,{writable:!0,value:void 0}),r.view=e,v(l(r),zt)[zt]={pointSize:null!=i.pointSize?i.pointSize:1,roundPoints:!1!==i.roundPoints,perspectivePoints:!1!==i.perspectivePoints,minPerspectivePointSize:null!=i.minPerspectivePointSize?i.minPerspectivePointSize:1,maxPerspectivePointSize:null!=i.maxPerspectivePointSize?i.maxPerspectivePointSize:6,filterIntensity:!!i.filterIntensity,minIntensity:null!=i.minIntensity?i.minIntensity:0,maxIntensity:null!=i.maxIntensity?i.maxIntensity:1},r}return h(e,t),e.prototype.destroy=function(){t.prototype.destroy.call(this)},a(e,[{key:"pointSize",get:function(){return v(this,zt)[zt].pointSize},set:function(t){v(this,zt)[zt].pointSize=t,this.view.redraw()}},{key:"roundPoints",get:function(){return v(this,zt)[zt].roundPoints},set:function(t){v(this,zt)[zt].roundPoints!==t&&(v(this,zt)[zt].roundPoints=t,this.view.rebuild())}},{key:"perspectivePoints",get:function(){return v(this,zt)[zt].perspectivePoints},set:function(t){v(this,zt)[zt].perspectivePoints!==t&&(v(this,zt)[zt].perspectivePoints=t,this.view.rebuild())}},{key:"minPerspectivePointSize",get:function(){return v(this,zt)[zt].minPerspectivePointSize},set:function(t){v(this,zt)[zt].minPerspectivePointSize!==t&&(v(this,zt)[zt].minPerspectivePointSize=t,this.view.rebuild())}},{key:"maxPerspectivePointSize",get:function(){return v(this,zt)[zt].maxPerspectivePointSize},set:function(t){v(this,zt)[zt].maxPerspectivePointSize!==t&&(v(this,zt)[zt].maxPerspectivePointSize=t,this.view.rebuild())}},{key:"filterIntensity",get:function(){return v(this,zt)[zt].filterIntensity},set:function(t){v(this,zt)[zt].filterIntensity!==t&&(v(this,zt)[zt].filterIntensity=t,this.view.rebuild())}},{key:"minIntensity",get:function(){return v(this,zt)[zt].minIntensity},set:function(t){v(this,zt)[zt].minIntensity!==t&&(v(this,zt)[zt].minIntensity=t,this.view.redraw())}},{key:"maxIntensity",get:function(){return v(this,zt)[zt].maxIntensity},set:function(t){v(this,zt)[zt].maxIntensity!==t&&(v(this,zt)[zt].maxIntensity=t,this.view.redraw())}},{key:"hash",get:function(){var t=v(this,zt)[zt];return t.pointSize+";\n        "+t.roundPoints+";\n        "+t.perspectivePoints+";\n        "+t.minPerspectivePointSize+";\n        "+t.maxPerspectivePointSize+";\n        "+t.filterIntensity}}]),e}(e.Component),Rt=/*#__PURE__*/u("state"),_t=/*#__PURE__*/u("inverseMatrixDirty"),Wt=/*#__PURE__*/u("transposedProjMatrixDirty"),Ht=/*#__PURE__*/u("onViewBoundary"),qt=/*#__PURE__*/function(t){function r(r,n){var s;return void 0===n&&(n={}),(s=t.call(this,r,n)||this).camera=void 0,s.onProjMatrix=void 0,Object.defineProperty(l(s),Rt,{writable:!0,value:void 0}),Object.defineProperty(l(s),_t,{writable:!0,value:void 0}),Object.defineProperty(l(s),Wt,{writable:!0,value:void 0}),Object.defineProperty(l(s),Ht,{writable:!0,value:void 0}),s.camera=r,v(l(s),Rt)[Rt]={near:n.near||.1,far:n.far||2e3,fov:n.fov||60,fovAxis:n.fovAxis||"min",projMatrix:R(),inverseProjMatrix:R(),transposedProjMatrix:R()},v(l(s),_t)[_t]=!0,v(l(s),Wt)[Wt]=!0,v(l(s),Ht)[Ht]=s.camera.view.onBoundary.subscribe(function(){s.setDirty()}),s.onProjMatrix=new e.EventEmitter(new i.EventDispatcher),s}h(r,t);var n=r.prototype;return n.clean=function(){var t=this.camera.view.boundary,e=t[2]/t[3],i=v(this,Rt)[Rt].fovAxis,r=v(this,Rt)[Rt].fov;("x"===i||"min"===i&&e<1||"max"===i&&e>1)&&(r/=e),function(t,e,i,r,n){var s=[],o=[];s[2]=i,o[2]=r,o[1]=s[2]*Math.tan(t/2),s[1]=-o[1],o[0]=o[1]*e,s[0]=-o[0],function(t,e,i){i||(i=R());var r=[t[0],t[1],t[2],0],n=[e[0],e[1],e[2],0];(function(t,e,i){i||(i=t),i[0]=t[0]+e[0],i[1]=t[1]+e[1],i[2]=t[2]+e[2],i[3]=t[3]+e[3]})(n,r,_),function(t,e,i){i||(i=t),i[0]=t[0]-e[0],i[1]=t[1]-e[1],i[2]=t[2]-e[2],i[3]=t[3]-e[3]}(n,r,W);var s=2*r[2],o=W[0],a=W[1],h=W[2];i[0]=s/o,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=s/a,i[6]=0,i[7]=0,i[8]=_[0]/o,i[9]=_[1]/a,i[10]=-_[2]/h,i[11]=-1,i[12]=0,i[13]=0,i[14]=-s*n[2]/h,i[15]=0}(s,o,n)}((r=Math.min(r,120))*(Math.PI/180),e,v(this,Rt)[Rt].near,v(this,Rt)[Rt].far,v(this,Rt)[Rt].projMatrix),v(this,_t)[_t]=!0,v(this,Wt)[Wt]=!0,this.camera.view.redraw(),this.onProjMatrix.dispatch(this,v(this,Rt)[Rt].projMatrix)},n.unproject=function(t,e,i,r,n){var s=this.camera.view.canvasElement,o=s.offsetWidth/2,a=s.offsetHeight/2;return i[0]=(t[0]-o)/o,i[1]=(t[1]-a)/a,i[2]=e,i[3]=1,G(this.inverseProjMatrix,i,r),S(r,1/r[3]),r[3]=1,r[1]*=-1,G(this.camera.inverseViewMatrix,r,n),n},n.destroy=function(){t.prototype.destroy.call(this),this.camera.view.onBoundary.unsubscribe(v(this,Ht)[Ht]),this.onProjMatrix.clear()},a(r,[{key:"fov",get:function(){return v(this,Rt)[Rt].fov},set:function(t){t!==v(this,Rt)[Rt].fov&&(v(this,Rt)[Rt].fov=t,this.setDirty())}},{key:"fovAxis",get:function(){return v(this,Rt)[Rt].fovAxis},set:function(t){t=t||"min",v(this,Rt)[Rt].fovAxis!==t&&("x"!==t&&"y"!==t&&"min"!==t&&(this.error("Unsupported value for 'fovAxis': "+t+" - defaulting to 'min'"),t="min"),v(this,Rt)[Rt].fovAxis=t,this.setDirty())}},{key:"near",get:function(){return v(this,Rt)[Rt].near},set:function(t){v(this,Rt)[Rt].near!==t&&(v(this,Rt)[Rt].near=t,this.setDirty())}},{key:"far",get:function(){return v(this,Rt)[Rt].far},set:function(t){v(this,Rt)[Rt].far!==t&&(v(this,Rt)[Rt].far=t,this.setDirty())}},{key:"projMatrix",get:function(){return this.dirty&&this.cleanIfDirty(),v(this,Rt)[Rt].projMatrix}},{key:"inverseProjMatrix",get:function(){return this.dirty&&this.cleanIfDirty(),v(this,_t)[_t]&&(B(v(this,Rt)[Rt].projMatrix,v(this,Rt)[Rt].inverseProjMatrix),v(this,_t)[_t]=!1),v(this,Rt)[Rt].inverseProjMatrix}},{key:"transposedProjMatrix",get:function(){return this.dirty&&this.cleanIfDirty(),v(this,Wt)[Wt]&&(N(v(this,Rt)[Rt].projMatrix,v(this,Rt)[Rt].transposedProjMatrix),v(this,Wt)[Wt]=!1),v(this,Rt)[Rt].transposedProjMatrix}}]),r}(e.Component);qt.type=x;var Xt=/*#__PURE__*/u("state"),Bt=/*#__PURE__*/u("inverseMatrixDirty"),Nt=/*#__PURE__*/u("transposedProjMatrixDirty"),Gt=/*#__PURE__*/u("onViewBoundary"),Kt=/*#__PURE__*/function(t){function r(r,n){var s;return void 0===n&&(n={}),(s=t.call(this,r,n)||this).camera=void 0,s.onProjMatrix=void 0,Object.defineProperty(l(s),Xt,{writable:!0,value:void 0}),Object.defineProperty(l(s),Bt,{writable:!0,value:void 0}),Object.defineProperty(l(s),Nt,{writable:!0,value:void 0}),Object.defineProperty(l(s),Gt,{writable:!0,value:void 0}),s.camera=r,v(l(s),Xt)[Xt]={near:n.near||.1,far:n.far||2e3,scale:n.scale||1,projMatrix:R(),inverseProjMatrix:R(),transposedProjMatrix:R()},s.onProjMatrix=new e.EventEmitter(new i.EventDispatcher),v(l(s),Bt)[Bt]=!0,v(l(s),Nt)[Nt]=!0,v(l(s),Gt)[Gt]=s.camera.view.onBoundary.subscribe(function(){s.setDirty()}),s}h(r,t);var n=r.prototype;return n.clean=function(){var t,e,i,r,n=this.camera.view,s=.5*v(this,Xt)[Xt].scale,o=n.boundary,a=o[2],h=o[3],c=a/h;a>h?(t=-s,e=s,i=s/c,r=-s/c):(t=-s*c,e=s*c,i=s,r=-s),function(t,e,i,r,n,s,o){o||(o=R());var a=e-t,h=r-i,c=s-n;o[0]=2/a,o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[5]=2/h,o[6]=0,o[7]=0,o[8]=0,o[9]=0,o[10]=-2/c,o[11]=0,o[12]=-(t+e)/a,o[13]=-(r+i)/h,o[14]=-(s+n)/c,o[15]=1}(t,e,r,i,v(this,Xt)[Xt].near,v(this,Xt)[Xt].far,v(this,Xt)[Xt].projMatrix),v(this,Bt)[Bt]=!0,v(this,Nt)[Nt]=!0,this.camera.view.redraw(),this.onProjMatrix.dispatch(this,v(this,Xt)[Xt].projMatrix)},n.unproject=function(t,e,i,r,n){var s=this.camera.view.canvasElement,o=s.offsetWidth/2,a=s.offsetHeight/2;return i[0]=(t[0]-o)/o,i[1]=(t[1]-a)/a,i[2]=e,i[3]=1,G(this.inverseProjMatrix,i,r),S(r,1/r[3]),r[3]=1,r[1]*=-1,G(this.camera.inverseViewMatrix,r,n),n},n.destroy=function(){t.prototype.destroy.call(this),this.camera.view.onBoundary.unsubscribe(v(this,Gt)[Gt]),this.onProjMatrix.clear()},a(r,[{key:"scale",get:function(){return v(this,Xt)[Xt].scale},set:function(t){t<=0&&(t=.01),v(this,Xt)[Xt].scale=t,this.setDirty()}},{key:"near",get:function(){return v(this,Xt)[Xt].near},set:function(t){v(this,Xt)[Xt].near!==t&&(v(this,Xt)[Xt].near=t,this.setDirty())}},{key:"far",get:function(){return v(this,Xt)[Xt].far},set:function(t){v(this,Xt)[Xt].far!==t&&(v(this,Xt)[Xt].far=t,this.setDirty())}},{key:"projMatrix",get:function(){return this.dirty&&this.cleanIfDirty(),v(this,Xt)[Xt].projMatrix}},{key:"inverseProjMatrix",get:function(){return this.dirty&&this.cleanIfDirty(),v(this,Bt)[Bt]&&(B(v(this,Xt)[Xt].projMatrix,v(this,Xt)[Xt].inverseProjMatrix),v(this,Bt)[Bt]=!1),v(this,Xt)[Xt].inverseProjMatrix}},{key:"transposedProjMatrix",get:function(){return this.dirty&&this.cleanIfDirty(),v(this,Nt)[Nt]&&(N(v(this,Xt)[Xt].projMatrix,v(this,Xt)[Xt].transposedProjMatrix),v(this,Nt)[Nt]=!1),v(this,Xt)[Xt].transposedProjMatrix}}]),r}(e.Component);Kt.type=M;var Qt=/*#__PURE__*/u("state"),Yt=/*#__PURE__*/u("inverseProjMatrixDirty"),$t=/*#__PURE__*/u("transposedProjMatrixDirty"),Jt=/*#__PURE__*/function(t){function r(r,n){var s;return void 0===n&&(n={}),(s=t.call(this,r,n)||this).camera=void 0,s.onProjMatrix=void 0,Object.defineProperty(l(s),Qt,{writable:!0,value:void 0}),Object.defineProperty(l(s),Yt,{writable:!0,value:void 0}),Object.defineProperty(l(s),$t,{writable:!0,value:void 0}),s.camera=r,v(l(s),Qt)[Qt]={projMatrix:R(n.projMatrix||H()),inverseProjMatrix:R(),transposedProjMatrix:R()},s.onProjMatrix=new e.EventEmitter(new i.EventDispatcher),v(l(s),Yt)[Yt]=!0,v(l(s),$t)[$t]=!1,s}h(r,t);var n=r.prototype;return n.unproject=function(t,e,i,r,n){var s=this.camera.view.canvasElement,o=s.offsetWidth/2,a=s.offsetHeight/2;return i[0]=(t[0]-o)/o,i[1]=(t[1]-a)/a,i[2]=e,i[3]=1,G(this.inverseProjMatrix,i,r),S(r,1/r[3]),r[3]=1,r[1]*=-1,G(this.camera.inverseViewMatrix,r,n),n},n.destroy=function(){t.prototype.destroy.call(this),this.onProjMatrix.clear()},a(r,[{key:"projMatrix",get:function(){return v(this,Qt)[Qt].projMatrix},set:function(t){v(this,Qt)[Qt].projMatrix.set(t),v(this,Yt)[Yt]=!0,v(this,$t)[$t]=!0,this.setDirty(),this.camera.view.redraw(),this.onProjMatrix.dispatch(this,v(this,Qt)[Qt].projMatrix)}},{key:"inverseProjMatrix",get:function(){return this.dirty&&this.cleanIfDirty(),v(this,Yt)[Yt]&&(B(v(this,Qt)[Qt].projMatrix,v(this,Qt)[Qt].inverseProjMatrix),v(this,Yt)[Yt]=!1),v(this,Qt)[Qt].inverseProjMatrix}},{key:"transposedProjMatrix",get:function(){return this.dirty&&this.cleanIfDirty(),v(this,$t)[$t]&&(N(v(this,Qt)[Qt].projMatrix,v(this,Qt)[Qt].transposedProjMatrix),v(this,$t)[$t]=!1),v(this,Qt)[Qt].transposedProjMatrix}}]),r}(e.Component);Jt.type=D;var Zt,te,ee,ie=R(),re=(Zt=n.newFloatArray(3),te=n.newFloatArray(3),ee=n.newFloatArray(3),function(t){return Zt[0]=t[0],Zt[1]=t[1],Zt[2]=t[2],te[0]=t[3],te[1]=t[4],te[2]=t[5],L(te,Zt,ee),Math.abs(U(ee))}),ne=function(){var t=n.newFloatArray(3),e=n.newFloatArray(3),i=n.newFloatArray(3);return function(r,n){t[0]=r[0],t[1]=r[1],t[2]=r[2],e[0]=r[3],e[1]=r[4],e[2]=r[5];var s=L(e,t,i),o=n[0]-r[0],a=r[3]-n[0],h=n[1]-r[1],c=r[4]-n[1],l=n[2]-r[2],d=r[5]-n[2];return s[0]+=o>a?o:a,s[1]+=h>c?h:c,s[2]+=l>d?l:d,Math.abs(U(s))}}();function se(t,e){return void 0===e&&(e=I()),e[0]=(t[0]+t[3])/2,e[1]=(t[1]+t[4])/2,e[2]=(t[2]+t[5])/2,e}n.newFloatArray(3);var oe=/*#__PURE__*/function(){function t(){this.testVertex=void 0,this.offset=void 0,this.normal=void 0,this.normal=I(),this.offset=0,this.testVertex=I()}return t.prototype.set=function(t,e,i,r){var n=1/Math.sqrt(t*t+e*e+i*i);this.normal[0]=t*n,this.normal[1]=e*n,this.normal[2]=i*n,this.offset=r*n,this.testVertex[0]=this.normal[0]>=0?1:0,this.testVertex[1]=this.normal[1]>=0?1:0,this.testVertex[2]=this.normal[2]>=0?1:0},t}(),ae=function(){this.planes=void 0,this.planes=[new oe,new oe,new oe,new oe,new oe,new oe]},he=I(),ce=I(),le=I(),de=I(),ue=I(),ve=I(),fe=R(),pe=R(),ye=I(),be=I(),we=I(),je=I(),ge=/*#__PURE__*/u("state"),Oe=/*#__PURE__*/u("frustum"),Pe=/*#__PURE__*/u("activeProjection"),me=/*#__PURE__*/function(t){function r(r,n){var s;return void 0===n&&(n={}),(s=t.call(this,r,n)||this).view=void 0,s.perspectiveProjection=void 0,s.orthoProjection=void 0,s.frustumProjection=void 0,s.customProjection=void 0,s.onProjectionType=void 0,s.onViewMatrix=void 0,s.onProjMatrix=void 0,s.onWorldAxis=void 0,s.onFrustum=void 0,Object.defineProperty(l(s),ge,{writable:!0,value:void 0}),Object.defineProperty(l(s),Oe,{writable:!0,value:void 0}),Object.defineProperty(l(s),Pe,{writable:!0,value:void 0}),s.onProjectionType=new e.EventEmitter(new i.EventDispatcher),s.onViewMatrix=new e.EventEmitter(new i.EventDispatcher),s.onProjMatrix=new e.EventEmitter(new i.EventDispatcher),s.onWorldAxis=new e.EventEmitter(new i.EventDispatcher),s.onFrustum=new e.EventEmitter(new i.EventDispatcher),s.view=r,v(l(s),ge)[ge]={eye:I(n.eye||[0,0,10]),look:I(n.look||[0,0,0]),up:I(n.up||[0,1,0]),worldUp:I([0,1,0]),worldRight:I([1,0,0]),worldForward:I([0,0,-1]),worldAxis:new Float32Array(n.worldAxis||[1,0,0,0,1,0,0,0,1]),gimbalLock:!1!==n.gimbalLock,constrainPitch:!0===n.constrainPitch,projectionType:n.projectionType||x,deviceMatrix:n.deviceMatrix?R(n.deviceMatrix):H(),hasDeviceMatrix:!!n.deviceMatrix,viewMatrix:R(),viewNormalMatrix:R(),inverseViewMatrix:R()},v(l(s),Oe)[Oe]=new ae,s.perspectiveProjection=new qt(l(s)),s.orthoProjection=new Kt(l(s)),s.customProjection=new Jt(l(s)),v(l(s),Pe)[Pe]=s.perspectiveProjection,s.perspectiveProjection.onProjMatrix.subscribe(function(){v(l(s),ge)[ge].projectionType===x&&s.onProjMatrix.dispatch(l(s),s.perspectiveProjection.projMatrix)}),s.orthoProjection.onProjMatrix.subscribe(function(){v(l(s),ge)[ge].projectionType===M&&s.onProjMatrix.dispatch(l(s),s.orthoProjection.projMatrix)}),s.frustumProjection.onProjMatrix.subscribe(function(){v(l(s),ge)[ge].projectionType===E&&s.onProjMatrix.dispatch(l(s),s.frustumProjection.projMatrix)}),s.customProjection.onProjMatrix.subscribe(function(){v(l(s),ge)[ge].projectionType===D&&s.onProjMatrix.dispatch(l(s),s.customProjection.projMatrix)}),s}h(r,t);var s=r.prototype;return s.clean=function(){var t,e=v(this,ge)[ge];this.projectionType===M?(L(v(this,ge)[ge].eye,v(this,ge)[ge].look,ye),F(ye,be),S(be,1e3,we),V(v(this,ge)[ge].look,we,je),t=je):t=v(this,ge)[ge].eye,e.hasDeviceMatrix?(X(t,v(this,ge)[ge].look,v(this,ge)[ge].up,pe),K(e.deviceMatrix,pe,e.viewMatrix)):X(t,v(this,ge)[ge].look,v(this,ge)[ge].up,e.viewMatrix),B(v(this,ge)[ge].viewMatrix,v(this,ge)[ge].inverseViewMatrix),N(v(this,ge)[ge].inverseViewMatrix,v(this,ge)[ge].viewNormalMatrix),this.view.redraw(),function(t,e,i){var r=K(e,t,ie),n=r[0],s=r[1],o=r[2],a=r[3],h=r[4],c=r[5],l=r[6],d=r[7],u=r[8],v=r[9],f=r[10],p=r[11],y=r[12],b=r[13],w=r[14],j=r[15];(i=i||new ae).planes[0].set(a-n,d-h,p-u,j-y),i.planes[1].set(a+n,d+h,p+u,j+y),i.planes[2].set(a-s,d-c,p-v,j-b),i.planes[3].set(a+s,d+c,p+v,j+b),i.planes[4].set(a-o,d-l,p-f,j-w),i.planes[5].set(a+o,d+l,p+f,j+w)}(v(this,ge)[ge].viewMatrix,v(this,Pe)[Pe].projMatrix,v(this,Oe)[Oe]),this.onViewMatrix.dispatch(this,v(this,ge)[ge].viewMatrix),this.onFrustum.dispatch(this,v(this,Oe)[Oe])},s.orbitYaw=function(t){var e=L(v(this,ge)[ge].eye,v(this,ge)[ge].look,he);q(.0174532925*t,v(this,ge)[ge].gimbalLock?v(this,ge)[ge].worldUp:v(this,ge)[ge].up,fe),e=Q(fe,e,ce),this.eye=V(v(this,ge)[ge].look,e,le),this.up=Q(fe,v(this,ge)[ge].up,de)},s.orbitPitch=function(t){if(!(v(this,ge)[ge].constrainPitch&&(t=A(v(this,ge)[ge].up,v(this,ge)[ge].worldUp)/n.DEGTORAD)<1)){var e=L(v(this,ge)[ge].eye,v(this,ge)[ge].look,he);q(.0174532925*t,T(F(e,ce),F(v(this,ge)[ge].up,le)),fe),e=Q(fe,e,de),this.up=Q(fe,v(this,ge)[ge].up,ue),this.eye=V(e,v(this,ge)[ge].look,ve)}},s.yaw=function(t){var e=L(v(this,ge)[ge].look,v(this,ge)[ge].eye,he);q(.0174532925*t,v(this,ge)[ge].gimbalLock?v(this,ge)[ge].worldUp:v(this,ge)[ge].up,fe),e=Q(fe,e,ce),this.look=V(e,v(this,ge)[ge].eye,le),v(this,ge)[ge].gimbalLock&&(this.up=Q(fe,v(this,ge)[ge].up,de))},s.pitch=function(t){if(!(v(this,ge)[ge].constrainPitch&&(t=A(v(this,ge)[ge].up,v(this,ge)[ge].worldUp)/n.DEGTORAD)<1)){var e=L(v(this,ge)[ge].look,v(this,ge)[ge].eye,he);q(.0174532925*t,T(F(e,ce),F(v(this,ge)[ge].up,le)),fe),this.up=Q(fe,v(this,ge)[ge].up,ve),e=Q(fe,e,de),this.look=V(e,v(this,ge)[ge].eye,ue)}},s.pan=function(t){var e,i=L(v(this,ge)[ge].eye,v(this,ge)[ge].look,he),r=[0,0,0];0!==t[0]&&(e=S(T(F(i,[]),F(v(this,ge)[ge].up,ce)),t[0]),r[0]+=e[0],r[1]+=e[1],r[2]+=e[2]),0!==t[1]&&(e=S(F(v(this,ge)[ge].up,le),t[1]),r[0]+=e[0],r[1]+=e[1],r[2]+=e[2]),0!==t[2]&&(e=S(F(i,de),t[2]),r[0]+=e[0],r[1]+=e[1],r[2]+=e[2]),this.eye=V(v(this,ge)[ge].eye,r,ue),this.look=V(v(this,ge)[ge].look,r,ve)},s.zoom=function(t){var e=L(v(this,ge)[ge].eye,v(this,ge)[ge].look,he),i=Math.abs(U(e)),r=Math.abs(i+t);if(!(r<.5)){var n=F(e,le);this.eye=V(v(this,ge)[ge].look,S(n,r),de)}},s.destroy=function(){t.prototype.destroy.call(this),this.onProjectionType.clear(),this.onViewMatrix.clear(),this.onProjMatrix.clear(),this.onWorldAxis.clear()},a(r,[{key:"project",get:function(){return v(this,Pe)[Pe]}},{key:"eye",get:function(){return v(this,ge)[ge].eye},set:function(t){v(this,ge)[ge].eye.set(t),this.setDirty()}},{key:"look",get:function(){return v(this,ge)[ge].look},set:function(t){v(this,ge)[ge].look.set(t),this.setDirty()}},{key:"up",get:function(){return v(this,ge)[ge].up},set:function(t){v(this,ge)[ge].up.set(t),this.setDirty()}},{key:"worldUp",get:function(){return v(this,ge)[ge].worldUp}},{key:"worldRight",get:function(){return v(this,ge)[ge].worldRight}},{key:"worldForward",get:function(){return v(this,ge)[ge].worldForward}},{key:"constrainPitch",get:function(){return v(this,ge)[ge].constrainPitch},set:function(t){v(this,ge)[ge].constrainPitch=t}},{key:"gimbalLock",get:function(){return v(this,ge)[ge].gimbalLock},set:function(t){v(this,ge)[ge].gimbalLock=t}},{key:"worldAxis",get:function(){return v(this,ge)[ge].worldAxis},set:function(t){var e=v(this,ge)[ge];e.worldAxis.set(t),e.worldRight[0]=e.worldAxis[0],e.worldRight[1]=e.worldAxis[1],e.worldRight[2]=e.worldAxis[2],e.worldUp[0]=e.worldAxis[3],e.worldUp[1]=e.worldAxis[4],e.worldUp[2]=e.worldAxis[5],e.worldForward[0]=e.worldAxis[6],e.worldForward[1]=e.worldAxis[7],e.worldForward[2]=e.worldAxis[8],this.onWorldAxis.dispatch(this,e.worldAxis)}},{key:"deviceMatrix",get:function(){return v(this,ge)[ge].deviceMatrix},set:function(t){v(this,ge)[ge].deviceMatrix.set(t||[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),v(this,ge)[ge].hasDeviceMatrix=!!t,this.setDirty()}},{key:"xUp",get:function(){return v(this,ge)[ge].worldUp[0]>v(this,ge)[ge].worldUp[1]&&v(this,ge)[ge].worldUp[0]>v(this,ge)[ge].worldUp[2]}},{key:"yUp",get:function(){return v(this,ge)[ge].worldUp[1]>v(this,ge)[ge].worldUp[0]&&v(this,ge)[ge].worldUp[1]>v(this,ge)[ge].worldUp[2]}},{key:"zUp",get:function(){return v(this,ge)[ge].worldUp[2]>v(this,ge)[ge].worldUp[0]&&v(this,ge)[ge].worldUp[2]>v(this,ge)[ge].worldUp[1]}},{key:"eyeLookDist",get:function(){return U(L(v(this,ge)[ge].look,v(this,ge)[ge].eye,he))}},{key:"viewMatrix",get:function(){return this.dirty&&this.cleanIfDirty(),v(this,ge)[ge].viewMatrix}},{key:"inverseViewMatrix",get:function(){return this.dirty&&this.cleanIfDirty(),v(this,ge)[ge].inverseViewMatrix}},{key:"projMatrix",get:function(){return v(this,Pe)[Pe].projMatrix}},{key:"frustum",get:function(){return this.dirty&&this.cleanIfDirty(),v(this,Oe)[Oe]}},{key:"projectionType",get:function(){return v(this,ge)[ge].projectionType},set:function(t){t=t||x,v(this,ge)[ge].projectionType!==t&&(t===x?v(this,Pe)[Pe]=this.perspectiveProjection:t===M?v(this,Pe)[Pe]=this.orthoProjection:t===E?v(this,Pe)[Pe]=this.frustumProjection:t===D?v(this,Pe)[Pe]=this.customProjection:(this.error("Unsupported value for 'projection': "+t+" defaulting to PerspectiveProjectionType"),v(this,Pe)[Pe]=this.perspectiveProjection,t=x),v(this,Pe)[Pe].clean(),v(this,ge)[ge].projectionType=t,this.clean(),this.onProjectionType.dispatch(this,v(this,ge)[ge].projectionType),this.onProjMatrix.dispatch(this,v(this,Pe)[Pe].projMatrix))}}]),r}(e.Component),ke={viewerId:"",time:0,startTime:0,prevTime:0,deltaTime:0},xe=/*#__PURE__*/u("viewersRenderInfo"),Me=/*#__PURE__*/u("viewerIDMap"),Ee=/*#__PURE__*/u("taskQueue"),De=/*#__PURE__*/u("taskBudget"),Ae=/*#__PURE__*/u("lastTime"),Ie=/*#__PURE__*/u("elapsedTime"),Ce=/*#__PURE__*/u("runTasks"),Se=/*#__PURE__*/u("runTasksUntil"),Ve=/*#__PURE__*/u("fireTickEvents"),Le=/*#__PURE__*/u("renderViewers");function Te(t){v(this,Se)[Se](t+v(this,De)[De]),this.getNumTasks(),v(this,De)}function Ue(t){void 0===t&&(t=-1);for(var e=(new Date).getTime(),i=0;v(this,Ee)[Ee].length>0&&(t<0||e<t);){var r=v(this,Ee)[Ee].shift(),n=v(this,Ee)[Ee].shift();n?r.call(n):r(),e=(new Date).getTime(),i++}return i}function ze(t){for(var e in ke.time=t,Re.viewers)if(this.viewers.hasOwnProperty(e)){var i=this.viewers[e];ke.viewerId=e,ke.startTime=i.startTime,ke.deltaTime=null!=ke.prevTime?ke.time-ke.prevTime:0,i.onTick.dispatch(i,ke)}ke.prevTime=t}function Fe(){for(var t in this.viewers)if(this.viewers.hasOwnProperty(t)){var e=this.viewers[t],i=v(this,xe)[xe][t];i||(i=v(this,xe)[xe][t]={}),e.render({})}}var Re=new(/*#__PURE__*/function(){function t(){var t=this;Object.defineProperty(this,Le,{value:Fe}),Object.defineProperty(this,Ve,{value:ze}),Object.defineProperty(this,Se,{value:Ue}),Object.defineProperty(this,Ce,{value:Te}),this.viewers=void 0,Object.defineProperty(this,xe,{writable:!0,value:{}}),Object.defineProperty(this,Me,{writable:!0,value:new j}),Object.defineProperty(this,Ee,{writable:!0,value:new g}),Object.defineProperty(this,De,{writable:!0,value:10}),Object.defineProperty(this,Ae,{writable:!0,value:0}),Object.defineProperty(this,Ie,{writable:!0,value:0}),this.viewers={},requestAnimationFrame(function e(){var i=Date.now();v(t,Ae)[Ae]>0&&(v(t,Ie)[Ie]=i-v(t,Ae)[Ae]),v(t,Ce)[Ce](i),v(t,Ve)[Ve](i),v(t,Le)[Le](),v(t,Ae)[Ae]=i,requestAnimationFrame(e)})}var e=t.prototype;return e.registerViewer=function(t){if(t.id){if(this.viewers[t.id])return void console.error("[ERROR] Viewer "+O(t.id)+" already exists")}else t.id=v(this,Me)[Me].addItem({});this.viewers[t.id]=t,v(this,xe)[xe][t.id]={}},e.deregisterViewer=function(t){this.viewers[t.id]&&(v(this,Me)[Me].removeItem(t.id),delete this.viewers[t.id],delete v(this,xe)[xe][t.id])},e.scheduleTask=function(t,e){v(this,Ee)[Ee].push(t),v(this,Ee)[Ee].push(e)},e.getNumTasks=function(){return v(this,Ee)[Ee].length},t}()),_e=I(),We=I(),He=I(),qe=I(),Xe=I(),Be=/*#__PURE__*/u("duration"),Ne=/*#__PURE__*/u("look1"),Ge=/*#__PURE__*/u("eye1"),Ke=/*#__PURE__*/u("up1"),Qe=/*#__PURE__*/u("look2"),Ye=/*#__PURE__*/u("eye2"),$e=/*#__PURE__*/u("up2"),Je=/*#__PURE__*/u("orthoScale1"),Ze=/*#__PURE__*/u("orthoScale2"),ti=/*#__PURE__*/u("fit"),ei=/*#__PURE__*/u("trail"),ii=/*#__PURE__*/u("flying"),ri=/*#__PURE__*/u("flyEyeLookUp"),ni=/*#__PURE__*/u("flyingEye"),si=/*#__PURE__*/u("flyingLook"),oi=/*#__PURE__*/u("callback"),ai=/*#__PURE__*/u("callbackScope"),hi=/*#__PURE__*/u("time1"),ci=/*#__PURE__*/u("time2"),li=/*#__PURE__*/u("flyingEyeLookUp"),di=/*#__PURE__*/u("fitFOV"),ui=/*#__PURE__*/u("projection2"),vi=/*#__PURE__*/u("projMatrix1"),fi=/*#__PURE__*/u("projMatrix2"),pi=/*#__PURE__*/u("jumpTo"),yi=/*#__PURE__*/u("update"),bi=/*#__PURE__*/u("ease"),wi=/*#__PURE__*/u("easeInCubic"),ji=/*#__PURE__*/u("easeOutExpo"),gi=/*#__PURE__*/function(t){function r(r,n){var s;return s=t.call(this,r,n)||this,Object.defineProperty(l(s),yi,{value:Pi}),Object.defineProperty(l(s),pi,{value:Oi}),s.view=void 0,s.camera=void 0,Object.defineProperty(l(s),Be,{writable:!0,value:void 0}),Object.defineProperty(l(s),Ne,{writable:!0,value:void 0}),Object.defineProperty(l(s),Ge,{writable:!0,value:void 0}),Object.defineProperty(l(s),Ke,{writable:!0,value:void 0}),Object.defineProperty(l(s),Qe,{writable:!0,value:void 0}),Object.defineProperty(l(s),Ye,{writable:!0,value:void 0}),Object.defineProperty(l(s),$e,{writable:!0,value:void 0}),Object.defineProperty(l(s),Je,{writable:!0,value:void 0}),Object.defineProperty(l(s),Ze,{writable:!0,value:void 0}),Object.defineProperty(l(s),ti,{writable:!0,value:void 0}),Object.defineProperty(l(s),ei,{writable:!0,value:void 0}),Object.defineProperty(l(s),ii,{writable:!0,value:void 0}),Object.defineProperty(l(s),ri,{writable:!0,value:void 0}),Object.defineProperty(l(s),ni,{writable:!0,value:void 0}),Object.defineProperty(l(s),si,{writable:!0,value:void 0}),Object.defineProperty(l(s),oi,{writable:!0,value:void 0}),Object.defineProperty(l(s),ai,{writable:!0,value:void 0}),Object.defineProperty(l(s),hi,{writable:!0,value:void 0}),Object.defineProperty(l(s),ci,{writable:!0,value:void 0}),s.easing=void 0,Object.defineProperty(l(s),li,{writable:!0,value:void 0}),Object.defineProperty(l(s),di,{writable:!0,value:void 0}),Object.defineProperty(l(s),ui,{writable:!0,value:void 0}),Object.defineProperty(l(s),vi,{writable:!0,value:void 0}),Object.defineProperty(l(s),fi,{writable:!0,value:void 0}),s.onStarted=void 0,s.onStopped=void 0,s.onCancelled=void 0,s.view=r,s.camera=r.camera,v(l(s),Ne)[Ne]=I(),v(l(s),Ge)[Ge]=I(),v(l(s),Ke)[Ke]=I(),v(l(s),Qe)[Qe]=I(),v(l(s),Ye)[Ye]=I(),v(l(s),$e)[$e]=I(),v(l(s),Je)[Je]=1,v(l(s),Ze)[Ze]=1,v(l(s),ii)[ii]=!1,v(l(s),ri)[ri]=!1,v(l(s),ni)[ni]=!1,v(l(s),si)[si]=!1,v(l(s),oi)[oi]=null,v(l(s),ai)[ai]=null,v(l(s),hi)[hi]=null,v(l(s),ci)[ci]=null,s.easing=!0,v(l(s),ei)[ei]=!1,v(l(s),ti)[ti]=!0,v(l(s),Be)[Be]=500,s.onStarted=new e.EventEmitter(new i.EventDispatcher),s.onStopped=new e.EventEmitter(new i.EventDispatcher),s.onCancelled=new e.EventEmitter(new i.EventDispatcher),s}h(r,t);var s=r.prototype;return s.flyTo=function(t,e){void 0===t&&(t={}),v(this,ii)[ii]&&this.stop(),v(this,ii)[ii]=!1,v(this,ni)[ni]=!1,v(this,si)[si]=!1,v(this,li)[li]=!1,v(this,oi)[oi]=e;var i,r,s,o,a=this.camera,h=!!t.projection&&t.projection!==a.projectionType;v(this,Ge)[Ge][0]=a.eye[0],v(this,Ge)[Ge][1]=a.eye[1],v(this,Ge)[Ge][2]=a.eye[2],v(this,Ne)[Ne][0]=a.look[0],v(this,Ne)[Ne][1]=a.look[1],v(this,Ne)[Ne][2]=a.look[2],v(this,Ke)[Ke][0]=a.up[0],v(this,Ke)[Ke][1]=a.up[1],v(this,Ke)[Ke][2]=a.up[2],v(this,Je)[Je]=a.orthoProjection.scale,v(this,Ze)[Ze]=t.orthoScale||v(this,Je)[Je],t.aabb?i=t.aabb:t.eye&&t.look||t.up?(r=t.eye,s=t.look,o=t.up):t.eye?r=t.eye:t.look?s=t.look:h||(i=this.view.aabb);var c=t.poi;if(i){if(i[3]<i[0]||i[4]<i[1]||i[5]<i[2])return;if(i[3]===i[0]&&i[4]===i[1]&&i[5]===i[2])return;var l=se(i=i.slice());v(this,Qe)[Qe]=c||l;var d=F(L(v(this,Ge)[Ge],v(this,Ne)[Ne],_e)),u=c?ne(i,c):re(i),f=t.fitFOV||v(this,di)[di],p=Math.abs(u/Math.tan(f*n.DEGTORAD));v(this,Ze)[Ze]=1.1*u,v(this,Ye)[Ye][0]=v(this,Qe)[Qe][0]+d[0]*p,v(this,Ye)[Ye][1]=v(this,Qe)[Qe][1]+d[1]*p,v(this,Ye)[Ye][2]=v(this,Qe)[Qe][2]+d[2]*p,v(this,$e)[$e][0]=v(this,Ke)[Ke][0],v(this,$e)[$e][1]=v(this,Ke)[Ke][1],v(this,$e)[$e][2]=v(this,Ke)[Ke][2],v(this,li)[li]=!0}else(r||s||o)&&(v(this,li)[li]=!!r&&!!s&&!!o,v(this,ni)[ni]=!!r&&!s,v(this,si)[si]=!!s&&!r,r&&(v(this,Ye)[Ye][0]=r[0],v(this,Ye)[Ye][1]=r[1],v(this,Ye)[Ye][2]=r[2]),s&&(v(this,Qe)[Qe][0]=s[0],v(this,Qe)[Qe][1]=s[1],v(this,Qe)[Qe][2]=s[2]),o&&(v(this,$e)[$e][0]=o[0],v(this,$e)[$e][1]=o[1],v(this,$e)[$e][2]=o[2]));h?(t.projection===M&&a.projectionType!==M&&(v(this,ui)[ui]=M,v(this,vi)[vi]=a.projMatrix.slice(),v(this,fi)[fi]=a.orthoProjection.projMatrix.slice(),a.projectionType=D),t.projection===x&&a.projectionType!==x&&(v(this,ui)[ui]=x,v(this,vi)[vi]=a.projMatrix.slice(),v(this,fi)[fi]=a.perspectiveProjection.projMatrix.slice(),a.projectionType=D)):v(this,ui)[ui]=null,this.onStarted.dispatch(this,null),v(this,hi)[hi]=Date.now(),v(this,ci)[ci]=v(this,hi)[hi]+(t.duration?1e3*t.duration:v(this,Be)[Be]),v(this,ii)[ii]=!0,Re.scheduleTask(v(this,yi)[yi],this)},s.jumpTo=function(t){v(this,pi)[pi](t)},s.stop=function(){if(v(this,ii)[ii]){v(this,ii)[ii]=!1,v(this,hi)[hi]=null,v(this,ci)[ci]=null,v(this,ui)[ui]&&(this.camera.projectionType=v(this,ui)[ui]);var t=v(this,oi)[oi];t&&(v(this,oi)[oi]=null,t()),this.onStopped.dispatch(this,null)}},s.cancel=function(){v(this,ii)[ii]&&(v(this,ii)[ii]=!1,v(this,hi)[hi]=null,v(this,ci)[ci]=null,v(this,oi)[oi]&&(v(this,oi)[oi]=null),this.onCancelled.dispatch(this,null))},s.destroy=function(){this.stop(),t.prototype.destroy.call(this),this.onStarted.clear(),this.onStopped.clear(),this.onCancelled.clear()},a(r,[{key:"duration",get:function(){return v(this,Be)[Be]/1e3},set:function(t){v(this,Be)[Be]=t?1e3*t:500,this.stop()}},{key:"fit",get:function(){return v(this,ti)[ti]},set:function(t){v(this,ti)[ti]=t}},{key:"fitFOV",get:function(){return v(this,di)[di]},set:function(t){v(this,di)[di]=t}},{key:"trail",get:function(){return v(this,ei)[ei]},set:function(t){v(this,ei)[ei]=t}}]),r}(e.Component);function Oi(t){v(this,ii)[ii]&&this.stop();var e,i,r,s,o=this.camera;t.aabb?e=t.aabb:t.eye||t.look||t.up?(i=t.eye,r=t.look,s=t.up):e=this.view.aabb;var a=t.poi;if(e){if(e[3]<=e[0]||e[4]<=e[1]||e[5]<=e[2])return;var h,c=a?ne(e,a):re(e);r=a||se(e,r),v(this,ei)[ei]?L(o.look,r,Xe):L(o.eye,o.look,Xe),F(Xe),h=(void 0!==t.fit?t.fit:v(this,ti)[ti])?Math.abs(c/Math.tan((t.fitFOV||v(this,di)[di])*n.DEGTORAD)):U(L(o.eye,o.look,_e)),S(Xe,h),o.eye=V(r,Xe,_e),o.look=r,this.camera.orthoProjection.scale=1.1*c}else(i||r||s)&&(i&&(o.eye=i),r&&(o.look=r),s&&(o.up=s));t.projection&&(o.projectionType=t.projection)}function Pi(){if(v(this,ii)[ii]){var t=(Date.now()-v(this,hi)[hi])/(v(this,ci)[ci]-v(this,hi)[hi]),e=t>=1;t>1&&(t=1);var i=this.easing?v(gi,bi)[bi](t,0,1,1):t,r=this.camera;if(v(this,ni)[ni]||v(this,si)[si]?v(this,ni)[ni]?(L(r.eye,r.look,Xe),r.eye=z(i,0,1,v(this,Ge)[Ge],v(this,Ye)[Ye],He),r.look=L(He,Xe,We)):v(this,si)[si]&&(r.look=z(i,0,1,v(this,Ne)[Ne],v(this,Qe)[Qe],We),r.up=z(i,0,1,v(this,Ke)[Ke],v(this,$e)[$e],qe)):v(this,li)[li]&&(r.eye=z(i,0,1,v(this,Ge)[Ge],v(this,Ye)[Ye],He),r.look=z(i,0,1,v(this,Ne)[Ne],v(this,Qe)[Qe],We),r.up=z(i,0,1,v(this,Ke)[Ke],v(this,$e)[$e],qe)),v(this,ui)[ui]){var n=v(this,ui)[ui]===M?v(gi,ji)[ji](t,0,1,1):v(gi,wi)[wi](t,0,1,1);r.customProjection.projMatrix=function(t,e,i,r,n,s){var o=R(),a=(t-0)/1;return o[0]=r[0]+a*(n[0]-r[0]),o[1]=r[1]+a*(n[1]-r[1]),o[2]=r[2]+a*(n[2]-r[2]),o[3]=r[3]+a*(n[3]-r[3]),o[4]=r[4]+a*(n[4]-r[4]),o[5]=r[5]+a*(n[5]-r[5]),o[6]=r[6]+a*(n[6]-r[6]),o[7]=r[7]+a*(n[7]-r[7]),o[8]=r[8]+a*(n[8]-r[8]),o[9]=r[9]+a*(n[9]-r[9]),o[10]=r[10]+a*(n[10]-r[10]),o[11]=r[11]+a*(n[11]-r[11]),o[12]=r[12]+a*(n[12]-r[12]),o[13]=r[13]+a*(n[13]-r[13]),o[14]=r[14]+a*(n[14]-r[14]),o[15]=r[15]+a*(n[15]-r[15]),o}(n,0,0,v(this,vi)[vi],v(this,fi)[fi])}else r.orthoProjection.scale=v(this,Je)[Je]+t*(v(this,Ze)[Ze]-v(this,Je)[Je]);if(e)return r.orthoProjection.scale=v(this,Ze)[Ze],void this.stop();Re.scheduleTask(v(this,yi)[yi],this)}}Object.defineProperty(gi,ji,{value:function(t,e,i,r){return i*(1-Math.pow(2,-10*t/r))+e}}),Object.defineProperty(gi,wi,{value:function(t,e,i,r){return i*(t/=r)*t*t+e}}),Object.defineProperty(gi,bi,{value:function(t,e,i,r){return-i*(t/=r)*(t-2)+e}});var mi=/*#__PURE__*/u("onTick"),ki=/*#__PURE__*/u("backgroundColor"),xi=/*#__PURE__*/u("backgroundColorFromAmbientLight"),Mi=/*#__PURE__*/u("resolutionScale"),Ei=/*#__PURE__*/u("numObjects"),Di=/*#__PURE__*/u("objectIds"),Ai=/*#__PURE__*/u("numVisibleObjects"),Ii=/*#__PURE__*/u("visibleObjectIds"),Ci=/*#__PURE__*/u("numXRayedObjects"),Si=/*#__PURE__*/u("xrayedObjectIds"),Vi=/*#__PURE__*/u("numHighlightedObjects"),Li=/*#__PURE__*/u("highlightedObjectIds"),Ti=/*#__PURE__*/u("numSelectedObjects"),Ui=/*#__PURE__*/u("selectedObjectIds"),zi=/*#__PURE__*/u("numColorizedObjects"),Fi=/*#__PURE__*/u("colorizedObjectIds"),Ri=/*#__PURE__*/u("numOpacityObjects"),_i=/*#__PURE__*/u("opacityObjectIds"),Wi=/*#__PURE__*/u("qualityRender"),Hi=/*#__PURE__*/u("lightsHash"),qi=/*#__PURE__*/u("sectionPlanesHash"),Xi=/*#__PURE__*/u("registerSectionPlane"),Bi=/*#__PURE__*/u("deregisterSectionPlane"),Ni=/*#__PURE__*/u("initObjects"),Gi=/*#__PURE__*/u("createObjects"),Ki=/*#__PURE__*/u("destroyObjects"),Qi=/*#__PURE__*/function(t){function r(r){var n;if(n=t.call(this,null,r)||this,Object.defineProperty(l(n),Ki,{value:tr}),Object.defineProperty(l(n),Gi,{value:Zi}),Object.defineProperty(l(n),Ni,{value:Ji}),Object.defineProperty(l(n),Bi,{value:$i}),Object.defineProperty(l(n),Xi,{value:Yi}),n.viewIndex=void 0,n.camera=void 0,n.canvasElement=void 0,n.transparent=void 0,n.boundary=void 0,n.logarithmicDepthBufferEnabled=void 0,n.sao=void 0,n.cameraFlight=void 0,n.metrics=void 0,n.xrayMaterial=void 0,n.highlightMaterial=void 0,n.selectedMaterial=void 0,n.edgeMaterial=void 0,n.pointsMaterial=void 0,n.linesMaterial=void 0,n.objects=void 0,n.visibleObjects=void 0,n.xrayedObjects=void 0,n.highlightedObjects=void 0,n.selectedObjects=void 0,n.colorizedObjects=void 0,n.opacityObjects=void 0,n.sectionPlanes=void 0,n.sectionPlanesList=[],n.lights=void 0,n.lightsList=[],n.gammaOutput=void 0,n.layers=void 0,n.autoLayers=void 0,n.onBoundary=void 0,n.onObjectVisibility=void 0,n.onObjectXRayed=void 0,n.onLayerCreated=void 0,n.onLayerDestroyed=void 0,n.onSectionPlaneCreated=void 0,n.onSectionPlaneDestroyed=void 0,Object.defineProperty(l(n),mi,{writable:!0,value:void 0}),Object.defineProperty(l(n),ki,{writable:!0,value:void 0}),Object.defineProperty(l(n),xi,{writable:!0,value:void 0}),Object.defineProperty(l(n),Mi,{writable:!0,value:void 0}),Object.defineProperty(l(n),Ei,{writable:!0,value:void 0}),Object.defineProperty(l(n),Di,{writable:!0,value:void 0}),Object.defineProperty(l(n),Ai,{writable:!0,value:void 0}),Object.defineProperty(l(n),Ii,{writable:!0,value:void 0}),Object.defineProperty(l(n),Ci,{writable:!0,value:void 0}),Object.defineProperty(l(n),Si,{writable:!0,value:void 0}),Object.defineProperty(l(n),Vi,{writable:!0,value:void 0}),Object.defineProperty(l(n),Li,{writable:!0,value:void 0}),Object.defineProperty(l(n),Ti,{writable:!0,value:void 0}),Object.defineProperty(l(n),Ui,{writable:!0,value:void 0}),Object.defineProperty(l(n),zi,{writable:!0,value:void 0}),Object.defineProperty(l(n),Fi,{writable:!0,value:void 0}),Object.defineProperty(l(n),Ri,{writable:!0,value:void 0}),Object.defineProperty(l(n),_i,{writable:!0,value:void 0}),Object.defineProperty(l(n),Wi,{writable:!0,value:void 0}),Object.defineProperty(l(n),Hi,{writable:!0,value:null}),Object.defineProperty(l(n),qi,{writable:!0,value:null}),n.viewer=r.viewer,!((r.canvasElement||document.getElementById(r.canvasId))instanceof HTMLCanvasElement))throw"Mandatory View config expected: valid canvasId or canvasElement";n.viewIndex=0,n.objects={},n.visibleObjects={},n.xrayedObjects={},n.highlightedObjects={},n.selectedObjects={},n.colorizedObjects={},n.opacityObjects={},n.sectionPlanes={},n.sectionPlanesList=[],n.lights={},n.lightsList=[],n.layers={},v(l(n),Ei)[Ei]=0,v(l(n),Di)[Di]=null,v(l(n),Ai)[Ai]=0,v(l(n),Ii)[Ii]=null,v(l(n),Ci)[Ci]=0,v(l(n),Si)[Si]=null,v(l(n),Vi)[Vi]=0,v(l(n),Li)[Li]=null,v(l(n),Ti)[Ti]=0,v(l(n),Ui)[Ui]=null,v(l(n),zi)[zi]=0,v(l(n),Fi)[Fi]=null,v(l(n),Ri)[Ri]=0,v(l(n),_i)[_i]=null,v(l(n),Wi)[Wi]=!!r.qualityRender,n.gammaOutput=!0,v(l(n),qi)[qi]=null,v(l(n),Hi)[Hi]=null,n.onBoundary=new e.EventEmitter(new i.EventDispatcher),v(l(n),Mi)[Mi]=1,v(l(n),ki)[ki]=I([r.backgroundColor?r.backgroundColor[0]:1,r.backgroundColor?r.backgroundColor[1]:1,r.backgroundColor?r.backgroundColor[2]:1]),v(l(n),xi)[xi]=!!r.backgroundColorFromAmbientLight,n.canvasElement=r.canvasElement,n.transparent=!!r.transparent,n.canvasElement.width=n.canvasElement.clientWidth,n.canvasElement.height=n.canvasElement.clientHeight,n.boundary=[n.canvasElement.offsetLeft,n.canvasElement.offsetTop,n.canvasElement.clientWidth,n.canvasElement.clientHeight];var s=0,o=0,a=0,h=0,c=0,d=0,u=null,f=null;return v(l(n),mi)[mi]=n.viewer.onTick.subscribe(function(){var t=n.canvasElement,e=v(l(n),Mi)[Mi]!==f,i=window.innerWidth!==s||window.innerHeight!==o,r=t.clientWidth!==a||t.clientHeight!==h,p=t.offsetLeft!==c||t.offsetTop!==d,y=t.parentElement;if(e||i||r||p||y!==u){if(e||r||p){var b=t.clientWidth,w=t.clientHeight;(e||r)&&(t.width=Math.round(t.clientWidth*v(l(n),Mi)[Mi]),t.height=Math.round(t.clientHeight*v(l(n),Mi)[Mi]));var j=n.boundary;j[0]=t.offsetLeft,j[1]=t.offsetTop,j[2]=b,j[3]=w,e&&!r||n.onBoundary.dispatch(l(n),j),a=b,h=w}e&&(f=v(l(n),Mi)[Mi]),i&&(s=window.innerWidth,o=window.innerHeight),p&&(c=t.offsetLeft,d=t.offsetTop),u=y}}),n.camera=new me(l(n)),n.sao=new ht(l(n),{}),n.cameraFlight=new gi(l(n),{duration:.5}),n.metrics=new ot(l(n),{units:r.units,scale:r.scale,origin:r.origin}),n.xrayMaterial=new Lt(l(n),{fill:!0,fillColor:[.9,.7,.6],fillAlpha:.4,edges:!0,edgeColor:[.5,.4,.4],edgeAlpha:1,edgeWidth:1}),n.highlightMaterial=new Lt(l(n),{fill:!0,fillColor:[1,1,0],fillAlpha:.5,edges:!0,edgeColor:[.5,.4,.4],edgeAlpha:1,edgeWidth:1}),n.selectedMaterial=new Lt(l(n),{fill:!0,fillColor:[0,1,0],fillAlpha:.5,edges:!0,edgeColor:[.4,.5,.4],edgeAlpha:1,edgeWidth:1}),n.edgeMaterial=new Ut(l(n),{edgeColor:[0,0,0],edgeAlpha:1,edgeWidth:1,edges:!0,renderModes:[m]}),n.pointsMaterial=new Ft(l(n),{pointSize:1,roundPoints:!0,perspectivePoints:!0,minPerspectivePointSize:1,maxPerspectivePointSize:6,filterIntensity:!1,minIntensity:0,maxIntensity:1}),n.linesMaterial=new lt(l(n),{lineWidth:1}),n.lights={},v(l(n),Wi)[Wi]=!!r.qualityRender,n.autoLayers=!1!==r.autoLayers,n.logarithmicDepthBufferEnabled=!!r.logarithmicDepthBufferEnabled,n.onObjectVisibility=new e.EventEmitter(new i.EventDispatcher),n.onObjectXRayed=new e.EventEmitter(new i.EventDispatcher),n.onLayerCreated=new e.EventEmitter(new i.EventDispatcher),n.onLayerDestroyed=new e.EventEmitter(new i.EventDispatcher),n.onSectionPlaneCreated=new e.EventEmitter(new i.EventDispatcher),n.onSectionPlaneDestroyed=new e.EventEmitter(new i.EventDispatcher),v(l(n),Ni)[Ni](),n}h(r,t);var n=r.prototype;return n.registerViewObject=function(t){this.objects[t.id]=t,v(this,Ei)[Ei]++,v(this,Di)[Di]=null},n.deregisterViewObject=function(t){delete this.objects[t.id],delete this.visibleObjects[t.id],delete this.xrayedObjects[t.id],delete this.highlightedObjects[t.id],delete this.selectedObjects[t.id],delete this.colorizedObjects[t.id],delete this.opacityObjects[t.id],v(this,Ei)[Ei]--,v(this,Di)[Di]=null},n.objectVisibilityUpdated=function(t,e,i){void 0===i&&(i=!0),e?(this.visibleObjects[t.id]=t,v(this,Ai)[Ai]++):(delete this.visibleObjects[t.id],v(this,Ai)[Ai]--),v(this,Ii)[Ii]=null,i&&this.onObjectVisibility.dispatch(this,t)},n.objectXRayedUpdated=function(t,e,i){void 0===i&&(i=!0),e?(this.xrayedObjects[t.id]=t,v(this,Ci)[Ci]++):(delete this.xrayedObjects[t.id],v(this,Ci)[Ci]--),v(this,Si)[Si]=null,i&&this.onObjectXRayed.dispatch(this,t)},n.objectHighlightedUpdated=function(t,e){e?(this.highlightedObjects[t.id]=t,v(this,Vi)[Vi]++):(delete this.highlightedObjects[t.id],v(this,Vi)[Vi]--),v(this,Li)[Li]=null},n.objectSelectedUpdated=function(t,e){e?(this.selectedObjects[t.id]=t,v(this,Ti)[Ti]++):(delete this.selectedObjects[t.id],v(this,Ti)[Ti]--),v(this,Ui)[Ui]=null},n.objectColorizeUpdated=function(t,e){e?(this.colorizedObjects[t.id]=t,v(this,zi)[zi]++):(delete this.colorizedObjects[t.id],v(this,zi)[zi]--),v(this,Fi)[Fi]=null},n.objectOpacityUpdated=function(t,e){e?(this.opacityObjects[t.id]=t,v(this,Ri)[Ri]++):(delete this.opacityObjects[t.id],v(this,Ri)[Ri]--),v(this,_i)[_i]=null},n.createSectionPlane=function(t){var e=this,i=t.id||P();this.sectionPlanes[i]&&(this.error('SectionPlane with ID "'+i+'" already exists - will randomly-generate ID'),i=P());var r=new et(this,t);return v(this,Xi)[Xi](r),r.onDestroyed.one(function(){v(e,Bi)[Bi](r)}),r},n.clearSectionPlanes=function(){for(var t=Object.keys(this.sectionPlanes),e=0,i=t.length;e<i;e++)this.sectionPlanes[t[e]].destroy();this.sectionPlanesList.length=0,v(this,qi)[qi]=null},n.getSectionPlanesHash=function(){if(v(this,qi)[qi])return v(this,qi)[qi];if(0===this.sectionPlanesList.length)return v(this,qi)[qi]=";";for(var t=[],e=0,i=this.sectionPlanesList.length;e<i;e++)t.push("cp");return t.push(";"),v(this,qi)[qi]=t.join(""),v(this,qi)[qi]},n.registerLight=function(t){this.lightsList.push(t),this.lights[t.id]=t,v(this,Hi)[Hi]=null,this.rebuild()},n.deregisterLight=function(t){for(var e=0,i=this.lightsList.length;e<i;e++)if(this.lightsList[e].id===t.id)return this.lightsList.splice(e,1),v(this,Hi)[Hi]=null,delete this.lights[t.id],void this.rebuild()},n.clearLights=function(){for(var t=Object.keys(this.lights),e=0,i=t.length;e<i;e++)this.lights[t[e]].destroy()},n.getLightsHash=function(){if(v(this,Hi)[Hi])return v(this,Hi)[Hi];if(0===this.lightsList.length)return v(this,Hi)[Hi]=";";for(var t=[],e=this.lightsList,i=0,r=e.length;i<r;i++){var n=e[i];t.push("/"),t.push(n.type),t.push("world"===n.space?"w":"v"),n.castsShadow&&t.push("sh")}return t.push(";"),v(this,Hi)[Hi]=t.join(""),v(this,Hi)[Hi]},n.rebuild=function(){this.viewer.renderer.needsRebuild(this.viewIndex)},n.redraw=function(){this.viewer.renderer.setImageDirty(this.viewIndex)},n.destroy=function(){this.viewer.onTick.unsubscribe(v(this,mi)[mi]),t.prototype.destroy.call(this),this.onObjectVisibility.clear(),this.onObjectXRayed.clear(),this.onLayerCreated.clear(),this.onLayerDestroyed.clear(),this.onSectionPlaneCreated.clear(),this.onSectionPlaneDestroyed.clear()},n.getAmbientColorAndIntensity=function(){return[0,0,0,1]},n.setObjectsVisible=function(t,e){return this.withObjects(t,function(t){var i=t.visible!==e;return t.visible=e,i})},n.setObjectsCollidable=function(t,e){return this.withObjects(t,function(t){var i=t.collidable!==e;return t.collidable=e,i})},n.setObjectsCulled=function(t,e){return this.withObjects(t,function(t){var i=t.culled!==e;return t.culled=e,i})},n.setObjectsSelected=function(t,e){return this.withObjects(t,function(t){var i=t.selected!==e;return t.selected=e,i})},n.setObjectsHighlighted=function(t,e){return this.withObjects(t,function(t){var i=t.highlighted!==e;return t.highlighted=e,i})},n.setObjectsXRayed=function(t,e){return this.withObjects(t,function(t){var i=t.xrayed!==e;return i&&(t.xrayed=e),i})},n.setObjectsColorized=function(t,e){return this.withObjects(t,function(t){t.colorize=e})},n.setObjectsOpacity=function(t,e){return this.withObjects(t,function(t){var i=t.opacity!==e;return i&&(t.opacity=e),i})},n.setObjectsPickable=function(t,e){return this.withObjects(t,function(t){var i=t.pickable!==e;return i&&(t.pickable=e),i})},n.setObjectsClippable=function(t,e){return this.withObjects(t,function(t){var i=t.clippable!==e;return i&&(t.clippable=e),i})},n.withObjects=function(t,e){for(var i=!1,r=0,n=t.length;r<n;r++){var s=this.objects[t[r]];s&&(i=e(s)||i)}return i},n.createLayer=function(t){var e=this,i=this.layers[t.id];return i||(i=new At({id:t.id,view:this,viewer:this.viewer}),this.layers[t.id]=i,this.onLayerCreated.dispatch(this,i),i.onDestroyed.one(function(){delete e.layers[i.id],e.onLayerDestroyed.dispatch(e,i)})),i.autoDestroy=!1,i},a(r,[{key:"aabb",get:function(){return this.viewer.scene.aabb}},{key:"backgroundColor",get:function(){return v(this,ki)[ki]},set:function(t){t?(v(this,ki)[ki][0]=t[0],v(this,ki)[ki][1]=t[1],v(this,ki)[ki][2]=t[2]):(v(this,ki)[ki][0]=1,v(this,ki)[ki][1]=1,v(this,ki)[ki][2]=1),this.redraw()}},{key:"backgroundColorFromAmbientLight",get:function(){return v(this,xi)[xi]},set:function(t){v(this,xi)[xi]=!1!==t}},{key:"resolutionScale",get:function(){return v(this,Mi)[Mi]},set:function(t){if((t=t||1)!==v(this,Mi)[Mi]){v(this,Mi)[Mi]=t;var e=this.canvasElement;e.width=Math.round(e.clientWidth*v(this,Mi)[Mi]),e.height=Math.round(e.clientHeight*v(this,Mi)[Mi]),this.redraw()}}},{key:"gammaFactor",get:function(){return 1}},{key:"qualityRender",get:function(){return v(this,Wi)[Wi]},set:function(t){v(this,Wi)[Wi]!==t&&(v(this,Wi)[Wi]=t,this.redraw())}},{key:"numObjects",get:function(){return v(this,Ei)[Ei]}},{key:"objectIds",get:function(){return v(this,Di)[Di]||(v(this,Di)[Di]=Object.keys(this.objects)),v(this,Di)[Di]}},{key:"numVisibleObjects",get:function(){return v(this,Ai)[Ai]}},{key:"visibleObjectIds",get:function(){return v(this,Ii)[Ii]||(v(this,Ii)[Ii]=Object.keys(this.visibleObjects)),v(this,Ii)[Ii]}},{key:"numXRayedObjects",get:function(){return v(this,Ci)[Ci]}},{key:"xrayedObjectIds",get:function(){return v(this,Si)[Si]||(v(this,Si)[Si]=Object.keys(this.xrayedObjects)),v(this,Si)[Si]}},{key:"numHighlightedObjects",get:function(){return v(this,Vi)[Vi]}},{key:"highlightedObjectIds",get:function(){return v(this,Li)[Li]||(v(this,Li)[Li]=Object.keys(this.highlightedObjects)),v(this,Li)[Li]}},{key:"numSelectedObjects",get:function(){return v(this,Ti)[Ti]}},{key:"selectedObjectIds",get:function(){return v(this,Ui)[Ui]||(v(this,Ui)[Ui]=Object.keys(this.selectedObjects)),v(this,Ui)[Ui]}},{key:"numColorizedObjects",get:function(){return v(this,zi)[zi]}},{key:"colorizedObjectIds",get:function(){return v(this,Fi)[Fi]||(v(this,Fi)[Fi]=Object.keys(this.colorizedObjects)),v(this,Fi)[Fi]}},{key:"opacityObjectIds",get:function(){return v(this,_i)[_i]||(v(this,_i)[_i]=Object.keys(this.opacityObjects)),v(this,_i)[_i]}},{key:"numOpacityObjects",get:function(){return v(this,Ri)[Ri]}}]),r}(e.Component);function Yi(t){this.sectionPlanesList.push(t),this.sectionPlanes[t.id]=t,v(this,qi)[qi]=null,this.rebuild(),this.onSectionPlaneCreated.dispatch(this,t)}function $i(t){for(var e=0,i=this.sectionPlanesList.length;e<i;e++)if(this.sectionPlanesList[e].id===t.id)return this.sectionPlanesList.splice(e,1),v(this,qi)[qi]=null,delete this.sectionPlanes[t.id],this.rebuild(),void this.onSectionPlaneDestroyed.dispatch(this,t)}function Ji(){var t=this;for(var e in this.viewer.scene.models)v(this,Gi)[Gi](this.viewer.scene.models[e]);this.viewer.scene.onModelCreated.subscribe(function(e,i){v(t,Gi)[Gi](i)}),this.viewer.scene.onModelDestroyed.subscribe(function(e,i){v(t,Ki)[Ki](i)})}function Zi(t){var e=this,i=t.objects,r=this.viewer.renderer.rendererViewObjects,n=function(){var t=i[s],n=r[s],o="default",a=e.layers[o];if(!a){if(!e.autoLayers)return"continue";a=new At({id:o,view:e,viewer:e.viewer}),e.layers[o]=a,a.onDestroyed.one(function(){delete e.layers[a.id],e.onLayerDestroyed.dispatch(e,a)}),e.onLayerCreated.dispatch(e,a)}var h=new Z(a,t,n);a.registerViewObject(h),e.registerViewObject(h)};for(var s in i)n()}function tr(t){var e=t.objects;for(var i in e){var r=this.layers.default,n=this.objects[e[i].id];this.deregisterViewObject(n),r&&(r.deregisterViewObject(n),r.autoDestroy&&0===r.numObjects&&r.destroy())}}var er=/*#__PURE__*/u("prefixMessageWithID"),ir=/*#__PURE__*/u("registerView"),rr=/*#__PURE__*/u("deregisterView"),nr=/*#__PURE__*/function(t){function n(n){var s;return s=t.call(this,null,{})||this,Object.defineProperty(l(s),rr,{value:ar}),Object.defineProperty(l(s),ir,{value:or}),Object.defineProperty(l(s),er,{value:sr}),s.capabilities=void 0,s.onTick=void 0,s.onViewCreated=void 0,s.onViewDestroyed=void 0,s.scene=void 0,s.views=void 0,s.viewList=void 0,s.numViews=void 0,s.startTime=(new Date).getTime(),s.renderer=void 0,s.onTick=new e.EventEmitter(new i.EventDispatcher),s.onViewCreated=new e.EventEmitter(new i.EventDispatcher),s.onViewDestroyed=new e.EventEmitter(new i.EventDispatcher),s.id=n.id||P(),s.viewList=[],s.numViews=0,s.views={},s.destroyed=!1,s.capabilities={maxViews:0,astcSupported:!1,etc1Supported:!1,etc2Supported:!1,dxtSupported:!1,bptcSupported:!1,pvrtcSupported:!1},s.scene=n.scene||new r.Scene,s.renderer=n.renderer,s.renderer.getCapabilities(s.capabilities),s.renderer.init(l(s)),Re.registerViewer(l(s)),s}h(n,t);var s=n.prototype;return s.createView=function(t){var i=this;if(this.viewList.length>=this.capabilities.maxViews)return new e.SDKError("Attempted to create too many Views with View.createView() - maximum of "+this.capabilities.maxViews+" is allowed");var r=t.id||P();if(this.views[r])return new e.SDKError('View with ID "'+r+'" already exists');if(!((t.canvasElement||document.getElementById(t.canvasId))instanceof HTMLCanvasElement))return new e.SDKError("Mandatory View config expected: valid canvasId or canvasElement");var n=new Qi(function(t,e){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);return e}({viewId:r,viewer:this},t));return v(this,ir)[ir](n),n.viewIndex=this.renderer.registerView(n),n.onDestroyed.one(function(){v(i,rr)[rr](n),i.renderer.deregisterView(n.viewIndex),i.onViewDestroyed.dispatch(i,n)}),this.onViewCreated.dispatch(this,n),this.log("View created: "+n.viewId),n},s.redraw=function(){for(var t in this.views)this.views[t].redraw()},s.log=function(t){t="[LOG] "+v(this,er)[er](t),window.console.log(t)},s.warn=function(t){t="[WARN] "+v(this,er)[er](t),window.console.warn(t)},s.error=function(t){t="[ERROR] "+v(this,er)[er](t),window.console.error(t)},s.destroy=function(){if(!this.destroyed){for(var t in Re.deregisterViewer(this),this.views)this.views[t].destroy();this.onTick.clear(),this.onViewCreated.clear(),this.onViewDestroyed.clear()}},s.render=function(t){for(var e=0;e<this.viewList.length;e++)this.renderer.render(e,{force:!0})},n}(e.Component);function sr(t){return" ["+this.constructor.name+' "'+O(this.id)+'"]: '+t}function or(t){if(!this.views[t.id]){this.views[t.id]=t;for(var e=0;;e++)if(!this.viewList[e])return this.viewList[e]=t,this.numViews++,void(t.viewIndex=e)}}function ar(t){this.views[t.id]&&(delete this.views[t.id],delete this.viewList[t.viewIndex],this.numViews--)}var hr=/*#__PURE__*/u("state"),cr=/*#__PURE__*/u("inverseMatrixDirty"),lr=/*#__PURE__*/u("transposedProjMatrixDirty"),dr=/*#__PURE__*/function(t){function r(r,n){var s;return void 0===n&&(n={}),(s=t.call(this,r,n)||this).camera=void 0,s.onProjMatrix=void 0,Object.defineProperty(l(s),hr,{writable:!0,value:void 0}),Object.defineProperty(l(s),cr,{writable:!0,value:void 0}),Object.defineProperty(l(s),lr,{writable:!0,value:void 0}),s.camera=r,v(l(s),hr)[hr]={projMatrix:R(),inverseProjMatrix:R(),transposedProjMatrix:R(),near:.1,far:1e4,left:null!=n.left?n.left:-1,right:null!=n.right?n.right:1,bottom:null!=n.bottom?n.bottom:-1,top:null!=n.top?n.top:1},s.onProjMatrix=new e.EventEmitter(new i.EventDispatcher),v(l(s),cr)[cr]=!0,v(l(s),lr)[lr]=!0,s}h(r,t);var n=r.prototype;return n.clean=function(){!function(t,e,i,r,n,s,o){o||(o=R());var a=e-t,h=r-i,c=s-n;o[0]=2*n/a,o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[5]=2*n/h,o[6]=0,o[7]=0,o[8]=(e+t)/a,o[9]=(r+i)/h,o[10]=-(s+n)/c,o[11]=-1,o[12]=0,o[13]=0,o[14]=-s*n*2/c,o[15]=0}(v(this,hr)[hr].left,v(this,hr)[hr].right,v(this,hr)[hr].bottom,v(this,hr)[hr].top,v(this,hr)[hr].near,v(this,hr)[hr].far,v(this,hr)[hr].projMatrix),v(this,cr)[cr]=!0,v(this,lr)[lr]=!0,this.camera.view.redraw(),this.onProjMatrix.dispatch(this,v(this,hr)[hr].projMatrix)},n.unproject=function(t,e,i,r,n){var s=this.camera.view.canvasElement,o=s.offsetWidth/2,a=s.offsetHeight/2;return i[0]=(t[0]-o)/o,i[1]=(t[1]-a)/a,i[2]=e,i[3]=1,G(this.inverseProjMatrix,i,r),S(r,1/r[3]),r[3]=1,r[1]*=-1,G(this.camera.inverseViewMatrix,r,n),n},n.destroy=function(){t.prototype.destroy.call(this),this.onProjMatrix.clear()},a(r,[{key:"left",get:function(){return v(this,hr)[hr].left},set:function(t){v(this,hr)[hr].left=t,this.setDirty()}},{key:"right",get:function(){return v(this,hr)[hr].right},set:function(t){v(this,hr)[hr].right=t,this.setDirty()}},{key:"top",get:function(){return v(this,hr)[hr].top},set:function(t){v(this,hr)[hr].top=t,this.setDirty()}},{key:"bottom",get:function(){return v(this,hr)[hr].bottom},set:function(t){v(this,hr)[hr].bottom=t,this.setDirty()}},{key:"near",get:function(){return v(this,hr)[hr].near},set:function(t){v(this,hr)[hr].near=t,this.setDirty()}},{key:"far",get:function(){return v(this,hr)[hr].far},set:function(t){v(this,hr)[hr].far=t,this.setDirty()}},{key:"projMatrix",get:function(){return this.dirty&&this.cleanIfDirty(),v(this,hr)[hr].projMatrix}},{key:"inverseProjMatrix",get:function(){return this.dirty&&this.cleanIfDirty(),v(this,cr)[cr]&&(B(v(this,hr)[hr].projMatrix,v(this,hr)[hr].inverseProjMatrix),v(this,cr)[cr]=!1),v(this,hr)[hr].inverseProjMatrix}},{key:"transposedProjMatrix",get:function(){return this.dirty&&this.cleanIfDirty(),v(this,lr)[lr]&&(N(v(this,hr)[hr].projMatrix,v(this,hr)[hr].transposedProjMatrix),v(this,lr)[lr]=!1),v(this,hr)[hr].transposedProjMatrix}}]),r}(e.Component);dr.type=E;var ur=/*#__PURE__*/u("state"),vr=/*#__PURE__*/function(t){function e(e,i){var r;return void 0===i&&(i={}),(r=t.call(this,e,i)||this).view=void 0,Object.defineProperty(l(r),ur,{writable:!0,value:void 0}),r.view=e,v(l(r),ur)[ur]={type:"ambient",color:new Float32Array(i.color||[.7,.7,.7]),intensity:null!=i.intensity?i.intensity:1},r.view.registerLight(l(r)),r}return h(e,t),e.prototype.destroy=function(){t.prototype.destroy.call(this),this.view.deregisterLight(this)},a(e,[{key:"color",get:function(){return v(this,ur)[ur].color},set:function(t){v(this,ur)[ur].color.set(t),this.view.redraw()}},{key:"intensity",get:function(){return v(this,ur)[ur].intensity},set:function(t){v(this,ur)[ur].intensity=void 0!==t?t:1,this.view.redraw()}}]),e}(e.Component),fr=/*#__PURE__*/u("state"),pr=/*#__PURE__*/function(t){function e(e,i){var r;return void 0===i&&(i={}),(r=t.call(this,e,i)||this).view=void 0,Object.defineProperty(l(r),fr,{writable:!0,value:void 0}),r.view=e,v(l(r),fr)[fr]={type:"dir",dir:new Float32Array(i.dir||[1,1,1]),color:new Float32Array(i.color||[.7,.7,.8]),intensity:null!=i.intensity?i.intensity:1,space:i.space||"view"},r.view.registerLight(l(r)),r}return h(e,t),e.prototype.destroy=function(){t.prototype.destroy.call(this),this.view.deregisterLight(this),this.view.redraw()},a(e,[{key:"dir",get:function(){return v(this,fr)[fr].dir},set:function(t){v(this,fr)[fr].dir.set(t),this.view.redraw()}},{key:"color",get:function(){return v(this,fr)[fr].color},set:function(t){v(this,fr)[fr].color.set(t),this.view.redraw()}},{key:"intensity",get:function(){return v(this,fr)[fr].intensity},set:function(t){v(this,fr)[fr].intensity=t,this.view.redraw()}}]),e}(e.Component),yr=/*#__PURE__*/u("state"),br=/*#__PURE__*/function(t){function e(e,i){var r;return void 0===i&&(i={}),(r=t.call(this,e,i)||this).view=void 0,Object.defineProperty(l(r),yr,{writable:!0,value:void 0}),r.view=e,v(l(r),yr)[yr]={type:"point",pos:new Float64Array(i.pos||[1,1,1]),color:new Float32Array(i.color||[.7,.7,.8]),intensity:1,attenuation:new Float32Array([i.constantAttenuation,i.linearAttenuation,i.quadraticAttenuation]),space:i.space||"view"},r.view.registerLight(l(r)),r}return h(e,t),e.prototype.destroy=function(){t.prototype.destroy.call(this),this.view.deregisterLight(this),this.view.redraw()},a(e,[{key:"pos",get:function(){return v(this,yr)[yr].pos},set:function(t){v(this,yr)[yr].pos.set(t||[1,1,1]),this.view.redraw()}},{key:"color",get:function(){return v(this,yr)[yr].color},set:function(t){v(this,yr)[yr].color.set(t||[.7,.7,.8]),this.view.redraw()}},{key:"intensity",get:function(){return v(this,yr)[yr].intensity},set:function(t){t!==v(this,yr)[yr].intensity&&(v(this,yr)[yr].intensity=t,this.view.redraw())}},{key:"constantAttenuation",get:function(){return v(this,yr)[yr].attenuation[0]},set:function(t){v(this,yr)[yr].attenuation[0]=t,this.view.redraw()}},{key:"linearAttenuation",get:function(){return v(this,yr)[yr].attenuation[1]},set:function(t){v(this,yr)[yr].attenuation[1]=t,this.view.redraw()}},{key:"quadraticAttenuation",get:function(){return v(this,yr)[yr].attenuation[2]},set:function(t){v(this,yr)[yr].attenuation[2]=t,this.view.redraw()}}]),e}(e.Component),wr=/*#__PURE__*/u("viewObject"),jr=/*#__PURE__*/u("gotCanvasPos"),gr=/*#__PURE__*/u("gotOrigin"),Or=/*#__PURE__*/u("gotDirection"),Pr=/*#__PURE__*/u("gotIndices"),mr=/*#__PURE__*/u("gotLocalPos"),kr=/*#__PURE__*/u("gotWorldPos"),xr=/*#__PURE__*/u("gotViewPos"),Mr=/*#__PURE__*/u("gotWorldNormal"),Er=/*#__PURE__*/u("gotUV"),Dr=/*#__PURE__*/u("canvasPos"),Ar=/*#__PURE__*/u("origin"),Ir=/*#__PURE__*/u("direction"),Cr=/*#__PURE__*/u("indices"),Sr=/*#__PURE__*/u("localPos"),Vr=/*#__PURE__*/u("worldPos"),Lr=/*#__PURE__*/u("viewPos"),Tr=/*#__PURE__*/u("worldNormal"),Ur=/*#__PURE__*/u("uv"),zr=/*#__PURE__*/function(){function t(){Object.defineProperty(this,wr,{writable:!0,value:void 0}),Object.defineProperty(this,jr,{writable:!0,value:void 0}),Object.defineProperty(this,gr,{writable:!0,value:void 0}),Object.defineProperty(this,Or,{writable:!0,value:void 0}),Object.defineProperty(this,Pr,{writable:!0,value:void 0}),Object.defineProperty(this,mr,{writable:!0,value:void 0}),Object.defineProperty(this,kr,{writable:!0,value:void 0}),Object.defineProperty(this,xr,{writable:!0,value:void 0}),Object.defineProperty(this,Mr,{writable:!0,value:void 0}),Object.defineProperty(this,Er,{writable:!0,value:void 0}),Object.defineProperty(this,Dr,{writable:!0,value:void 0}),Object.defineProperty(this,Ar,{writable:!0,value:void 0}),Object.defineProperty(this,Ir,{writable:!0,value:void 0}),Object.defineProperty(this,Cr,{writable:!0,value:void 0}),Object.defineProperty(this,Sr,{writable:!0,value:void 0}),Object.defineProperty(this,Vr,{writable:!0,value:void 0}),Object.defineProperty(this,Lr,{writable:!0,value:void 0}),Object.defineProperty(this,Tr,{writable:!0,value:void 0}),Object.defineProperty(this,Ur,{writable:!0,value:void 0}),v(this,wr)[wr]=null,v(this,Dr)[Dr]=new Int16Array([0,0]),v(this,Ar)[Ar]=new Float64Array([0,0,0]),v(this,Ir)[Ir]=new Float64Array([0,0,0]),v(this,Cr)[Cr]=new Int32Array(3),v(this,Sr)[Sr]=new Float64Array([0,0,0]),v(this,Vr)[Vr]=new Float64Array([0,0,0]),v(this,Lr)[Lr]=new Float64Array([0,0,0]),v(this,Tr)[Tr]=new Float64Array([0,0,0]),v(this,Ur)[Ur]=new Float64Array([0,0]),v(this,gr)[gr]=!1,v(this,Or)[Or]=!1,v(this,Pr)[Pr]=!1,v(this,jr)[jr]=!1,v(this,mr)[mr]=!1,v(this,kr)[kr]=!1,v(this,xr)[xr]=!1,v(this,Mr)[Mr]=!1,v(this,Er)[Er]=!1,this.reset()}return t.prototype.reset=function(){v(this,wr)[wr]=null,v(this,jr)[jr]=!1,v(this,gr)[gr]=!1,v(this,Or)[Or]=!1,v(this,Pr)[Pr]=!1,v(this,mr)[mr]=!1,v(this,kr)[kr]=!1,v(this,xr)[xr]=!1,v(this,Mr)[Mr]=!1,v(this,Er)[Er]=!1},a(t,[{key:"viewObject",get:function(){return v(this,wr)[wr]},set:function(t){v(this,wr)[wr]=t}},{key:"canvasPos",get:function(){return v(this,jr)[jr]?v(this,Dr)[Dr]:void 0},set:function(t){t?(v(this,Dr)[Dr][0]=t[0],v(this,Dr)[Dr][1]=t[1],v(this,jr)[jr]=!0):v(this,jr)[jr]=!1}},{key:"origin",get:function(){return v(this,gr)[gr]?v(this,Ar)[Ar]:null},set:function(t){t?(v(this,Ar)[Ar][0]=t[0],v(this,Ar)[Ar][1]=t[1],v(this,Ar)[Ar][2]=t[2],v(this,gr)[gr]=!0):v(this,gr)[gr]=!1}},{key:"direction",get:function(){return v(this,Or)[Or]?v(this,Ir)[Ir]:null},set:function(t){t?(v(this,Ir)[Ir][0]=t[0],v(this,Ir)[Ir][1]=t[1],v(this,Ir)[Ir][2]=t[2],v(this,Or)[Or]=!0):v(this,Or)[Or]=!1}},{key:"indices",get:function(){return v(this,wr)[wr]&&v(this,Pr)[Pr]?v(this,Cr)[Cr]:null},set:function(t){t?(v(this,Cr)[Cr][0]=t[0],v(this,Cr)[Cr][1]=t[1],v(this,Cr)[Cr][2]=t[2],v(this,Pr)[Pr]=!0):v(this,Pr)[Pr]=!1}},{key:"localPos",get:function(){return v(this,wr)[wr]&&v(this,mr)[mr]?v(this,Sr)[Sr]:null},set:function(t){t?(v(this,Sr)[Sr][0]=t[0],v(this,Sr)[Sr][1]=t[1],v(this,Sr)[Sr][2]=t[2],v(this,mr)[mr]=!0):v(this,mr)[mr]=!1}},{key:"worldPos",get:function(){return v(this,wr)[wr]&&v(this,kr)[kr]?v(this,Vr)[Vr]:null},set:function(t){t?(v(this,Vr)[Vr][0]=t[0],v(this,Vr)[Vr][1]=t[1],v(this,Vr)[Vr][2]=t[2],v(this,kr)[kr]=!0):v(this,kr)[kr]=!1}},{key:"viewPos",get:function(){return v(this,wr)[wr]&&v(this,xr)[xr]?v(this,Lr)[Lr]:null},set:function(t){t?(v(this,Lr)[Lr][0]=t[0],v(this,Lr)[Lr][1]=t[1],v(this,Lr)[Lr][2]=t[2],v(this,xr)[xr]=!0):v(this,xr)[xr]=!1}},{key:"worldNormal",get:function(){return v(this,wr)[wr]&&v(this,Mr)[Mr]?v(this,Tr)[Tr]:null},set:function(t){t?(v(this,Tr)[Tr][0]=t[0],v(this,Tr)[Tr][1]=t[1],v(this,Tr)[Tr][2]=t[2],v(this,Mr)[Mr]=!0):v(this,Mr)[Mr]=!1}},{key:"uv",get:function(){return v(this,wr)[wr]&&v(this,Er)[Er]?v(this,Ur)[Ur]:null},set:function(t){t?(v(this,Ur)[Ur][0]=t[0],v(this,Ur)[Ur][1]=t[1],v(this,Er)[Er]=!0):v(this,Er)[Er]=!1}}]),t}();t.AmbientLight=vr,t.Camera=me,t.CameraFlightAnimation=gi,t.CustomProjection=Jt,t.DirLight=pr,t.EdgeMaterial=Ut,t.EmphasisMaterial=Lt,t.FrustumProjection=dr,t.Metrics=ot,t.OrthoProjection=Kt,t.PerspectiveProjection=qt,t.PickResult=zr,t.PointLight=br,t.PointsMaterial=Ft,t.SAO=ht,t.SectionPlane=et,t.View=Qi,t.ViewLayer=At,t.ViewObject=Z,t.Viewer=nr});
//# sourceMappingURL=index.umd.js.map
