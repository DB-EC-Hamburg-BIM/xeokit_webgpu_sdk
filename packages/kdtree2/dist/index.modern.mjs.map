{"version":3,"file":"index.modern.mjs","sources":["../../math/dist/index.es","../../matrix/dist/index.es","../../boundaries/dist/index.es","../src/KdTree2.ts","../../../node_modules/ste-core/dist/dispatching/DispatcherWrapper.js","../../../node_modules/ste-core/dist/events/Subscription.js","../../../node_modules/ste-core/dist/management/EventManagement.js","../../../node_modules/ste-core/dist/dispatching/DispatcherBase.js","../../../node_modules/ste-core/dist/dispatching/DispatchError.js","../../../node_modules/ste-core/dist/dispatching/EventListBase.js","../../../node_modules/ste-core/dist/handling/HandlingBase.js","../../../node_modules/ste-core/dist/events/PromiseSubscription.js","../../../node_modules/ste-core/dist/dispatching/PromiseDispatcherBase.js","../../../node_modules/ste-core/dist/index.js","../../../node_modules/ste-events/dist/EventDispatcher.js","../../../node_modules/ste-events/dist/EventList.js","../../../node_modules/ste-events/dist/EventHandlingBase.js","../../../node_modules/ste-events/dist/NonUniformEventList.js","../../../node_modules/ste-events/dist/index.js","../../../node_modules/ste-simple-events/dist/SimpleEventDispatcher.js","../../../node_modules/ste-simple-events/dist/SimpleEventList.js","../../../node_modules/ste-simple-events/dist/SimpleEventHandlingBase.js","../../../node_modules/ste-simple-events/dist/NonUniformSimpleEventList.js","../../../node_modules/ste-simple-events/dist/index.js","../../../node_modules/ste-signals/dist/SignalDispatcher.js","../../../node_modules/ste-signals/dist/SignalList.js","../../../node_modules/ste-signals/dist/SignalHandlingBase.js","../../../node_modules/ste-signals/dist/index.js","../../../node_modules/ste-promise-events/dist/PromiseEventDispatcher.js","../../../node_modules/ste-promise-events/dist/PromiseEventList.js","../../../node_modules/ste-promise-events/dist/PromiseEventHandlingBase.js","../../../node_modules/ste-promise-events/dist/NonUniformPromiseEventList.js","../../../node_modules/ste-promise-events/dist/index.js","../../../node_modules/ste-promise-signals/dist/PromiseSignalDispatcher.js","../../../node_modules/ste-promise-signals/dist/PromiseSignalList.js","../../../node_modules/ste-promise-signals/dist/PromiseSignalHandlingBase.js","../../../node_modules/ste-promise-signals/dist/index.js","../../../node_modules/ste-promise-simple-events/dist/PromiseSimpleEventDispatcher.js","../../../node_modules/ste-promise-simple-events/dist/NonUniformPromiseSimpleEventList.js","../../../node_modules/ste-promise-simple-events/dist/PromiseSimpleEventList.js","../../../node_modules/ste-promise-simple-events/dist/PromiseSimpleEventHandlingBase.js","../../../node_modules/ste-promise-simple-events/dist/index.js","../../../node_modules/strongly-typed-events/dist/index.js","../../scene/dist/index.es","../src/createKdTree2FromSceneObjectVerts.ts","../src/searchKdTree2ForNearestNeighbor.ts","../src/KdVertex2.ts"],"sourcesContent":["var r=Float64Array,n=-Number.MAX_SAFE_INTEGER,t=Number.MAX_SAFE_INTEGER,a=.0174532925,e=57.295779513;function u(r,n,t){return Math.max(n,Math.min(t,r))}function E(n){return new r(n)}export{a as DEGTORAD,r as FloatArrayClass,t as MAX_DOUBLE,n as MIN_DOUBLE,e as RADTODEG,u as clamp,E as newFloatArray};\n//# sourceMappingURL=index.es.map\n","import{newFloatArray as n,clamp as t,DEGTORAD as r}from\"@xeokit/math\";var u=s(),a=M(),o=M(),i=M(),e=M(),c=M(),f=s();function v(n,t){return n[0]*t[0]+n[1]*t[1]+n[2]*t[2]}function h(n){return new FloatArrayClass(n||2)}function M(n){return new Float64Array(n||3)}function s(n){return new FloatArrayClass(n||4)}function l(n,t){return t||(t=n),t[0]=-n[0],t[1]=-n[1],t[2]=-n[2],t}function d(n,t){return t||(t=n),t[0]=-n[0],t[1]=-n[1],t[2]=-n[2],t[3]=-n[3],t}function q(n,t,r){return r||(r=n),r[0]=n[0]+t[0],r[1]=n[1]+t[1],r[2]=n[2]+t[2],r[3]=n[3]+t[3],r}function X(n,t,r){return r||(r=n),r[0]=n[0]+t,r[1]=n[1]+t,r[2]=n[2]+t,r[3]=n[3]+t,r}function Y(n,t,r){return r||(r=n),r[0]=n[0]*t,r[1]=n[1]*t,r[2]=n[2]*t,r[3]=n[3]*t,r}function Z(n,t,r){return r||(r=n),r[0]=n[0]*t,r[1]=n[1]*t,r[2]=n[2]*t,r}function b(n,t,r){return r||(r=n),r[0]=n[0]*t,r[1]=n[1]*t,r}function g(n,t,r){return r||(r=n),r[0]=n[0]+t[0],r[1]=n[1]+t[1],r[2]=n[2]+t[2],r}function y(n,t,r){return r||(r=n),r[0]=n[0]+t,r[1]=n[1]+t,r[2]=n[2]+t,r}function w(n,t,r){return r||(r=n),r[0]=n[0]-t[0],r[1]=n[1]-t[1],r[2]=n[2]-t[2],r[3]=n[3]-t[3],r}function A(n,t){return n[0]===t[0]&&n[1]===t[1]&&n[2]===t[2]}function p(n,t,r){return r||(r=n),r[0]=n[0]-t[0],r[1]=n[1]-t[1],r[2]=n[2]-t[2],r}function F(n,t,r){return r||(r=n),r[0]=n[0]-t[0],r[1]=n[1]-t[1],r}function m(){for(var n=[].slice.call(arguments),t=new Float32Array(n[0]),r=1;r<n.length;r++)t[0]+=n[r][0],t[1]+=n[r][1];return t[0]/=n.length,t[1]/=n.length,t}function x(n,t,r){return r||(r=n),r[0]=n[0]-t,r[1]=n[1]-t,r[2]=n[2]-t,r[3]=n[3]-t,r}function C(n,t,r){return r||(r=n),r[0]=t-n[0],r[1]=t-n[1],r[2]=t-n[2],r[3]=t-n[3],r}function k(n,t,r){return r||(r=n),r[0]=n[0]*t[0],r[1]=n[1]*t[1],r[2]=n[2]*t[2],r[3]=n[3]*t[3],r}function j(n,t,r){return r||(r=n),r[0]=n[0]/t[0],r[1]=n[1]/t[1],r[2]=n[2]/t[2],r}function z(n,t,r){return r||(r=n),r[0]=n[0]/t[0],r[1]=n[1]/t[1],r[2]=n[2]/t[2],r[3]=n[3]/t[3],r}function B(n,t,r){return r||(r=t),r[0]=n/t[0],r[1]=n/t[1],r[2]=n/t[2],r}function D(n,t,r){return r||(r=n),r[0]=n[0]/t,r[1]=n[1]/t,r[2]=n[2]/t,r}function E(n,t,r){return r||(r=n),r[0]=n[0]/t,r[1]=n[1]/t,r[2]=n[2]/t,r[3]=n[3]/t,r}function G(n,t,r){return r||(r=t),r[0]=n/t[0],r[1]=n/t[1],r[2]=n/t[2],r[3]=n/t[3],r}function H(n,t){return n[0]*t[0]+n[1]*t[1]+n[2]*t[2]+n[3]*t[3]}function I(n,t){var r=n[0],u=n[1],a=n[2],o=t[0],i=t[1],e=t[2];return[u*e-a*i,a*o-r*e,r*i-u*o,0]}function J(n,t,r){r||(r=n);var u=n[0],a=n[1],o=n[2],i=t[0],e=t[1],c=t[2];return r[0]=a*c-o*e,r[1]=o*i-u*c,r[2]=u*e-a*i,r}function K(n){return H(n,n)}function L(n){return Math.sqrt(K(n))}function N(n,t){return n[0]*t[0]+n[1]*t[1]}function O(n){return v(n,n)}function P(n){return N(n,n)}function Q(n){return Math.sqrt(O(n))}var R,S=(R=M(),function(n,t){return Q(p(n,t,R))});function T(n){return Math.sqrt(P(n))}function U(n,t,r,u,a,o){var i=o||M(),e=(n-t)/(r-t);return i[0]=u[0]+e*(a[0]-u[0]),i[1]=u[1]+e*(a[1]-u[1]),i[2]=u[2]+e*(a[2]-u[2]),i}var V=function(){var n=h();return function(t,r){return T(F(t,r,n))}}();function W(n,t){return B(1,n,t)}function $(n,t){return Y(n,1/L(n),t)}function _(n,t){return Z(n,1/Q(n),t)}function nn(n,t){return b(n,1/T(n),t)}function tn(n,t){var r=v(n,t)/Math.sqrt(O(n)*O(t));return r=r<-1?-1:r>1?1:r,Math.acos(r)}var rn=function(){var n=M();return function(t,r){return n[0]=t[0],n[1]=t[1],n[2]=t[2],r[0]=Q(n),n[0]=t[4],n[1]=t[5],n[2]=t[6],r[1]=Q(n),n[0]=t[8],n[1]=t[9],n[2]=t[10],r[2]=Q(n),r}}();function un(n){for(var t=0,r=(n=Array.prototype.slice.call(n)).length;t<r;t++)n[t]=an(n[t]);return n}function an(n){return Math.round(1e5*n)/1e5}function on(n,t,r,u){void 0===u&&(u=M());var a=t[0]-n[0],o=t[1]-n[1],i=t[2]-n[2],e=r[0]-n[0],c=r[1]-n[1],f=r[2]-n[2],v=o*f-i*c,h=i*e-a*f,s=a*c-o*e,l=Math.sqrt(v*v+h*h+s*s);return 0===l?(u[0]=0,u[1]=0,u[2]=0):(u[0]=v/l,u[1]=h/l,u[2]=s/l),u}function en(t){return new n(t||9)}function cn(t){return n(t||16)}var fn=cn(),vn=cn();function hn(n,t){return n[0]===t[0]&&n[1]===t[1]&&n[2]===t[2]&&n[3]===t[3]&&n[4]===t[4]&&n[5]===t[5]&&n[6]===t[6]&&n[7]===t[7]&&n[8]===t[8]&&n[9]===t[9]&&n[10]===t[10]&&n[11]===t[11]&&n[12]===t[12]&&n[13]===t[13]&&n[14]===t[14]&&n[15]===t[15]}function Mn(n,t,r,u,a){var o=[],i=[];return o[2]=r,i[2]=u,i[1]=o[2]*Math.tan(n/2),o[1]=-i[1],i[0]=i[1]*t,o[0]=-i[0],sn(o,i,a)}function sn(n,t,r){r||(r=cn());var u=[n[0],n[1],n[2],0],a=[t[0],t[1],t[2],0];q(a,u,fn),w(a,u,vn);var o=2*u[2],i=vn[0],e=vn[1],c=vn[2];return r[0]=o/i,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=o/e,r[6]=0,r[7]=0,r[8]=fn[0]/i,r[9]=fn[1]/e,r[10]=-fn[2]/c,r[11]=-1,r[12]=0,r[13]=0,r[14]=-o*a[2]/c,r[15]=0,r}function ln(n,t,r,u,a,o,i){i||(i=cn());var e=t-n,c=u-r,f=o-a;return i[0]=2/e,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=2/c,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=-2/f,i[11]=0,i[12]=-(n+t)/e,i[13]=-(u+r)/c,i[14]=-(o+a)/f,i[15]=1,i}function dn(n,t,r,u,a,o,i){i||(i=cn());var e=t-n,c=u-r,f=o-a;return i[0]=2*a/e,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=2*a/c,i[6]=0,i[7]=0,i[8]=(t+n)/e,i[9]=(u+r)/c,i[10]=-(o+a)/f,i[11]=-1,i[12]=0,i[13]=0,i[14]=-o*a*2/f,i[15]=0,i}function qn(n){return n||(n=cn()),n[0]=1,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=1,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=1,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n}function Xn(n){return n||(n=cn()),n[0]=1,n[1]=0,n[2]=0,n[3]=0,n[4]=1,n[5]=0,n[6]=0,n[7]=0,n[8]=1,n}function Yn(n){return 1===n[0]&&0===n[1]&&0===n[2]&&0===n[3]&&0===n[4]&&1===n[5]&&0===n[6]&&0===n[7]&&0===n[8]&&0===n[9]&&1===n[10]&&0===n[11]&&0===n[12]&&0===n[13]&&0===n[14]&&1===n[15]}function Zn(n,t,r){r||(r=cn());var u,a,o,i,e,c,f=$([t[0],t[1],t[2],0],[]),v=Math.sin(n),h=Math.cos(n),M=1-h,s=f[0],l=f[1],d=f[2];return u=s*l,a=l*d,o=d*s,i=s*v,e=l*v,c=d*v,r[0]=M*s*s+h,r[1]=M*u+c,r[2]=M*o-e,r[3]=0,r[4]=M*u-c,r[5]=M*l*l+h,r[6]=M*a+i,r[7]=0,r[8]=M*o+e,r[9]=M*a-i,r[10]=M*d*d+h,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r}function bn(n,t,r,u){u||(u=cn());var a,o,i,e,c,f,v,h,M,s,l=n[0],d=n[1],q=n[2],X=r[0],Y=r[1],Z=r[2],b=t[0],g=t[1],y=t[2];return l===b&&d===g&&q===y?qn():(a=l-b,o=d-g,i=q-y,e=Y*(i*=s=1/Math.sqrt(a*a+o*o+i*i))-Z*(o*=s),c=Z*(a*=s)-X*i,f=X*o-Y*a,(s=Math.sqrt(e*e+c*c+f*f))?(e*=s=1/s,c*=s,f*=s):(e=0,c=0,f=0),v=o*f-i*c,h=i*e-a*f,M=a*c-o*e,(s=Math.sqrt(v*v+h*h+M*M))?(v*=s=1/s,h*=s,M*=s):(v=0,h=0,M=0),u[0]=e,u[1]=v,u[2]=a,u[3]=0,u[4]=c,u[5]=h,u[6]=o,u[7]=0,u[8]=f,u[9]=M,u[10]=i,u[11]=0,u[12]=-(e*l+c*d+f*q),u[13]=-(v*l+h*d+M*q),u[14]=-(a*l+o*d+i*q),u[15]=1,u)}function gn(n,t){t||(t=n);var r=n[0],u=n[1],a=n[2],o=n[3],i=n[4],e=n[5],c=n[6],f=n[7],v=n[8],h=n[9],M=n[10],s=n[11],l=n[12],d=n[13],q=n[14],X=n[15],Y=r*e-u*i,Z=r*c-a*i,b=r*f-o*i,g=u*c-a*e,y=u*f-o*e,w=a*f-o*c,A=v*d-h*l,p=v*q-M*l,F=v*X-s*l,m=h*q-M*d,x=h*X-s*d,C=M*X-s*q,k=1/(Y*C-Z*x+b*m+g*F-y*p+w*A);return t[0]=(e*C-c*x+f*m)*k,t[1]=(-u*C+a*x-o*m)*k,t[2]=(d*w-q*y+X*g)*k,t[3]=(-h*w+M*y-s*g)*k,t[4]=(-i*C+c*F-f*p)*k,t[5]=(r*C-a*F+o*p)*k,t[6]=(-l*w+q*b-X*Z)*k,t[7]=(v*w-M*b+s*Z)*k,t[8]=(i*x-e*F+f*A)*k,t[9]=(-r*x+u*F-o*A)*k,t[10]=(l*y-d*b+X*Y)*k,t[11]=(-v*y+h*b-s*Y)*k,t[12]=(-i*m+e*p-c*A)*k,t[13]=(r*m-u*p+a*A)*k,t[14]=(-l*g+d*Z-q*Y)*k,t[15]=(v*g-h*Z+M*Y)*k,t}function yn(n,t){var r=n[4],u=n[14],a=n[8],o=n[13],i=n[12],e=n[9];if(!t||n===t){var c=n[1],f=n[2],v=n[3],h=n[6],M=n[7],s=n[11];return n[1]=r,n[2]=a,n[3]=i,n[4]=c,n[6]=e,n[7]=o,n[8]=f,n[9]=h,n[11]=u,n[12]=v,n[13]=M,n[14]=s,n}return t[0]=n[0],t[1]=r,t[2]=a,t[3]=i,t[4]=n[1],t[5]=n[5],t[6]=e,t[7]=o,t[8]=n[2],t[9]=n[6],t[10]=n[10],t[11]=u,t[12]=n[3],t[13]=n[7],t[14]=n[11],t[15]=n[15],t}function wn(n,t,r){r||(r=n);var u=t[0],a=t[1],o=t[2],i=t[3];return r[0]=n[0]*u+n[4]*a+n[8]*o+n[12]*i,r[1]=n[1]*u+n[5]*a+n[9]*o+n[13]*i,r[2]=n[2]*u+n[6]*a+n[10]*o+n[14]*i,r[3]=n[3]*u+n[7]*a+n[11]*o+n[15]*i,r}function An(n,t,r){r||(r=n);var u=n[0],a=n[1],o=n[2],i=n[3],e=n[4],c=n[5],f=n[6],v=n[7],h=n[8],M=n[9],s=n[10],l=n[11],d=n[12],q=n[13],X=n[14],Y=n[15],Z=t[0],b=t[1],g=t[2],y=t[3],w=t[4],A=t[5],p=t[6],F=t[7],m=t[8],x=t[9],C=t[10],k=t[11],j=t[12],z=t[13],B=t[14],D=t[15];return r[0]=Z*u+b*e+g*h+y*d,r[1]=Z*a+b*c+g*M+y*q,r[2]=Z*o+b*f+g*s+y*X,r[3]=Z*i+b*v+g*l+y*Y,r[4]=w*u+A*e+p*h+F*d,r[5]=w*a+A*c+p*M+F*q,r[6]=w*o+A*f+p*s+F*X,r[7]=w*i+A*v+p*l+F*Y,r[8]=m*u+x*e+C*h+k*d,r[9]=m*a+x*c+C*M+k*q,r[10]=m*o+x*f+C*s+k*X,r[11]=m*i+x*v+C*l+k*Y,r[12]=j*u+z*e+B*h+D*d,r[13]=j*a+z*c+B*M+D*q,r[14]=j*o+z*f+B*s+D*X,r[15]=j*i+z*v+B*l+D*Y,r}function pn(t,r,u){void 0===u&&(u=n(9));var a=t[0],o=t[3],i=t[6],e=t[1],c=t[4],f=t[7],v=t[2],h=t[5],M=t[8],s=r[0],l=r[3],d=r[6],q=r[1],X=r[4],Y=r[7],Z=r[2],b=r[5],g=r[8];return u[0]=a*s+o*q+i*Z,u[3]=a*l+o*X+i*b,u[6]=a*d+o*Y+i*g,u[1]=e*s+c*q+f*Z,u[4]=e*l+c*X+f*b,u[7]=e*d+c*Y+f*g,u[2]=v*s+h*q+M*Z,u[5]=v*l+h*X+M*b,u[8]=v*d+h*Y+M*g,u}function Fn(n,t,r){r||(r=t);var u=t[0],a=t[1],o=t[2];return r[0]=n[0]*u+n[4]*a+n[8]*o+n[12],r[1]=n[1]*u+n[5]*a+n[9]*o+n[13],r[2]=n[2]*u+n[6]*a+n[10]*o+n[14],r}function mn(n,t,r){return r[0]=n[0]*t[0]+n[4]*t[1]+n[8]*t[2]+n[12]*t[3],r[1]=n[1]*t[0]+n[5]*t[1]+n[9]*t[2]+n[13]*t[3],r[2]=n[2]*t[0]+n[6]*t[1]+n[10]*t[2]+n[14]*t[3],r[3]=n[3]*t[0]+n[7]*t[1]+n[11]*t[2]+n[15]*t[3],r}function xn(n,t,r){for(var u,a,o,i,e,c=r||[],f=t.length,v=n[0],h=n[1],M=n[2],s=n[3],l=n[4],d=n[5],q=n[6],X=n[7],Y=n[8],Z=n[9],b=n[10],g=n[11],y=n[12],w=n[13],A=n[14],p=n[15],F=0;F<f;++F)u=(i=t[F])[0],a=i[1],o=i[2],(e=c[F]||(c[F]=[0,0,0]))[0]=v*u+l*a+Y*o+y,e[1]=h*u+d*a+Z*o+w,e[2]=M*u+q*a+b*o+A,e[3]=s*u+X*a+g*o+p;return c.length=f,c}function Cn(n,t,r){var u;r||(r=t);var a,o,i,e=t.length,c=n[0],f=n[1],v=n[2],h=n[3],M=n[4],s=n[5],l=n[6],d=n[7],q=n[8],X=n[9],Y=n[10],Z=n[11],b=n[12],g=n[13],y=n[14],w=n[15];for(u=0;u<e;u+=3)r[u+0]=c*(a=t[u+0])+M*(o=t[u+1])+q*(i=t[u+2])+b,r[u+1]=f*a+s*o+X*i+g,r[u+2]=v*a+l*o+Y*i+y,r[u+3]=h*a+d*o+Z*i+w;return r}function kn(n,t,r){var u;r||(r=t);var a,o,i,e=t.length,c=n[0],f=n[1],v=n[2],h=n[3],M=n[4],s=n[5],l=n[6],d=n[7],q=n[8],X=n[9],Y=n[10],Z=n[11],b=n[12],g=n[13],y=n[14],w=n[15];for(u=0;u<e;u+=4)r[u+0]=c*(a=t[u+0])+M*(o=t[u+1])+q*(i=t[u+2])+b,r[u+1]=f*a+s*o+X*i+g,r[u+2]=v*a+l*o+Y*i+y,r[u+3]=h*a+d*o+Z*i+w;return r}function jn(n,t,r){var u=t[0],a=t[1],o=t[2];return(r=r||M())[0]=n[0]*u+n[4]*a+n[8]*o,r[1]=n[1]*u+n[5]*a+n[9]*o,r[2]=n[2]*u+n[6]*a+n[10]*o,r}function zn(n,t,r){var u=t[0],a=t[1],o=t[2],i=t[3];return(r=r||s())[0]=n[0]*u+n[4]*a+n[8]*o+n[12]*i,r[1]=n[1]*u+n[5]*a+n[9]*o+n[13]*i,r[2]=n[2]*u+n[6]*a+n[10]*o+n[14]*i,r[3]=n[3]*u+n[7]*a+n[11]*o+n[15]*i,r}function Bn(n,t){void 0===t&&(t=qn());var r=n[0],u=n[1],a=n[2];return t[0]*=r,t[4]*=u,t[8]*=a,t[1]*=r,t[5]*=u,t[9]*=a,t[2]*=r,t[6]*=u,t[10]*=a,t[3]*=r,t[7]*=u,t[11]*=a,t}function Dn(n,t){return void 0===t&&(t=qn()),t[0]=n[0],t[5]=n[1],t[10]=n[2],t}function En(n,t){return void 0===t&&(t=Xn()),t[0]=n[0],t[4]=n[1],t}var Gn,Hn=(Gn=n(3),function(n,t,r,u){return Gn[0]=n,Gn[1]=t,Gn[2]=r,Dn(Gn,u)});function In(n,t,r,u){return u[0]*=n,u[4]*=t,u[8]*=r,u[1]*=n,u[5]*=t,u[9]*=r,u[2]*=n,u[6]*=t,u[10]*=r,u[3]*=n,u[7]*=t,u[11]*=r,u}function Jn(n){return Hn(n,n,n)}function Kn(n,t,r,u){return void 0===u&&(u=cn()),et(t,u),Bn(r,u),Nn(n,u),u}var Ln=function(){var n=M(),t=cn();return function(r,u,a,o){n[0]=r[0],n[1]=r[1],n[2]=r[2];var i=Q(n);n[0]=r[4],n[1]=r[5],n[2]=r[6];var e=Q(n);n[8]=r[8],n[9]=r[9],n[10]=r[10];var c=Q(n);Un(r)<0&&(i=-i),u[0]=r[12],u[1]=r[13],u[2]=r[14],t.set(r);var f=1/i,v=1/e,h=1/c;t[0]*=f,t[1]*=f,t[2]*=f,t[4]*=v,t[5]*=v,t[6]*=v,t[8]*=h,t[9]*=h,t[10]*=h,nt(t,a),o[0]=i,o[1]=e,o[2]=c}}();function Nn(n,t){return void 0===t&&(t=qn()),On(n[0],n[1],n[2],t)}function On(n,t,r,u){void 0===u&&(u=qn());var a=u[3];u[0]+=a*n,u[1]+=a*t,u[2]+=a*r;var o=u[7];u[4]+=o*n,u[5]+=o*t,u[6]+=o*r;var i=u[11];u[8]+=i*n,u[9]+=i*t,u[10]+=i*r;var e=u[15];return u[12]+=e*n,u[13]+=e*t,u[14]+=e*r,u}function Pn(n,t,r){return r[0]=n[0],r[1]=n[1],r[2]=n[2],r[3]=n[3],r[4]=n[4],r[5]=n[5],r[6]=n[6],r[7]=n[7],r[8]=n[8],r[9]=n[9],r[10]=n[10],r[11]=n[11],r[12]=t[0],r[13]=t[1],r[14]=t[2],r[15]=n[15],r}function Qn(n,t){var r=t||qn();return r[12]=n[0],r[13]=n[1],r[14]=n[2],r}function Rn(n,t){var r=t||Xn();return r[6]=n[0],r[7]=n[1],r}var Sn=function(){var t=n(3);return function(n,r,u,a){return t[0]=n,t[1]=r,t[2]=u,Qn(t,a)}}();function Tn(n,t){return Sn(n,n,n,t)}function Un(n){var t=n[0],r=n[1],u=n[2],a=n[3],o=n[4],i=n[5],e=n[6],c=n[7],f=n[8],v=n[9],h=n[10],M=n[11],s=n[12],l=n[13],d=n[14],q=n[15];return s*v*e*a-f*l*e*a-s*i*h*a+o*l*h*a+f*i*d*a-o*v*d*a-s*v*u*c+f*l*u*c+s*r*h*c-t*l*h*c-f*r*d*c+t*v*d*c+s*i*u*M-o*l*u*M-s*r*e*M+t*l*e*M+o*r*d*M-t*i*d*M-f*i*u*q+o*v*u*q+f*r*e*q-t*v*e*q-o*r*h*q+t*i*h*q}function Vn(n,r,u){void 0===u&&(u=M());var a=n[0],o=n[4],i=n[8],e=n[1],c=n[5],f=n[9],v=n[2],h=n[6],s=n[10];return\"XYZ\"===r?(u[1]=Math.asin(t(i,-1,1)),Math.abs(i)<.99999?(u[0]=Math.atan2(-f,s),u[2]=Math.atan2(-o,a)):(u[0]=Math.atan2(h,c),u[2]=0)):\"YXZ\"===r?(u[0]=Math.asin(-t(f,-1,1)),Math.abs(f)<.99999?(u[1]=Math.atan2(i,s),u[2]=Math.atan2(e,c)):(u[1]=Math.atan2(-v,a),u[2]=0)):\"ZXY\"===r?(u[0]=Math.asin(t(h,-1,1)),Math.abs(h)<.99999?(u[1]=Math.atan2(-v,s),u[2]=Math.atan2(-o,c)):(u[1]=0,u[2]=Math.atan2(e,a))):\"ZYX\"===r?(u[1]=Math.asin(-t(v,-1,1)),Math.abs(v)<.99999?(u[0]=Math.atan2(h,s),u[2]=Math.atan2(e,a)):(u[0]=0,u[2]=Math.atan2(-o,c))):\"YZX\"===r?(u[2]=Math.asin(t(e,-1,1)),Math.abs(e)<.99999?(u[0]=Math.atan2(-f,c),u[1]=Math.atan2(-v,a)):(u[0]=0,u[1]=Math.atan2(i,s))):\"XZY\"===r&&(u[2]=Math.asin(-t(o,-1,1)),Math.abs(o)<.99999?(u[0]=Math.atan2(h,c),u[1]=Math.atan2(i,a)):(u[0]=Math.atan2(-f,s),u[1]=0)),u}function Wn(n,t,r,u,a,o){var i=o||cn(),e=(n-t)/(r-t);return i[0]=u[0]+e*(a[0]-u[0]),i[1]=u[1]+e*(a[1]-u[1]),i[2]=u[2]+e*(a[2]-u[2]),i[3]=u[3]+e*(a[3]-u[3]),i[4]=u[4]+e*(a[4]-u[4]),i[5]=u[5]+e*(a[5]-u[5]),i[6]=u[6]+e*(a[6]-u[6]),i[7]=u[7]+e*(a[7]-u[7]),i[8]=u[8]+e*(a[8]-u[8]),i[9]=u[9]+e*(a[9]-u[9]),i[10]=u[10]+e*(a[10]-u[10]),i[11]=u[11]+e*(a[11]-u[11]),i[12]=u[12]+e*(a[12]-u[12]),i[13]=u[13]+e*(a[13]-u[13]),i[14]=u[14]+e*(a[14]-u[14]),i[15]=u[15]+e*(a[15]-u[15]),i}function $n(n){return void 0===n&&(n=s()),n[0]=0,n[1]=0,n[2]=0,n[3]=1,n}function _n(n,t,u){void 0===u&&(u=s());var a=n[0]*r/2,o=n[1]*r/2,i=n[2]*r/2,e=Math.cos(a),c=Math.cos(o),f=Math.cos(i),v=Math.sin(a),h=Math.sin(o),M=Math.sin(i);return\"XYZ\"===t?(u[0]=v*c*f+e*h*M,u[1]=e*h*f-v*c*M,u[2]=e*c*M+v*h*f,u[3]=e*c*f-v*h*M):\"YXZ\"===t?(u[0]=v*c*f+e*h*M,u[1]=e*h*f-v*c*M,u[2]=e*c*M-v*h*f,u[3]=e*c*f+v*h*M):\"ZXY\"===t?(u[0]=v*c*f-e*h*M,u[1]=e*h*f+v*c*M,u[2]=e*c*M+v*h*f,u[3]=e*c*f-v*h*M):\"ZYX\"===t?(u[0]=v*c*f-e*h*M,u[1]=e*h*f+v*c*M,u[2]=e*c*M-v*h*f,u[3]=e*c*f+v*h*M):\"YZX\"===t?(u[0]=v*c*f+e*h*M,u[1]=e*h*f+v*c*M,u[2]=e*c*M-v*h*f,u[3]=e*c*f-v*h*M):\"XZY\"===t&&(u[0]=v*c*f-e*h*M,u[1]=e*h*f-v*c*M,u[2]=e*c*M+v*h*f,u[3]=e*c*f+v*h*M),u}function nt(n,t){void 0===t&&(t=s());var r,u=n[0],a=n[4],o=n[8],i=n[1],e=n[5],c=n[9],f=n[2],v=n[6],h=n[10],M=u+e+h;return M>0?(r=.5/Math.sqrt(M+1),t[3]=.25/r,t[0]=(v-c)*r,t[1]=(o-f)*r,t[2]=(i-a)*r):u>e&&u>h?(r=2*Math.sqrt(1+u-e-h),t[3]=(v-c)/r,t[0]=.25*r,t[1]=(a+i)/r,t[2]=(o+f)/r):e>h?(r=2*Math.sqrt(1+e-u-h),t[3]=(o-f)/r,t[0]=(a+i)/r,t[1]=.25*r,t[2]=(c+v)/r):(r=2*Math.sqrt(1+h-u-e),t[3]=(i-a)/r,t[0]=(o+f)/r,t[1]=(c+v)/r,t[2]=.25*r),t}function tt(n,t,r){void 0===r&&(r=s());var u=Math.sqrt(v(n,n)*v(t,t)),a=u+v(n,t);return a<1e-8*u?(a=0,Math.abs(n[0])>Math.abs(n[2])?(r[0]=-n[1],r[1]=n[0],r[2]=0):(r[0]=0,r[1]=-n[2],r[2]=n[1])):J(n,t,r),r[3]=a,ct(r)}function rt(n,t){void 0===t&&(t=s());var r=n[3]/2,u=Math.sin(r);return t[0]=u*n[0],t[1]=u*n[1],t[2]=u*n[2],t[3]=Math.cos(r),t}function ut(n,t,r){return void 0===r&&(r=M()),et(n,fn),Vn(fn,t,r),r}function at(n,t,r){void 0===r&&(r=s());var u=n[0],a=n[1],o=n[2],i=n[3],e=t[0],c=t[1],f=t[2],v=t[3];return r[0]=i*e+u*v+a*f-o*c,r[1]=i*c+a*v+o*e-u*f,r[2]=i*f+o*v+u*c-a*e,r[3]=i*v-u*e-a*c-o*f,r}function ot(n,t,r){void 0===r&&(r=M());var u=t[0],a=t[1],o=t[2],i=n[0],e=n[1],c=n[2],f=n[3],v=f*u+e*o-c*a,h=f*a+c*u-i*o,s=f*o+i*a-e*u,l=-i*u-e*a-c*o;return r[0]=v*f+l*-i+h*-c-s*-e,r[1]=h*f+l*-e+s*-i-v*-c,r[2]=s*f+l*-c+v*-e-h*-i,r}function it(n,t){t=qn(t);var r=n[0],u=n[1],a=n[2],o=n[3],i=2*r,e=2*u,c=2*a,f=i*o,v=e*o,h=c*o,M=i*r,s=e*r,l=c*r,d=e*u,q=c*u,X=c*a;return t[0]=1-(d+X),t[1]=s+h,t[2]=l-v,t[4]=s-h,t[5]=1-(M+X),t[6]=q+f,t[8]=l+v,t[9]=q-f,t[10]=1-(M+d),t}function et(n,t){var r=n[0],u=n[1],a=n[2],o=n[3],i=r+r,e=u+u,c=a+a,f=r*i,v=r*e,h=r*c,M=u*e,s=u*c,l=a*c,d=o*i,q=o*e,X=o*c;return t[0]=1-(M+l),t[4]=v-X,t[8]=h+q,t[1]=v+X,t[5]=1-(f+l),t[9]=s-d,t[2]=h-q,t[6]=s+d,t[10]=1-(f+M),t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function ct(n,t){void 0===t&&(t=n);var r=L([n[0],n[1],n[2],n[3]]);return t[0]=n[0]/r,t[1]=n[1]/r,t[2]=n[2]/r,t[3]=n[3]/r,t}function ft(n,t){return void 0===t&&(t=n),t[0]=-n[0],t[1]=-n[1],t[2]=-n[2],t[3]=n[3],t}function vt(n,t){return ct(ft(n,t))}function ht(n,t){void 0===t&&(t=s());var r=(n=ct(n,u))[3],a=2*Math.acos(r),o=Math.sqrt(1-r*r);return o<.001?(t[0]=n[0],t[1]=n[1],t[2]=n[2]):(t[0]=n[0]/o,t[1]=n[1]/o,t[2]=n[2]/o),t[3]=a,t}function Mt(n,t,r,u,f,h){h=h||M();var s=p(u,r,a),l=p(f,r,o),d=J(t,l,i),q=v(s,d);if(q<1e-6)return null;var X=p(n,r,e),Y=v(X,d);if(Y<0||Y>q)return null;var Z=J(X,s,c),b=v(t,Z);if(b<0||Y+b>q)return null;var g=v(l,Z)/q;return h[0]=n[0]+g*t[0],h[1]=n[1]+g*t[1],h[2]=n[2]+g*t[2],h}function st(n,t,r,a,o){u[0]=t[0],u[1]=t[1],u[2]=t[2],u[3]=1,zn(n,u,f),a[0]=f[0],a[1]=f[1],a[2]=f[2],u[0]=r[0],u[1]=r[1],u[2]=r[2],jn(n,u,f),_(f),o[0]=f[0],o[1]=f[1],o[2]=f[2]}export{g as addVec3,y as addVec3Scalar,q as addVec4,X as addVec4Scalar,rt as angleAxisToQuaternion,tn as angleVec3,hn as compareMat4,A as compareVec3,Kn as composeMat4,ft as conjugateQuat,en as createMat3,cn as createMat4,h as createVec2,M as createVec3,s as createVec4,J as cross3Vec3,I as cross3Vec4,Ln as decomposeMat4,Un as determinantMat4,V as distVec2,S as distVec3,B as divScalarVec3,G as divScalarVec4,j as divVec3,D as divVec3Scalar,z as divVec4,E as divVec4Scalar,N as dotVec2,v as dotVec3,H as dotVec4,_n as eulerToQuat,dn as frustumMat4,sn as frustumMat4v,m as geometricMeanVec2,Xn as identityMat3,qn as identityMat4,$n as identityQuat,gn as inverseMat4,vt as inverseQuat,Yn as isIdentityMat4,T as lenVec2,Q as lenVec3,L as lenVec4,Wn as lerpMat4,U as lerpVec3,bn as lookAtMat4v,Vn as mat4ToEuler,nt as mat4ToQuat,pn as mulMat3,An as mulMat4,wn as mulMat4v4,at as mulQuats,b as mulVec2Scalar,Z as mulVec3Scalar,k as mulVec4,Y as mulVec4Scalar,l as negateVec3,d as negateVec4,ct as normalizeQuat,nn as normalizeVec2,_ as normalizeVec3,$ as normalizeVec4,ln as orthoMat4c,Mn as perspectiveMat4,ht as quatToAngleAxis,ut as quatToEuler,it as quatToMat4,et as quatToRotationMat4,Mt as rayTriangleIntersect,W as rcpVec3,Zn as rotationMat4v,In as scaleMat4c,Bn as scaleMat4v,En as scalingMat3v,Hn as scalingMat4c,Jn as scalingMat4s,Dn as scalingMat4v,Pn as setMat4Translation,P as sqLenVec2,O as sqLenVec3,K as sqLenVec4,C as subScalarVec4,F as subVec2,p as subVec3,w as subVec4,x as subVec4Scalar,Fn as transformPoint3,mn as transformPoint4,xn as transformPoints3,Cn as transformPositions3,kn as transformPositions4,st as transformRay,jn as transformVec3,zn as transformVec4,On as translateMat4c,Nn as translateMat4v,Rn as translationMat3v,Sn as translationMat4c,Tn as translationMat4s,Qn as translationMat4v,yn as transposeMat4,on as triangleNormal,ot as vec3ApplyQuat,rn as vec3FromMat4Scale,tt as vec3PairToQuat,un as vecToArray};\n//# sourceMappingURL=index.es.map\n","import{createVec3 as t,createMat4 as n,subVec3 as r,lenVec3 as e,createVec2 as o,mulMat4 as i}from\"@xeokit/matrix\";import{newFloatArray as u,MAX_DOUBLE as f,MIN_DOUBLE as a}from\"@xeokit/math\";import{decompressPoint3 as s}from\"@xeokit/compression\";var c=t(),v=t(),l=n();function h(t){return new Float64Array(t||6)}function m(t){return new Int16Array(t||6)}function p(t){return u(t||4)}function x(t){return u(t||32)}function d(t){return u(t||16)}function V(t,n,r,e){return u([t,n,r,e])}function w(t,n,r){var e;void 0===r&&(r=n);var o,i,u,f=n.length,a=t[0],s=t[1],c=t[2],v=t[3],l=t[4],h=t[5],m=t[6],p=t[7],x=t[8],d=t[9],V=t[10],w=t[11],g=t[12],k=t[13],y=t[14],M=t[15];for(e=0;e<f;e+=4)r[e+0]=a*(o=n[e+0])+l*(i=n[e+1])+x*(u=n[e+2])+g,r[e+1]=s*o+h*i+d*u+k,r[e+2]=c*o+m*i+V*u+y,r[e+3]=v*o+p*i+w*u+M;return r}function g(t,n){return t[0]<=n[0]&&n[3]<=t[3]&&t[1]<=n[1]&&t[2]<=n[2]}function k(t,n){return t[0]<=n[0]&&n[3]<=t[3]&&t[1]<=n[1]&&n[4]<=t[4]&&t[2]<=n[2]&&n[5]<=t[5]}var y,M,b,A=(y=u(3),M=u(3),b=u(3),function(t){return y[0]=t[0],y[1]=t[1],y[2]=t[2],M[0]=t[3],M[1]=t[4],M[2]=t[5],r(M,y,b),Math.abs(e(b))}),q=function(){var t=u(3),n=u(3),o=u(3);return function(i,u){t[0]=i[0],t[1]=i[1],t[2]=i[2],n[0]=i[3],n[1]=i[4],n[2]=i[5];var f=r(n,t,o),a=u[0]-i[0],s=i[3]-u[0],c=u[1]-i[1],v=i[4]-u[1],l=u[2]-i[2],h=i[5]-u[2];return f[0]+=a>s?a:s,f[1]+=c>v?c:v,f[2]+=l>h?l:h,Math.abs(e(f))}}();function F(t){return(t[3]-t[0])*(t[4]-t[1])*(t[5]-t[2])}function I(n,r){return void 0===r&&(r=t()),r[0]=(n[0]+n[3])/2,r[1]=(n[1]+n[4])/2,r[2]=(n[2]+n[5])/2,r}function j(t,n){return void 0===n&&(n=o()),n[0]=(t[2]+t[0])/2,n[1]=(t[3]+t[1])/2,n}function z(t){return void 0===t&&(t=h()),t[0]=f,t[1]=f,t[2]=f,t[3]=a,t[4]=a,t[5]=a,t}function B(t){return void 0===t&&(t=m()),t[0]=65535,t[1]=65535,t[2]=65535,t[3]=-65535,t[4]=-65535,t[5]=-65535,t}function C(t,n){return void 0===t&&(t=h()),void 0===n&&(n=x()),n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=1,n[4]=t[3],n[5]=t[1],n[6]=t[2],n[7]=1,n[8]=t[3],n[9]=t[4],n[10]=t[2],n[11]=1,n[12]=t[0],n[13]=t[4],n[14]=t[2],n[15]=1,n[16]=t[0],n[17]=t[1],n[18]=t[5],n[19]=1,n[20]=t[3],n[21]=t[1],n[22]=t[5],n[23]=1,n[24]=t[3],n[25]=t[4],n[26]=t[5],n[27]=1,n[28]=t[0],n[29]=t[4],n[30]=t[5],n[31]=1,n}function D(t,n){return t[0]>n[0]&&(t[0]=n[0]),t[1]>n[1]&&(t[1]=n[1]),t[2]>n[2]&&(t[2]=n[2]),t[3]<n[3]&&(t[3]=n[3]),t[4]<n[4]&&(t[4]=n[4]),t[5]<n[5]&&(t[5]=n[5]),t}function E(t,n){return t[0]>n[0]&&(t[0]=n[0]),t[1]>n[1]&&(t[1]=n[1]),t[3]<n[3]&&(t[3]=n[3]),t[4]<n[4]&&(t[4]=n[4]),t}function G(t,n){return t[0]>n[0]&&(t[0]=n[0]),t[1]>n[1]&&(t[1]=n[1]),t[2]>n[2]&&(t[2]=n[2]),t[3]<n[0]&&(t[3]=n[0]),t[4]<n[1]&&(t[4]=n[1]),t[5]<n[2]&&(t[5]=n[2]),t}function H(t,n){return t[0]>n[0]&&(t[0]=n[0]),t[1]>n[1]&&(t[1]=n[1]),t[3]<n[0]&&(t[3]=n[0]),t[4]<n[1]&&(t[4]=n[1]),t}function J(t,n){for(var r,e,o,i=0,u=n.length;i<u;i+=3)e=n[i+1],o=n[i+2],t[0]>(r=n[i])&&(t[0]=r),t[1]>e&&(t[1]=e),t[2]>o&&(t[2]=o),t[3]<r&&(t[3]=r),t[4]<e&&(t[4]=e),t[5]<o&&(t[5]=o);return t}function K(t,n){return void 0===n&&(n=x()),n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=1,n[4]=t[3],n[5]=t[1],n[6]=t[2],n[7]=1,n[8]=t[3],n[9]=t[4],n[10]=t[2],n[11]=1,n[12]=t[0],n[13]=t[4],n[14]=t[2],n[15]=1,n[16]=t[0],n[17]=t[1],n[18]=t[5],n[19]=1,n[20]=t[3],n[21]=t[1],n[22]=t[5],n[23]=1,n[24]=t[3],n[25]=t[4],n[26]=t[5],n[27]=1,n[28]=t[0],n[29]=t[4],n[30]=t[5],n[31]=1,n}var L,N=(L=u(3),function(t,n,r){n=n||h();for(var e,o,i,u=f,c=f,v=f,l=a,m=a,p=a,x=0,d=t.length;x<d;x+=3)r?(L[0]=t[x+0],L[1]=t[x+1],L[2]=t[x+2],s(L,r,L),e=L[0],o=L[1],i=L[2]):(e=t[x+0],o=t[x+1],i=t[x+2]),e<u&&(u=e),o<c&&(c=o),i<v&&(v=i),e>l&&(l=e),o>m&&(m=o),i>p&&(p=i);return n[0]=u,n[1]=c,n[2]=v,n[3]=l,n[4]=m,n[5]=p,n});function O(t,n){void 0===n&&(n=h());for(var r,e,o,i=f,u=f,s=f,c=a,v=a,l=a,m=0,p=t.length;m<p;m+=4)(r=t[m+0])<i&&(i=r),(e=t[m+1])<u&&(u=e),(o=t[m+2])<s&&(s=o),r>c&&(c=r),e>v&&(v=e),o>l&&(l=o);return n[0]=i,n[1]=u,n[2]=s,n[3]=c,n[4]=v,n[5]=l,n}function P(t,n){void 0===n&&(n=h());for(var r,e,o,i=f,u=f,s=f,c=a,v=a,l=a,m=0,p=t.length;m<p;m++)(r=t[m][0])<i&&(i=r),(e=t[m][1])<u&&(u=e),(o=t[m][2])<s&&(s=o),r>c&&(c=r),e>v&&(v=e),o>l&&(l=o);return n[0]=i,n[1]=u,n[2]=s,n[3]=c,n[4]=v,n[5]=l,n}function Q(n,r){void 0===r&&(r=t());for(var e=0,o=0,i=0,u=0,f=n.length;u<f;u+=3)e+=n[u+0],o+=n[u+1],i+=n[u+2];var a=n.length/3;return r[0]=e/a,r[1]=o/a,r[2]=i/a,r}var R=/*#__PURE__*/function(){function n(){this.testVertex=void 0,this.offset=void 0,this.normal=void 0,this.normal=t(),this.offset=0,this.testVertex=t()}return n.prototype.set=function(t,n,r,e){var o=1/Math.sqrt(t*t+n*n+r*r);this.normal[0]=t*o,this.normal[1]=n*o,this.normal[2]=r*o,this.offset=e*o,this.testVertex[0]=this.normal[0]>=0?1:0,this.testVertex[1]=this.normal[1]>=0?1:0,this.testVertex[2]=this.normal[2]>=0?1:0},n}(),S=1,T=2,U=3,W=function(){this.planes=void 0,this.planes=[new R,new R,new R,new R,new R,new R]};function X(t,n,r){var e=i(n,t,l),o=e[0],u=e[1],f=e[2],a=e[3],s=e[4],c=e[5],v=e[6],h=e[7],m=e[8],p=e[9],x=e[10],d=e[11],V=e[12],w=e[13],g=e[14],k=e[15];return(r=r||new W).planes[0].set(a-o,h-s,d-m,k-V),r.planes[1].set(a+o,h+s,d+m,k+V),r.planes[2].set(a-u,h-c,d-p,k-w),r.planes[3].set(a+u,h+c,d+p,k+w),r.planes[4].set(a-f,h-v,d-x,k-g),r.planes[5].set(a+f,h+v,d+x,k+g),r}function Y(t,n){var r=1,e=c,o=v;e[0]=n[0],e[1]=n[1],e[2]=n[2],o[0]=n[3],o[1]=n[4],o[2]=n[5];for(var i=[e,o],u=0;u<6;++u){var f=t.planes[u];if(f.normal[0]*i[f.testVertex[0]][0]+f.normal[1]*i[f.testVertex[1]][1]+f.normal[2]*i[f.testVertex[2]][2]+f.offset<0)return 3;f.normal[0]*i[1-f.testVertex[0]][0]+f.normal[1]*i[1-f.testVertex[1]][1]+f.normal[2]*i[1-f.testVertex[2]][2]+f.offset<0&&(r=2)}return r}function Z(t,n){return 2}function $(t,n,r){return!0}function _(t,n,r,e){return!0}function tt(t,n,r){return!0}function nt(t,n){return!0}function rt(t,n){return!0}function et(t,n,r){return!1}function ot(t,n,r){return!1}function it(t,n){for(var r=t[0],e=t[1],o=t[2],i=t[3],u=t[4],f=t[5],a=0,s=n.length;a<s;a+=3){var c=n[a];if(r<=c&&c<=i){var v=n[a+1];if(e<=v&&v<=u){var l=n[a+2];if(o<=l&&l<=f)return!0}}}return!1}function ut(t,n){return t[0]<=n[0]&&n[0]<=t[3]&&t[1]<=n[1]&&n[1]<=t[4]&&t[2]<=n[2]&&n[2]<=t[5]}function ft(t,n){return t[0]<=n[0]&&n[0]<=t[3]&&t[1]<=n[1]&&n[1]<=t[4]}export{C as AABB3ToOBB3,K as ABB3ToOBB3,W as Frustum3,R as FrustumPlane3,S as INSIDE,T as INTERSECT,O as OBB3ToAABB3,U as OUTSIDE,z as collapseAABB3,B as collapseAABB3Int16,g as containsAABB2,ft as containsAABB2Point2,k as containsAABB3,ut as containsAABB3Point3,p as createAABB2,h as createAABB3,m as createAABB3Int16,d as createOBB2,x as createOBB3,V as createSphere3,E as expandAABB2,H as expandAABB2Point2,D as expandAABB3,G as expandAABB3Point3,J as expandAABB3Points3,j as getAABB2Center,F as getAABB3Area,I as getAABB3Center,A as getAABB3Diag,q as getAABB3DiagPoint,Q as getPositions3Center,ot as intersectAABB3Lines3,it as intersectAABB3Positions3,et as intersectAABB3Triangles3,Z as intersectAABB3s,Y as intersectFrustum3AABB3,tt as intersectFrustum3Lines3,rt as intersectFrustum3Point3,nt as intersectFrustum3Positions3,_ as intersectFrustum3Triangle3,$ as intersectFrustum3Triangles3,P as points3ToAABB3,N as positions3ToAABB3,X as setFrustum3,w as transformOBB3};\n//# sourceMappingURL=index.es.map\n","import {FloatArrayParam, IntArrayParam} from \"@xeokit/math\";\nimport {containsAABB2} from \"@xeokit/boundaries\";\n\nconst MAX_KD_TREE_DEPTH = 10; // Increase if greater precision needed\nconst kdTreeDimLength = new Float32Array(2);\n\n/**\n * An item stored in a 2D k-d tree.\n *\n * See {@link \"@xeokit/collision/kdtree2\"} for usage.\n */\nexport interface KdItem2D {\n\n    /**\n     * The item stored in this KdItem2D.\n     */\n    item: any;\n}\n\n/**\n * A 2D k-d tree node.\n *\n * See {@link \"@xeokit/collision/kdtree2\"} for usage.\n */\nexport interface KdNode2D {\n\n    /**\n     * The axis-aligned 2D boundary of this kd-tree node.\n     */\n    aabb: FloatArrayParam;\n\n    /**\n     * The left KD2Node.\n     */\n    left?: KdNode2D;\n\n    /**\n     * The right KD2Node.\n     */\n    right?: KdNode2D;\n\n    /**\n     * The {@link KdItem2D | KdItem2Ds} stored in this KD2Node.\n     */\n    items?: KdItem2D[];\n}\n\n/**\n * Parameters for creating a 2D k-d tree.\n *\n * See {@link \"@xeokit/collision/kdtree2\"} for usage.\n */\nexport interface KdTree2DParams {\n\n    /**\n     * The 2D boundary of all the nodes we'll add to this k-d tree.\n     */\n    aabb: FloatArrayParam;\n\n    /**\n     * Maximum depth of the 2D kd-tree.\n     */\n    maxDepth?: number;\n}\n\n/**\n * A static 2D k-d tree.\n *\n * See {@link \"@xeokit/collision/kdtree2\"} for usage.\n */\nexport class KdTree2 {\n\n    /**\n     * The root node in this k-d tree.\n     */\n    readonly root: KdNode2D;\n\n    /**\n     * The maximum allowed depth of this 2D k-d tree.\n     */\n    readonly maxDepth: number;\n\n    /**\n     * Creates a new 2D k-d tree.\n     *\n     * @param params\n     */\n    constructor(params?: KdTree2DParams) {\n        this.maxDepth = params?.maxDepth || MAX_KD_TREE_DEPTH;\n        this.root = {\n            aabb: params.aabb.slice()\n        };\n    }\n\n    /**\n     * Inserts a bounded item into this 2D k-d tree.\n     *\n     * @param item\n     * @param aabb\n     */\n    insertItem(item: any, aabb: IntArrayParam) {\n        this.#insertItem(this.root, <KdItem2D>{item}, aabb, 1)\n    }\n\n    #insertItem(node: KdNode2D, item: KdItem2D, aabb: IntArrayParam, depth: number) {\n        if (depth >= this.maxDepth) {\n            node.items = node.items || [];\n            node.items.push(item);\n            return;\n        }\n        if (node.left) {\n            if (containsAABB2(node.left.aabb, aabb)) {\n                this.#insertItem(node.left, item, aabb, depth + 1);\n                return;\n            }\n        }\n        if (node.right) {\n            if (containsAABB2(node.right.aabb, aabb)) {\n                this.#insertItem(node.right, item, aabb, depth + 1);\n                return;\n            }\n        }\n        const nodeAABB = node.aabb;\n        kdTreeDimLength[0] = nodeAABB[2] - nodeAABB[0];\n        kdTreeDimLength[1] = nodeAABB[3] - nodeAABB[1];\n        let dim = 0;\n        if (kdTreeDimLength[1] > kdTreeDimLength[dim]) {\n            dim = 1;\n        }\n        if (!node.left) {\n            const aabbLeft = nodeAABB.slice();\n            aabbLeft[dim + 2] = ((nodeAABB[dim] + nodeAABB[dim + 2]) / 2.0);\n            node.left = {\n                aabb: aabbLeft\n            };\n            if (containsAABB2(aabbLeft, aabb)) {\n                this.#insertItem(node.left, item, aabb, depth + 1);\n                return;\n            }\n        }\n        if (!node.right) {\n            const aabbRight = nodeAABB.slice();\n            aabbRight[dim] = ((nodeAABB[dim] + nodeAABB[dim + 2]) / 2.0);\n            node.right = {\n                aabb: aabbRight\n            };\n            if (containsAABB2(aabbRight, aabb)) {\n                this.#insertItem(node.right, item, aabb, depth + 1);\n                return;\n            }\n        }\n        node.items = node.items || [];\n        node.items.push(item);\n    }\n}\n","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.DispatcherWrapper = void 0;\r\n/**\r\n * Hides the implementation of the event dispatcher. Will expose methods that\r\n * are relevent to the event.\r\n *\r\n * @export\r\n * @class DispatcherWrapper\r\n * @implements {ISubscribable<TEventHandler>}\r\n * @template TEventHandler The type of event handler.\r\n */\r\nclass DispatcherWrapper {\r\n    /**\r\n     * Creates an instance of DispatcherWrapper.\r\n     * @param {ISubscribable<TEventHandler>} dispatcher\r\n     *\r\n     * @memberOf DispatcherWrapper\r\n     */\r\n    constructor(dispatcher) {\r\n        this._subscribe = (fn) => dispatcher.subscribe(fn);\r\n        this._unsubscribe = (fn) => dispatcher.unsubscribe(fn);\r\n        this._one = (fn) => dispatcher.one(fn);\r\n        this._has = (fn) => dispatcher.has(fn);\r\n        this._clear = () => dispatcher.clear();\r\n        this._count = () => dispatcher.count;\r\n        this._onSubscriptionChange = () => dispatcher.onSubscriptionChange;\r\n    }\r\n    /**\r\n     * Triggered when subscriptions are changed (added or removed).\r\n     *\r\n     * @readonly\r\n     * @type {ISubscribable<SubscriptionChangeEventHandler>}\r\n     * @memberOf DispatcherWrapper\r\n     */\r\n    get onSubscriptionChange() {\r\n        return this._onSubscriptionChange();\r\n    }\r\n    /**\r\n     * Returns the number of subscriptions.\r\n     *\r\n     * @readonly\r\n     * @type {number}\r\n     * @memberOf DispatcherWrapper\r\n     */\r\n    get count() {\r\n        return this._count();\r\n    }\r\n    /**\r\n     * Subscribe to the event dispatcher.\r\n     *\r\n     * @param {TEventHandler} fn The event handler that is called when the event is dispatched.\r\n     * @returns {() => void} A function that unsubscribes the event handler from the event.\r\n     *\r\n     * @memberOf DispatcherWrapper\r\n     */\r\n    subscribe(fn) {\r\n        return this._subscribe(fn);\r\n    }\r\n    /**\r\n     * Subscribe to the event dispatcher.\r\n     *\r\n     * @param {TEventHandler} fn The event handler that is called when the event is dispatched.\r\n     * @returns {() => void} A function that unsubscribes the event handler from the event.\r\n     *\r\n     * @memberOf DispatcherWrapper\r\n     */\r\n    sub(fn) {\r\n        return this.subscribe(fn);\r\n    }\r\n    /**\r\n     * Unsubscribe from the event dispatcher.\r\n     *\r\n     * @param {TEventHandler} fn The event handler that is called when the event is dispatched.\r\n     *\r\n     * @memberOf DispatcherWrapper\r\n     */\r\n    unsubscribe(fn) {\r\n        this._unsubscribe(fn);\r\n    }\r\n    /**\r\n     * Unsubscribe from the event dispatcher.\r\n     *\r\n     * @param {TEventHandler} fn The event handler that is called when the event is dispatched.\r\n     *\r\n     * @memberOf DispatcherWrapper\r\n     */\r\n    unsub(fn) {\r\n        this.unsubscribe(fn);\r\n    }\r\n    /**\r\n     * Subscribe once to the event with the specified name.\r\n     *\r\n     * @returns {() => void} A function that unsubscribes the event handler from the event.\r\n     *\r\n     * @memberOf DispatcherWrapper\r\n     */\r\n    one(fn) {\r\n        return this._one(fn);\r\n    }\r\n    /**\r\n     * Checks it the event has a subscription for the specified handler.\r\n     *\r\n     * @param {TEventHandler} fn The event handler that is called when the event is dispatched.\r\n     *\r\n     * @memberOf DispatcherWrapper\r\n     */\r\n    has(fn) {\r\n        return this._has(fn);\r\n    }\r\n    /**\r\n     * Clears all the subscriptions.\r\n     *\r\n     * @memberOf DispatcherWrapper\r\n     */\r\n    clear() {\r\n        this._clear();\r\n    }\r\n}\r\nexports.DispatcherWrapper = DispatcherWrapper;\r\n","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.Subscription = void 0;\r\n/**\r\n * Stores a handler. Manages execution meta data.\r\n * @class Subscription\r\n * @template TEventHandler\r\n */\r\nclass Subscription {\r\n    /**\r\n     * Creates an instance of Subscription.\r\n     *\r\n     * @param {TEventHandler} handler The handler for the subscription.\r\n     * @param {boolean} isOnce Indicates if the handler should only be executed once.\r\n     */\r\n    constructor(handler, isOnce) {\r\n        this.handler = handler;\r\n        this.isOnce = isOnce;\r\n        /**\r\n         * Indicates if the subscription has been executed before.\r\n         */\r\n        this.isExecuted = false;\r\n    }\r\n    /**\r\n     * Executes the handler.\r\n     *\r\n     * @param {boolean} executeAsync True if the even should be executed async.\r\n     * @param {*} scope The scope the scope of the event.\r\n     * @param {IArguments} args The arguments for the event.\r\n     */\r\n    execute(executeAsync, scope, args) {\r\n        if (!this.isOnce || !this.isExecuted) {\r\n            this.isExecuted = true;\r\n            var fn = this.handler;\r\n            if (executeAsync) {\r\n                setTimeout(() => {\r\n                    fn.apply(scope, args);\r\n                }, 1);\r\n            }\r\n            else {\r\n                fn.apply(scope, args);\r\n            }\r\n        }\r\n    }\r\n}\r\nexports.Subscription = Subscription;\r\n","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.EventManagement = void 0;\r\n/**\r\n * Allows the user to interact with the event.\r\n *\r\n * @export\r\n * @class EventManagement\r\n * @implements {IEventManagement}\r\n */\r\nclass EventManagement {\r\n    /**\r\n     * Creates an instance of EventManagement.\r\n     * @param {() => void} unsub An unsubscribe handler.\r\n     *\r\n     * @memberOf EventManagement\r\n     */\r\n    constructor(unsub) {\r\n        this.unsub = unsub;\r\n        this.propagationStopped = false;\r\n    }\r\n    /**\r\n     * Stops the propagation of the event.\r\n     * Cannot be used when async dispatch is done.\r\n     *\r\n     * @memberOf EventManagement\r\n     */\r\n    stopPropagation() {\r\n        this.propagationStopped = true;\r\n    }\r\n}\r\nexports.EventManagement = EventManagement;\r\n","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.SubscriptionChangeEventDispatcher = exports.DispatcherBase = void 0;\r\nconst DispatcherWrapper_1 = require(\"./DispatcherWrapper\");\r\nconst Subscription_1 = require(\"../events/Subscription\");\r\nconst EventManagement_1 = require(\"../management/EventManagement\");\r\n/**\r\n * Base class for implementation of the dispatcher. It facilitates the subscribe\r\n * and unsubscribe methods based on generic handlers. The TEventType specifies\r\n * the type of event that should be exposed. Use the asEvent to expose the\r\n * dispatcher as event.\r\n *\r\n * @export\r\n * @abstract\r\n * @class DispatcherBase\r\n * @implements {ISubscribable<TEventHandler>}\r\n * @template TEventHandler The type of event handler.\r\n */\r\nclass DispatcherBase {\r\n    constructor() {\r\n        /**\r\n         * The subscriptions.\r\n         *\r\n         * @protected\r\n         *\r\n         * @memberOf DispatcherBase\r\n         */\r\n        this._subscriptions = new Array();\r\n    }\r\n    /**\r\n     * Returns the number of subscriptions.\r\n     *\r\n     * @readonly\r\n     * @type {number}\r\n     * @memberOf DispatcherBase\r\n     */\r\n    get count() {\r\n        return this._subscriptions.length;\r\n    }\r\n    /**\r\n     * Triggered when subscriptions are changed (added or removed).\r\n     *\r\n     * @readonly\r\n     * @type {ISubscribable<SubscriptionChangeEventHandler>}\r\n     * @memberOf DispatcherBase\r\n     */\r\n    get onSubscriptionChange() {\r\n        if (this._onSubscriptionChange == null) {\r\n            this._onSubscriptionChange = new SubscriptionChangeEventDispatcher();\r\n        }\r\n        return this._onSubscriptionChange.asEvent();\r\n    }\r\n    /**\r\n     * Subscribe to the event dispatcher.\r\n     *\r\n     * @param {TEventHandler} fn The event handler that is called when the event is dispatched.\r\n     * @returns A function that unsubscribes the event handler from the event.\r\n     *\r\n     * @memberOf DispatcherBase\r\n     */\r\n    subscribe(fn) {\r\n        if (fn) {\r\n            this._subscriptions.push(this.createSubscription(fn, false));\r\n            this.triggerSubscriptionChange();\r\n        }\r\n        return () => {\r\n            this.unsubscribe(fn);\r\n        };\r\n    }\r\n    /**\r\n     * Subscribe to the event dispatcher.\r\n     *\r\n     * @param {TEventHandler} fn The event handler that is called when the event is dispatched.\r\n     * @returns A function that unsubscribes the event handler from the event.\r\n     *\r\n     * @memberOf DispatcherBase\r\n     */\r\n    sub(fn) {\r\n        return this.subscribe(fn);\r\n    }\r\n    /**\r\n     * Subscribe once to the event with the specified name.\r\n     *\r\n     * @param {TEventHandler} fn The event handler that is called when the event is dispatched.\r\n     * @returns A function that unsubscribes the event handler from the event.\r\n     *\r\n     * @memberOf DispatcherBase\r\n     */\r\n    one(fn) {\r\n        if (fn) {\r\n            this._subscriptions.push(this.createSubscription(fn, true));\r\n            this.triggerSubscriptionChange();\r\n        }\r\n        return () => {\r\n            this.unsubscribe(fn);\r\n        };\r\n    }\r\n    /**\r\n     * Checks it the event has a subscription for the specified handler.\r\n     *\r\n     * @param {TEventHandler} fn The event handler.\r\n     *\r\n     * @memberOf DispatcherBase\r\n     */\r\n    has(fn) {\r\n        if (!fn)\r\n            return false;\r\n        return this._subscriptions.some((sub) => sub.handler == fn);\r\n    }\r\n    /**\r\n     * Unsubscribes the handler from the dispatcher.\r\n     *\r\n     * @param {TEventHandler} fn The event handler.\r\n     *\r\n     * @memberOf DispatcherBase\r\n     */\r\n    unsubscribe(fn) {\r\n        if (!fn)\r\n            return;\r\n        let changes = false;\r\n        for (let i = 0; i < this._subscriptions.length; i++) {\r\n            if (this._subscriptions[i].handler == fn) {\r\n                this._subscriptions.splice(i, 1);\r\n                changes = true;\r\n                break;\r\n            }\r\n        }\r\n        if (changes) {\r\n            this.triggerSubscriptionChange();\r\n        }\r\n    }\r\n    /**\r\n     * Unsubscribes the handler from the dispatcher.\r\n     *\r\n     * @param {TEventHandler} fn The event handler.\r\n     *\r\n     * @memberOf DispatcherBase\r\n     */\r\n    unsub(fn) {\r\n        this.unsubscribe(fn);\r\n    }\r\n    /**\r\n     * Generic dispatch will dispatch the handlers with the given arguments.\r\n     *\r\n     * @protected\r\n     * @param {boolean} executeAsync `True` if the even should be executed async.\r\n     * @param {*} scope The scope of the event. The scope becomes the `this` for handler.\r\n     * @param {IArguments} args The arguments for the event.\r\n     * @returns {(IPropagationStatus | null)} The propagation status, or if an `executeAsync` is used `null`.\r\n     *\r\n     * @memberOf DispatcherBase\r\n     */\r\n    _dispatch(executeAsync, scope, args) {\r\n        //execute on a copy because of bug #9\r\n        for (let sub of [...this._subscriptions]) {\r\n            let ev = new EventManagement_1.EventManagement(() => this.unsub(sub.handler));\r\n            let nargs = Array.prototype.slice.call(args);\r\n            nargs.push(ev);\r\n            let s = sub;\r\n            s.execute(executeAsync, scope, nargs);\r\n            //cleanup subs that are no longer needed\r\n            this.cleanup(sub);\r\n            if (!executeAsync && ev.propagationStopped) {\r\n                return { propagationStopped: true };\r\n            }\r\n        }\r\n        if (executeAsync) {\r\n            return null;\r\n        }\r\n        return { propagationStopped: false };\r\n    }\r\n    /**\r\n     * Creates a subscription.\r\n     *\r\n     * @protected\r\n     * @param {TEventHandler} handler The handler.\r\n     * @param {boolean} isOnce True if the handler should run only one.\r\n     * @returns {ISubscription<TEventHandler>} The subscription.\r\n     *\r\n     * @memberOf DispatcherBase\r\n     */\r\n    createSubscription(handler, isOnce) {\r\n        return new Subscription_1.Subscription(handler, isOnce);\r\n    }\r\n    /**\r\n     * Cleans up subs that ran and should run only once.\r\n     *\r\n     * @protected\r\n     * @param {ISubscription<TEventHandler>} sub The subscription.\r\n     *\r\n     * @memberOf DispatcherBase\r\n     */\r\n    cleanup(sub) {\r\n        let changes = false;\r\n        if (sub.isOnce && sub.isExecuted) {\r\n            let i = this._subscriptions.indexOf(sub);\r\n            if (i > -1) {\r\n                this._subscriptions.splice(i, 1);\r\n                changes = true;\r\n            }\r\n        }\r\n        if (changes) {\r\n            this.triggerSubscriptionChange();\r\n        }\r\n    }\r\n    /**\r\n     * Creates an event from the dispatcher. Will return the dispatcher\r\n     * in a wrapper. This will prevent exposure of any dispatcher methods.\r\n     *\r\n     * @returns {ISubscribable<TEventHandler>}\r\n     *\r\n     * @memberOf DispatcherBase\r\n     */\r\n    asEvent() {\r\n        if (this._wrap == null) {\r\n            this._wrap = new DispatcherWrapper_1.DispatcherWrapper(this);\r\n        }\r\n        return this._wrap;\r\n    }\r\n    /**\r\n     * Clears the subscriptions.\r\n     *\r\n     * @memberOf DispatcherBase\r\n     */\r\n    clear() {\r\n        if (this._subscriptions.length != 0) {\r\n            this._subscriptions.splice(0, this._subscriptions.length);\r\n            this.triggerSubscriptionChange();\r\n        }\r\n    }\r\n    /**\r\n     * Triggers the subscription change event.\r\n     *\r\n     * @private\r\n     *\r\n     * @memberOf DispatcherBase\r\n     */\r\n    triggerSubscriptionChange() {\r\n        if (this._onSubscriptionChange != null) {\r\n            this._onSubscriptionChange.dispatch(this.count);\r\n        }\r\n    }\r\n}\r\nexports.DispatcherBase = DispatcherBase;\r\n/**\r\n * Dispatcher for subscription changes.\r\n *\r\n * @export\r\n * @class SubscriptionChangeEventDispatcher\r\n * @extends {DispatcherBase<SubscriptionChangeEventHandler>}\r\n */\r\nclass SubscriptionChangeEventDispatcher extends DispatcherBase {\r\n    /**\r\n     * Dispatches the event.\r\n     *\r\n     * @param {number} count The currrent number of subscriptions.\r\n     *\r\n     * @memberOf SubscriptionChangeEventDispatcher\r\n     */\r\n    dispatch(count) {\r\n        this._dispatch(false, this, arguments);\r\n    }\r\n}\r\nexports.SubscriptionChangeEventDispatcher = SubscriptionChangeEventDispatcher;\r\n","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.DispatchError = void 0;\r\n/**\r\n * Indicates an error with dispatching.\r\n *\r\n * @export\r\n * @class DispatchError\r\n * @extends {Error}\r\n */\r\nclass DispatchError extends Error {\r\n    /**\r\n     * Creates an instance of DispatchError.\r\n     * @param {string} message The message.\r\n     *\r\n     * @memberOf DispatchError\r\n     */\r\n    constructor(message) {\r\n        super(message);\r\n    }\r\n}\r\nexports.DispatchError = DispatchError;\r\n","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.EventListBase = void 0;\r\n/**\r\n * Base class for event lists classes. Implements the get and remove.\r\n *\r\n * @export\r\n * @abstract\r\n * @class EventListBaset\r\n * @template TEventDispatcher The type of event dispatcher.\r\n */\r\nclass EventListBase {\r\n    constructor() {\r\n        this._events = {};\r\n    }\r\n    /**\r\n     * Gets the dispatcher associated with the name.\r\n     *\r\n     * @param {string} name The name of the event.\r\n     * @returns {TEventDispatcher} The disptacher.\r\n     *\r\n     * @memberOf EventListBase\r\n     */\r\n    get(name) {\r\n        let event = this._events[name];\r\n        if (event) {\r\n            return event;\r\n        }\r\n        event = this.createDispatcher();\r\n        this._events[name] = event;\r\n        return event;\r\n    }\r\n    /**\r\n     * Removes the dispatcher associated with the name.\r\n     *\r\n     * @param {string} name\r\n     *\r\n     * @memberOf EventListBase\r\n     */\r\n    remove(name) {\r\n        delete this._events[name];\r\n    }\r\n}\r\nexports.EventListBase = EventListBase;\r\n","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.HandlingBase = void 0;\r\n/**\r\n * Base class that implements event handling. With a an\r\n * event list this base class will expose events that can be\r\n * subscribed to. This will give your class generic events.\r\n *\r\n * @export\r\n * @abstract\r\n * @class HandlingBase\r\n * @template TEventHandler The type of event handler.\r\n * @template TDispatcher The type of dispatcher.\r\n * @template TList The type of event list.\r\n */\r\nclass HandlingBase {\r\n    /**\r\n     * Creates an instance of HandlingBase.\r\n     * @param {TList} events The event list. Used for event management.\r\n     *\r\n     * @memberOf HandlingBase\r\n     */\r\n    constructor(events) {\r\n        this.events = events;\r\n    }\r\n    /**\r\n     * Subscribes once to the event with the specified name.\r\n     * @param {string} name The name of the event.\r\n     * @param {TEventHandler} fn The event handler.\r\n     *\r\n     * @memberOf HandlingBase\r\n     */\r\n    one(name, fn) {\r\n        this.events.get(name).one(fn);\r\n    }\r\n    /**\r\n     * Checks it the event has a subscription for the specified handler.\r\n     * @param {string} name The name of the event.\r\n     * @param {TEventHandler} fn The event handler.\r\n     *\r\n     * @memberOf HandlingBase\r\n     */\r\n    has(name, fn) {\r\n        return this.events.get(name).has(fn);\r\n    }\r\n    /**\r\n     * Subscribes to the event with the specified name.\r\n     * @param {string} name The name of the event.\r\n     * @param {TEventHandler} fn The event handler.\r\n     *\r\n     * @memberOf HandlingBase\r\n     */\r\n    subscribe(name, fn) {\r\n        this.events.get(name).subscribe(fn);\r\n    }\r\n    /**\r\n     * Subscribes to the event with the specified name.\r\n     * @param {string} name The name of the event.\r\n     * @param {TEventHandler} fn The event handler.\r\n     *\r\n     * @memberOf HandlingBase\r\n     */\r\n    sub(name, fn) {\r\n        this.subscribe(name, fn);\r\n    }\r\n    /**\r\n     * Unsubscribes from the event with the specified name.\r\n     * @param {string} name The name of the event.\r\n     * @param {TEventHandler} fn The event handler.\r\n     *\r\n     * @memberOf HandlingBase\r\n     */\r\n    unsubscribe(name, fn) {\r\n        this.events.get(name).unsubscribe(fn);\r\n    }\r\n    /**\r\n     * Unsubscribes from the event with the specified name.\r\n     * @param {string} name The name of the event.\r\n     * @param {TEventHandler} fn The event handler.\r\n     *\r\n     * @memberOf HandlingBase\r\n     */\r\n    unsub(name, fn) {\r\n        this.unsubscribe(name, fn);\r\n    }\r\n}\r\nexports.HandlingBase = HandlingBase;\r\n","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.PromiseSubscription = void 0;\r\n/**\r\n * Subscription implementation for events with promises.\r\n *\r\n * @export\r\n * @class PromiseSubscription\r\n * @implements {ISubscription<TEventHandler>}\r\n * @template TEventHandler The type of event handler.\r\n */\r\nclass PromiseSubscription {\r\n    /**\r\n     * Creates an instance of PromiseSubscription.\r\n     * @param {TEventHandler} handler The handler for the subscription.\r\n     * @param {boolean} isOnce Indicates if the handler should only be executed once.\r\n     *\r\n     * @memberOf PromiseSubscription\r\n     */\r\n    constructor(handler, isOnce) {\r\n        this.handler = handler;\r\n        this.isOnce = isOnce;\r\n        /**\r\n         * Indicates if the subscription has been executed before.\r\n         *\r\n         * @memberOf PromiseSubscription\r\n         */\r\n        this.isExecuted = false;\r\n    }\r\n    /**\r\n     * Executes the handler.\r\n     *\r\n     * @param {boolean} executeAsync True if the even should be executed async.\r\n     * @param {*} scope The scope the scope of the event.\r\n     * @param {IArguments} args The arguments for the event.\r\n     *\r\n     * @memberOf PromiseSubscription\r\n     */\r\n    async execute(executeAsync, scope, args) {\r\n        if (!this.isOnce || !this.isExecuted) {\r\n            this.isExecuted = true;\r\n            //TODO: do we need to cast to any -- seems yuck\r\n            var fn = this.handler;\r\n            if (executeAsync) {\r\n                setTimeout(() => {\r\n                    fn.apply(scope, args);\r\n                }, 1);\r\n                return;\r\n            }\r\n            let result = fn.apply(scope, args);\r\n            await result;\r\n        }\r\n    }\r\n}\r\nexports.PromiseSubscription = PromiseSubscription;\r\n","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.PromiseDispatcherBase = void 0;\r\nconst PromiseSubscription_1 = require(\"../events/PromiseSubscription\");\r\nconst EventManagement_1 = require(\"../management/EventManagement\");\r\nconst DispatcherBase_1 = require(\"./DispatcherBase\");\r\nconst DispatchError_1 = require(\"./DispatchError\");\r\n/**\r\n * Dispatcher base for dispatchers that use promises. Each promise\r\n * is awaited before the next is dispatched, unless the event is\r\n * dispatched with the executeAsync flag.\r\n *\r\n * @export\r\n * @abstract\r\n * @class PromiseDispatcherBase\r\n * @extends {DispatcherBase<TEventHandler>}\r\n * @template TEventHandler The type of event handler.\r\n */\r\nclass PromiseDispatcherBase extends DispatcherBase_1.DispatcherBase {\r\n    /**\r\n     * The normal dispatch cannot be used in this class.\r\n     *\r\n     * @protected\r\n     * @param {boolean} executeAsync `True` if the even should be executed async.\r\n     * @param {*} scope The scope of the event. The scope becomes the `this` for handler.\r\n     * @param {IArguments} args The arguments for the event.\r\n     * @returns {(IPropagationStatus | null)} The propagation status, or if an `executeAsync` is used `null`.\r\n     *\r\n     * @memberOf DispatcherBase\r\n     */\r\n    _dispatch(executeAsync, scope, args) {\r\n        throw new DispatchError_1.DispatchError(\"_dispatch not supported. Use _dispatchAsPromise.\");\r\n    }\r\n    /**\r\n     * Crates a new subscription.\r\n     *\r\n     * @protected\r\n     * @param {TEventHandler} handler The handler.\r\n     * @param {boolean} isOnce Indicates if the handler should only run once.\r\n     * @returns {ISubscription<TEventHandler>} The subscription.\r\n     *\r\n     * @memberOf PromiseDispatcherBase\r\n     */\r\n    createSubscription(handler, isOnce) {\r\n        return new PromiseSubscription_1.PromiseSubscription(handler, isOnce);\r\n    }\r\n    /**\r\n     * Generic dispatch will dispatch the handlers with the given arguments.\r\n     *\r\n     * @protected\r\n     * @param {boolean} executeAsync `True` if the even should be executed async.\r\n     * @param {*} scope The scope of the event. The scope becomes the `this` for handler.\r\n     * @param {IArguments} args The arguments for the event.\r\n     * @returns {(IPropagationStatus | null)} The propagation status, or if an `executeAsync` is used `null`.\r\n     *\r\n     * @memberOf DispatcherBase\r\n     */\r\n    async _dispatchAsPromise(executeAsync, scope, args) {\r\n        //execute on a copy because of bug #9\r\n        for (let sub of [...this._subscriptions]) {\r\n            let ev = new EventManagement_1.EventManagement(() => this.unsub(sub.handler));\r\n            let nargs = Array.prototype.slice.call(args);\r\n            nargs.push(ev);\r\n            let ps = sub;\r\n            await ps.execute(executeAsync, scope, nargs);\r\n            //cleanup subs that are no longer needed\r\n            this.cleanup(sub);\r\n            if (!executeAsync && ev.propagationStopped) {\r\n                return { propagationStopped: true };\r\n            }\r\n        }\r\n        if (executeAsync) {\r\n            return null;\r\n        }\r\n        return { propagationStopped: false };\r\n    }\r\n}\r\nexports.PromiseDispatcherBase = PromiseDispatcherBase;\r\n","\"use strict\";\r\n/*!\r\n * Strongly Typed Events for TypeScript - Core\r\n * https://github.com/KeesCBakker/StronlyTypedEvents/\r\n * http://keestalkstech.com\r\n *\r\n * Copyright Kees C. Bakker / KeesTalksTech\r\n * Released under the MIT license\r\n */\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.SubscriptionChangeEventDispatcher = exports.HandlingBase = exports.PromiseDispatcherBase = exports.PromiseSubscription = exports.DispatchError = exports.EventManagement = exports.EventListBase = exports.DispatcherWrapper = exports.DispatcherBase = exports.Subscription = void 0;\r\nconst DispatcherBase_1 = require(\"./dispatching/DispatcherBase\");\r\nObject.defineProperty(exports, \"DispatcherBase\", { enumerable: true, get: function () { return DispatcherBase_1.DispatcherBase; } });\r\nObject.defineProperty(exports, \"SubscriptionChangeEventDispatcher\", { enumerable: true, get: function () { return DispatcherBase_1.SubscriptionChangeEventDispatcher; } });\r\nconst DispatchError_1 = require(\"./dispatching/DispatchError\");\r\nObject.defineProperty(exports, \"DispatchError\", { enumerable: true, get: function () { return DispatchError_1.DispatchError; } });\r\nconst DispatcherWrapper_1 = require(\"./dispatching/DispatcherWrapper\");\r\nObject.defineProperty(exports, \"DispatcherWrapper\", { enumerable: true, get: function () { return DispatcherWrapper_1.DispatcherWrapper; } });\r\nconst EventListBase_1 = require(\"./dispatching/EventListBase\");\r\nObject.defineProperty(exports, \"EventListBase\", { enumerable: true, get: function () { return EventListBase_1.EventListBase; } });\r\nconst EventManagement_1 = require(\"./management/EventManagement\");\r\nObject.defineProperty(exports, \"EventManagement\", { enumerable: true, get: function () { return EventManagement_1.EventManagement; } });\r\nconst HandlingBase_1 = require(\"./handling/HandlingBase\");\r\nObject.defineProperty(exports, \"HandlingBase\", { enumerable: true, get: function () { return HandlingBase_1.HandlingBase; } });\r\nconst PromiseDispatcherBase_1 = require(\"./dispatching/PromiseDispatcherBase\");\r\nObject.defineProperty(exports, \"PromiseDispatcherBase\", { enumerable: true, get: function () { return PromiseDispatcherBase_1.PromiseDispatcherBase; } });\r\nconst PromiseSubscription_1 = require(\"./events/PromiseSubscription\");\r\nObject.defineProperty(exports, \"PromiseSubscription\", { enumerable: true, get: function () { return PromiseSubscription_1.PromiseSubscription; } });\r\nconst Subscription_1 = require(\"./events/Subscription\");\r\nObject.defineProperty(exports, \"Subscription\", { enumerable: true, get: function () { return Subscription_1.Subscription; } });\r\n","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.EventDispatcher = void 0;\r\nconst ste_core_1 = require(\"ste-core\");\r\n/**\r\n * Dispatcher implementation for events. Can be used to subscribe, unsubscribe\r\n * or dispatch events. Use the ToEvent() method to expose the event.\r\n *\r\n * @export\r\n * @class EventDispatcher\r\n * @extends {DispatcherBase<IEventHandler<TSender, TArgs>>}\r\n * @implements {IEvent<TSender, TArgs>}\r\n * @template TSender The sender type.\r\n * @template TArgs The event arguments type.\r\n */\r\nclass EventDispatcher extends ste_core_1.DispatcherBase {\r\n    /**\r\n     * Creates an instance of EventDispatcher.\r\n     *\r\n     * @memberOf EventDispatcher\r\n     */\r\n    constructor() {\r\n        super();\r\n    }\r\n    /**\r\n     * Dispatches the event.\r\n     *\r\n     * @param {TSender} sender The sender.\r\n     * @param {TArgs} args The arguments.\r\n     * @returns {IPropagationStatus} The propagation status to interact with the event\r\n     *\r\n     * @memberOf EventDispatcher\r\n     */\r\n    dispatch(sender, args) {\r\n        const result = this._dispatch(false, this, arguments);\r\n        if (result == null) {\r\n            throw new ste_core_1.DispatchError(\"Got `null` back from dispatch.\");\r\n        }\r\n        return result;\r\n    }\r\n    /**\r\n     * Dispatches the event in an async way. Does not support event interaction.\r\n     *\r\n     * @param {TSender} sender The sender.\r\n     * @param {TArgs} args The arguments.\r\n     *\r\n     * @memberOf EventDispatcher\r\n     */\r\n    dispatchAsync(sender, args) {\r\n        this._dispatch(true, this, arguments);\r\n    }\r\n    /**\r\n     * Creates an event from the dispatcher. Will return the dispatcher\r\n     * in a wrapper. This will prevent exposure of any dispatcher methods.\r\n     *\r\n     * @returns {IEvent<TSender, TArgs>} The event.\r\n     *\r\n     * @memberOf EventDispatcher\r\n     */\r\n    asEvent() {\r\n        return super.asEvent();\r\n    }\r\n}\r\nexports.EventDispatcher = EventDispatcher;\r\n","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.EventList = void 0;\r\nconst ste_core_1 = require(\"ste-core\");\r\nconst EventDispatcher_1 = require(\"./EventDispatcher\");\r\n/**\r\n * Storage class for multiple events that are accessible by name.\r\n * Events dispatchers are automatically created.\r\n */\r\nclass EventList extends ste_core_1.EventListBase {\r\n    /**\r\n     * Creates a new EventList instance.\r\n     */\r\n    constructor() {\r\n        super();\r\n    }\r\n    /**\r\n     * Creates a new dispatcher instance.\r\n     */\r\n    createDispatcher() {\r\n        return new EventDispatcher_1.EventDispatcher();\r\n    }\r\n}\r\nexports.EventList = EventList;\r\n","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.EventHandlingBase = void 0;\r\nconst ste_core_1 = require(\"ste-core\");\r\nconst EventList_1 = require(\"./EventList\");\r\n/**\r\n * Extends objects with signal event handling capabilities.\r\n */\r\nclass EventHandlingBase extends ste_core_1.HandlingBase {\r\n    constructor() {\r\n        super(new EventList_1.EventList());\r\n    }\r\n}\r\nexports.EventHandlingBase = EventHandlingBase;\r\n","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.NonUniformEventList = void 0;\r\nconst EventDispatcher_1 = require(\"./EventDispatcher\");\r\n/**\r\n * Similar to EventList, but instead of TArgs, a map of event names ang argument types is provided with TArgsMap.\r\n */\r\nclass NonUniformEventList {\r\n    constructor() {\r\n        this._events = {};\r\n    }\r\n    /**\r\n     * Gets the dispatcher associated with the name.\r\n     * @param name The name of the event.\r\n     */\r\n    get(name) {\r\n        if (this._events[name]) {\r\n            // @TODO avoid typecasting. Not sure why TS thinks this._events[name] could still be undefined.\r\n            return this._events[name];\r\n        }\r\n        const event = this.createDispatcher();\r\n        this._events[name] = event;\r\n        return event;\r\n    }\r\n    /**\r\n     * Removes the dispatcher associated with the name.\r\n     * @param name The name of the event.\r\n     */\r\n    remove(name) {\r\n        delete this._events[name];\r\n    }\r\n    /**\r\n     * Creates a new dispatcher instance.\r\n     */\r\n    createDispatcher() {\r\n        return new EventDispatcher_1.EventDispatcher();\r\n    }\r\n}\r\nexports.NonUniformEventList = NonUniformEventList;\r\n","\"use strict\";\r\n/*!\r\n * Strongly Typed Events for TypeScript - Core\r\n * https://github.com/KeesCBakker/StronlyTypedEvents/\r\n * http://keestalkstech.com\r\n *\r\n * Copyright Kees C. Bakker / KeesTalksTech\r\n * Released under the MIT license\r\n */\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.NonUniformEventList = exports.EventList = exports.EventHandlingBase = exports.EventDispatcher = void 0;\r\nconst EventDispatcher_1 = require(\"./EventDispatcher\");\r\nObject.defineProperty(exports, \"EventDispatcher\", { enumerable: true, get: function () { return EventDispatcher_1.EventDispatcher; } });\r\nconst EventHandlingBase_1 = require(\"./EventHandlingBase\");\r\nObject.defineProperty(exports, \"EventHandlingBase\", { enumerable: true, get: function () { return EventHandlingBase_1.EventHandlingBase; } });\r\nconst EventList_1 = require(\"./EventList\");\r\nObject.defineProperty(exports, \"EventList\", { enumerable: true, get: function () { return EventList_1.EventList; } });\r\nconst NonUniformEventList_1 = require(\"./NonUniformEventList\");\r\nObject.defineProperty(exports, \"NonUniformEventList\", { enumerable: true, get: function () { return NonUniformEventList_1.NonUniformEventList; } });\r\n","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.SimpleEventDispatcher = void 0;\r\nconst ste_core_1 = require(\"ste-core\");\r\n/**\r\n * The dispatcher handles the storage of subsciptions and facilitates\r\n * subscription, unsubscription and dispatching of a simple event\r\n *\r\n * @export\r\n * @class SimpleEventDispatcher\r\n * @extends {DispatcherBase<ISimpleEventHandler<TArgs>>}\r\n * @implements {ISimpleEvent<TArgs>}\r\n * @template TArgs\r\n */\r\nclass SimpleEventDispatcher extends ste_core_1.DispatcherBase {\r\n    /**\r\n     * Creates an instance of SimpleEventDispatcher.\r\n     *\r\n     * @memberOf SimpleEventDispatcher\r\n     */\r\n    constructor() {\r\n        super();\r\n    }\r\n    /**\r\n     * Dispatches the event.\r\n     *\r\n     * @param {TArgs} args The arguments object.\r\n     * @returns {IPropagationStatus} The status of the event.\r\n     *\r\n     * @memberOf SimpleEventDispatcher\r\n     */\r\n    dispatch(args) {\r\n        const result = this._dispatch(false, this, arguments);\r\n        if (result == null) {\r\n            throw new ste_core_1.DispatchError(\"Got `null` back from dispatch.\");\r\n        }\r\n        return result;\r\n    }\r\n    /**\r\n     * Dispatches the event without waiting for the result.\r\n     *\r\n     * @param {TArgs} args The arguments object.\r\n     *\r\n     * @memberOf SimpleEventDispatcher\r\n     */\r\n    dispatchAsync(args) {\r\n        this._dispatch(true, this, arguments);\r\n    }\r\n    /**\r\n     * Creates an event from the dispatcher. Will return the dispatcher\r\n     * in a wrapper. This will prevent exposure of any dispatcher methods.\r\n     *\r\n     * @returns {ISimpleEvent<TArgs>} The event.\r\n     *\r\n     * @memberOf SimpleEventDispatcher\r\n     */\r\n    asEvent() {\r\n        return super.asEvent();\r\n    }\r\n}\r\nexports.SimpleEventDispatcher = SimpleEventDispatcher;\r\n","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.SimpleEventList = void 0;\r\nconst ste_core_1 = require(\"ste-core\");\r\nconst SimpleEventDispatcher_1 = require(\"./SimpleEventDispatcher\");\r\n/**\r\n * Storage class for multiple simple events that are accessible by name.\r\n * Events dispatchers are automatically created.\r\n */\r\nclass SimpleEventList extends ste_core_1.EventListBase {\r\n    /**\r\n     * Creates a new SimpleEventList instance.\r\n     */\r\n    constructor() {\r\n        super();\r\n    }\r\n    /**\r\n     * Creates a new dispatcher instance.\r\n     */\r\n    createDispatcher() {\r\n        return new SimpleEventDispatcher_1.SimpleEventDispatcher();\r\n    }\r\n}\r\nexports.SimpleEventList = SimpleEventList;\r\n","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.SimpleEventHandlingBase = void 0;\r\nconst ste_core_1 = require(\"ste-core\");\r\nconst SimpleEventList_1 = require(\"./SimpleEventList\");\r\n/**\r\n * Extends objects with signal event handling capabilities.\r\n */\r\nclass SimpleEventHandlingBase extends ste_core_1.HandlingBase {\r\n    constructor() {\r\n        super(new SimpleEventList_1.SimpleEventList());\r\n    }\r\n}\r\nexports.SimpleEventHandlingBase = SimpleEventHandlingBase;\r\n","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.NonUniformSimpleEventList = void 0;\r\nconst SimpleEventDispatcher_1 = require(\"./SimpleEventDispatcher\");\r\n/**\r\n * Similar to EventList, but instead of TArgs, a map of event names ang argument types is provided with TArgsMap.\r\n */\r\nclass NonUniformSimpleEventList {\r\n    constructor() {\r\n        this._events = {};\r\n    }\r\n    /**\r\n     * Gets the dispatcher associated with the name.\r\n     * @param name The name of the event.\r\n     */\r\n    get(name) {\r\n        if (this._events[name]) {\r\n            // @TODO avoid typecasting. Not sure why TS thinks this._events[name] could still be undefined.\r\n            return this._events[name];\r\n        }\r\n        const event = this.createDispatcher();\r\n        this._events[name] = event;\r\n        return event;\r\n    }\r\n    /**\r\n     * Removes the dispatcher associated with the name.\r\n     * @param name The name of the event.\r\n     */\r\n    remove(name) {\r\n        delete this._events[name];\r\n    }\r\n    /**\r\n     * Creates a new dispatcher instance.\r\n     */\r\n    createDispatcher() {\r\n        return new SimpleEventDispatcher_1.SimpleEventDispatcher();\r\n    }\r\n}\r\nexports.NonUniformSimpleEventList = NonUniformSimpleEventList;\r\n","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.NonUniformSimpleEventList = exports.SimpleEventList = exports.SimpleEventHandlingBase = exports.SimpleEventDispatcher = void 0;\r\nconst SimpleEventDispatcher_1 = require(\"./SimpleEventDispatcher\");\r\nObject.defineProperty(exports, \"SimpleEventDispatcher\", { enumerable: true, get: function () { return SimpleEventDispatcher_1.SimpleEventDispatcher; } });\r\nconst SimpleEventHandlingBase_1 = require(\"./SimpleEventHandlingBase\");\r\nObject.defineProperty(exports, \"SimpleEventHandlingBase\", { enumerable: true, get: function () { return SimpleEventHandlingBase_1.SimpleEventHandlingBase; } });\r\nconst NonUniformSimpleEventList_1 = require(\"./NonUniformSimpleEventList\");\r\nObject.defineProperty(exports, \"NonUniformSimpleEventList\", { enumerable: true, get: function () { return NonUniformSimpleEventList_1.NonUniformSimpleEventList; } });\r\nconst SimpleEventList_1 = require(\"./SimpleEventList\");\r\nObject.defineProperty(exports, \"SimpleEventList\", { enumerable: true, get: function () { return SimpleEventList_1.SimpleEventList; } });\r\n","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.SignalDispatcher = void 0;\r\nconst ste_core_1 = require(\"ste-core\");\r\n/**\r\n * The dispatcher handles the storage of subsciptions and facilitates\r\n * subscription, unsubscription and dispatching of a signal event.\r\n *\r\n * @export\r\n * @class SignalDispatcher\r\n * @extends {DispatcherBase<ISignalHandler>}\r\n * @implements {ISignal}\r\n */\r\nclass SignalDispatcher extends ste_core_1.DispatcherBase {\r\n    /**\r\n     * Dispatches the signal.\r\n     *\r\n     * @returns {IPropagationStatus} The status of the signal.\r\n     *\r\n     * @memberOf SignalDispatcher\r\n     */\r\n    dispatch() {\r\n        const result = this._dispatch(false, this, arguments);\r\n        if (result == null) {\r\n            throw new ste_core_1.DispatchError(\"Got `null` back from dispatch.\");\r\n        }\r\n        return result;\r\n    }\r\n    /**\r\n     * Dispatches the signal without waiting for the result.\r\n     *\r\n     * @memberOf SignalDispatcher\r\n     */\r\n    dispatchAsync() {\r\n        this._dispatch(true, this, arguments);\r\n    }\r\n    /**\r\n     * Creates an event from the dispatcher. Will return the dispatcher\r\n     * in a wrapper. This will prevent exposure of any dispatcher methods.\r\n     *\r\n     * @returns {ISignal} The signal.\r\n     *\r\n     * @memberOf SignalDispatcher\r\n     */\r\n    asEvent() {\r\n        return super.asEvent();\r\n    }\r\n}\r\nexports.SignalDispatcher = SignalDispatcher;\r\n","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.SignalList = void 0;\r\nconst ste_core_1 = require(\"ste-core\");\r\nconst SignalDispatcher_1 = require(\"./SignalDispatcher\");\r\n/**\r\n * Storage class for multiple signal events that are accessible by name.\r\n * Events dispatchers are automatically created.\r\n *\r\n * @export\r\n * @class SignalList\r\n * @extends {EventListBase<SignalDispatcher>}\r\n */\r\nclass SignalList extends ste_core_1.EventListBase {\r\n    /**\r\n     * Creates an instance of SignalList.\r\n     *\r\n     * @memberOf SignalList\r\n     */\r\n    constructor() {\r\n        super();\r\n    }\r\n    /**\r\n     * Creates a new dispatcher instance.\r\n     *\r\n     * @protected\r\n     * @returns {SignalDispatcher}\r\n     *\r\n     * @memberOf SignalList\r\n     */\r\n    createDispatcher() {\r\n        return new SignalDispatcher_1.SignalDispatcher();\r\n    }\r\n}\r\nexports.SignalList = SignalList;\r\n","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.SignalHandlingBase = void 0;\r\nconst ste_core_1 = require(\"ste-core\");\r\nconst SignalList_1 = require(\"./SignalList\");\r\n/**\r\n * Extends objects with signal event handling capabilities.\r\n *\r\n * @export\r\n * @abstract\r\n * @class SignalHandlingBase\r\n * @extends {HandlingBase<ISignalHandler, SignalDispatcher, SignalList>}\r\n * @implements {ISignalHandling}\r\n */\r\nclass SignalHandlingBase extends ste_core_1.HandlingBase {\r\n    /**\r\n     * Creates an instance of SignalHandlingBase.\r\n     *\r\n     * @memberOf SignalHandlingBase\r\n     */\r\n    constructor() {\r\n        super(new SignalList_1.SignalList());\r\n    }\r\n}\r\nexports.SignalHandlingBase = SignalHandlingBase;\r\n","\"use strict\";\r\n/*!\r\n * Strongly Typed Events for TypeScript - Promise Signals\r\n * https://github.com/KeesCBakker/StronlyTypedEvents/\r\n * http://keestalkstech.com\r\n *\r\n * Copyright Kees C. Bakker / KeesTalksTech\r\n * Released under the MIT license\r\n */\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.SignalList = exports.SignalHandlingBase = exports.SignalDispatcher = void 0;\r\nconst SignalDispatcher_1 = require(\"./SignalDispatcher\");\r\nObject.defineProperty(exports, \"SignalDispatcher\", { enumerable: true, get: function () { return SignalDispatcher_1.SignalDispatcher; } });\r\nconst SignalHandlingBase_1 = require(\"./SignalHandlingBase\");\r\nObject.defineProperty(exports, \"SignalHandlingBase\", { enumerable: true, get: function () { return SignalHandlingBase_1.SignalHandlingBase; } });\r\nconst SignalList_1 = require(\"./SignalList\");\r\nObject.defineProperty(exports, \"SignalList\", { enumerable: true, get: function () { return SignalList_1.SignalList; } });\r\n","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.PromiseEventDispatcher = void 0;\r\nconst ste_core_1 = require(\"ste-core\");\r\n/**\r\n * Dispatcher implementation for events. Can be used to subscribe, unsubscribe\r\n * or dispatch events. Use the ToEvent() method to expose the event.\r\n *\r\n * @export\r\n * @class PromiseEventDispatcher\r\n * @extends {PromiseDispatcherBase<IPromiseEventHandler<TSender, TArgs>>}\r\n * @implements {IPromiseEvent<TSender, TArgs>}\r\n * @template TSender\r\n * @template TArgs\r\n */\r\nclass PromiseEventDispatcher extends ste_core_1.PromiseDispatcherBase {\r\n    /**\r\n     * Creates a new EventDispatcher instance.\r\n     */\r\n    constructor() {\r\n        super();\r\n    }\r\n    /**\r\n     * Dispatches the event.\r\n     *\r\n     * @param {TSender} sender The sender object.\r\n     * @param {TArgs} args The argument object.\r\n     * @returns {Promise<IPropagationStatus>} The status.\r\n     *\r\n     * @memberOf PromiseEventDispatcher\r\n     */\r\n    async dispatch(sender, args) {\r\n        const result = await this._dispatchAsPromise(false, this, arguments);\r\n        if (result == null) {\r\n            throw new ste_core_1.DispatchError(\"Got `null` back from dispatch.\");\r\n        }\r\n        return result;\r\n    }\r\n    /**\r\n     * Dispatches the event without waiting for the result.\r\n     *\r\n     * @param {TSender} sender The sender object.\r\n     * @param {TArgs} args The argument object.\r\n     *\r\n     * @memberOf PromiseEventDispatcher\r\n     */\r\n    dispatchAsync(sender, args) {\r\n        this._dispatchAsPromise(true, this, arguments);\r\n    }\r\n    /**\r\n     * Creates an event from the dispatcher. Will return the dispatcher\r\n     * in a wrapper. This will prevent exposure of any dispatcher methods.\r\n     */\r\n    asEvent() {\r\n        return super.asEvent();\r\n    }\r\n}\r\nexports.PromiseEventDispatcher = PromiseEventDispatcher;\r\n","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.PromiseEventList = void 0;\r\nconst ste_core_1 = require(\"ste-core\");\r\nconst PromiseEventDispatcher_1 = require(\"./PromiseEventDispatcher\");\r\n/**\r\n * Storage class for multiple events that are accessible by name.\r\n * Events dispatchers are automatically created.\r\n */\r\nclass PromiseEventList extends ste_core_1.EventListBase {\r\n    /**\r\n     * Creates a new EventList instance.\r\n     */\r\n    constructor() {\r\n        super();\r\n    }\r\n    /**\r\n     * Creates a new dispatcher instance.\r\n     */\r\n    createDispatcher() {\r\n        return new PromiseEventDispatcher_1.PromiseEventDispatcher();\r\n    }\r\n}\r\nexports.PromiseEventList = PromiseEventList;\r\n","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.PromiseEventHandlingBase = void 0;\r\nconst ste_core_1 = require(\"ste-core\");\r\nconst PromiseEventList_1 = require(\"./PromiseEventList\");\r\n/**\r\n * Extends objects with signal event handling capabilities.\r\n */\r\nclass PromiseEventHandlingBase extends ste_core_1.HandlingBase {\r\n    constructor() {\r\n        super(new PromiseEventList_1.PromiseEventList());\r\n    }\r\n}\r\nexports.PromiseEventHandlingBase = PromiseEventHandlingBase;\r\n","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.NonUniformPromiseEventList = void 0;\r\nconst PromiseEventDispatcher_1 = require(\"./PromiseEventDispatcher\");\r\n/**\r\n * Similar to EventList, but instead of TArgs, a map of event names ang argument types is provided with TArgsMap.\r\n */\r\nclass NonUniformPromiseEventList {\r\n    constructor() {\r\n        this._events = {};\r\n    }\r\n    /**\r\n     * Gets the dispatcher associated with the name.\r\n     * @param name The name of the event.\r\n     */\r\n    get(name) {\r\n        if (this._events[name]) {\r\n            // @TODO avoid typecasting. Not sure why TS thinks this._events[name] could still be undefined.\r\n            return this._events[name];\r\n        }\r\n        const event = this.createDispatcher();\r\n        this._events[name] = event;\r\n        return event;\r\n    }\r\n    /**\r\n     * Removes the dispatcher associated with the name.\r\n     * @param name The name of the event.\r\n     */\r\n    remove(name) {\r\n        delete this._events[name];\r\n    }\r\n    /**\r\n     * Creates a new dispatcher instance.\r\n     */\r\n    createDispatcher() {\r\n        return new PromiseEventDispatcher_1.PromiseEventDispatcher();\r\n    }\r\n}\r\nexports.NonUniformPromiseEventList = NonUniformPromiseEventList;\r\n","\"use strict\";\r\n/*!\r\n * Strongly Typed Events for TypeScript - Core\r\n * https://github.com/KeesCBakker/StronlyTypedEvents/\r\n * http://keestalkstech.com\r\n *\r\n * Copyright Kees C. Bakker / KeesTalksTech\r\n * Released under the MIT license\r\n */\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.NonUniformPromiseEventList = exports.PromiseEventList = exports.PromiseEventHandlingBase = exports.PromiseEventDispatcher = void 0;\r\nconst PromiseEventDispatcher_1 = require(\"./PromiseEventDispatcher\");\r\nObject.defineProperty(exports, \"PromiseEventDispatcher\", { enumerable: true, get: function () { return PromiseEventDispatcher_1.PromiseEventDispatcher; } });\r\nconst PromiseEventHandlingBase_1 = require(\"./PromiseEventHandlingBase\");\r\nObject.defineProperty(exports, \"PromiseEventHandlingBase\", { enumerable: true, get: function () { return PromiseEventHandlingBase_1.PromiseEventHandlingBase; } });\r\nconst PromiseEventList_1 = require(\"./PromiseEventList\");\r\nObject.defineProperty(exports, \"PromiseEventList\", { enumerable: true, get: function () { return PromiseEventList_1.PromiseEventList; } });\r\nconst NonUniformPromiseEventList_1 = require(\"./NonUniformPromiseEventList\");\r\nObject.defineProperty(exports, \"NonUniformPromiseEventList\", { enumerable: true, get: function () { return NonUniformPromiseEventList_1.NonUniformPromiseEventList; } });\r\n","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.PromiseSignalDispatcher = void 0;\r\nconst ste_core_1 = require(\"ste-core\");\r\n/**\r\n * The dispatcher handles the storage of subsciptions and facilitates\r\n * subscription, unsubscription and dispatching of a signal event.\r\n */\r\nclass PromiseSignalDispatcher extends ste_core_1.PromiseDispatcherBase {\r\n    /**\r\n     * Creates a new SignalDispatcher instance.\r\n     */\r\n    constructor() {\r\n        super();\r\n    }\r\n    /**\r\n     * Dispatches the signal.\r\n     *\r\n     * @returns {IPropagationStatus} The status of the dispatch.\r\n     *\r\n     * @memberOf SignalDispatcher\r\n     */\r\n    async dispatch() {\r\n        const result = await this._dispatchAsPromise(false, this, arguments);\r\n        if (result == null) {\r\n            throw new ste_core_1.DispatchError(\"Got `null` back from dispatch.\");\r\n        }\r\n        return result;\r\n    }\r\n    /**\r\n     * Dispatches the signal threaded.\r\n     */\r\n    dispatchAsync() {\r\n        this._dispatchAsPromise(true, this, arguments);\r\n    }\r\n    /**\r\n     * Creates an event from the dispatcher. Will return the dispatcher\r\n     * in a wrapper. This will prevent exposure of any dispatcher methods.\r\n     */\r\n    asEvent() {\r\n        return super.asEvent();\r\n    }\r\n}\r\nexports.PromiseSignalDispatcher = PromiseSignalDispatcher;\r\n","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.PromiseSignalList = void 0;\r\nconst ste_core_1 = require(\"ste-core\");\r\nconst PromiseSignalDispatcher_1 = require(\"./PromiseSignalDispatcher\");\r\n/**\r\n * Storage class for multiple signal events that are accessible by name.\r\n * Events dispatchers are automatically created.\r\n */\r\nclass PromiseSignalList extends ste_core_1.EventListBase {\r\n    /**\r\n     * Creates a new SignalList instance.\r\n     */\r\n    constructor() {\r\n        super();\r\n    }\r\n    /**\r\n     * Creates a new dispatcher instance.\r\n     */\r\n    createDispatcher() {\r\n        return new PromiseSignalDispatcher_1.PromiseSignalDispatcher();\r\n    }\r\n}\r\nexports.PromiseSignalList = PromiseSignalList;\r\n","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.PromiseSignalHandlingBase = void 0;\r\nconst ste_core_1 = require(\"ste-core\");\r\nconst PromiseSignalList_1 = require(\"./PromiseSignalList\");\r\n/**\r\n * Extends objects with signal event handling capabilities.\r\n */\r\nclass PromiseSignalHandlingBase extends ste_core_1.HandlingBase {\r\n    constructor() {\r\n        super(new PromiseSignalList_1.PromiseSignalList());\r\n    }\r\n}\r\nexports.PromiseSignalHandlingBase = PromiseSignalHandlingBase;\r\n","\"use strict\";\r\n/*!\r\n * Strongly Typed Events for TypeScript - Promise Signals\r\n * https://github.com/KeesCBakker/StronlyTypedEvents/\r\n * http://keestalkstech.com\r\n *\r\n * Copyright Kees C. Bakker / KeesTalksTech\r\n * Released under the MIT license\r\n */\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.PromiseSignalList = exports.PromiseSignalHandlingBase = exports.PromiseSignalDispatcher = void 0;\r\nconst PromiseSignalDispatcher_1 = require(\"./PromiseSignalDispatcher\");\r\nObject.defineProperty(exports, \"PromiseSignalDispatcher\", { enumerable: true, get: function () { return PromiseSignalDispatcher_1.PromiseSignalDispatcher; } });\r\nconst PromiseSignalHandlingBase_1 = require(\"./PromiseSignalHandlingBase\");\r\nObject.defineProperty(exports, \"PromiseSignalHandlingBase\", { enumerable: true, get: function () { return PromiseSignalHandlingBase_1.PromiseSignalHandlingBase; } });\r\nconst PromiseSignalList_1 = require(\"./PromiseSignalList\");\r\nObject.defineProperty(exports, \"PromiseSignalList\", { enumerable: true, get: function () { return PromiseSignalList_1.PromiseSignalList; } });\r\n","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.PromiseSimpleEventDispatcher = void 0;\r\nconst ste_core_1 = require(\"ste-core\");\r\n/**\r\n * The dispatcher handles the storage of subsciptions and facilitates\r\n * subscription, unsubscription and dispatching of a simple event\r\n *\r\n * @export\r\n * @class PromiseSimpleEventDispatcher\r\n * @extends {PromiseDispatcherBase<IPromiseSimpleEventHandler<TArgs>>}\r\n * @implements {IPromiseSimpleEvent<TArgs>}\r\n * @template TArgs\r\n */\r\nclass PromiseSimpleEventDispatcher extends ste_core_1.PromiseDispatcherBase {\r\n    /**\r\n     * Creates a new SimpleEventDispatcher instance.\r\n     */\r\n    constructor() {\r\n        super();\r\n    }\r\n    /**\r\n     * Dispatches the event.\r\n     * @param args The arguments object.\r\n     * @returns {IPropagationStatus} The status of the dispatch.\r\n     * @memberOf PromiseSimpleEventDispatcher\r\n     */\r\n    async dispatch(args) {\r\n        const result = await this._dispatchAsPromise(false, this, arguments);\r\n        if (result == null) {\r\n            throw new ste_core_1.DispatchError(\"Got `null` back from dispatch.\");\r\n        }\r\n        return result;\r\n    }\r\n    /**\r\n     * Dispatches the event without waiting for it to complete.\r\n     * @param args The argument object.\r\n     * @memberOf PromiseSimpleEventDispatcher\r\n     */\r\n    dispatchAsync(args) {\r\n        this._dispatchAsPromise(true, this, arguments);\r\n    }\r\n    /**\r\n     * Creates an event from the dispatcher. Will return the dispatcher\r\n     * in a wrapper. This will prevent exposure of any dispatcher methods.\r\n     */\r\n    asEvent() {\r\n        return super.asEvent();\r\n    }\r\n}\r\nexports.PromiseSimpleEventDispatcher = PromiseSimpleEventDispatcher;\r\n","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.NonUniformPromiseSimpleEventList = void 0;\r\nconst PromiseSimpleEventDispatcher_1 = require(\"./PromiseSimpleEventDispatcher\");\r\n/**\r\n * Similar to EventList, but instead of TArgs, a map of event names ang argument types is provided with TArgsMap.\r\n */\r\nclass NonUniformPromiseSimpleEventList {\r\n    constructor() {\r\n        this._events = {};\r\n    }\r\n    /**\r\n     * Gets the dispatcher associated with the name.\r\n     * @param name The name of the event.\r\n     */\r\n    get(name) {\r\n        if (this._events[name]) {\r\n            // @TODO avoid typecasting. Not sure why TS thinks this._events[name] could still be undefined.\r\n            return this._events[name];\r\n        }\r\n        const event = this.createDispatcher();\r\n        this._events[name] = event;\r\n        return event;\r\n    }\r\n    /**\r\n     * Removes the dispatcher associated with the name.\r\n     * @param name The name of the event.\r\n     */\r\n    remove(name) {\r\n        delete this._events[name];\r\n    }\r\n    /**\r\n     * Creates a new dispatcher instance.\r\n     */\r\n    createDispatcher() {\r\n        return new PromiseSimpleEventDispatcher_1.PromiseSimpleEventDispatcher();\r\n    }\r\n}\r\nexports.NonUniformPromiseSimpleEventList = NonUniformPromiseSimpleEventList;\r\n","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.PromiseSimpleEventList = void 0;\r\nconst ste_core_1 = require(\"ste-core\");\r\nconst PromiseSimpleEventDispatcher_1 = require(\"./PromiseSimpleEventDispatcher\");\r\n/**\r\n * Storage class for multiple simple events that are accessible by name.\r\n * Events dispatchers are automatically created.\r\n */\r\nclass PromiseSimpleEventList extends ste_core_1.EventListBase {\r\n    /**\r\n     * Creates a new SimpleEventList instance.\r\n     */\r\n    constructor() {\r\n        super();\r\n    }\r\n    /**\r\n     * Creates a new dispatcher instance.\r\n     */\r\n    createDispatcher() {\r\n        return new PromiseSimpleEventDispatcher_1.PromiseSimpleEventDispatcher();\r\n    }\r\n}\r\nexports.PromiseSimpleEventList = PromiseSimpleEventList;\r\n","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.PromiseSimpleEventHandlingBase = void 0;\r\nconst ste_core_1 = require(\"ste-core\");\r\nconst PromiseSimpleEventList_1 = require(\"./PromiseSimpleEventList\");\r\n/**\r\n * Extends objects with signal event handling capabilities.\r\n */\r\nclass PromiseSimpleEventHandlingBase extends ste_core_1.HandlingBase {\r\n    constructor() {\r\n        super(new PromiseSimpleEventList_1.PromiseSimpleEventList());\r\n    }\r\n}\r\nexports.PromiseSimpleEventHandlingBase = PromiseSimpleEventHandlingBase;\r\n","\"use strict\";\r\n/*!\r\n * Strongly Typed Events for TypeScript - Core\r\n * https://github.com/KeesCBakker/StronlyTypedEvents/\r\n * http://keestalkstech.com\r\n *\r\n * Copyright Kees C. Bakker / KeesTalksTech\r\n * Released under the MIT license\r\n */\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.NonUniformPromiseSimpleEventList = exports.PromiseSimpleEventList = exports.PromiseSimpleEventHandlingBase = exports.PromiseSimpleEventDispatcher = void 0;\r\nconst NonUniformPromiseSimpleEventList_1 = require(\"./NonUniformPromiseSimpleEventList\");\r\nObject.defineProperty(exports, \"NonUniformPromiseSimpleEventList\", { enumerable: true, get: function () { return NonUniformPromiseSimpleEventList_1.NonUniformPromiseSimpleEventList; } });\r\nconst PromiseSimpleEventDispatcher_1 = require(\"./PromiseSimpleEventDispatcher\");\r\nObject.defineProperty(exports, \"PromiseSimpleEventDispatcher\", { enumerable: true, get: function () { return PromiseSimpleEventDispatcher_1.PromiseSimpleEventDispatcher; } });\r\nconst PromiseSimpleEventHandlingBase_1 = require(\"./PromiseSimpleEventHandlingBase\");\r\nObject.defineProperty(exports, \"PromiseSimpleEventHandlingBase\", { enumerable: true, get: function () { return PromiseSimpleEventHandlingBase_1.PromiseSimpleEventHandlingBase; } });\r\nconst PromiseSimpleEventList_1 = require(\"./PromiseSimpleEventList\");\r\nObject.defineProperty(exports, \"PromiseSimpleEventList\", { enumerable: true, get: function () { return PromiseSimpleEventList_1.PromiseSimpleEventList; } });\r\n","\"use strict\";\r\n/*!\r\n * Strongly Typed Events for TypeScript\r\n * https://github.com/KeesCBakker/StronlyTypedEvents/\r\n * http://keestalkstech.com\r\n *\r\n * Copyright Kees C. Bakker / KeesTalksTech\r\n * Released under the MIT license\r\n */\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.NonUniformPromiseSimpleEventList = exports.PromiseSimpleEventList = exports.PromiseSimpleEventHandlingBase = exports.PromiseSimpleEventDispatcher = exports.PromiseSignalList = exports.PromiseSignalHandlingBase = exports.PromiseSignalDispatcher = exports.NonUniformPromiseEventList = exports.PromiseEventList = exports.PromiseEventHandlingBase = exports.PromiseEventDispatcher = exports.SignalList = exports.SignalHandlingBase = exports.SignalDispatcher = exports.NonUniformSimpleEventList = exports.SimpleEventList = exports.SimpleEventHandlingBase = exports.SimpleEventDispatcher = exports.NonUniformEventList = exports.EventList = exports.EventHandlingBase = exports.EventDispatcher = exports.HandlingBase = exports.PromiseDispatcherBase = exports.PromiseSubscription = exports.DispatchError = exports.EventManagement = exports.EventListBase = exports.DispatcherWrapper = exports.DispatcherBase = exports.Subscription = void 0;\r\nvar ste_core_1 = require(\"ste-core\");\r\nObject.defineProperty(exports, \"Subscription\", { enumerable: true, get: function () { return ste_core_1.Subscription; } });\r\nObject.defineProperty(exports, \"DispatcherBase\", { enumerable: true, get: function () { return ste_core_1.DispatcherBase; } });\r\nObject.defineProperty(exports, \"DispatcherWrapper\", { enumerable: true, get: function () { return ste_core_1.DispatcherWrapper; } });\r\nObject.defineProperty(exports, \"EventListBase\", { enumerable: true, get: function () { return ste_core_1.EventListBase; } });\r\nObject.defineProperty(exports, \"EventManagement\", { enumerable: true, get: function () { return ste_core_1.EventManagement; } });\r\nObject.defineProperty(exports, \"DispatchError\", { enumerable: true, get: function () { return ste_core_1.DispatchError; } });\r\nObject.defineProperty(exports, \"PromiseSubscription\", { enumerable: true, get: function () { return ste_core_1.PromiseSubscription; } });\r\nObject.defineProperty(exports, \"PromiseDispatcherBase\", { enumerable: true, get: function () { return ste_core_1.PromiseDispatcherBase; } });\r\nObject.defineProperty(exports, \"HandlingBase\", { enumerable: true, get: function () { return ste_core_1.HandlingBase; } });\r\nvar ste_events_1 = require(\"ste-events\");\r\nObject.defineProperty(exports, \"EventDispatcher\", { enumerable: true, get: function () { return ste_events_1.EventDispatcher; } });\r\nObject.defineProperty(exports, \"EventHandlingBase\", { enumerable: true, get: function () { return ste_events_1.EventHandlingBase; } });\r\nObject.defineProperty(exports, \"EventList\", { enumerable: true, get: function () { return ste_events_1.EventList; } });\r\nObject.defineProperty(exports, \"NonUniformEventList\", { enumerable: true, get: function () { return ste_events_1.NonUniformEventList; } });\r\nvar ste_simple_events_1 = require(\"ste-simple-events\");\r\nObject.defineProperty(exports, \"SimpleEventDispatcher\", { enumerable: true, get: function () { return ste_simple_events_1.SimpleEventDispatcher; } });\r\nObject.defineProperty(exports, \"SimpleEventHandlingBase\", { enumerable: true, get: function () { return ste_simple_events_1.SimpleEventHandlingBase; } });\r\nObject.defineProperty(exports, \"SimpleEventList\", { enumerable: true, get: function () { return ste_simple_events_1.SimpleEventList; } });\r\nObject.defineProperty(exports, \"NonUniformSimpleEventList\", { enumerable: true, get: function () { return ste_simple_events_1.NonUniformSimpleEventList; } });\r\nvar ste_signals_1 = require(\"ste-signals\");\r\nObject.defineProperty(exports, \"SignalDispatcher\", { enumerable: true, get: function () { return ste_signals_1.SignalDispatcher; } });\r\nObject.defineProperty(exports, \"SignalHandlingBase\", { enumerable: true, get: function () { return ste_signals_1.SignalHandlingBase; } });\r\nObject.defineProperty(exports, \"SignalList\", { enumerable: true, get: function () { return ste_signals_1.SignalList; } });\r\nvar ste_promise_events_1 = require(\"ste-promise-events\");\r\nObject.defineProperty(exports, \"PromiseEventDispatcher\", { enumerable: true, get: function () { return ste_promise_events_1.PromiseEventDispatcher; } });\r\nObject.defineProperty(exports, \"PromiseEventHandlingBase\", { enumerable: true, get: function () { return ste_promise_events_1.PromiseEventHandlingBase; } });\r\nObject.defineProperty(exports, \"PromiseEventList\", { enumerable: true, get: function () { return ste_promise_events_1.PromiseEventList; } });\r\nObject.defineProperty(exports, \"NonUniformPromiseEventList\", { enumerable: true, get: function () { return ste_promise_events_1.NonUniformPromiseEventList; } });\r\nvar ste_promise_signals_1 = require(\"ste-promise-signals\");\r\nObject.defineProperty(exports, \"PromiseSignalDispatcher\", { enumerable: true, get: function () { return ste_promise_signals_1.PromiseSignalDispatcher; } });\r\nObject.defineProperty(exports, \"PromiseSignalHandlingBase\", { enumerable: true, get: function () { return ste_promise_signals_1.PromiseSignalHandlingBase; } });\r\nObject.defineProperty(exports, \"PromiseSignalList\", { enumerable: true, get: function () { return ste_promise_signals_1.PromiseSignalList; } });\r\nvar ste_promise_simple_events_1 = require(\"ste-promise-simple-events\");\r\nObject.defineProperty(exports, \"PromiseSimpleEventDispatcher\", { enumerable: true, get: function () { return ste_promise_simple_events_1.PromiseSimpleEventDispatcher; } });\r\nObject.defineProperty(exports, \"PromiseSimpleEventHandlingBase\", { enumerable: true, get: function () { return ste_promise_simple_events_1.PromiseSimpleEventHandlingBase; } });\r\nObject.defineProperty(exports, \"PromiseSimpleEventList\", { enumerable: true, get: function () { return ste_promise_simple_events_1.PromiseSimpleEventList; } });\r\nObject.defineProperty(exports, \"NonUniformPromiseSimpleEventList\", { enumerable: true, get: function () { return ste_promise_simple_events_1.NonUniformPromiseSimpleEventList; } });\r\n","import{SDKError as e,EventEmitter as t,Component as r}from\"@xeokit/core\";import{newFloatArray as n,MAX_DOUBLE as o,MIN_DOUBLE as i,DEGTORAD as s}from\"@xeokit/math\";import{EventDispatcher as a}from\"strongly-typed-events\";import{createVec3 as c,createMat4 as u,subVec3 as l,lenVec3 as d,transformPositions3 as f,createVec4 as h,identityMat4 as p,dotVec3 as g,cross3Vec3 as m,normalizeVec3 as y}from\"@xeokit/matrix\";import{decompressPoint3 as v,decompressPositions3 as w,quantizePositions3 as b}from\"@xeokit/compression\";function x(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,\"value\"in n&&(n.writable=!0),Object.defineProperty(e,\"symbol\"==typeof(o=function(e,t){if(\"object\"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,\"string\");if(\"object\"!=typeof n)return n;throw new TypeError(\"@@toPrimitive must return a primitive value.\")}return String(e)}(n.key))?o:String(o),n)}var o}function S(e,t,r){return t&&x(e.prototype,t),r&&x(e,r),Object.defineProperty(e,\"prototype\",{writable:!1}),e}function T(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,M(e,t)}function M(e,t){return M=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},M(e,t)}function k(e){if(void 0===e)throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");return e}var _=0;function j(e){return\"__private_\"+_+++\"_\"+e}function A(e,t){if(!Object.prototype.hasOwnProperty.call(e,t))throw new TypeError(\"attempted to use private field on non-instance\");return e}function B(e,t){if(!e)throw new Error(t||\"loader assertion failed.\")}const I=Boolean(\"object\"!=typeof process||\"[object process]\"!==String(process)||process.browser);function E(e,t){if(!e)throw new Error(t||\"loaders.gl assertion failed.\")}\"undefined\"!=typeof process&&process.version&&/v([0-9]*)/.exec(process.version);const C={self:\"undefined\"!=typeof self&&self,window:\"undefined\"!=typeof window&&window,global:\"undefined\"!=typeof global&&global,document:\"undefined\"!=typeof document&&document},P=C.global||C.self||C.window||{},L=\"object\"!=typeof process||\"[object process]\"!==String(process)||process.browser,O=\"function\"==typeof importScripts,F=\"undefined\"!=typeof window&&void 0!==window.orientation;function U(e){return U=\"function\"==typeof Symbol&&\"symbol\"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&\"function\"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?\"symbol\":typeof e},U(e)}function R(e,t,r){return(t=function(e){var t=function(e,t){if(\"object\"!==U(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,\"string\");if(\"object\"!==U(n))return n;throw new TypeError(\"@@toPrimitive must return a primitive value.\")}return String(e)}(e);return\"symbol\"===U(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}\"undefined\"!=typeof process&&process.version&&/v([0-9]*)/.exec(process.version);class D{constructor(e,t){R(this,\"name\",void 0),R(this,\"workerThread\",void 0),R(this,\"isRunning\",!0),R(this,\"result\",void 0),R(this,\"_resolve\",()=>{}),R(this,\"_reject\",()=>{}),this.name=e,this.workerThread=t,this.result=new Promise((e,t)=>{this._resolve=e,this._reject=t})}postMessage(e,t){this.workerThread.postMessage({source:\"loaders.gl\",type:e,payload:t})}done(e){E(this.isRunning),this.isRunning=!1,this._resolve(e)}error(e){E(this.isRunning),this.isRunning=!1,this._reject(e)}}class G{terminate(){}}const W=new Map;function N(e){const t=new Blob([e],{type:\"application/javascript\"});return URL.createObjectURL(t)}function H(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=arguments.length>2?arguments[2]:void 0;const n=r||new Set;if(e)if(V(e))n.add(e);else if(V(e.buffer))n.add(e.buffer);else if(ArrayBuffer.isView(e));else if(t&&\"object\"==typeof e)for(const r in e)H(e[r],t,n);return void 0===r?Array.from(n):[]}function V(e){return!!e&&(e instanceof ArrayBuffer||\"undefined\"!=typeof MessagePort&&e instanceof MessagePort||\"undefined\"!=typeof ImageBitmap&&e instanceof ImageBitmap||\"undefined\"!=typeof OffscreenCanvas&&e instanceof OffscreenCanvas)}function Q(e){if(null===e)return{};const t=Object.assign({},e);return Object.keys(t).forEach(r=>{t[r]=\"object\"!=typeof e[r]||ArrayBuffer.isView(e[r])||e[r]instanceof Array?\"function\"==typeof t[r]||t[r]instanceof RegExp?{}:e[r]:Q(e[r])}),t}const J=()=>{};class z{static isSupported(){return\"undefined\"!=typeof Worker&&L||void 0!==G&&!L}constructor(e){R(this,\"name\",void 0),R(this,\"source\",void 0),R(this,\"url\",void 0),R(this,\"terminated\",!1),R(this,\"worker\",void 0),R(this,\"onMessage\",void 0),R(this,\"onError\",void 0),R(this,\"_loadableURL\",\"\");const{name:t,source:r,url:n}=e;E(r||n),this.name=t,this.source=r,this.url=n,this.onMessage=J,this.onError=e=>console.log(e),this.worker=L?this._createBrowserWorker():this._createNodeWorker()}destroy(){this.onMessage=J,this.onError=J,this.worker.terminate(),this.terminated=!0}get isRunning(){return Boolean(this.onMessage)}postMessage(e,t){t=t||H(e),this.worker.postMessage(e,t)}_getErrorFromErrorEvent(e){let t=\"Failed to load \";return t+=\"worker \".concat(this.name,\" from \").concat(this.url,\". \"),e.message&&(t+=\"\".concat(e.message,\" in \")),e.lineno&&(t+=\":\".concat(e.lineno,\":\").concat(e.colno)),new Error(t)}_createBrowserWorker(){this._loadableURL=function(e){E(e.source&&!e.url||!e.source&&e.url);let t=W.get(e.source||e.url);return t||(e.url&&(t=(r=e.url).startsWith(\"http\")?N(\"try {\\n  importScripts('\".concat(r,\"');\\n} catch (error) {\\n  console.error(error);\\n  throw error;\\n}\")):r,W.set(e.url,t)),e.source&&(t=N(e.source),W.set(e.source,t))),E(t),t;var r}({source:this.source,url:this.url});const e=new Worker(this._loadableURL,{name:this.name});return e.onmessage=e=>{e.data?this.onMessage(e.data):this.onError(new Error(\"No data received\"))},e.onerror=e=>{this.onError(this._getErrorFromErrorEvent(e)),this.terminated=!0},e.onmessageerror=e=>console.error(e),e}_createNodeWorker(){let e;if(this.url){const t=this.url.includes(\":/\")||this.url.startsWith(\"/\")?this.url:\"./\".concat(this.url);e=new G(t,{eval:!1})}else{if(!this.source)throw new Error(\"no worker\");e=new G(this.source,{eval:!0})}return e.on(\"message\",e=>{this.onMessage(e)}),e.on(\"error\",e=>{this.onError(e)}),e.on(\"exit\",e=>{}),e}}class q{static isSupported(){return z.isSupported()}constructor(e){R(this,\"name\",\"unnamed\"),R(this,\"source\",void 0),R(this,\"url\",void 0),R(this,\"maxConcurrency\",1),R(this,\"maxMobileConcurrency\",1),R(this,\"onDebug\",()=>{}),R(this,\"reuseWorkers\",!0),R(this,\"props\",{}),R(this,\"jobQueue\",[]),R(this,\"idleQueue\",[]),R(this,\"count\",0),R(this,\"isDestroyed\",!1),this.source=e.source,this.url=e.url,this.setProps(e)}destroy(){this.idleQueue.forEach(e=>e.destroy()),this.isDestroyed=!0}setProps(e){this.props={...this.props,...e},void 0!==e.name&&(this.name=e.name),void 0!==e.maxConcurrency&&(this.maxConcurrency=e.maxConcurrency),void 0!==e.maxMobileConcurrency&&(this.maxMobileConcurrency=e.maxMobileConcurrency),void 0!==e.reuseWorkers&&(this.reuseWorkers=e.reuseWorkers),void 0!==e.onDebug&&(this.onDebug=e.onDebug)}async startJob(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:(e,t,r)=>e.done(r),r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:(e,t)=>e.error(t);const n=new Promise(n=>(this.jobQueue.push({name:e,onMessage:t,onError:r,onStart:n}),this));return this._startQueuedJob(),await n}async _startQueuedJob(){if(!this.jobQueue.length)return;const e=this._getAvailableWorker();if(!e)return;const t=this.jobQueue.shift();if(t){this.onDebug({message:\"Starting job\",name:t.name,workerThread:e,backlog:this.jobQueue.length});const r=new D(t.name,e);e.onMessage=e=>t.onMessage(r,e.type,e.payload),e.onError=e=>t.onError(r,e),t.onStart(r);try{await r.result}finally{this.returnWorkerToQueue(e)}}}returnWorkerToQueue(e){this.isDestroyed||!this.reuseWorkers||this.count>this._getMaxConcurrency()?(e.destroy(),this.count--):this.idleQueue.push(e),this.isDestroyed||this._startQueuedJob()}_getAvailableWorker(){if(this.idleQueue.length>0)return this.idleQueue.shift()||null;if(this.count<this._getMaxConcurrency()){this.count++;const e=\"\".concat(this.name.toLowerCase(),\" (#\").concat(this.count,\" of \").concat(this.maxConcurrency,\")\");return new z({name:e,source:this.source,url:this.url})}return null}_getMaxConcurrency(){return F?this.maxMobileConcurrency:this.maxConcurrency}}const K={maxConcurrency:3,maxMobileConcurrency:1,reuseWorkers:!0,onDebug:()=>{}};class Y{static isSupported(){return z.isSupported()}static getWorkerFarm(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Y._workerFarm=Y._workerFarm||new Y({}),Y._workerFarm.setProps(e),Y._workerFarm}constructor(e){R(this,\"props\",void 0),R(this,\"workerPools\",new Map),this.props={...K},this.setProps(e),this.workerPools=new Map}destroy(){for(const e of this.workerPools.values())e.destroy();this.workerPools=new Map}setProps(e){this.props={...this.props,...e};for(const e of this.workerPools.values())e.setProps(this._getWorkerPoolProps())}getWorkerPool(e){const{name:t,source:r,url:n}=e;let o=this.workerPools.get(t);return o||(o=new q({name:t,source:r,url:n}),o.setProps(this._getWorkerPoolProps()),this.workerPools.set(t,o)),o}_getWorkerPoolProps(){return{maxConcurrency:this.props.maxConcurrency,maxMobileConcurrency:this.props.maxMobileConcurrency,reuseWorkers:this.props.reuseWorkers,onDebug:this.props.onDebug}}}R(Y,\"_workerFarm\",void 0);const X=\"latest\",$=\"3.3.1\";function Z(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const r=t[e.id]||{},n=\"\".concat(e.id,\"-worker.js\");let o=r.workerUrl;if(o||\"compression\"!==e.id||(o=t.workerUrl),\"test\"===t._workerType&&(o=\"modules/\".concat(e.module,\"/dist/\").concat(n)),!o){let t=e.version;\"latest\"===t&&(t=X);const r=t?\"@\".concat(t):\"\";o=\"https://unpkg.com/@loaders.gl/\".concat(e.module).concat(r,\"/dist/\").concat(n)}return E(o),o}async function ee(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};const o=function(e){const t=e.version!==$?\" (worker-utils@\".concat($,\")\"):\"\";return\"\".concat(e.name,\"@\").concat(e.version).concat(t)}(e),i=Y.getWorkerFarm(r),{source:s}=r,a={name:o,source:s};s||(a.url=Z(e,r));const c=i.getWorkerPool(a),u=r.jobName||e.name,l=await c.startJob(u,te.bind(null,n)),d=Q(r);return l.postMessage(\"process\",{input:t,options:d}),(await l.result).result}async function te(e,t,r,n){switch(r){case\"done\":t.done(n);break;case\"error\":t.error(new Error(n.error));break;case\"process\":const{id:o,input:i,options:s}=n;try{if(!e.process)return void t.postMessage(\"error\",{id:o,error:\"Worker not set up to process on main thread\"});const r=await e.process(i,s);t.postMessage(\"done\",{id:o,result:r})}catch(e){const r=e instanceof Error?e.message:\"unknown error\";t.postMessage(\"error\",{id:o,error:r})}break;default:console.warn(\"process-on-worker: unknown message \".concat(r))}}var re={__proto__:null,default:{}};const ne={};async function oe(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return t&&(e=function(e,t,r){if(e.startsWith(\"http\"))return e;const n=r.modules||{};return n[e]?n[e]:L?r.CDN?(E(r.CDN.startsWith(\"http\")),\"\".concat(r.CDN,\"/\").concat(t,\"@\").concat(\"3.3.1\",\"/dist/libs/\").concat(e)):O?\"../src/libs/\".concat(e):\"modules/\".concat(t,\"/src/libs/\").concat(e):\"modules/\".concat(t,\"/dist/libs/\").concat(e)}(e,t,arguments.length>2&&void 0!==arguments[2]?arguments[2]:{})),ne[e]=ne[e]||async function(e){if(e.endsWith(\"wasm\")){const t=await fetch(e);return await t.arrayBuffer()}if(!L)try{return re&&void 0}catch{return null}if(O)return importScripts(e);const t=await fetch(e);return function(e,t){if(!L)return;if(O)return eval.call(P,e),null;const r=document.createElement(\"script\");r.id=t;try{r.appendChild(document.createTextNode(e))}catch(t){r.text=e}return document.body.appendChild(r),null}(await t.text(),e)}(e),await ne[e]}async function ie(e,t,r,n,o){const i=e.id,s=Z(e,r),a=Y.getWorkerFarm(r).getWorkerPool({name:i,url:s});r=JSON.parse(JSON.stringify(r)),n=JSON.parse(JSON.stringify(n||{}));const c=await a.startJob(\"process-on-worker\",se.bind(null,o));c.postMessage(\"process\",{input:t,options:r,context:n});const u=await c.result;return await u.result}async function se(e,t,r,n){switch(r){case\"done\":t.done(n);break;case\"error\":t.error(new Error(n.error));break;case\"process\":const{id:o,input:i,options:s}=n;try{const r=await e(i,s);t.postMessage(\"done\",{id:o,result:r})}catch(e){const r=e instanceof Error?e.message:\"unknown error\";t.postMessage(\"error\",{id:o,error:r})}break;default:console.warn(\"parse-with-worker unknown message \".concat(r))}}function ae(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];const n=t.map(e=>e instanceof ArrayBuffer?new Uint8Array(e):e),o=n.reduce((e,t)=>e+t.byteLength,0),i=new Uint8Array(o);let s=0;for(const e of n)i.set(e,s),s+=e.byteLength;return i.buffer}let ce=\"\";const ue={};function le(e){for(const t in ue)e.startsWith(t)&&(e=e.replace(t,ue[t]));return e.startsWith(\"http://\")||e.startsWith(\"https://\")||(e=\"\".concat(ce).concat(e)),e}function de(e){if((t=e)&&\"object\"==typeof t&&t.isBuffer)return(void 0)(e);var t;if(e instanceof ArrayBuffer)return e;if(ArrayBuffer.isView(e))return 0===e.byteOffset&&e.byteLength===e.buffer.byteLength?e.buffer:e.buffer.slice(e.byteOffset,e.byteOffset+e.byteLength);if(\"string\"==typeof e){const t=e;return(new TextEncoder).encode(t).buffer}if(e&&\"object\"==typeof e&&e._toArrayBuffer)return e._toArrayBuffer();throw new Error(\"toArrayBuffer\")}const fe=\"3.3.1\",he=\"https://unpkg.com/@loaders.gl/textures@\".concat(fe,\"/dist/libs/basis_encoder.wasm\"),pe=\"https://unpkg.com/@loaders.gl/textures@\".concat(fe,\"/dist/libs/basis_encoder.js\");let ge;const me={name:\"Basis Universal Supercompressed GPU Texture\",id:\"ktx2-basis-writer\",module:\"textures\",version:\"3.3.1\",extensions:[\"ktx2\"],options:{useSRGB:!1,qualityLevel:10,encodeUASTC:!1,mipmaps:!1},encode:async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{useSRGB:r=!1,qualityLevel:n=10,encodeUASTC:o=!1,mipmaps:i=!1}=t,{BasisEncoder:s}=await async function(e){const t=e.modules||{};return t.basisEncoder?t.basisEncoder:(ge=ge||async function(e){let t=null,r=null;return[t,r]=await Promise.all([await oe(pe,\"textures\",e),await oe(he,\"textures\",e)]),t=t||globalThis.BASIS,await function(e,t){const r={};return t&&(r.wasmBinary=t),new Promise(t=>{e(r).then(e=>{const{BasisFile:r,KTX2File:n,initializeBasis:o,BasisEncoder:i}=e;o(),t({BasisFile:r,KTX2File:n,BasisEncoder:i})})})}(t,r)}(e),await ge)}(t),a=new s;try{const t=new Uint8Array(e.width*e.height*4);a.setCreateKTX2File(!0),a.setKTX2UASTCSupercompression(!0),a.setKTX2SRGBTransferFunc(!0),a.setSliceSourceImage(0,e.data,e.width,e.height,!1),a.setPerceptual(r),a.setMipSRGB(r),a.setQualityLevel(n),a.setUASTC(o),a.setMipGen(i);const s=a.encode(t);return t.subarray(0,s).buffer}catch(e){throw console.error(\"Basis Universal Supercompressed GPU Texture encoder Error: \",e),e}finally{a.delete()}}},{_parseImageNode:ye}=globalThis,ve=\"undefined\"!=typeof Image,we=\"undefined\"!=typeof ImageBitmap,be=Boolean(ye),xe=!!I||be,Se=/^data:image\\/svg\\+xml/,Te=/\\.svg((\\?|#).*)?$/;function Me(e){return e&&(Se.test(e)||Te.test(e))}function ke(e,t){if(Me(t))throw new Error(\"SVG cannot be parsed directly to imagebitmap\");return new Blob([new Uint8Array(e)])}async function _e(e,t,r){const n=function(e,t){if(Me(t)){let t=(new TextDecoder).decode(e);try{\"function\"==typeof unescape&&\"function\"==typeof encodeURIComponent&&(t=unescape(encodeURIComponent(t)))}catch(e){throw new Error(e.message)}return\"data:image/svg+xml;base64,\".concat(btoa(t))}return ke(e,t)}(e,r),o=self.URL||self.webkitURL,i=\"string\"!=typeof n&&o.createObjectURL(n);try{return await async function(e,t){const r=new Image;return r.src=e,t.image&&t.image.decode&&r.decode?(await r.decode(),r):await new Promise((t,n)=>{try{r.onload=()=>t(r),r.onerror=t=>n(new Error(\"Could not load image \".concat(e,\": \").concat(t)))}catch(e){n(e)}})}(i||n,t)}finally{i&&o.revokeObjectURL(i)}}const je={};let Ae=!0;const Be=!1,Ie=!0;function Ee(e){const t=Ce(e);return function(e){const t=Ce(e);return t.byteLength>=24&&2303741511===t.getUint32(0,Be)?{mimeType:\"image/png\",width:t.getUint32(16,Be),height:t.getUint32(20,Be)}:null}(t)||function(e){const t=Ce(e);if(!(t.byteLength>=3&&65496===t.getUint16(0,Be)&&255===t.getUint8(2)))return null;const{tableMarkers:r,sofMarkers:n}=function(){const e=new Set([65499,65476,65484,65501,65534]);for(let t=65504;t<65520;++t)e.add(t);return{tableMarkers:e,sofMarkers:new Set([65472,65473,65474,65475,65477,65478,65479,65481,65482,65483,65485,65486,65487,65502])}}();let o=2;for(;o+9<t.byteLength;){const e=t.getUint16(o,Be);if(n.has(e))return{mimeType:\"image/jpeg\",height:t.getUint16(o+5,Be),width:t.getUint16(o+7,Be)};if(!r.has(e))return null;o+=2,o+=t.getUint16(o,Be)}return null}(t)||function(e){const t=Ce(e);return t.byteLength>=10&&1195984440===t.getUint32(0,Be)?{mimeType:\"image/gif\",width:t.getUint16(6,Ie),height:t.getUint16(8,Ie)}:null}(t)||function(e){const t=Ce(e);return t.byteLength>=14&&16973===t.getUint16(0,Be)&&t.getUint32(2,Ie)===t.byteLength?{mimeType:\"image/bmp\",width:t.getUint32(18,Ie),height:t.getUint32(22,Ie)}:null}(t)}function Ce(e){if(e instanceof DataView)return e;if(ArrayBuffer.isView(e))return new DataView(e.buffer);if(e instanceof ArrayBuffer)return new DataView(e);throw new Error(\"toDataView\")}const Pe={id:\"image\",module:\"images\",name:\"Images\",version:\"3.3.1\",mimeTypes:[\"image/png\",\"image/jpeg\",\"image/gif\",\"image/webp\",\"image/bmp\",\"image/vnd.microsoft.icon\",\"image/svg+xml\"],extensions:[\"png\",\"jpg\",\"jpeg\",\"gif\",\"webp\",\"bmp\",\"ico\",\"svg\"],parse:async function(e,t,r){const n=((t=t||{}).image||{}).type||\"auto\",{url:o}=r||{};let i;switch(function(e){switch(e){case\"auto\":case\"data\":return function(){if(we)return\"imagebitmap\";if(ve)return\"image\";if(xe)return\"data\";throw new Error(\"Install '@loaders.gl/polyfills' to parse images under Node.js\")}();default:return function(e){switch(e){case\"auto\":return we||ve||xe;case\"imagebitmap\":return we;case\"image\":return ve;case\"data\":return xe;default:throw new Error(\"@loaders.gl/images: image \".concat(e,\" not supported in this environment\"))}}(e),e}}(n)){case\"imagebitmap\":i=await async function(e,t,r){let n;n=Me(r)?await _e(e,t,r):ke(e,r);const o=t&&t.imagebitmap;return await async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(!function(e){for(const t in e||je)return!1;return!0}(t)&&Ae||(t=null),t)try{return await createImageBitmap(e,t)}catch(e){console.warn(e),Ae=!1}return await createImageBitmap(e)}(n,o)}(e,t,o);break;case\"image\":i=await _e(e,t,o);break;case\"data\":i=await async function(e,t){const{mimeType:r}=Ee(e)||{},n=globalThis._parseImageNode;return B(n),await n(e,r)}(e);break;default:B(!1)}return\"data\"===n&&(i=function(e){switch(function(e){const t=function(e){return\"undefined\"!=typeof ImageBitmap&&e instanceof ImageBitmap?\"imagebitmap\":\"undefined\"!=typeof Image&&e instanceof Image?\"image\":e&&\"object\"==typeof e&&e.data&&e.width&&e.height?\"data\":null}(e);if(!t)throw new Error(\"Not an image\");return t}(e)){case\"data\":return e;case\"image\":case\"imagebitmap\":const t=document.createElement(\"canvas\"),r=t.getContext(\"2d\");if(!r)throw new Error(\"getImageData\");return t.width=e.width,t.height=e.height,r.drawImage(e,0,0),r.getImageData(0,0,e.width,e.height);default:throw new Error(\"getImageData\")}}(i)),i},tests:[e=>Boolean(Ee(new DataView(e)))],options:{image:{type:\"auto\",decode:!0}}};var Le=1e3,Oe=2e4,Fe=20001,Ue=20002,Re=20003,De=20004;function Ge(e){return new Float64Array(e||6)}function We(e){return void 0===e&&(e=Ge()),e[0]=o,e[1]=o,e[2]=o,e[3]=i,e[4]=i,e[5]=i,e}function Ne(e,t){for(var r,n,o,i=0,s=t.length;i<s;i+=3)n=t[i+1],o=t[i+2],e[0]>(r=t[i])&&(e[0]=r),e[1]>n&&(e[1]=n),e[2]>o&&(e[2]=o),e[3]<r&&(e[3]=r),e[4]<n&&(e[4]=n),e[5]<o&&(e[5]=o);return e}c(),c(),u(),n(3),n(3),n(3),n(3),n(3),n(3),n(3);var He=function(e){this.positionsCompressed=void 0,this.uvsCompressed=void 0,this.colorsCompressed=void 0,this.indices=void 0,this.edgeIndices=void 0,this.positionsCompressed=e.positionsCompressed,this.uvsCompressed=e.uvsCompressed,this.colorsCompressed=e.colorsCompressed,this.indices=e.indices,this.edgeIndices=e.edgeIndices},Ve=function(e){this.id=void 0,this.primitive=void 0,this.positionsDecompressMatrix=void 0,this.aabb=void 0,this.uvsDecompressMatrix=void 0,this.geometryBuckets=void 0,this.rendererGeometry=void 0,this.geometryBuckets=[];for(var t=0,r=e.geometryBuckets.length;t<r;t++)this.geometryBuckets[t]=new He(e.geometryBuckets[t]);this.id=e.id,this.positionsDecompressMatrix=e.positionsDecompressMatrix,this.primitive=e.primitive},Qe=/*#__PURE__*/j(\"positionsDecompressed\"),Je=/*#__PURE__*/j(\"positionsWorld\"),ze=new(/*#__PURE__*/function(){function e(){this.object=void 0,this.mesh=void 0,this.meshIndex=void 0,this.geometry=void 0,this.geometryBucket=void 0,this.geometryBucketIndex=void 0,Object.defineProperty(this,Qe,{writable:!0,value:void 0}),Object.defineProperty(this,Je,{writable:!0,value:void 0}),this.object=null,this.mesh=null,this.meshIndex=0,this.geometry=null,this.geometryBucket=null,this.geometryBucketIndex=0,A(this,Qe)[Qe]=null,A(this,Je)[Je]=null}return e.prototype.reset=function(){A(this,Qe)[Qe]=null,A(this,Je)[Je]=null},S(e,[{key:\"totalGeometryBuckets\",get:function(){var e=0;if(this.object)for(var t=0,r=this.object.meshes.length;t<r;t++)e+=this.object.meshes[t].geometry.geometryBuckets.length;return e}},{key:\"numPrimitives\",get:function(){var e=this.geometry.primitive;return this.geometryBucket.indices.length/(e===Ue?3:e===Fe?2:1)}},{key:\"positionsDecompressed\",get:function(){return A(this,Qe)[Qe]||(A(this,Qe)[Qe]=new Float32Array(this.geometryBucket.positionsCompressed.length),w(this.geometryBucket.positionsCompressed,this.geometry.positionsDecompressMatrix,A(this,Qe)[Qe])),A(this,Qe)[Qe]}},{key:\"positionsWorld\",get:function(){if(!A(this,Je)[Je]){var e=this.positionsDecompressed;A(this,Je)[Je]=new Float64Array(e.length),f(e,this.mesh.matrix,A(this,Je)[Je])}return A(this,Je)[Je]}},{key:\"uvsDecompressed\",get:function(){return null}}]),e}());function qe(e,t){ze.reset(),ze.object=e;for(var r=0,n=e.meshes.length;r<n;r++){var o=e.meshes[r];ze.mesh=o,ze.meshIndex=r;var i=o.geometry;ze.geometry=i;for(var s=0,a=i.geometryBuckets.length;s<a;s++)if(ze.geometryBucket=i.geometryBuckets[s],ze.geometryBucketIndex=s,t(ze))return!0}return!1}var Ke=/*#__PURE__*/j(\"aabb\"),Ye=/*#__PURE__*/j(\"aabbDirty\"),Xe=/*#__PURE__*/function(){function e(e){this.model=void 0,this.id=void 0,this.meshes=void 0,this.layerId=void 0,this.rendererObject=void 0,Object.defineProperty(this,Ke,{writable:!0,value:void 0}),Object.defineProperty(this,Ye,{writable:!0,value:void 0}),this.id=e.id,this.layerId=e.layerId,this.meshes=e.meshes,A(this,Ke)[Ke]=Ge(),A(this,Ye)[Ye]=!0,this.rendererObject=null}return e.prototype.setAABBDirty=function(){A(this,Ye)[Ye]=!0},S(e,[{key:\"aabb\",get:function(){var e=this;return A(this,Ye)[Ye]&&(We(A(this,Ke)[Ke]),qe(this,function(t){return Ne(A(e,Ke)[Ke],t.positionsWorld),!1}),A(this,Ye)[Ye]=!1),A(this,Ke)[Ke]}}]),e}(),$e=function(e,t){this.id=void 0,this.colorTexture=void 0,this.metallicRoughnessTexture=void 0,this.occlusionTexture=void 0,this.emissiveTexture=void 0,this.rendererTextureSet=void 0,this.id=e.id,this.colorTexture=t.colorTexture,this.metallicRoughnessTexture=t.metallicRoughnessTexture,this.occlusionTexture=t.occlusionTexture,this.emissiveTexture=t.emissiveTexture,this.rendererTextureSet=null},Ze=function(e){this.rendererTexture=void 0,this.id=void 0,this.src=void 0,this.imageData=void 0,this.buffers=void 0,this.image=void 0,this.height=void 0,this.width=void 0,this.compressed=void 0,this.mediaType=void 0,this.magFilter=void 0,this.minFilter=void 0,this.wrapS=void 0,this.wrapT=void 0,this.wrapR=void 0,this.flipY=void 0,this.encoding=void 0,this.preloadColor=void 0,this.channel=void 0,this.id=e.id,this.imageData=e.imageData,this.src=e.src,this.mediaType=e.mediaType,this.minFilter=e.minFilter||1007,this.magFilter=e.magFilter||1007,this.wrapS=e.wrapS||Le,this.wrapT=e.wrapT||Le,this.wrapR=e.wrapR||Le,this.encoding=e.encoding||3e3,this.preloadColor=h(e.preloadColor||[1,1,1,1]),this.channel=0,this.rendererTexture=null},et=/*#__PURE__*/j(\"color\"),tt=/*#__PURE__*/j(\"matrix\"),rt=/*#__PURE__*/j(\"metallic\"),nt=/*#__PURE__*/j(\"roughness\"),ot=/*#__PURE__*/j(\"opacity\"),it=/*#__PURE__*/function(){function e(e){this.id=void 0,this.geometry=void 0,this.textureSet=void 0,this.rendererMesh=void 0,this.object=void 0,Object.defineProperty(this,et,{writable:!0,value:void 0}),Object.defineProperty(this,tt,{writable:!0,value:void 0}),Object.defineProperty(this,rt,{writable:!0,value:void 0}),Object.defineProperty(this,nt,{writable:!0,value:void 0}),Object.defineProperty(this,ot,{writable:!0,value:void 0}),this.id=e.id,A(this,tt)[tt]=e.matrix?u(e.matrix):p(),this.geometry=e.geometry,this.textureSet=e.textureSet,this.rendererMesh=null,this.color=e.color||c([1,1,1]),this.metallic=null!=e.metallic?e.metallic:0,this.roughness=null!=e.roughness?e.roughness:1,this.opacity=null!=e.opacity?e.opacity:1}return S(e,[{key:\"color\",get:function(){return A(this,et)[et]},set:function(e){var t=A(this,et)[et];t||((t=A(this,et)[et]=new Float32Array(4))[3]=1),e?(t[0]=e[0],t[1]=e[1],t[2]=e[2]):(t[0]=1,t[1]=1,t[2]=1),this.rendererMesh&&this.rendererMesh.setColor(A(this,et)[et])}},{key:\"matrix\",get:function(){return A(this,tt)[tt]},set:function(e){e?A(this,tt)[tt].set(e):p(A(this,tt)[tt]),this.rendererMesh&&this.rendererMesh.setMatrix(A(this,tt)[tt]),this.object&&this.object.setAABBDirty()}},{key:\"metallic\",get:function(){return A(this,rt)[rt]},set:function(e){e=null!=e?e:1,A(this,rt)[rt]!==e&&(A(this,rt)[rt]=e,this.rendererMesh&&this.rendererMesh.setMetallic(A(this,rt)[rt]))}},{key:\"roughness\",get:function(){return A(this,nt)[nt]},set:function(e){e=null!=e?e:1,A(this,nt)[nt]!==e&&(A(this,nt)[nt]=e,this.rendererMesh&&this.rendererMesh.setRoughness(A(this,nt)[nt]))}},{key:\"opacity\",get:function(){return A(this,ot)[ot]},set:function(e){e=null!=e?e:1,A(this,ot)[ot]!==e&&(A(this,ot)[ot]=e)}}]),e}(),st=[],at=[],ct=[],ut=[],lt=[],dt=0,ft=new Uint16Array(3),ht=new Uint16Array(3),pt=new Uint16Array(3),gt=c(),mt=c(),yt=c(),vt=c(),wt=c(),bt=c(),xt=c(),St=null;function Tt(e,t){for(var r,n=0;n<3;n++)if(0!=(r=St[3*e+n]-St[3*t+n]))return r;return 0}var Mt=null,kt=null;function _t(e,t){var r,n,o,i,s,a,c=3*e,u=3*t,l=Math.min(r=kt[c],n=kt[c+1],o=kt[c+2]),d=Math.min(i=kt[u],s=kt[u+1],a=kt[u+2]);if(l!=d)return l-d;var f=Math.max(r,n,o),h=Math.max(i,s,a);return f!=h?f-h:0}function jt(e){var t=u(),r=We();Ne(r,e.positions);var n,o=b(e.positions,r,t),i=e.primitive!==Re&&e.primitive!==De&&e.primitive!==Ue||!e.indices?null:function(e,t,r,n){!function(e,t){var r,n,o,i,s,a,c={},u=Math.pow(10,4),l=0;for(s=0,a=e.length;s<a;s+=3)r=e[s],n=e[s+1],o=e[s+2],void 0===c[i=Math.round(r*u)+\"_\"+Math.round(n*u)+\"_\"+Math.round(o*u)]&&(c[i]=l/3,st[l++]=r,st[l++]=n,st[l++]=o),at[s/3]=c[i];for(s=0,a=t.length;s<a;s++)ut[s]=at[t[s]],ct[ut[s]]=t[s]}(e,t),function(e,t){dt=0;for(var r=0,n=e;r<n;r+=3){var o=3*ut[r],i=3*ut[r+1],s=3*ut[r+2];t?(ft[0]=st[o],ft[1]=st[o+1],ft[2]=st[o+2],ht[0]=st[i],ht[1]=st[i+1],ht[2]=st[i+2],pt[0]=st[s],pt[1]=st[s+1],pt[2]=st[s+2],v(ft,t,gt),v(ht,t,mt),v(pt,t,yt)):(gt[0]=st[o],gt[1]=st[o+1],gt[2]=st[o+2],mt[0]=st[i],mt[1]=st[i+1],mt[2]=st[i+2],yt[0]=st[s],yt[1]=st[s+1],yt[2]=st[s+2]),l(yt,mt,vt),l(gt,mt,wt),m(vt,wt,bt),y(bt,xt);var a=lt[dt]||(lt[dt]={normal:c()});a.normal[0]=xt[0],a.normal[1]=xt[1],a.normal[2]=xt[2],dt++}}(t.length,r);for(var o,i,a,u,d,f,h,p,w=[],b=Math.cos(10*s),x={},S=!1,T=0,M=t.length;T<M;T+=3)for(var k=T/3,_=0;_<3;_++)o=ut[T+_],i=ut[T+(_+1)%3],void 0===x[d=(a=Math.min(o,i))+\",\"+(u=Math.max(o,i))]?x[d]={index1:a,index2:u,face1:k,face2:void 0}:x[d].face2=k;for(d in x)void 0!==(f=x[d]).face2&&g(lt[f.face1].normal,lt[f.face2].normal)>b||(h=ct[f.index1],p=ct[f.index2],(!S&&h>65535||p>65535)&&(S=!0),w.push(h),w.push(p));return S?new Uint32Array(w):new Uint16Array(w)}(o,e.indices,t),a=function(e){var t=e.positionsCompressed,r=e.indices,n=e.edgeIndices;!function(e){if(!(null!==Mt&&Mt.length>=e)){Mt=new Uint32Array(e);for(var t=0;t<e;t++)Mt[t]=t}}(t.length/3);var o=Mt.slice(0,t.length/3),i=Mt.slice(0,t.length/3);St=t,o.sort(Tt);var s=0;i[o[0]]=0;for(var a=1,c=o.length;a<c;a++)0!=Tt(o[a],o[a-1])&&s++,i[o[a]]=s;var u=new Uint16Array(3*(s+1));u[3*(s=0)+0]=t[3*o[0]+0],u[3*s+1]=t[3*o[0]+1],u[3*s+2]=t[3*o[0]+2];for(var l=1,d=o.length;l<d;l++)0!==Tt(o[l],o[l-1])&&(u[3*++s+0]=t[3*o[l]+0],u[3*s+1]=t[3*o[l]+1],u[3*s+2]=t[3*o[l]+2]),i[o[l]]=s;St=null;for(var f,h=new Uint32Array(r.length),p=0,g=r.length;p<g;p++)h[p]=i[r[p]];if(n){f=new Uint32Array(n.length);for(var m=0,y=n.length;m<y;m++)f[m]=i[n[m]]}return[u,h,f]}({positionsCompressed:o,uvs:e.uvs,indices:e.indices,edgeIndices:i}),d=function(e,t,r){void 0===r&&(r=!1);var n=e.positionsCompressed||[],o=function(e,t){for(var r=new Int32Array(e.length/3),n=0,o=r.length;n<o;n++)r[n]=n;kt=new Int32Array(e.length);for(var i=0,s=e.length;i<s;i++)kt[i]=e[i]>>t;r.sort(_t);for(var a=new Int32Array(e.length),c=0,u=r.length;c<u;c++)a[3*c+0]=e[3*r[c]+0],a[3*c+1]=e[3*r[c]+1],a[3*c+2]=e[3*r[c]+2];return a}(e.indices||[],t),i=[];function s(e,t){if(e>t){var r=e;e=t,t=r}function n(r,n){return r!=e?e-r:n!=t?t-n:0}for(var o=0,s=(i.length>>1)-1;o<=s;){var a=s+o>>1,c=n(i[2*a],i[2*a+1]);if(c>0)o=a+1;else{if(!(c<0))return a;s=a-1}}return-o-1}var a=new Int32Array(i.length/2);a.fill(0);var c=n.length/3;if(c>8*(1<<t))return[e];var u=new Int32Array(c);u.fill(-1);var l=[];function d(){u.fill(-1);var e={positionsCompressed:[],indices:[],edgeIndices:[],maxNumPositions:(1<<t)-t,numPositions:0,bucketNumber:l.length};return l.push(e),e}for(var f=d(),h=0,p=o.length;h<p;h+=3){var g=0,m=o[h],y=o[h+1],v=o[h+2];if(-1==u[m]&&g++,-1==u[y]&&g++,-1==u[v]&&g++,g+f.numPositions>f.maxNumPositions&&(f=d()),f.bucketNumber>8)return[e];-1==u[m]&&(u[m]=f.numPositions++,f.positionsCompressed.push(n[3*m]),f.positionsCompressed.push(n[3*m+1]),f.positionsCompressed.push(n[3*m+2])),-1==u[y]&&(u[y]=f.numPositions++,f.positionsCompressed.push(n[3*y]),f.positionsCompressed.push(n[3*y+1]),f.positionsCompressed.push(n[3*y+2])),-1==u[v]&&(u[v]=f.numPositions++,f.positionsCompressed.push(n[3*v]),f.positionsCompressed.push(n[3*v+1]),f.positionsCompressed.push(n[3*v+2])),f.indices.push(u[m]),f.indices.push(u[y]),f.indices.push(u[v]);var w=void 0;(w=s(m,y))>=0&&0==a[w]&&(a[w]=1,f.edgeIndices.push(u[i[2*w]]),f.edgeIndices.push(u[i[2*w+1]])),(w=s(m,v))>=0&&0==a[w]&&(a[w]=1,f.edgeIndices.push(u[i[2*w]]),f.edgeIndices.push(u[i[2*w+1]])),(w=s(y,v))>=0&&0==a[w]&&(a[w]=1,f.edgeIndices.push(u[i[2*w]]),f.edgeIndices.push(u[i[2*w+1]]))}var b=t/8,x=2*n.length+(o.length+i.length)*(t/8*2),S=0;return l.forEach(function(e){S+=2*e.positionsCompressed.length+(e.indices.length+e.edgeIndices.length)*b}),S>x?[e]:(r&&function(e,t){var r={};e.forEach(function(e){for(var t=e.indices,n=e.edgeIndices,o=e.positionsCompressed,i=0,s=t.length;i<s;i+=3)r[o[3*t[i]]+\"_\"+o[3*t[i]+1]+\"_\"+o[3*t[i]+2]+\"/\"+o[3*t[i+1]]+\"_\"+o[3*t[i+1]+1]+\"_\"+o[3*t[i+1]+2]+\"/\"+o[3*t[i+2]]+\"_\"+o[3*t[i+2]+1]+\"_\"+o[3*t[i+2]+2]]=!0;for(i=0,s=n.length;i<s;i+=2);});for(var n=t.indices,o=t.positionsCompressed,i=0,s=n.length;i<s;i+=3){var a=o[3*n[i]]+\"_\"+o[3*n[i]+1]+\"_\"+o[3*n[i]+2]+\"/\"+o[3*n[i+1]]+\"_\"+o[3*n[i+1]+1]+\"_\"+o[3*n[i+1]+2]+\"/\"+o[3*n[i+2]]+\"_\"+o[3*n[i+2]+1]+\"_\"+o[3*n[i+2]+2];if(!(a in r))throw console.log(\"Not found \"+a),\"Ohhhh!\"}}(l,e),l)}({positionsCompressed:n=a[0],indices:a[1],edgeIndices:a[2]},n.length/3>65536?16:8);return{id:e.id,primitive:e.primitive===Re&&d.length>1?Ue:e.primitive,aabb:r,positionsDecompressMatrix:t,uvsDecompressMatrix:void 0,geometryBuckets:d}}const At=e=>\"function\"==typeof e,Bt=e=>null!==e&&\"object\"==typeof e,It=e=>Bt(e)&&e.constructor==={}.constructor,Et=e=>e&&\"function\"==typeof e[Symbol.iterator],Ct=e=>e&&\"function\"==typeof e[Symbol.asyncIterator],Pt=e=>\"undefined\"!=typeof Response&&e instanceof Response||e&&e.arrayBuffer&&e.text&&e.json,Lt=e=>\"undefined\"!=typeof Blob&&e instanceof Blob,Ot=e=>e&&\"object\"==typeof e&&e.isBuffer,Ft=e=>(e=>\"undefined\"!=typeof ReadableStream&&e instanceof ReadableStream||Bt(e)&&At(e.tee)&&At(e.cancel)&&At(e.getReader))(e)||(e=>Bt(e)&&At(e.read)&&At(e.pipe)&&(e=>\"boolean\"==typeof e)(e.readable))(e),Ut=/^data:([-\\w.]+\\/[-\\w.+]+)(;|,)/,Rt=/^([-\\w.]+\\/[-\\w.+]+)/;function Dt(e){const t=Rt.exec(e);return t?t[1]:e}function Gt(e){const t=Ut.exec(e);return t?t[1]:\"\"}const Wt=/\\?.*/;function Nt(e){if(Pt(e)){const t=Ht(e.url||\"\");return{url:t,type:Dt(e.headers.get(\"content-type\")||\"\")||Gt(t)}}return Lt(e)?{url:Ht(e.name||\"\"),type:e.type||\"\"}:\"string\"==typeof e?{url:Ht(e),type:Gt(e)}:{url:\"\",type:\"\"}}function Ht(e){return e.replace(Wt,\"\")}async function Vt(e){if(Pt(e))return e;const t={},r=function(e){return Pt(e)?e.headers[\"content-length\"]||-1:Lt(e)?e.size:\"string\"==typeof e?e.length:e instanceof ArrayBuffer||ArrayBuffer.isView(e)?e.byteLength:-1}(e);r>=0&&(t[\"content-length\"]=String(r));const{url:n,type:o}=Nt(e);o&&(t[\"content-type\"]=o);const i=await async function(e){if(\"string\"==typeof e)return\"data:,\".concat(e.slice(0,5));if(e instanceof Blob){const t=e.slice(0,5);return await new Promise(e=>{const r=new FileReader;r.onload=t=>{var r;return e(null==t||null===(r=t.target)||void 0===r?void 0:r.result)},r.readAsDataURL(t)})}if(e instanceof ArrayBuffer){const t=function(e){let t=\"\";const r=new Uint8Array(e);for(let e=0;e<r.byteLength;e++)t+=String.fromCharCode(r[e]);return btoa(t)}(e.slice(0,5));return\"data:base64,\".concat(t)}return null}(e);i&&(t[\"x-first-bytes\"]=i),\"string\"==typeof e&&(e=(new TextEncoder).encode(e));const s=new Response(e,{headers:t});return Object.defineProperty(s,\"url\",{value:n}),s}async function Qt(e,t){if(\"string\"==typeof e){e=le(e);let r=t;return null!=t&&t.fetch&&\"function\"!=typeof(null==t?void 0:t.fetch)&&(r=t.fetch),await fetch(e,r)}return await Vt(e)}function Jt(){return!(\"object\"==typeof process&&\"[object process]\"===String(process)&&!process.browser)||function(e){if(\"undefined\"!=typeof window&&\"object\"==typeof window.process&&\"renderer\"===window.process.type)return!0;if(\"undefined\"!=typeof process&&\"object\"==typeof process.versions&&Boolean(process.versions.electron))return!0;const t=\"object\"==typeof navigator&&\"string\"==typeof navigator.userAgent&&navigator.userAgent;return!!(t&&t.indexOf(\"Electron\")>=0)}()}const zt={self:\"undefined\"!=typeof self&&self,window:\"undefined\"!=typeof window&&window,global:\"undefined\"!=typeof global&&global,document:\"undefined\"!=typeof document&&document,process:\"object\"==typeof process&&process},qt=zt.window||zt.self||zt.global,Kt=zt.process||{},Yt=\"undefined\"!=typeof __VERSION__?__VERSION__:\"untranspiled source\";Jt();class Xt{constructor(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:\"sessionStorage\";R(this,\"storage\",void 0),R(this,\"id\",void 0),R(this,\"config\",void 0),this.storage=function(e){try{const t=window[e],r=\"__storage_test__\";return t.setItem(r,r),t.removeItem(r),t}catch(e){return null}}(r),this.id=e,this.config=t,this._loadConfiguration()}getConfiguration(){return this.config}setConfiguration(e){if(Object.assign(this.config,e),this.storage){const e=JSON.stringify(this.config);this.storage.setItem(this.id,e)}}_loadConfiguration(){let e={};if(this.storage){const t=this.storage.getItem(this.id);e=t?JSON.parse(t):{}}return Object.assign(this.config,e),this}}function $t(e,t,r){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:600;const o=e.src.replace(/\\(/g,\"%28\").replace(/\\)/g,\"%29\");e.width>n&&(r=Math.min(r,n/e.width));const i=e.width*r,s=e.height*r,a=[\"font-size:1px;\",\"padding:\".concat(Math.floor(s/2),\"px \").concat(Math.floor(i/2),\"px;\"),\"line-height:\".concat(s,\"px;\"),\"background:url(\".concat(o,\");\"),\"background-size:\".concat(i,\"px \").concat(s,\"px;\"),\"color:transparent;\"].join(\"\");return[\"\".concat(t,\" %c+\"),a]}let Zt;function er(e){return\"string\"==typeof e?Zt[e.toUpperCase()]||Zt.WHITE:e}function tr(e,t){if(!e)throw new Error(t||\"Assertion failed\")}function rr(){let e;var t,r;if(Jt&&\"performance\"in qt)e=null==qt||null===(t=qt.performance)||void 0===t||null===(r=t.now)||void 0===r?void 0:r.call(t);else if(\"hrtime\"in Kt){var n;const t=null==Kt||null===(n=Kt.hrtime)||void 0===n?void 0:n.call(Kt);e=1e3*t[0]+t[1]/1e6}else e=Date.now();return e}!function(e){e[e.BLACK=30]=\"BLACK\",e[e.RED=31]=\"RED\",e[e.GREEN=32]=\"GREEN\",e[e.YELLOW=33]=\"YELLOW\",e[e.BLUE=34]=\"BLUE\",e[e.MAGENTA=35]=\"MAGENTA\",e[e.CYAN=36]=\"CYAN\",e[e.WHITE=37]=\"WHITE\",e[e.BRIGHT_BLACK=90]=\"BRIGHT_BLACK\",e[e.BRIGHT_RED=91]=\"BRIGHT_RED\",e[e.BRIGHT_GREEN=92]=\"BRIGHT_GREEN\",e[e.BRIGHT_YELLOW=93]=\"BRIGHT_YELLOW\",e[e.BRIGHT_BLUE=94]=\"BRIGHT_BLUE\",e[e.BRIGHT_MAGENTA=95]=\"BRIGHT_MAGENTA\",e[e.BRIGHT_CYAN=96]=\"BRIGHT_CYAN\",e[e.BRIGHT_WHITE=97]=\"BRIGHT_WHITE\"}(Zt||(Zt={}));const nr={debug:Jt&&console.debug||console.log,log:console.log,info:console.info,warn:console.warn,error:console.error},or={enabled:!0,level:0};function ir(){}const sr={},ar={once:!0};class cr{constructor(){let{id:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{id:\"\"};R(this,\"id\",void 0),R(this,\"VERSION\",Yt),R(this,\"_startTs\",rr()),R(this,\"_deltaTs\",rr()),R(this,\"_storage\",void 0),R(this,\"userData\",{}),R(this,\"LOG_THROTTLE_TIMEOUT\",0),this.id=e,this.userData={},this._storage=new Xt(\"__probe-\".concat(this.id,\"__\"),or),this.timeStamp(\"\".concat(this.id,\" started\")),function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[\"constructor\"];const r=Object.getPrototypeOf(e),n=Object.getOwnPropertyNames(r);for(const r of n)\"function\"==typeof e[r]&&(t.find(e=>r===e)||(e[r]=e[r].bind(e)))}(this),Object.seal(this)}set level(e){this.setLevel(e)}get level(){return this.getLevel()}isEnabled(){return this._storage.config.enabled}getLevel(){return this._storage.config.level}getTotal(){return Number((rr()-this._startTs).toPrecision(10))}getDelta(){return Number((rr()-this._deltaTs).toPrecision(10))}set priority(e){this.level=e}get priority(){return this.level}getPriority(){return this.level}enable(){return this._storage.setConfiguration({enabled:!(arguments.length>0&&void 0!==arguments[0])||arguments[0]}),this}setLevel(e){return this._storage.setConfiguration({level:e}),this}get(e){return this._storage.config[e]}set(e,t){this._storage.setConfiguration({[e]:t})}settings(){console.table?console.table(this._storage.config):console.log(this._storage.config)}assert(e,t){tr(e,t)}warn(e){return this._getLogFunction(0,e,nr.warn,arguments,ar)}error(e){return this._getLogFunction(0,e,nr.error,arguments)}deprecated(e,t){return this.warn(\"`\".concat(e,\"` is deprecated and will be removed in a later version. Use `\").concat(t,\"` instead\"))}removed(e,t){return this.error(\"`\".concat(e,\"` has been removed. Use `\").concat(t,\"` instead\"))}probe(e,t){return this._getLogFunction(e,t,nr.log,arguments,{time:!0,once:!0})}log(e,t){return this._getLogFunction(e,t,nr.debug,arguments)}info(e,t){return this._getLogFunction(e,t,console.info,arguments)}once(e,t){for(var r=arguments.length,n=new Array(r>2?r-2:0),o=2;o<r;o++)n[o-2]=arguments[o];return this._getLogFunction(e,t,nr.debug||nr.info,arguments,ar)}table(e,t,r){return t?this._getLogFunction(e,t,console.table||ir,r&&[r],{tag:dr(t)}):ir}image(e){let{logLevel:t,priority:r,image:n,message:o=\"\",scale:i=1}=e;return this._shouldLog(t||r)?Jt?function(e){let{image:t,message:r=\"\",scale:n=1}=e;if(\"string\"==typeof t){const e=new Image;return e.onload=()=>{const t=$t(e,r,n);console.log(...t)},e.src=t,ir}const o=t.nodeName||\"\";if(\"img\"===o.toLowerCase())return console.log(...$t(t,r,n)),ir;if(\"canvas\"===o.toLowerCase()){const e=new Image;return e.onload=()=>console.log(...$t(e,r,n)),e.src=t.toDataURL(),ir}return ir}({image:n,message:o,scale:i}):(console.warn(\"removed\"),ir):ir}time(e,t){return this._getLogFunction(e,t,console.time?console.time:console.info)}timeEnd(e,t){return this._getLogFunction(e,t,console.timeEnd?console.timeEnd:console.info)}timeStamp(e,t){return this._getLogFunction(e,t,console.timeStamp||ir)}group(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{collapsed:!1};const n=lr({logLevel:e,message:t,opts:r}),{collapsed:o}=r;return n.method=(o?console.groupCollapsed:console.group)||console.info,this._getLogFunction(n)}groupCollapsed(e,t){return this.group(e,t,Object.assign({},arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},{collapsed:!0}))}groupEnd(e){return this._getLogFunction(e,\"\",console.groupEnd||ir)}withGroup(e,t,r){this.group(e,t)();try{r()}finally{this.groupEnd(e)()}}trace(){console.trace&&console.trace()}_shouldLog(e){return this.isEnabled()&&this.getLevel()>=ur(e)}_getLogFunction(e,t,r,n,o){if(this._shouldLog(e)){o=lr({logLevel:e,message:t,args:n,opts:o}),tr(r=r||o.method),o.total=this.getTotal(),o.delta=this.getDelta(),this._deltaTs=rr();const i=o.tag||o.message;if(o.once){if(sr[i])return ir;sr[i]=rr()}return t=function(e,t,r){if(\"string\"==typeof t){const s=r.time?function(e){const t=Math.max((arguments.length>1&&void 0!==arguments[1]?arguments[1]:8)-e.length,0);return\"\".concat(\" \".repeat(t)).concat(e)}(function(e){let t;return t=e<10?\"\".concat(e.toFixed(2),\"ms\"):e<100?\"\".concat(e.toFixed(1),\"ms\"):e<1e3?\"\".concat(e.toFixed(0),\"ms\"):\"\".concat((e/1e3).toFixed(2),\"s\"),t}(r.total)):\"\";n=t=r.time?\"\".concat(e,\": \").concat(s,\"  \").concat(t):\"\".concat(e,\": \").concat(t),o=r.color,i=r.background,Jt||\"string\"!=typeof n||(o&&(o=er(o),n=\"\u001b[\".concat(o,\"m\").concat(n,\"\u001b[39m\")),i&&(o=er(i),n=\"\u001b[\".concat(i+10,\"m\").concat(n,\"\u001b[49m\"))),t=n}var n,o,i;return t}(this.id,o.message,o),r.bind(console,t,...o.args)}return ir}}function ur(e){if(!e)return 0;let t;switch(typeof e){case\"number\":t=e;break;case\"object\":t=e.logLevel||e.priority||0;break;default:return 0}return tr(Number.isFinite(t)&&t>=0),t}function lr(e){const{logLevel:t,message:r}=e;e.logLevel=ur(t);const n=e.args?Array.from(e.args):[];for(;n.length&&n.shift()!==r;);switch(typeof t){case\"string\":case\"function\":void 0!==r&&n.unshift(r),e.message=t;break;case\"object\":Object.assign(e,t)}\"function\"==typeof e.message&&(e.message=e.message());const o=typeof e.message;return tr(\"string\"===o||\"object\"===o),Object.assign(e,{args:n},e.opts)}function dr(e){for(const t in e)for(const r in e[t])return r||\"untitled\";return\"empty\"}R(cr,\"VERSION\",Yt);const fr=new cr({id:\"loaders.gl\"});class hr{log(){return()=>{}}info(){return()=>{}}warn(){return()=>{}}error(){return()=>{}}}const pr={fetch:null,mimeType:void 0,nothrow:!1,log:new class{constructor(){R(this,\"console\",void 0),this.console=console}log(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return this.console.log.bind(this.console,...t)}info(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return this.console.info.bind(this.console,...t)}warn(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return this.console.warn.bind(this.console,...t)}error(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return this.console.error.bind(this.console,...t)}},CDN:\"https://unpkg.com/@loaders.gl\",worker:!0,maxConcurrency:3,maxMobileConcurrency:1,reuseWorkers:I,_nodeWorkers:!1,_workerType:\"\",limit:0,_limitMB:0,batchSize:\"auto\",batchDebounceMs:0,metadata:!1,transforms:[]},gr={throws:\"nothrow\",dataType:\"(no longer used)\",uri:\"baseUri\",method:\"fetch.method\",headers:\"fetch.headers\",body:\"fetch.body\",mode:\"fetch.mode\",credentials:\"fetch.credentials\",cache:\"fetch.cache\",redirect:\"fetch.redirect\",referrer:\"fetch.referrer\",referrerPolicy:\"fetch.referrerPolicy\",integrity:\"fetch.integrity\",keepalive:\"fetch.keepalive\",signal:\"fetch.signal\"};function mr(){globalThis.loaders=globalThis.loaders||{};const{loaders:e}=globalThis;return e._state=e._state||{},e._state}const yr=()=>{const e=mr();return e.globalOptions=e.globalOptions||{...pr},e.globalOptions};function vr(e,t){const r=yr(),n=e||r;return\"function\"==typeof n.fetch?n.fetch:Bt(n.fetch)?e=>Qt(e,n):null!=t&&t.fetch?null==t?void 0:t.fetch:Qt}function wr(e,t,r,n,o){const i=t||\"Top level\",s=t?\"\".concat(t,\".\"):\"\";for(const a in e){const c=!t&&Bt(e[a]);if(!(a in r)&&(\"baseUri\"!==a||t)&&(\"workerUrl\"!==a||!t))if(a in n)fr.warn(\"\".concat(i,\" loader option '\").concat(s).concat(a,\"' no longer supported, use '\").concat(n[a],\"'\"))();else if(!c){const e=br(a,o);fr.warn(\"\".concat(i,\" loader option '\").concat(s).concat(a,\"' not recognized. \").concat(e))()}}}function br(e,t){const r=e.toLowerCase();let n=\"\";for(const o of t)for(const t in o.options){if(e===t)return\"Did you mean '\".concat(o.id,\".\").concat(t,\"'?\");const i=t.toLowerCase();(r.startsWith(i)||i.startsWith(r))&&(n=n||\"Did you mean '\".concat(o.id,\".\").concat(t,\"'?\"))}return n}function xr(e,t){for(const r in t)r in t&&(e[r]=It(t[r])&&It(e[r])?{...e[r],...t[r]}:t[r])}function Sr(e){var t;return!!e&&(Array.isArray(e)&&(e=e[0]),Array.isArray(null===(t=e)||void 0===t?void 0:t.extensions))}function Tr(e){var t,r;let n;return B(e,\"null loader\"),B(Sr(e),\"invalid loader\"),Array.isArray(e)&&(n=e[1],e=e[0],e={...e,options:{...e.options,...n}}),(null!==(t=e)&&void 0!==t&&t.parseTextSync||null!==(r=e)&&void 0!==r&&r.parseText)&&(e.text=!0),e.text||(e.binary=!0),e}const Mr=()=>{const e=mr();return e.loaderRegistry=e.loaderRegistry||[],e.loaderRegistry},kr=new cr({id:\"loaders.gl\"}),_r=/\\.([^.]+)$/;function jr(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=arguments.length>2?arguments[2]:void 0,n=arguments.length>3?arguments[3]:void 0;if(!Ar(e))return null;if(t&&!Array.isArray(t))return Tr(t);let o=[];t&&(o=o.concat(t)),null!=r&&r.ignoreRegisteredLoaders||o.push(...Mr()),function(e){for(const t of e)Tr(t)}(o);const i=function(e,t,r,n){const{url:o,type:i}=Nt(e),s=o||(null==n?void 0:n.url);let a=null,c=\"\";var u;return null!=r&&r.mimeType&&(a=Ir(t,null==r?void 0:r.mimeType),c=\"match forced by supplied MIME type \".concat(null==r?void 0:r.mimeType)),a=a||function(e,t){const r=t&&_r.exec(t),n=r&&r[1];return n?function(e,t){t=t.toLowerCase();for(const r of e)for(const e of r.extensions)if(e.toLowerCase()===t)return r;return null}(e,n):null}(t,s),c=c||(a?\"matched url \".concat(s):\"\"),a=a||Ir(t,i),c=c||(a?\"matched MIME type \".concat(i):\"\"),a=a||function(e,t){if(!t)return null;for(const r of e)if(\"string\"==typeof t){if(Er(t,r))return r}else if(ArrayBuffer.isView(t)){if(Cr(t.buffer,t.byteOffset,r))return r}else if(t instanceof ArrayBuffer&&Cr(t,0,r))return r;return null}(t,e),c=c||(a?\"matched initial data \".concat(Pr(e)):\"\"),a=a||Ir(t,null==r?void 0:r.fallbackMimeType),c=c||(a?\"matched fallback MIME type \".concat(i):\"\"),c&&kr.log(1,\"selectLoader selected \".concat(null===(u=a)||void 0===u?void 0:u.name,\": \").concat(c,\".\")),a}(e,o,r,n);if(!(i||null!=r&&r.nothrow))throw new Error(Br(e));return i}function Ar(e){return!(e instanceof Response&&204===e.status)}function Br(e){const{url:t,type:r}=Nt(e);let n=\"No valid loader found (\";n+=t?\"\".concat(function(e){const t=e&&e.lastIndexOf(\"/\");return t>=0?e.substr(t+1):\"\"}(t),\", \"):\"no url provided, \",n+=\"MIME type: \".concat(r?'\"'.concat(r,'\"'):\"not provided\",\", \");const o=e?Pr(e):\"\";return n+=o?' first bytes: \"'.concat(o,'\"'):\"first bytes: not available\",n+=\")\",n}function Ir(e,t){for(const r of e){if(r.mimeTypes&&r.mimeTypes.includes(t))return r;if(t===\"application/x.\".concat(r.id))return r}return null}function Er(e,t){return t.testText?t.testText(e):(Array.isArray(t.tests)?t.tests:[t.tests]).some(t=>e.startsWith(t))}function Cr(e,t,r){return(Array.isArray(r.tests)?r.tests:[r.tests]).some(n=>function(e,t,r,n){if(n instanceof ArrayBuffer)return function(e,t,r){if(e.byteLength<(r=r||e.byteLength)||t.byteLength<r)return!1;const n=new Uint8Array(e),o=new Uint8Array(t);for(let e=0;e<n.length;++e)if(n[e]!==o[e])return!1;return!0}(n,e,n.byteLength);switch(typeof n){case\"function\":return n(e,r);case\"string\":return n===Lr(e,t,n.length);default:return!1}}(e,t,r,n))}function Pr(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5;return\"string\"==typeof e?e.slice(0,t):ArrayBuffer.isView(e)?Lr(e.buffer,e.byteOffset,t):e instanceof ArrayBuffer?Lr(e,0,t):\"\"}function Lr(e,t,r){if(e.byteLength<t+r)return\"\";const n=new DataView(e);let o=\"\";for(let e=0;e<r;e++)o+=String.fromCharCode(n.getUint8(t+e));return o}const Or=262144,Fr=262144,Ur=1048576;function Rr(e,t){return I?async function*(e,t){const r=e.getReader();let n;try{for(;;){const e=n||r.read();null!=t&&t._streamReadAhead&&(n=r.read());const{done:o,value:i}=await e;if(o)return;yield de(i)}}catch(e){r.releaseLock()}}(e,t):async function*(e,t){for await(const t of e)yield de(t)}(e)}const Dr=\"Cannot convert supplied data type\";async function Gr(e,t,r,n){E(!n||\"object\"==typeof n),!t||Array.isArray(t)||Sr(t)||(n=void 0,r=t,t=void 0),e=await e,r=r||{};const{url:o}=Nt(e),i=function(e,t){if(!t&&e&&!Array.isArray(e))return e;let r;if(e&&(r=Array.isArray(e)?e:[e]),t&&t.loaders){const e=Array.isArray(t.loaders)?t.loaders:[t.loaders];r=r?[...r,...e]:e}return r&&r.length?r:null}(t,n),s=await async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=arguments.length>2?arguments[2]:void 0,n=arguments.length>3?arguments[3]:void 0;if(!Ar(e))return null;let o=jr(e,t,{...r,nothrow:!0},n);if(o)return o;if(Lt(e)&&(o=jr(e=await e.slice(0,10).arrayBuffer(),t,r,n)),!(o||null!=r&&r.nothrow))throw new Error(Br(e));return o}(e,i,r);return s?(n=function(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(r)return r;const n={fetch:vr(t,e),...e};return Array.isArray(n.loaders)||(n.loaders=null),n}({url:o,parse:Gr,loaders:i},r=function(e,t,r,n){return r=r||[],function(e,t){wr(e,null,pr,gr,t);for(const r of t)wr(e&&e[r.id]||{},r.id,r.options&&r.options[r.id]||{},r.deprecatedOptions&&r.deprecatedOptions[r.id]||{},t)}(e,r=Array.isArray(r)?r:[r]),function(e,t,r){const n={...e.options||{}};return function(e,t){t&&!(\"baseUri\"in e)&&(e.baseUri=t)}(n,r),null===n.log&&(n.log=new hr),xr(n,yr()),xr(n,t),n}(t,e,n)}(r,s,i,o),n),await async function(e,t,r,n){if(E(e,\"no worker provided\"),Pt(t)){const e=t,{ok:r,redirected:o,status:i,statusText:s,type:a,url:c}=e,u=Object.fromEntries(e.headers.entries());n.response={headers:u,ok:r,redirected:o,status:i,statusText:s,type:a,url:c}}if(t=await async function(e,t,r){const n=e instanceof ArrayBuffer||ArrayBuffer.isView(e);if(\"string\"==typeof e||n)return function(e,t,r){if(t.text&&\"string\"==typeof e)return e;if(Ot(e)&&(e=e.buffer),e instanceof ArrayBuffer){const r=e;return t.text&&!t.binary?new TextDecoder(\"utf8\").decode(r):r}if(ArrayBuffer.isView(e)){if(t.text&&!t.binary)return new TextDecoder(\"utf8\").decode(e);let r=e.buffer;const n=e.byteLength||e.length;return 0===e.byteOffset&&n===r.byteLength||(r=r.slice(e.byteOffset,e.byteOffset+n)),r}throw new Error(Dr)}(e,t);if(Lt(e)&&(e=await Vt(e)),Pt(e)){const r=e;return await async function(e){if(!e.ok){const t=await async function(e){let t=\"Failed to fetch resource \".concat(e.url,\" (\").concat(e.status,\"): \");try{const r=e.headers.get(\"Content-Type\");let n=e.statusText;r.includes(\"application/json\")&&(n+=\" \".concat(await e.text())),t+=n,t=t.length>60?\"\".concat(t.slice(0,60),\"...\"):t}catch(e){}return t}(e);throw new Error(t)}}(r),t.binary?await r.arrayBuffer():await r.text()}if(Ft(e)&&(e=function(e,t){if(\"string\"==typeof e)return function*(e,t){const r=(null==t?void 0:t.chunkSize)||Or;let n=0;const o=new TextEncoder;for(;n<e.length;){const t=Math.min(e.length-n,r),i=e.slice(n,n+t);n+=t,yield o.encode(i)}}(e,t);if(e instanceof ArrayBuffer)return function*(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{chunkSize:r=Fr}=t;let n=0;for(;n<e.byteLength;){const t=Math.min(e.byteLength-n,r),o=new ArrayBuffer(t),i=new Uint8Array(e,n,t);new Uint8Array(o).set(i),n+=t,yield o}}(e,t);if(Lt(e))return async function*(e,t){const r=(null==t?void 0:t.chunkSize)||Ur;let n=0;for(;n<e.size;){const t=n+r,o=await e.slice(n,t).arrayBuffer();n=t,yield o}}(e,t);if(Ft(e))return Rr(e,t);if(Pt(e))return Rr(e.body,t);throw new Error(\"makeIterator\")}(e,r)),Et(e)||Ct(e))return async function(e){const t=[];for await(const r of e)t.push(r);return ae(...t)}(e);throw new Error(Dr)}(t,e,r),e.parseTextSync&&\"string\"==typeof t)return r.dataType=\"text\",e.parseTextSync(t,r,n,e);if(function(e,t){return!!Y.isSupported()&&!!(L||null!=t&&t._nodeWorkers)&&e.worker&&(null==t?void 0:t.worker)}(e,r))return await ie(e,t,r,n,Gr);if(e.parseText&&\"string\"==typeof t)return await e.parseText(t,r,n,e);if(e.parse)return await e.parse(t,r,n,e);throw E(!e.parseSync),new Error(\"\".concat(e.id,\" loader - no parser found and worker is disabled\"))}(s,e,r,n)):null}async function Wr(e,t,r){if(function(e,t){return!!Y.isSupported()&&!!(I||null!=t&&t._nodeWorkers)&&e.worker&&(null==t?void 0:t.worker)}(t,r={...yr(),...r}))return await ee(t,e,r);if(t.encode)return await t.encode(e,r);if(t.encodeSync)return t.encodeSync(e,r);if(t.encodeText)return(new TextEncoder).encode(await t.encodeText(e,r));if(t.encodeInBatches){const n=function(e,t,r){if(t.encodeInBatches){const n=function(e){return[{table:e,start:0,end:e.length}]}(e);return t.encodeInBatches(n,r)}throw new Error(\"Writer could not encode data in batches\")}(e,t,r),o=[];for await(const e of n)o.push(e);return ae(...o)}if(!I&&t.encodeURLtoURL){const n=Nr(\"input\");await async function(e,t,r){e=le(e),I||await(void 0)(e,t,{flag:\"w\"}),B(!1)}(n,e);const o=Nr(\"output\"),i=await async function(e,t,r,n){if(e=le(e),t=le(t),I||!r.encodeURLtoURL)throw new Error;return await r.encodeURLtoURL(e,t,n)}(n,o,t,r);return(await Qt(i)).arrayBuffer()}throw new Error(\"Writer could not encode data\")}function Nr(e){return\"/tmp/\".concat(e)}var Hr={0:{useSRGB:!0,qualityLevel:50,encodeUASTC:!0,mipmaps:!0},3:{useSRGB:!0,encodeUASTC:!0,qualityLevel:10,mipmaps:!1},1:{useSRGB:!1,encodeUASTC:!0,qualityLevel:50,mipmaps:!0},2:{useSRGB:!1,encodeUASTC:!0,qualityLevel:10,mipmaps:!1},4:{useSRGB:!1,encodeUASTC:!0,qualityLevel:10,mipmaps:!1}},Vr=/*#__PURE__*/j(\"texturesList\"),Qr=/*#__PURE__*/j(\"numObjects\"),Jr=/*#__PURE__*/j(\"meshUsedByObject\"),zr=/*#__PURE__*/j(\"removeUnusedTextures\"),qr=/*#__PURE__*/j(\"compressTextures\"),Kr=/*#__PURE__*/function(r){function n(e,n){var o;return o=r.call(this,e,{id:n.id})||this,Object.defineProperty(k(o),qr,{value:Xr}),Object.defineProperty(k(o),zr,{value:Yr}),o.scene=void 0,o.layerId=void 0,o.built=void 0,o.edgeThreshold=void 0,o.geometries=void 0,o.textures=void 0,o.textureSets=void 0,o.meshes=void 0,o.objects=void 0,o.aabb=void 0,o.onBuilt=void 0,o.rendererModel=void 0,Object.defineProperty(k(o),Vr,{writable:!0,value:void 0}),Object.defineProperty(k(o),Qr,{writable:!0,value:void 0}),Object.defineProperty(k(o),Jr,{writable:!0,value:void 0}),o.scene=e,o.onBuilt=new t(new a),o.onDestroyed=new t(new a),A(k(o),Qr)[Qr]=0,A(k(o),Jr)[Jr]={},o.id=n.id||\"default\",o.layerId=n.layerId,o.edgeThreshold=10,o.geometries={},o.textures={},A(k(o),Vr)[Vr]=[],o.textureSets={},o.meshes={},o.objects={},o.aabb=Ge(),o.built=!1,o.rendererModel=null,o.fromJSON(n),o}T(n,r);var o=n.prototype;return o.fromJSON=function(t){if(this.destroyed)return new e(\"Failed to add components to SceneModel - SceneModel already destroyed\");if(this.built)return new e(\"Failed to add components to SceneModel - SceneModel already built\");if(t.geometries)for(var r=0,n=t.geometries.length;r<n;r++)this.createGeometry(t.geometries[r]);if(t.textures)for(var o=0,i=t.textures.length;o<i;o++)this.createTexture(t.textures[o]);if(t.textureSets)for(var s=0,a=t.textureSets.length;s<a;s++)this.createTextureSet(t.textureSets[s]);if(t.meshes)for(var c=0,u=t.meshes.length;c<u;c++)this.createMesh(t.meshes[c]);if(t.objects)for(var l=0,d=t.objects.length;l<d;l++)this.createObject(t.objects[l])},o.createTransform=function(t){return this.destroyed?new e(\"Failed to create Transform in SceneModel - SceneModel already destroyed\"):this.built?new e(\"Failed to create Transform in SceneModel - SceneModel already built\"):void 0},o.createTexture=function(t){if(this.destroyed)return new e(\"Failed to create Texture in SceneModel - SceneModel already destroyed\");if(this.built)return new e(\"Failed to create Texture in SceneModel - SceneModel already built\");if(!t.imageData&&!t.src&&!t.buffers)return new e(\"Failed to create Texture in SceneModel - Parameter expected: textureParams.imageData, textureParams.src or textureParams.buffers\");if(this.textures[t.id])return new e(\"Failed to create Texture in SceneModel - Texture already exists with this ID: \"+t.id);t.src&&t.src.split(\".\").pop();var r=new Ze(t);return this.textures[t.id]=r,A(this,Vr)[Vr].push(r),r},o.createTextureSet=function(t){if(this.destroyed)return new e(\"Failed to create TextureSet in SceneModel - SceneModel already destroyed\");if(this.built)return new e(\"Failed to create TextureSet in SceneModel - SceneModel already built\");if(this.textureSets[t.id])return new e(\"Failed to create TextureSet in SceneModel - TextureSet already exists with this ID: \"+t.id);var r,n,o,i,s;if(null!=t.colorTextureId){if(!(r=this.textures[t.colorTextureId]))return new e(\"Failed to create TextureSet in SceneModel - Texture not found: \"+t.colorTextureId+\" - ensure that you create it first with createTexture()\");r.channel=0}if(null!=t.metallicRoughnessTextureId){if(!(n=this.textures[t.metallicRoughnessTextureId]))return new e(\"Failed to create TextureSet in SceneModel - Texture not found: \"+t.metallicRoughnessTextureId+\" - ensure that you create it first with createTexture()\");n.channel=1}if(null!=t.normalsTextureId){if(!(o=this.textures[t.normalsTextureId]))return new e(\"Failed to create TextureSet in SceneModel - Texture not found: \"+t.normalsTextureId+\" - ensure that you create it first with createTexture()\");o.channel=2}if(null!=t.emissiveTextureId){if(!(i=this.textures[t.emissiveTextureId]))return new e(\"Failed to create TextureSet in SceneModel - Texture not found: \"+t.emissiveTextureId+\" - ensure that you create it first with createTexture()\");i.channel=3}if(null!=t.occlusionTextureId){if(!(s=this.textures[t.occlusionTextureId]))return new e(\"Failed to create TextureSet in SceneModel - Texture not found: \"+t.occlusionTextureId+\" - ensure that you create it first with createTexture()\");s.channel=4}var a=new $e(t,{emissiveTexture:i,occlusionTexture:s,metallicRoughnessTexture:n,colorTexture:r});return this.textureSets[t.id]=a,a},o.createGeometry=function(t){if(this.destroyed)return new e(\"Failed to create Geometry in SceneModel - SceneModel already destroyed\");if(this.built)return new e(\"Failed to create Geometry in SceneModel - SceneModel already built\");if(!t)return new e(\"Failed to create Geometry in SceneModel - Parameters expected: geometryParams\");if(null==t.id)return new e(\"Failed to create Geometry in SceneModel - Parameter expected: geometryParams.id\");var r=t.id;if(this.geometries[r])return new e(\"Failed to create Geometry in SceneModel - Geometry with this ID already created: \"+r);var n=t.primitive;if(n!==Oe&&n!==Fe&&n!==Ue&&n!==Re&&n!==De)return new e(\"Failed to create Geometry in SceneModel - Unsupported value for geometryParams.primitive: '\"+n+\"' - supported values are PointsPrimitive, LinesPrimitive, TrianglesPrimitive, SolidPrimitive and SurfacePrimitive\");if(!t.positions)return new e(\"Failed to create Geometry in SceneModel - Param expected: geometryParams.positions\");if(!t.indices&&n!==Oe)return new e(\"Failed to create Geometry in SceneModel - Param expected: geometryParams.indices (required for primitive type)\");if(t.uvs&&t.uvs.length/2!=t.positions.length/3)return new e(\"Failed to create Geometry in SceneModel - mismatch between given quantities of vertex positions and UVs\");if(t.indices)for(var o=t.positions.length/3,i=0,s=t.indices.length;i<s;i++){var a=t.indices[i];if(a<0||a>=o)return new e(\"Failed to create Geometry in SceneModel - indices out of range of vertex positions\");if(t.uvs&&(a<0||a>=t.uvs.length/2))return new e(\"Failed to create Geometry in SceneModel - indices out of range of vertex UVs\")}var c=new Ve(jt(t));return this.geometries[r]=c,c},o.createGeometryCompressed=function(t){if(this.destroyed)return new e(\"Failed to add compressed Geometry to SceneModel - SceneModel already destroyed\");if(this.built)return new e(\"Failed to add compressed Geometry to SceneModel - SceneModel already built\");if(!t)return new e(\"Failed to add compressed Geometry to SceneModel - Parameters expected: geometryCompressedParams\");var r=t.id;if(this.geometries[r])return new e(\"Failed to add compressed Geometry to SceneModel - Geometry with this ID already created: \"+r);var n=t.primitive;if(n!==Oe&&n!==Fe&&n!==Ue&&n!==Re&&n!==De)return new e(\"Failed to add compressed Geometry to SceneModel - Unsupported value for geometryCompressedParams.primitive: '\"+n+\"' - supported values are PointsPrimitive, LinesPrimitive, TrianglesPrimitive, SolidPrimitive and SurfacePrimitive\");var o=new Ve(t);return this.geometries[r]=o,o},o.createMesh=function(t){if(this.destroyed)return new e(\"Failed to create Mesh in SceneModel - SceneModel already destroyed\");if(this.built)return new e(\"Failed to create Mesh in SceneModel - SceneModel already built\");if(this.meshes[t.id])return new e(\"Failed to create Mesh in SceneModel - Mesh already exists with this ID: \"+t.id);var r=this.geometries[t.geometryId];if(!r)return new e(\"Failed to create Mesh in SceneModel - Geometry not found: \"+t.geometryId);var n=t.textureSetId?this.textureSets[t.textureSetId]:void 0;if(t.textureSetId&&!n)return new e(\"Failed to create Mesh in SceneModel - TextureSet not found: \"+t.textureSetId);var o=new it({id:t.id,geometry:r,textureSet:n,matrix:t.matrix,color:t.color,opacity:t.opacity,roughness:t.roughness,metallic:t.metallic});return this.meshes[t.id]=o,o},o.createObject=function(t){if(this.destroyed)return new e(\"Failed to create SceneObject - SceneModel already destroyed\");if(this.built)return new e(\"Failed to create SceneObject SceneModel already built\");if(0===t.meshIds.length)return new e(\"Failed to create SceneObject - no meshes specified\");if(this.scene.objects[t.id])return new e(\"Failed to create SceneObject - SceneObject already exists in Scene: \"+t.id);for(var r=t.meshIds,n=[],o=0,i=r.length;o<i;o++){var s=r[o],a=this.meshes[s];if(!a)return new e(\"Failed to create SceneObject - Mesh not found: \"+s);if(A(this,Jr)[Jr][s])return new e(\"Failed to create SceneObject - Mesh \"+s+\" already belongs to another SceneObject\");n.push(a),A(this,Jr)[Jr][a.id]=!0}for(var c=new Xe({id:t.id,layerId:t.layerId||this.layerId,model:this,meshes:n}),u=0,l=n.length;u<l;u++)n[u].object=c;return A(this,Qr)[Qr]++,this.objects[t.id]=c,c},o.build=function(){try{var t=this;return Promise.resolve(new Promise(function(r){if(t.destroyed)throw new e(\"Failed to build SceneModel - SceneModel already destroyed\");if(t.built)throw new e(\"Failed to build SceneModel - SceneModel already built\");A(t,zr)[zr](),A(t,qr)[qr]().then(function(){t.built=!0,t.onBuilt.dispatch(t,null),r(t)}).catch(function(e){throw e})}))}catch(e){return Promise.reject(e)}},n}(r);function Yr(){}function Xr(){var t=this,r=A(this,Vr)[Vr].length;return new Promise(function(n){if(0!==r)for(var o=function(){var o=A(t,Vr)[Vr][i],s=Hr[o.channel]||{};if(o.src){var a=o.src;switch(a.split(\".\").pop()){case\"jpeg\":case\"jpg\":case\"png\":(async function(e,t,r,n){Array.isArray(t)||Sr(t)||(r=t,t=void 0);const o=vr(r);let i=e;return\"string\"==typeof e&&(i=await o(e)),Lt(e)&&(i=await o(e)),await Gr(i,t,r)})(a,Pe,{image:{type:\"data\"}}).then(function(t){o.compressed?Wr(t,me,s).then(function(e){var t=new Uint8Array(e);o.imageData=t,--r<=0&&n()}).catch(function(t){return new e(\"Failed to compress texture: \"+t)}):(o.imageData=new Uint8Array(1),--r<=0&&n())}).catch(function(t){return new e(\"Failed to load texture image: \"+t)});break;default:--r<=0&&n()}}o.imageData&&(o.compressed?Wr(o.imageData,me,s).then(function(e){o.imageData=new Uint8Array(e),--r<=0&&n()}).catch(function(t){return new e(\"Failed to compress texture: \"+t)}):(o.imageData=new Uint8Array(1),--r<=0&&n()))},i=0,s=A(t,Vr)[Vr].length;i<s;i++)o();else n()})}var $r=/*#__PURE__*/j(\"onModelBuilts\"),Zr=/*#__PURE__*/j(\"onModelDestroys\"),en=/*#__PURE__*/j(\"center\"),tn=/*#__PURE__*/j(\"aabbDirty\"),rn=/*#__PURE__*/j(\"aabb\"),nn=/*#__PURE__*/j(\"registerObjects\"),on=/*#__PURE__*/j(\"deregisterObjects\"),sn=/*#__PURE__*/function(r){function n(){var e;return e=r.call(this,null,{})||this,Object.defineProperty(k(e),on,{value:cn}),Object.defineProperty(k(e),nn,{value:an}),e.models=void 0,e.objects=void 0,e.onModelCreated=void 0,e.onModelDestroyed=void 0,Object.defineProperty(k(e),$r,{writable:!0,value:void 0}),Object.defineProperty(k(e),Zr,{writable:!0,value:void 0}),Object.defineProperty(k(e),en,{writable:!0,value:void 0}),Object.defineProperty(k(e),tn,{writable:!0,value:void 0}),Object.defineProperty(k(e),rn,{writable:!0,value:void 0}),A(k(e),rn)[rn]=Ge(),A(k(e),tn)[tn]=!0,e.models={},e.objects={},A(k(e),$r)[$r]={},A(k(e),Zr)[Zr]={},e.onModelCreated=new t(new a),e.onModelDestroyed=new t(new a),e}T(n,r);var s=n.prototype;return s.createModel=function(t){var r=this;if(this.destroyed)return new e(\"Scene already destroyed\");var n=t.id;if(this.models[n])return new e(\"SceneModel already created in this Scene: \"+n);var o=new Kr(this,t);return this.models[n]=o,o.onDestroyed.one(function(){delete r.models[o.id],A(r,on)[on](o),r.onModelDestroyed.dispatch(r,o)}),o.onBuilt.one(function(){A(r,nn)[nn](o),r.onModelCreated.dispatch(r,o)}),o},s.setAABBDirty=function(){A(this,tn)[tn]||(A(this,tn)[tn]=!0)},s.clear=function(){if(this.destroyed)return new e(\"Scene already destroyed\");for(var t in this.models)this.models[t].destroy()},s.destroy=function(){this.clear(),this.onModelCreated.clear(),this.onModelDestroyed.clear(),r.prototype.destroy.call(this)},S(n,[{key:\"center\",get:function(){if(A(this,tn)[tn]){var e=this.aabb;A(this,en)[en][0]=(e[0]+e[3])/2,A(this,en)[en][1]=(e[1]+e[4])/2,A(this,en)[en][2]=(e[2]+e[5])/2}return A(this,en)[en]}},{key:\"aabb\",get:function(){if(A(this,tn)[tn]){var e,t=o,r=o,n=o,s=i,a=i,c=i,u=this.objects,l=!1;for(var d in u)u.hasOwnProperty(d)&&((e=u[d].aabb)[0]<t&&(t=e[0]),e[1]<r&&(r=e[1]),e[2]<n&&(n=e[2]),e[3]>s&&(s=e[3]),e[4]>a&&(a=e[4]),e[5]>c&&(c=e[5]),l=!0);l||(t=-100,r=-100,n=-100,s=100,a=100,c=100),A(this,rn)[rn][0]=t,A(this,rn)[rn][1]=r,A(this,rn)[rn][2]=n,A(this,rn)[rn][3]=s,A(this,rn)[rn][4]=a,A(this,rn)[rn][5]=c,A(this,tn)[tn]=!1}return A(this,rn)[rn]}}]),n}(r);function an(e){var t=e.objects;for(var r in t){var n=t[r];this.objects[n.id]=n}A(this,tn)[tn]=!0}function cn(e){var t=e.objects;for(var r in t)delete this.objects[t[r].id];A(this,tn)[tn]=!0}export{Ve as Geometry,He as GeometryBucket,it as Mesh,sn as Scene,Kr as SceneModel,Xe as SceneObject,Ze as Texture,$e as TextureSet,jt as compressGeometryParams,qe as getSceneObjectGeometry};\n//# sourceMappingURL=index.es.map\n","import {GeometryView, getSceneObjectGeometry, SceneObject} from \"@xeokit/scene\";\nimport {\n    INSIDE,\n    INTERSECT,\n    OUTSIDE,\n    setFrustum3,\n    intersectFrustum3AABB3,\n    intersectFrustum3Point3\n} from \"@xeokit/boundaries\";\nimport {FloatArrayParam} from \"@xeokit/math\";\nimport {createMat4, createVec4, transformPoint4} from \"@xeokit/matrix\";\nimport {KdTree2} from \"./KdTree2\";\nimport {KdVertex2} from \"./KdVertex2\";\n\n/**\n * A k-d tree to accelerate intersection and nearest-neighbour tests on the projected\n * 2D canvas positions of {@link @xeokit/scene!SceneObject} geometry vertices.\n *\n * See {@link \"@xeokit/kd-canvas-verts\"} for usage.\n */\nexport function createKdTree2FromSceneObjectVerts(params: {\n    viewMatrix: FloatArrayParam,\n    projMatrix: FloatArrayParam,\n    canvasBoundary: FloatArrayParam,\n    sceneObjects: SceneObject[]\n}): KdTree2 {\n\n    const kdTree2D = new KdTree2({\n        aabb: params.canvasBoundary\n    });\n\n    const viewMatrix = createMat4(params.viewMatrix);\n    const projMatrix = createMat4(params.projMatrix);\n    const frustum = setFrustum3(viewMatrix, projMatrix);\n    const canvasBoundary = params.canvasBoundary;\n    const sceneObjects = params.sceneObjects;\n\n    if (sceneObjects) {\n        for (let i = 0, len = sceneObjects.length; i < len; i++) {\n            insertSceneObject(sceneObjects[i]);\n        }\n    }\n\n    function insertSceneObject(sceneObject: SceneObject, intersects: number = INTERSECT) {\n        if (intersects !== INSIDE) {\n            intersects = intersectFrustum3AABB3(frustum, sceneObject.aabb);\n        }\n        if (intersects === OUTSIDE) {\n            return;\n        }\n        getSceneObjectGeometry(sceneObject,\n            (geometryView: GeometryView): boolean | undefined => {\n                const positionsWorld = geometryView.positionsWorld;\n                for (let i = 0, len = positionsWorld.length; i < len; i += 3) {\n                    const worldPos = createVec4();\n                    worldPos[0] = positionsWorld[i];\n                    worldPos[1] = positionsWorld[i + 1];\n                    worldPos[2] = positionsWorld[i + 2];\n                    worldPos[3] = 1.0;\n                    if (intersects === INSIDE || intersectFrustum3Point3(frustum, worldPos)) {\n                        insertVertex(sceneObject, worldPos);\n                    }\n                }\n                return false;\n            });\n    }\n\n    function insertVertex(sceneObject: SceneObject, worldPos: FloatArrayParam) {\n        const viewPos = createVec4();\n        const projPos = createVec4();\n        const canvasPos = new Uint16Array(2);\n        transformPoint4(viewMatrix, worldPos, viewPos);\n        transformPoint4(projMatrix, viewPos, projPos);\n        canvasPos[0] = Math.floor((1 + projPos[0] / projPos[3]) * canvasBoundary[2] / 2);\n        canvasPos[1] = Math.floor((1 - projPos[1] / projPos[3]) * canvasBoundary[3] / 2);\n        kdTree2D.insertItem(<KdVertex2>{sceneObject, worldPos, canvasPos}, [canvasPos[0], canvasPos[1], canvasPos[0], canvasPos[1]]);\n    }\n\n    return kdTree2D;\n}\n","import {FloatArrayParam} from \"@xeokit/math\";\nimport {SceneObject} from \"@xeokit/scene\";\nimport {KdTree2} from \"./KdTree2\";\n\n/**\n *\n */\nexport function searchKdTree2ForNearestNeighbor(params: {\n    kdTree: KdTree2,\n    canvasPos: FloatArrayParam\n}): SceneObject[] {\n    const kdTree = params.kdTree;\n    const canvasPos = params.canvasPos;\n    const sceneObjects = [];\n\n//...\n\n    return sceneObjects;\n}\n","import {SceneObject} from \"@xeokit/scene\";\nimport {FloatArrayParam, IntArrayParam} from \"@xeokit/math\";\n\n/**\n * TODO\n */\nexport class KdVertex2 {\n    sceneObject: SceneObject;\n    worldPos: FloatArrayParam;\n    canvasPos: IntArrayParam;\n}"],"names":["r","Float64Array","M","n","s","FloatArrayClass","cn","t","mn","c","v","l","g","R","testVertex","offset","normal","this","prototype","set","e","o","Math","sqrt","W","planes","kdTreeDimLength","Float32Array","_insertItem","_classPrivateFieldLooseKey","KdTree2","constructor","params","Object","defineProperty","value","_insertItem2","root","maxDepth","aabb","slice","insertItem","item","_classPrivateFieldLooseBase","node","depth","items","push","left","containsAABB2","right","nodeAABB","dim","aabbLeft","aabbRight","exports","DispatcherWrapper","dispatcher","_subscribe","fn","subscribe","_unsubscribe","unsubscribe","_one","one","_has","has","_clear","clear","_count","count","_onSubscriptionChange","onSubscriptionChange","sub","unsub","Subscription","handler","isOnce","isExecuted","execute","executeAsync","scope","args","setTimeout","apply","EventManagement","propagationStopped","stopPropagation","SubscriptionChangeEventDispatcher","DispatcherBase","_subscriptions","Array","length","asEvent","createSubscription","triggerSubscriptionChange","some","changes","i","splice","_dispatch","ev","EventManagement_1","nargs","call","cleanup","Subscription_1","indexOf","_wrap","DispatcherWrapper_1","dispatch","arguments","DispatchError","Error","message","super","EventListBase","_events","get","name","event","createDispatcher","remove","HandlingBase","events","PromiseSubscription","async","result","PromiseDispatcherBase","DispatcherBase_1","DispatchError_1","PromiseSubscription_1","ps","enumerable","EventListBase_1","HandlingBase_1","PromiseDispatcherBase_1","EventDispatcher","ste_core_1","sender","dispatchAsync","EventList","EventDispatcher_1","EventHandlingBase","EventList_1","NonUniformEventList","EventHandlingBase_1","NonUniformEventList_1","SimpleEventDispatcher","SimpleEventList","SimpleEventDispatcher_1","SimpleEventHandlingBase","SimpleEventList_1","NonUniformSimpleEventList","SimpleEventHandlingBase_1","NonUniformSimpleEventList_1","SignalDispatcher","SignalList","SignalDispatcher_1","SignalHandlingBase","SignalList_1","SignalHandlingBase_1","PromiseEventDispatcher","_dispatchAsPromise","PromiseEventList","PromiseEventDispatcher_1","PromiseEventHandlingBase","PromiseEventList_1","NonUniformPromiseEventList","PromiseEventHandlingBase_1","NonUniformPromiseEventList_1","PromiseSignalDispatcher","PromiseSignalList","PromiseSignalDispatcher_1","PromiseSignalHandlingBase","PromiseSignalList_1","PromiseSignalHandlingBase_1","PromiseSimpleEventDispatcher","NonUniformPromiseSimpleEventList","PromiseSimpleEventDispatcher_1","PromiseSimpleEventList","PromiseSimpleEventHandlingBase","PromiseSimpleEventList_1","NonUniformPromiseSimpleEventList_1","PromiseSimpleEventHandlingBase_1","ste_events_1","ste_simple_events_1","ste_signals_1","ste_promise_events_1","ste_promise_signals_1","ste_promise_simple_events_1","_","j","A","hasOwnProperty","TypeError","configurable","writable","Symbol","toPrimitive","String","key","x","u","a","f","h","d","q","X","Y","Z","b","y","w","createKdTree2FromSceneObjectVerts","kdTree2D","canvasBoundary","viewMatrix","createMat4","projMatrix","frustum","p","F","m","C","k","z","B","D","V","setFrustum3","sceneObjects","len","insertSceneObject","sceneObject","intersects","intersectFrustum3AABB3","getSceneObjectGeometry","geometryView","positionsWorld","worldPos","createVec4","insertVertex","viewPos","projPos","canvasPos","Uint16Array","transformPoint4","floor","searchKdTree2ForNearestNeighbor","KdVertex2"],"mappings":"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"}