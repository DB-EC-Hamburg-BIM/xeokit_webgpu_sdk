import{decompressPositions3 as e}from"@xeokit/compression";import"@xeokit/core";function t(){return t=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},t.apply(this,arguments)}var n=0;function r(e){return"__private_"+n+++"_"+e}function i(e,t){if(!Object.prototype.hasOwnProperty.call(e,t))throw new TypeError("attempted to use private field on non-instance");return e}var s=Float64Array;function o(e){return new Float64Array(e||3)}function a(e){return new FloatArrayClass(e||4)}function c(e){return new s(e||16)}function u(e,t,n){return n[0]=e[0]*t[0]+e[4]*t[1]+e[8]*t[2]+e[12]*t[3],n[1]=e[1]*t[0]+e[5]*t[1]+e[9]*t[2]+e[13]*t[3],n[2]=e[2]*t[0]+e[6]*t[1]+e[10]*t[2]+e[14]*t[3],n[3]=e[3]*t[0]+e[7]*t[1]+e[11]*t[2]+e[15]*t[3],n}a(),a(),new FloatArrayClass(2);var l=o(),p=o(),h=c();function d(e,t){return e[0]<=t[0]&&t[3]<=e[3]&&e[1]<=t[1]&&e[2]<=t[2]}var f=/*#__PURE__*/function(){function e(){this.testVertex=void 0,this.offset=void 0,this.normal=void 0,this.normal=o(),this.offset=0,this.testVertex=o()}return e.prototype.set=function(e,t,n,r){var i=1/Math.sqrt(e*e+t*t+n*n);this.normal[0]=e*i,this.normal[1]=t*i,this.normal[2]=n*i,this.offset=r*i,this.testVertex[0]=this.normal[0]>=0?1:0,this.testVertex[1]=this.normal[1]>=0?1:0,this.testVertex[2]=this.normal[2]>=0?1:0},e}(),g=function(){this.planes=void 0,this.planes=[new f,new f,new f,new f,new f,new f]};const m=new Float32Array(2);var v=/*#__PURE__*/r("insertItem");class b{constructor(e){Object.defineProperty(this,v,{value:y}),this.root=void 0,this.maxDepth=void 0,this.maxDepth=(null==e?void 0:e.maxDepth)||10,this.root={aabb:e.aabb.slice()}}insertItem(e,t){i(this,v)[v](this.root,{item:e},t,1)}}function y(e,t,n,r){if(r>=this.maxDepth)return e.items=e.items||[],void e.items.push(t);if(e.left&&d(e.left.aabb,n))return void i(this,v)[v](e.left,t,n,r+1);if(e.right&&d(e.right.aabb,n))return void i(this,v)[v](e.right,t,n,r+1);const s=e.aabb;m[0]=s[2]-s[0],m[1]=s[3]-s[1];let o=0;if(m[1]>m[o]&&(o=1),!e.left){const a=s.slice();if(a[o+2]=(s[o]+s[o+2])/2,e.left={aabb:a},d(a,n))return void i(this,v)[v](e.left,t,n,r+1)}if(!e.right){const a=s.slice();if(a[o]=(s[o]+s[o+2])/2,e.right={aabb:a},d(a,n))return void i(this,v)[v](e.right,t,n,r+1)}e.items=e.items||[],e.items.push(t)}function E(e){var t={exports:{}};return e(t,t.exports),t.exports}var P=E(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.DispatcherWrapper=void 0,t.DispatcherWrapper=class{constructor(e){this._subscribe=t=>e.subscribe(t),this._unsubscribe=t=>e.unsubscribe(t),this._one=t=>e.one(t),this._has=t=>e.has(t),this._clear=()=>e.clear(),this._count=()=>e.count,this._onSubscriptionChange=()=>e.onSubscriptionChange}get onSubscriptionChange(){return this._onSubscriptionChange()}get count(){return this._count()}subscribe(e){return this._subscribe(e)}sub(e){return this.subscribe(e)}unsubscribe(e){this._unsubscribe(e)}unsub(e){this.unsubscribe(e)}one(e){return this._one(e)}has(e){return this._has(e)}clear(){this._clear()}}}),_=E(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.Subscription=void 0,t.Subscription=class{constructor(e,t){this.handler=e,this.isOnce=t,this.isExecuted=!1}execute(e,t,n){if(!this.isOnce||!this.isExecuted){this.isExecuted=!0;var r=this.handler;e?setTimeout(()=>{r.apply(t,n)},1):r.apply(t,n)}}}}),S=E(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.EventManagement=void 0,t.EventManagement=class{constructor(e){this.unsub=e,this.propagationStopped=!1}stopPropagation(){this.propagationStopped=!0}}}),w=E(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.SubscriptionChangeEventDispatcher=t.DispatcherBase=void 0;class n{constructor(){this._subscriptions=new Array}get count(){return this._subscriptions.length}get onSubscriptionChange(){return null==this._onSubscriptionChange&&(this._onSubscriptionChange=new r),this._onSubscriptionChange.asEvent()}subscribe(e){return e&&(this._subscriptions.push(this.createSubscription(e,!1)),this.triggerSubscriptionChange()),()=>{this.unsubscribe(e)}}sub(e){return this.subscribe(e)}one(e){return e&&(this._subscriptions.push(this.createSubscription(e,!0)),this.triggerSubscriptionChange()),()=>{this.unsubscribe(e)}}has(e){return!!e&&this._subscriptions.some(t=>t.handler==e)}unsubscribe(e){if(!e)return;let t=!1;for(let n=0;n<this._subscriptions.length;n++)if(this._subscriptions[n].handler==e){this._subscriptions.splice(n,1),t=!0;break}t&&this.triggerSubscriptionChange()}unsub(e){this.unsubscribe(e)}_dispatch(e,t,n){for(let r of[...this._subscriptions]){let i=new S.EventManagement(()=>this.unsub(r.handler)),s=Array.prototype.slice.call(n);if(s.push(i),r.execute(e,t,s),this.cleanup(r),!e&&i.propagationStopped)return{propagationStopped:!0}}return e?null:{propagationStopped:!1}}createSubscription(e,t){return new _.Subscription(e,t)}cleanup(e){let t=!1;if(e.isOnce&&e.isExecuted){let n=this._subscriptions.indexOf(e);n>-1&&(this._subscriptions.splice(n,1),t=!0)}t&&this.triggerSubscriptionChange()}asEvent(){return null==this._wrap&&(this._wrap=new P.DispatcherWrapper(this)),this._wrap}clear(){0!=this._subscriptions.length&&(this._subscriptions.splice(0,this._subscriptions.length),this.triggerSubscriptionChange())}triggerSubscriptionChange(){null!=this._onSubscriptionChange&&this._onSubscriptionChange.dispatch(this.count)}}t.DispatcherBase=n;class r extends n{dispatch(e){this._dispatch(!1,this,arguments)}}t.SubscriptionChangeEventDispatcher=r}),j=E(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.DispatchError=void 0;class n extends Error{constructor(e){super(e)}}t.DispatchError=n}),D=E(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.EventListBase=void 0,t.EventListBase=class{constructor(){this._events={}}get(e){let t=this._events[e];return t||(t=this.createDispatcher(),this._events[e]=t,t)}remove(e){delete this._events[e]}}}),L=E(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.HandlingBase=void 0,t.HandlingBase=class{constructor(e){this.events=e}one(e,t){this.events.get(e).one(t)}has(e,t){return this.events.get(e).has(t)}subscribe(e,t){this.events.get(e).subscribe(t)}sub(e,t){this.subscribe(e,t)}unsubscribe(e,t){this.events.get(e).unsubscribe(t)}unsub(e,t){this.unsubscribe(e,t)}}}),O=E(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.PromiseSubscription=void 0,t.PromiseSubscription=class{constructor(e,t){this.handler=e,this.isOnce=t,this.isExecuted=!1}async execute(e,t,n){if(!this.isOnce||!this.isExecuted){this.isExecuted=!0;var r=this.handler;if(e)return void setTimeout(()=>{r.apply(t,n)},1);let i=r.apply(t,n);await i}}}}),B=E(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.PromiseDispatcherBase=void 0,t.PromiseDispatcherBase=class extends w.DispatcherBase{_dispatch(e,t,n){throw new j.DispatchError("_dispatch not supported. Use _dispatchAsPromise.")}createSubscription(e,t){return new O.PromiseSubscription(e,t)}async _dispatchAsPromise(e,t,n){for(let r of[...this._subscriptions]){let i=new S.EventManagement(()=>this.unsub(r.handler)),s=Array.prototype.slice.call(n);s.push(i);let o=r;if(await o.execute(e,t,s),this.cleanup(r),!e&&i.propagationStopped)return{propagationStopped:!0}}return e?null:{propagationStopped:!1}}}}),x=E(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.SubscriptionChangeEventDispatcher=t.HandlingBase=t.PromiseDispatcherBase=t.PromiseSubscription=t.DispatchError=t.EventManagement=t.EventListBase=t.DispatcherWrapper=t.DispatcherBase=t.Subscription=void 0,Object.defineProperty(t,"DispatcherBase",{enumerable:!0,get:function(){return w.DispatcherBase}}),Object.defineProperty(t,"SubscriptionChangeEventDispatcher",{enumerable:!0,get:function(){return w.SubscriptionChangeEventDispatcher}}),Object.defineProperty(t,"DispatchError",{enumerable:!0,get:function(){return j.DispatchError}}),Object.defineProperty(t,"DispatcherWrapper",{enumerable:!0,get:function(){return P.DispatcherWrapper}}),Object.defineProperty(t,"EventListBase",{enumerable:!0,get:function(){return D.EventListBase}}),Object.defineProperty(t,"EventManagement",{enumerable:!0,get:function(){return S.EventManagement}}),Object.defineProperty(t,"HandlingBase",{enumerable:!0,get:function(){return L.HandlingBase}}),Object.defineProperty(t,"PromiseDispatcherBase",{enumerable:!0,get:function(){return B.PromiseDispatcherBase}}),Object.defineProperty(t,"PromiseSubscription",{enumerable:!0,get:function(){return O.PromiseSubscription}}),Object.defineProperty(t,"Subscription",{enumerable:!0,get:function(){return _.Subscription}})}),M=E(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.EventDispatcher=void 0,t.EventDispatcher=class extends x.DispatcherBase{constructor(){super()}dispatch(e,t){const n=this._dispatch(!1,this,arguments);if(null==n)throw new x.DispatchError("Got `null` back from dispatch.");return n}dispatchAsync(e,t){this._dispatch(!0,this,arguments)}asEvent(){return super.asEvent()}}}),H=E(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.EventList=void 0,t.EventList=class extends x.EventListBase{constructor(){super()}createDispatcher(){return new M.EventDispatcher}}}),k=E(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.EventHandlingBase=void 0,t.EventHandlingBase=class extends x.HandlingBase{constructor(){super(new H.EventList)}}}),C=E(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.NonUniformEventList=void 0,t.NonUniformEventList=class{constructor(){this._events={}}get(e){if(this._events[e])return this._events[e];const t=this.createDispatcher();return this._events[e]=t,t}remove(e){delete this._events[e]}createDispatcher(){return new M.EventDispatcher}}}),N=E(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.NonUniformEventList=t.EventList=t.EventHandlingBase=t.EventDispatcher=void 0,Object.defineProperty(t,"EventDispatcher",{enumerable:!0,get:function(){return M.EventDispatcher}}),Object.defineProperty(t,"EventHandlingBase",{enumerable:!0,get:function(){return k.EventHandlingBase}}),Object.defineProperty(t,"EventList",{enumerable:!0,get:function(){return H.EventList}}),Object.defineProperty(t,"NonUniformEventList",{enumerable:!0,get:function(){return C.NonUniformEventList}})}),A=E(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.SimpleEventDispatcher=void 0,t.SimpleEventDispatcher=class extends x.DispatcherBase{constructor(){super()}dispatch(e){const t=this._dispatch(!1,this,arguments);if(null==t)throw new x.DispatchError("Got `null` back from dispatch.");return t}dispatchAsync(e){this._dispatch(!0,this,arguments)}asEvent(){return super.asEvent()}}}),T=E(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.SimpleEventList=void 0,t.SimpleEventList=class extends x.EventListBase{constructor(){super()}createDispatcher(){return new A.SimpleEventDispatcher}}}),U=E(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.SimpleEventHandlingBase=void 0,t.SimpleEventHandlingBase=class extends x.HandlingBase{constructor(){super(new T.SimpleEventList)}}}),W=E(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.NonUniformSimpleEventList=void 0,t.NonUniformSimpleEventList=class{constructor(){this._events={}}get(e){if(this._events[e])return this._events[e];const t=this.createDispatcher();return this._events[e]=t,t}remove(e){delete this._events[e]}createDispatcher(){return new A.SimpleEventDispatcher}}}),I=E(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.NonUniformSimpleEventList=t.SimpleEventList=t.SimpleEventHandlingBase=t.SimpleEventDispatcher=void 0,Object.defineProperty(t,"SimpleEventDispatcher",{enumerable:!0,get:function(){return A.SimpleEventDispatcher}}),Object.defineProperty(t,"SimpleEventHandlingBase",{enumerable:!0,get:function(){return U.SimpleEventHandlingBase}}),Object.defineProperty(t,"NonUniformSimpleEventList",{enumerable:!0,get:function(){return W.NonUniformSimpleEventList}}),Object.defineProperty(t,"SimpleEventList",{enumerable:!0,get:function(){return T.SimpleEventList}})}),R=E(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.SignalDispatcher=void 0,t.SignalDispatcher=class extends x.DispatcherBase{dispatch(){const e=this._dispatch(!1,this,arguments);if(null==e)throw new x.DispatchError("Got `null` back from dispatch.");return e}dispatchAsync(){this._dispatch(!0,this,arguments)}asEvent(){return super.asEvent()}}}),F=E(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.SignalList=void 0,t.SignalList=class extends x.EventListBase{constructor(){super()}createDispatcher(){return new R.SignalDispatcher}}}),G=E(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.SignalHandlingBase=void 0,t.SignalHandlingBase=class extends x.HandlingBase{constructor(){super(new F.SignalList)}}}),V=E(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.SignalList=t.SignalHandlingBase=t.SignalDispatcher=void 0,Object.defineProperty(t,"SignalDispatcher",{enumerable:!0,get:function(){return R.SignalDispatcher}}),Object.defineProperty(t,"SignalHandlingBase",{enumerable:!0,get:function(){return G.SignalHandlingBase}}),Object.defineProperty(t,"SignalList",{enumerable:!0,get:function(){return F.SignalList}})}),Q=E(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.PromiseEventDispatcher=void 0,t.PromiseEventDispatcher=class extends x.PromiseDispatcherBase{constructor(){super()}async dispatch(e,t){const n=await this._dispatchAsPromise(!1,this,arguments);if(null==n)throw new x.DispatchError("Got `null` back from dispatch.");return n}dispatchAsync(e,t){this._dispatchAsPromise(!0,this,arguments)}asEvent(){return super.asEvent()}}}),Y=E(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.PromiseEventList=void 0,t.PromiseEventList=class extends x.EventListBase{constructor(){super()}createDispatcher(){return new Q.PromiseEventDispatcher}}}),J=E(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.PromiseEventHandlingBase=void 0,t.PromiseEventHandlingBase=class extends x.HandlingBase{constructor(){super(new Y.PromiseEventList)}}}),K=E(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.NonUniformPromiseEventList=void 0,t.NonUniformPromiseEventList=class{constructor(){this._events={}}get(e){if(this._events[e])return this._events[e];const t=this.createDispatcher();return this._events[e]=t,t}remove(e){delete this._events[e]}createDispatcher(){return new Q.PromiseEventDispatcher}}}),z=E(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.NonUniformPromiseEventList=t.PromiseEventList=t.PromiseEventHandlingBase=t.PromiseEventDispatcher=void 0,Object.defineProperty(t,"PromiseEventDispatcher",{enumerable:!0,get:function(){return Q.PromiseEventDispatcher}}),Object.defineProperty(t,"PromiseEventHandlingBase",{enumerable:!0,get:function(){return J.PromiseEventHandlingBase}}),Object.defineProperty(t,"PromiseEventList",{enumerable:!0,get:function(){return Y.PromiseEventList}}),Object.defineProperty(t,"NonUniformPromiseEventList",{enumerable:!0,get:function(){return K.NonUniformPromiseEventList}})}),q=E(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.PromiseSignalDispatcher=void 0,t.PromiseSignalDispatcher=class extends x.PromiseDispatcherBase{constructor(){super()}async dispatch(){const e=await this._dispatchAsPromise(!1,this,arguments);if(null==e)throw new x.DispatchError("Got `null` back from dispatch.");return e}dispatchAsync(){this._dispatchAsPromise(!0,this,arguments)}asEvent(){return super.asEvent()}}}),X=E(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.PromiseSignalList=void 0,t.PromiseSignalList=class extends x.EventListBase{constructor(){super()}createDispatcher(){return new q.PromiseSignalDispatcher}}}),Z=E(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.PromiseSignalHandlingBase=void 0,t.PromiseSignalHandlingBase=class extends x.HandlingBase{constructor(){super(new X.PromiseSignalList)}}}),$=E(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.PromiseSignalList=t.PromiseSignalHandlingBase=t.PromiseSignalDispatcher=void 0,Object.defineProperty(t,"PromiseSignalDispatcher",{enumerable:!0,get:function(){return q.PromiseSignalDispatcher}}),Object.defineProperty(t,"PromiseSignalHandlingBase",{enumerable:!0,get:function(){return Z.PromiseSignalHandlingBase}}),Object.defineProperty(t,"PromiseSignalList",{enumerable:!0,get:function(){return X.PromiseSignalList}})}),ee=E(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.PromiseSimpleEventDispatcher=void 0,t.PromiseSimpleEventDispatcher=class extends x.PromiseDispatcherBase{constructor(){super()}async dispatch(e){const t=await this._dispatchAsPromise(!1,this,arguments);if(null==t)throw new x.DispatchError("Got `null` back from dispatch.");return t}dispatchAsync(e){this._dispatchAsPromise(!0,this,arguments)}asEvent(){return super.asEvent()}}}),te=E(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.NonUniformPromiseSimpleEventList=void 0,t.NonUniformPromiseSimpleEventList=class{constructor(){this._events={}}get(e){if(this._events[e])return this._events[e];const t=this.createDispatcher();return this._events[e]=t,t}remove(e){delete this._events[e]}createDispatcher(){return new ee.PromiseSimpleEventDispatcher}}}),ne=E(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.PromiseSimpleEventList=void 0,t.PromiseSimpleEventList=class extends x.EventListBase{constructor(){super()}createDispatcher(){return new ee.PromiseSimpleEventDispatcher}}}),re=E(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.PromiseSimpleEventHandlingBase=void 0,t.PromiseSimpleEventHandlingBase=class extends x.HandlingBase{constructor(){super(new ne.PromiseSimpleEventList)}}}),ie=E(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.NonUniformPromiseSimpleEventList=t.PromiseSimpleEventList=t.PromiseSimpleEventHandlingBase=t.PromiseSimpleEventDispatcher=void 0,Object.defineProperty(t,"NonUniformPromiseSimpleEventList",{enumerable:!0,get:function(){return te.NonUniformPromiseSimpleEventList}}),Object.defineProperty(t,"PromiseSimpleEventDispatcher",{enumerable:!0,get:function(){return ee.PromiseSimpleEventDispatcher}}),Object.defineProperty(t,"PromiseSimpleEventHandlingBase",{enumerable:!0,get:function(){return re.PromiseSimpleEventHandlingBase}}),Object.defineProperty(t,"PromiseSimpleEventList",{enumerable:!0,get:function(){return ne.PromiseSimpleEventList}})});E(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.NonUniformPromiseSimpleEventList=t.PromiseSimpleEventList=t.PromiseSimpleEventHandlingBase=t.PromiseSimpleEventDispatcher=t.PromiseSignalList=t.PromiseSignalHandlingBase=t.PromiseSignalDispatcher=t.NonUniformPromiseEventList=t.PromiseEventList=t.PromiseEventHandlingBase=t.PromiseEventDispatcher=t.SignalList=t.SignalHandlingBase=t.SignalDispatcher=t.NonUniformSimpleEventList=t.SimpleEventList=t.SimpleEventHandlingBase=t.SimpleEventDispatcher=t.NonUniformEventList=t.EventList=t.EventHandlingBase=t.EventDispatcher=t.HandlingBase=t.PromiseDispatcherBase=t.PromiseSubscription=t.DispatchError=t.EventManagement=t.EventListBase=t.DispatcherWrapper=t.DispatcherBase=t.Subscription=void 0,Object.defineProperty(t,"Subscription",{enumerable:!0,get:function(){return x.Subscription}}),Object.defineProperty(t,"DispatcherBase",{enumerable:!0,get:function(){return x.DispatcherBase}}),Object.defineProperty(t,"DispatcherWrapper",{enumerable:!0,get:function(){return x.DispatcherWrapper}}),Object.defineProperty(t,"EventListBase",{enumerable:!0,get:function(){return x.EventListBase}}),Object.defineProperty(t,"EventManagement",{enumerable:!0,get:function(){return x.EventManagement}}),Object.defineProperty(t,"DispatchError",{enumerable:!0,get:function(){return x.DispatchError}}),Object.defineProperty(t,"PromiseSubscription",{enumerable:!0,get:function(){return x.PromiseSubscription}}),Object.defineProperty(t,"PromiseDispatcherBase",{enumerable:!0,get:function(){return x.PromiseDispatcherBase}}),Object.defineProperty(t,"HandlingBase",{enumerable:!0,get:function(){return x.HandlingBase}}),Object.defineProperty(t,"EventDispatcher",{enumerable:!0,get:function(){return N.EventDispatcher}}),Object.defineProperty(t,"EventHandlingBase",{enumerable:!0,get:function(){return N.EventHandlingBase}}),Object.defineProperty(t,"EventList",{enumerable:!0,get:function(){return N.EventList}}),Object.defineProperty(t,"NonUniformEventList",{enumerable:!0,get:function(){return N.NonUniformEventList}}),Object.defineProperty(t,"SimpleEventDispatcher",{enumerable:!0,get:function(){return I.SimpleEventDispatcher}}),Object.defineProperty(t,"SimpleEventHandlingBase",{enumerable:!0,get:function(){return I.SimpleEventHandlingBase}}),Object.defineProperty(t,"SimpleEventList",{enumerable:!0,get:function(){return I.SimpleEventList}}),Object.defineProperty(t,"NonUniformSimpleEventList",{enumerable:!0,get:function(){return I.NonUniformSimpleEventList}}),Object.defineProperty(t,"SignalDispatcher",{enumerable:!0,get:function(){return V.SignalDispatcher}}),Object.defineProperty(t,"SignalHandlingBase",{enumerable:!0,get:function(){return V.SignalHandlingBase}}),Object.defineProperty(t,"SignalList",{enumerable:!0,get:function(){return V.SignalList}}),Object.defineProperty(t,"PromiseEventDispatcher",{enumerable:!0,get:function(){return z.PromiseEventDispatcher}}),Object.defineProperty(t,"PromiseEventHandlingBase",{enumerable:!0,get:function(){return z.PromiseEventHandlingBase}}),Object.defineProperty(t,"PromiseEventList",{enumerable:!0,get:function(){return z.PromiseEventList}}),Object.defineProperty(t,"NonUniformPromiseEventList",{enumerable:!0,get:function(){return z.NonUniformPromiseEventList}}),Object.defineProperty(t,"PromiseSignalDispatcher",{enumerable:!0,get:function(){return $.PromiseSignalDispatcher}}),Object.defineProperty(t,"PromiseSignalHandlingBase",{enumerable:!0,get:function(){return $.PromiseSignalHandlingBase}}),Object.defineProperty(t,"PromiseSignalList",{enumerable:!0,get:function(){return $.PromiseSignalList}}),Object.defineProperty(t,"PromiseSimpleEventDispatcher",{enumerable:!0,get:function(){return ie.PromiseSimpleEventDispatcher}}),Object.defineProperty(t,"PromiseSimpleEventHandlingBase",{enumerable:!0,get:function(){return ie.PromiseSimpleEventHandlingBase}}),Object.defineProperty(t,"PromiseSimpleEventList",{enumerable:!0,get:function(){return ie.PromiseSimpleEventList}}),Object.defineProperty(t,"NonUniformPromiseSimpleEventList",{enumerable:!0,get:function(){return ie.NonUniformPromiseSimpleEventList}})});var se=0;function oe(e){return"__private_"+se+++"_"+e}function ae(e,t){if(!Object.prototype.hasOwnProperty.call(e,t))throw new TypeError("attempted to use private field on non-instance");return e}function ce(e,t){if(!e)throw new Error(t||"loaders.gl assertion failed.")}Boolean("object"!=typeof process||"[object process]"!==String(process)||process.browser),"undefined"!=typeof process&&process.version&&/v([0-9]*)/.exec(process.version);const ue="object"!=typeof process||"[object process]"!==String(process)||process.browser,le="undefined"!=typeof window&&void 0!==window.orientation;function pe(e){return pe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},pe(e)}function he(e,t,n){return(t=function(e){var t=function(e,t){if("object"!==pe(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==pe(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===pe(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}"undefined"!=typeof process&&process.version&&/v([0-9]*)/.exec(process.version);class de{constructor(e,t){he(this,"name",void 0),he(this,"workerThread",void 0),he(this,"isRunning",!0),he(this,"result",void 0),he(this,"_resolve",()=>{}),he(this,"_reject",()=>{}),this.name=e,this.workerThread=t,this.result=new Promise((e,t)=>{this._resolve=e,this._reject=t})}postMessage(e,t){this.workerThread.postMessage({source:"loaders.gl",type:e,payload:t})}done(e){ce(this.isRunning),this.isRunning=!1,this._resolve(e)}error(e){ce(this.isRunning),this.isRunning=!1,this._reject(e)}}class fe{terminate(){}}const ge=new Map;function me(e){const t=new Blob([e],{type:"application/javascript"});return URL.createObjectURL(t)}function ve(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2?arguments[2]:void 0;const r=n||new Set;if(e)if(be(e))r.add(e);else if(be(e.buffer))r.add(e.buffer);else if(ArrayBuffer.isView(e));else if(t&&"object"==typeof e)for(const n in e)ve(e[n],t,r);return void 0===n?Array.from(r):[]}function be(e){return!!e&&(e instanceof ArrayBuffer||"undefined"!=typeof MessagePort&&e instanceof MessagePort||"undefined"!=typeof ImageBitmap&&e instanceof ImageBitmap||"undefined"!=typeof OffscreenCanvas&&e instanceof OffscreenCanvas)}const ye=()=>{};class Ee{static isSupported(){return"undefined"!=typeof Worker&&ue||void 0!==fe&&!ue}constructor(e){he(this,"name",void 0),he(this,"source",void 0),he(this,"url",void 0),he(this,"terminated",!1),he(this,"worker",void 0),he(this,"onMessage",void 0),he(this,"onError",void 0),he(this,"_loadableURL","");const{name:t,source:n,url:r}=e;ce(n||r),this.name=t,this.source=n,this.url=r,this.onMessage=ye,this.onError=e=>console.log(e),this.worker=ue?this._createBrowserWorker():this._createNodeWorker()}destroy(){this.onMessage=ye,this.onError=ye,this.worker.terminate(),this.terminated=!0}get isRunning(){return Boolean(this.onMessage)}postMessage(e,t){t=t||ve(e),this.worker.postMessage(e,t)}_getErrorFromErrorEvent(e){let t="Failed to load ";return t+="worker ".concat(this.name," from ").concat(this.url,". "),e.message&&(t+="".concat(e.message," in ")),e.lineno&&(t+=":".concat(e.lineno,":").concat(e.colno)),new Error(t)}_createBrowserWorker(){this._loadableURL=function(e){ce(e.source&&!e.url||!e.source&&e.url);let t=ge.get(e.source||e.url);return t||(e.url&&(t=(n=e.url).startsWith("http")?me("try {\n  importScripts('".concat(n,"');\n} catch (error) {\n  console.error(error);\n  throw error;\n}")):n,ge.set(e.url,t)),e.source&&(t=me(e.source),ge.set(e.source,t))),ce(t),t;var n}({source:this.source,url:this.url});const e=new Worker(this._loadableURL,{name:this.name});return e.onmessage=e=>{e.data?this.onMessage(e.data):this.onError(new Error("No data received"))},e.onerror=e=>{this.onError(this._getErrorFromErrorEvent(e)),this.terminated=!0},e.onmessageerror=e=>console.error(e),e}_createNodeWorker(){let e;if(this.url){const t=this.url.includes(":/")||this.url.startsWith("/")?this.url:"./".concat(this.url);e=new fe(t,{eval:!1})}else{if(!this.source)throw new Error("no worker");e=new fe(this.source,{eval:!0})}return e.on("message",e=>{this.onMessage(e)}),e.on("error",e=>{this.onError(e)}),e.on("exit",e=>{}),e}}class Pe{static isSupported(){return Ee.isSupported()}constructor(e){he(this,"name","unnamed"),he(this,"source",void 0),he(this,"url",void 0),he(this,"maxConcurrency",1),he(this,"maxMobileConcurrency",1),he(this,"onDebug",()=>{}),he(this,"reuseWorkers",!0),he(this,"props",{}),he(this,"jobQueue",[]),he(this,"idleQueue",[]),he(this,"count",0),he(this,"isDestroyed",!1),this.source=e.source,this.url=e.url,this.setProps(e)}destroy(){this.idleQueue.forEach(e=>e.destroy()),this.isDestroyed=!0}setProps(e){this.props=t({},this.props,e),void 0!==e.name&&(this.name=e.name),void 0!==e.maxConcurrency&&(this.maxConcurrency=e.maxConcurrency),void 0!==e.maxMobileConcurrency&&(this.maxMobileConcurrency=e.maxMobileConcurrency),void 0!==e.reuseWorkers&&(this.reuseWorkers=e.reuseWorkers),void 0!==e.onDebug&&(this.onDebug=e.onDebug)}async startJob(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:(e,t,n)=>e.done(n),n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:(e,t)=>e.error(t);const r=new Promise(r=>(this.jobQueue.push({name:e,onMessage:t,onError:n,onStart:r}),this));return this._startQueuedJob(),await r}async _startQueuedJob(){if(!this.jobQueue.length)return;const e=this._getAvailableWorker();if(!e)return;const t=this.jobQueue.shift();if(t){this.onDebug({message:"Starting job",name:t.name,workerThread:e,backlog:this.jobQueue.length});const n=new de(t.name,e);e.onMessage=e=>t.onMessage(n,e.type,e.payload),e.onError=e=>t.onError(n,e),t.onStart(n);try{await n.result}finally{this.returnWorkerToQueue(e)}}}returnWorkerToQueue(e){this.isDestroyed||!this.reuseWorkers||this.count>this._getMaxConcurrency()?(e.destroy(),this.count--):this.idleQueue.push(e),this.isDestroyed||this._startQueuedJob()}_getAvailableWorker(){if(this.idleQueue.length>0)return this.idleQueue.shift()||null;if(this.count<this._getMaxConcurrency()){this.count++;const e="".concat(this.name.toLowerCase()," (#").concat(this.count," of ").concat(this.maxConcurrency,")");return new Ee({name:e,source:this.source,url:this.url})}return null}_getMaxConcurrency(){return le?this.maxMobileConcurrency:this.maxConcurrency}}const _e={maxConcurrency:3,maxMobileConcurrency:1,reuseWorkers:!0,onDebug:()=>{}};class Se{static isSupported(){return Ee.isSupported()}static getWorkerFarm(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Se._workerFarm=Se._workerFarm||new Se({}),Se._workerFarm.setProps(e),Se._workerFarm}constructor(e){he(this,"props",void 0),he(this,"workerPools",new Map),this.props=t({},_e),this.setProps(e),this.workerPools=new Map}destroy(){for(const e of this.workerPools.values())e.destroy();this.workerPools=new Map}setProps(e){this.props=t({},this.props,e);for(const e of this.workerPools.values())e.setProps(this._getWorkerPoolProps())}getWorkerPool(e){const{name:t,source:n,url:r}=e;let i=this.workerPools.get(t);return i||(i=new Pe({name:t,source:n,url:r}),i.setProps(this._getWorkerPoolProps()),this.workerPools.set(t,i)),i}_getWorkerPoolProps(){return{maxConcurrency:this.props.maxConcurrency,maxMobileConcurrency:this.props.maxMobileConcurrency,reuseWorkers:this.props.reuseWorkers,onDebug:this.props.onDebug}}}he(Se,"_workerFarm",void 0);var we=/*#__PURE__*/oe("positionsDecompressed"),je=/*#__PURE__*/oe("positionsWorld"),De=new(/*#__PURE__*/function(){function t(){this.object=void 0,this.mesh=void 0,this.meshIndex=void 0,this.geometry=void 0,this.geometryBucket=void 0,this.geometryBucketIndex=void 0,Object.defineProperty(this,we,{writable:!0,value:void 0}),Object.defineProperty(this,je,{writable:!0,value:void 0}),this.object=null,this.mesh=null,this.meshIndex=0,this.geometry=null,this.geometryBucket=null,this.geometryBucketIndex=0,ae(this,we)[we]=null,ae(this,je)[je]=null}return t.prototype.reset=function(){ae(this,we)[we]=null,ae(this,je)[je]=null},function(e,t,n){t&&function(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,"symbol"==typeof(i=function(e,t){if("object"!=typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(r.key))?i:String(i),r)}var i}(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1})}(t,[{key:"totalGeometryBuckets",get:function(){var e=0;if(this.object)for(var t=0,n=this.object.meshes.length;t<n;t++)e+=this.object.meshes[t].geometry.geometryBuckets.length;return e}},{key:"numPrimitives",get:function(){var e=this.geometry.primitive;return this.geometryBucket.indices.length/(20002===e?3:20001===e?2:1)}},{key:"positionsDecompressed",get:function(){return ae(this,we)[we]||(ae(this,we)[we]=new Float32Array(this.geometryBucket.positionsCompressed.length),e(this.geometryBucket.positionsCompressed,this.geometry.positionsDecompressMatrix,ae(this,we)[we])),ae(this,we)[we]}},{key:"positionsWorld",get:function(){if(!ae(this,je)[je]){var e=this.positionsDecompressed;ae(this,je)[je]=new Float64Array(e.length),function(e,t,n){var r;n||(n=t);var i,s,o,a=t.length,c=e[0],u=e[1],l=e[2],p=e[3],h=e[4],d=e[5],f=e[6],g=e[7],m=e[8],v=e[9],b=e[10],y=e[11],E=e[12],P=e[13],_=e[14],S=e[15];for(r=0;r<a;r+=3)n[r+0]=c*(i=t[r+0])+h*(s=t[r+1])+m*(o=t[r+2])+E,n[r+1]=u*i+d*s+v*o+P,n[r+2]=l*i+f*s+b*o+_,n[r+3]=p*i+g*s+y*o+S}(e,this.mesh.matrix,ae(this,je)[je])}return ae(this,je)[je]}},{key:"uvsDecompressed",get:function(){return null}}]),t}());function Le(){return!("object"==typeof process&&"[object process]"===String(process)&&!process.browser)||function(e){if("undefined"!=typeof window&&"object"==typeof window.process&&"renderer"===window.process.type)return!0;if("undefined"!=typeof process&&"object"==typeof process.versions&&Boolean(process.versions.electron))return!0;const t="object"==typeof navigator&&"string"==typeof navigator.userAgent&&navigator.userAgent;return!!(t&&t.indexOf("Electron")>=0)}()}const Oe={self:"undefined"!=typeof self&&self,window:"undefined"!=typeof window&&window,global:"undefined"!=typeof global&&global,document:"undefined"!=typeof document&&document,process:"object"==typeof process&&process},Be=Oe.window||Oe.self||Oe.global,xe=Oe.process||{},Me="undefined"!=typeof __VERSION__?__VERSION__:"untranspiled source";Le();class He{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"sessionStorage";he(this,"storage",void 0),he(this,"id",void 0),he(this,"config",void 0),this.storage=function(e){try{const t=window[e],n="__storage_test__";return t.setItem(n,n),t.removeItem(n),t}catch(e){return null}}(n),this.id=e,this.config=t,this._loadConfiguration()}getConfiguration(){return this.config}setConfiguration(e){if(Object.assign(this.config,e),this.storage){const e=JSON.stringify(this.config);this.storage.setItem(this.id,e)}}_loadConfiguration(){let e={};if(this.storage){const t=this.storage.getItem(this.id);e=t?JSON.parse(t):{}}return Object.assign(this.config,e),this}}function ke(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:600;const i=e.src.replace(/\(/g,"%28").replace(/\)/g,"%29");e.width>r&&(n=Math.min(n,r/e.width));const s=e.width*n,o=e.height*n,a=["font-size:1px;","padding:".concat(Math.floor(o/2),"px ").concat(Math.floor(s/2),"px;"),"line-height:".concat(o,"px;"),"background:url(".concat(i,");"),"background-size:".concat(s,"px ").concat(o,"px;"),"color:transparent;"].join("");return["".concat(t," %c+"),a]}let Ce;function Ne(e){return"string"==typeof e?Ce[e.toUpperCase()]||Ce.WHITE:e}function Ae(e,t){if(!e)throw new Error(t||"Assertion failed")}function Te(){let e;var t,n;if(Le&&"performance"in Be)e=null==Be||null===(t=Be.performance)||void 0===t||null===(n=t.now)||void 0===n?void 0:n.call(t);else if("hrtime"in xe){var r;const t=null==xe||null===(r=xe.hrtime)||void 0===r?void 0:r.call(xe);e=1e3*t[0]+t[1]/1e6}else e=Date.now();return e}var Ue;(Ue=Ce||(Ce={}))[Ue.BLACK=30]="BLACK",Ue[Ue.RED=31]="RED",Ue[Ue.GREEN=32]="GREEN",Ue[Ue.YELLOW=33]="YELLOW",Ue[Ue.BLUE=34]="BLUE",Ue[Ue.MAGENTA=35]="MAGENTA",Ue[Ue.CYAN=36]="CYAN",Ue[Ue.WHITE=37]="WHITE",Ue[Ue.BRIGHT_BLACK=90]="BRIGHT_BLACK",Ue[Ue.BRIGHT_RED=91]="BRIGHT_RED",Ue[Ue.BRIGHT_GREEN=92]="BRIGHT_GREEN",Ue[Ue.BRIGHT_YELLOW=93]="BRIGHT_YELLOW",Ue[Ue.BRIGHT_BLUE=94]="BRIGHT_BLUE",Ue[Ue.BRIGHT_MAGENTA=95]="BRIGHT_MAGENTA",Ue[Ue.BRIGHT_CYAN=96]="BRIGHT_CYAN",Ue[Ue.BRIGHT_WHITE=97]="BRIGHT_WHITE";const We={debug:Le&&console.debug||console.log,log:console.log,info:console.info,warn:console.warn,error:console.error},Ie={enabled:!0,level:0};function Re(){}const Fe={},Ge={once:!0};class Ve{constructor(){let{id:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{id:""};he(this,"id",void 0),he(this,"VERSION",Me),he(this,"_startTs",Te()),he(this,"_deltaTs",Te()),he(this,"_storage",void 0),he(this,"userData",{}),he(this,"LOG_THROTTLE_TIMEOUT",0),this.id=e,this.userData={},this._storage=new He("__probe-".concat(this.id,"__"),Ie),this.timeStamp("".concat(this.id," started")),function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:["constructor"];const n=Object.getPrototypeOf(e),r=Object.getOwnPropertyNames(n);for(const n of r)"function"==typeof e[n]&&(t.find(e=>n===e)||(e[n]=e[n].bind(e)))}(this),Object.seal(this)}set level(e){this.setLevel(e)}get level(){return this.getLevel()}isEnabled(){return this._storage.config.enabled}getLevel(){return this._storage.config.level}getTotal(){return Number((Te()-this._startTs).toPrecision(10))}getDelta(){return Number((Te()-this._deltaTs).toPrecision(10))}set priority(e){this.level=e}get priority(){return this.level}getPriority(){return this.level}enable(){return this._storage.setConfiguration({enabled:!(arguments.length>0&&void 0!==arguments[0])||arguments[0]}),this}setLevel(e){return this._storage.setConfiguration({level:e}),this}get(e){return this._storage.config[e]}set(e,t){this._storage.setConfiguration({[e]:t})}settings(){console.table?console.table(this._storage.config):console.log(this._storage.config)}assert(e,t){Ae(e,t)}warn(e){return this._getLogFunction(0,e,We.warn,arguments,Ge)}error(e){return this._getLogFunction(0,e,We.error,arguments)}deprecated(e,t){return this.warn("`".concat(e,"` is deprecated and will be removed in a later version. Use `").concat(t,"` instead"))}removed(e,t){return this.error("`".concat(e,"` has been removed. Use `").concat(t,"` instead"))}probe(e,t){return this._getLogFunction(e,t,We.log,arguments,{time:!0,once:!0})}log(e,t){return this._getLogFunction(e,t,We.debug,arguments)}info(e,t){return this._getLogFunction(e,t,console.info,arguments)}once(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];return this._getLogFunction(e,t,We.debug||We.info,arguments,Ge)}table(e,t,n){return t?this._getLogFunction(e,t,console.table||Re,n&&[n],{tag:Je(t)}):Re}image(e){let{logLevel:t,priority:n,image:r,message:i="",scale:s=1}=e;return this._shouldLog(t||n)?Le?function(e){let{image:t,message:n="",scale:r=1}=e;if("string"==typeof t){const e=new Image;return e.onload=()=>{const t=ke(e,n,r);console.log(...t)},e.src=t,Re}const i=t.nodeName||"";if("img"===i.toLowerCase())return console.log(...ke(t,n,r)),Re;if("canvas"===i.toLowerCase()){const e=new Image;return e.onload=()=>console.log(...ke(e,n,r)),e.src=t.toDataURL(),Re}return Re}({image:r,message:i,scale:s}):(console.warn("removed"),Re):Re}time(e,t){return this._getLogFunction(e,t,console.time?console.time:console.info)}timeEnd(e,t){return this._getLogFunction(e,t,console.timeEnd?console.timeEnd:console.info)}timeStamp(e,t){return this._getLogFunction(e,t,console.timeStamp||Re)}group(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{collapsed:!1};const r=Ye({logLevel:e,message:t,opts:n}),{collapsed:i}=n;return r.method=(i?console.groupCollapsed:console.group)||console.info,this._getLogFunction(r)}groupCollapsed(e,t){return this.group(e,t,Object.assign({},arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},{collapsed:!0}))}groupEnd(e){return this._getLogFunction(e,"",console.groupEnd||Re)}withGroup(e,t,n){this.group(e,t)();try{n()}finally{this.groupEnd(e)()}}trace(){console.trace&&console.trace()}_shouldLog(e){return this.isEnabled()&&this.getLevel()>=Qe(e)}_getLogFunction(e,t,n,r,i){if(this._shouldLog(e)){i=Ye({logLevel:e,message:t,args:r,opts:i}),Ae(n=n||i.method),i.total=this.getTotal(),i.delta=this.getDelta(),this._deltaTs=Te();const s=i.tag||i.message;if(i.once){if(Fe[s])return Re;Fe[s]=Te()}return t=function(e,t,n){if("string"==typeof t){const o=n.time?function(e){const t=Math.max((arguments.length>1&&void 0!==arguments[1]?arguments[1]:8)-e.length,0);return"".concat(" ".repeat(t)).concat(e)}(function(e){let t;return t=e<10?"".concat(e.toFixed(2),"ms"):e<100?"".concat(e.toFixed(1),"ms"):e<1e3?"".concat(e.toFixed(0),"ms"):"".concat((e/1e3).toFixed(2),"s"),t}(n.total)):"";r=t=n.time?"".concat(e,": ").concat(o,"  ").concat(t):"".concat(e,": ").concat(t),i=n.color,s=n.background,Le||"string"!=typeof r||(i&&(i=Ne(i),r="[".concat(i,"m").concat(r,"[39m")),s&&(i=Ne(s),r="[".concat(s+10,"m").concat(r,"[49m"))),t=r}var r,i,s;return t}(this.id,i.message,i),n.bind(console,t,...i.args)}return Re}}function Qe(e){if(!e)return 0;let t;switch(typeof e){case"number":t=e;break;case"object":t=e.logLevel||e.priority||0;break;default:return 0}return Ae(Number.isFinite(t)&&t>=0),t}function Ye(e){const{logLevel:t,message:n}=e;e.logLevel=Qe(t);const r=e.args?Array.from(e.args):[];for(;r.length&&r.shift()!==n;);switch(typeof t){case"string":case"function":void 0!==n&&r.unshift(n),e.message=t;break;case"object":Object.assign(e,t)}"function"==typeof e.message&&(e.message=e.message());const i=typeof e.message;return Ae("string"===i||"object"===i),Object.assign(e,{args:r},e.opts)}function Je(e){for(const t in e)for(const n in e[t])return n||"untitled";return"empty"}function Ke(e){const t=new b({aabb:e.canvasBoundary}),n=c(e.viewMatrix),r=c(e.projMatrix),i=function(e,t,n){var r=function(e,t,n){n||(n=e);var r=e[0],i=e[1],s=e[2],o=e[3],a=e[4],c=e[5],u=e[6],l=e[7],p=e[8],h=e[9],d=e[10],f=e[11],g=e[12],m=e[13],v=e[14],b=e[15],y=t[0],E=t[1],P=t[2],_=t[3],S=t[4],w=t[5],j=t[6],D=t[7],L=t[8],O=t[9],B=t[10],x=t[11],M=t[12],H=t[13],k=t[14],C=t[15];return n[0]=y*r+E*a+P*p+_*g,n[1]=y*i+E*c+P*h+_*m,n[2]=y*s+E*u+P*d+_*v,n[3]=y*o+E*l+P*f+_*b,n[4]=S*r+w*a+j*p+D*g,n[5]=S*i+w*c+j*h+D*m,n[6]=S*s+w*u+j*d+D*v,n[7]=S*o+w*l+j*f+D*b,n[8]=L*r+O*a+B*p+x*g,n[9]=L*i+O*c+B*h+x*m,n[10]=L*s+O*u+B*d+x*v,n[11]=L*o+O*l+B*f+x*b,n[12]=M*r+H*a+k*p+C*g,n[13]=M*i+H*c+k*h+C*m,n[14]=M*s+H*u+k*d+C*v,n[15]=M*o+H*l+k*f+C*b,n}(t,e,h),i=r[0],s=r[1],o=r[2],a=r[3],c=r[4],u=r[5],l=r[6],p=r[7],d=r[8],f=r[9],m=r[10],v=r[11],b=r[12],y=r[13],E=r[14],P=r[15];return(n=n||new g).planes[0].set(a-i,p-c,v-d,P-b),n.planes[1].set(a+i,p+c,v+d,P+b),n.planes[2].set(a-s,p-u,v-f,P-y),n.planes[3].set(a+s,p+u,v+f,P+y),n.planes[4].set(a-o,p-l,v-m,P-E),n.planes[5].set(a+o,p+l,v+m,P+E),n}(n,r),s=e.canvasBoundary,o=e.sceneObjects;if(o)for(let e=0,t=o.length;e<t;e++)d(o[e]);function d(e,t=2){1!==t&&(t=function(e,t){var n=1,r=l,i=p;r[0]=t[0],r[1]=t[1],r[2]=t[2],i[0]=t[3],i[1]=t[4],i[2]=t[5];for(var s=[r,i],o=0;o<6;++o){var a=e.planes[o];if(a.normal[0]*s[a.testVertex[0]][0]+a.normal[1]*s[a.testVertex[1]][1]+a.normal[2]*s[a.testVertex[2]][2]+a.offset<0)return 3;a.normal[0]*s[1-a.testVertex[0]][0]+a.normal[1]*s[1-a.testVertex[1]][1]+a.normal[2]*s[1-a.testVertex[2]][2]+a.offset<0&&(n=2)}return n}(i,e.aabb)),3!==t&&function(e,t){De.reset(),De.object=e;for(var n=0,r=e.meshes.length;n<r;n++){var i=e.meshes[n];De.mesh=i,De.meshIndex=n;var s=i.geometry;De.geometry=s;for(var o=0,a=s.geometryBuckets.length;o<a;o++)if(De.geometryBucket=s.geometryBuckets[o],De.geometryBucketIndex=o,t(De))return!0}}(e,t=>{const n=t.positionsWorld;for(let t=0,r=n.length;t<r;t+=3){const r=a();r[0]=n[t],r[1]=n[t+1],r[2]=n[t+2],r[3]=1,f(e,r)}return!1})}function f(e,i){const o=a(),c=a(),l=new Uint16Array(2);u(n,i,o),u(r,o,c),l[0]=Math.floor((1+c[0]/c[3])*s[2]/2),l[1]=Math.floor((1-c[1]/c[3])*s[3]/2),t.insertItem({sceneObject:e,worldPos:i,canvasPos:l},[l[0],l[1],l[0],l[1]])}return t}function ze(e){return[]}he(Ve,"VERSION",Me),new Ve({id:"loaders.gl"}),new class{constructor(){he(this,"console",void 0),this.console=console}log(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return this.console.log.bind(this.console,...t)}info(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return this.console.info.bind(this.console,...t)}warn(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return this.console.warn.bind(this.console,...t)}error(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return this.console.error.bind(this.console,...t)}},new Ve({id:"loaders.gl"});class qe{constructor(){this.sceneObject=void 0,this.worldPos=void 0,this.canvasPos=void 0}}export{b as KdTree2,qe as KdVertex2,Ke as createKdTree2FromSceneObjectVerts,ze as searchKdTree2ForNearestNeighbor};
//# sourceMappingURL=index.modern.mjs.map
