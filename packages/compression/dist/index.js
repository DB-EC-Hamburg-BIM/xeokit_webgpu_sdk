var t=require("@xeokit/matrix"),a=t.createMat4(),r=t.createMat4(),o=function(){var a=t.createMat3(),r=t.createMat3();return function(o,n,e){var s,i=new Uint16Array(o.length),M=new Float32Array([65535/(e[0]-n[0]),65535/(e[1]-n[1])]);for(s=0;s<o.length;s+=2)i[s+0]=Math.floor((o[s+0]-n[0])*M[0]),i[s+1]=Math.floor((o[s+1]-n[1])*M[1]);return t.identityMat3(a),t.translationMat3v(n,a),t.identityMat3(r),t.scalingMat3v([(e[0]-n[0])/65535,(e[1]-n[1])/65535],r),{quantized:i,decompressMatrix:t.mulMat3(a,r,t.identityMat3())}}}();function n(t,a,r,o){var n=t[a]/(Math.abs(t[a])+Math.abs(t[a+1])+Math.abs(t[a+2])),e=t[a+1]/(Math.abs(t[a])+Math.abs(t[a+1])+Math.abs(t[a+2]));if(t[a+2]<0){var s=(1-Math.abs(e))*(n>=0?1:-1),i=(1-Math.abs(n))*(e>=0?1:-1);n=s,e=i}return new Int8Array([Math[r](127.5*n+(n<0?-1:0)),Math[o](127.5*e+(e<0?-1:0))])}function e(t,a,r){return t[a]*r[0]+t[a+1]*r[1]+t[a+2]*r[2]}function s(a,r){void 0===r&&(r=t.createVec3());var o=a[0],n=a[1];o=(2*o+1)/255,n=(2*n+1)/255;var e=1-Math.abs(o)-Math.abs(n);e<0&&(o=(1-Math.abs(n))*(o>=0?1:-1),n=(1-Math.abs(o))*(n>=0?1:-1));var s=Math.sqrt(o*o+n*n+e*e);return r[0]=o/s,r[1]=n/s,r[2]=e/s,r}function i(t,a,r){var o,n,e=t[0]/(Math.abs(t[0])+Math.abs(t[1])+Math.abs(t[2])),s=t[1]/(Math.abs(t[0])+Math.abs(t[1])+Math.abs(t[2]));return t[2]<0&&(o=(1-Math.abs(s))*(e>=0?1:-1),n=(1-Math.abs(e))*(s>=0?1:-1),e=o,s=n),new Int8Array([Math[a](127.5*e+(e<0?-1:0)),Math[r](127.5*s+(s<0?-1:0))])}function M(t,a,r,o){var n=t[a]/(Math.abs(t[a])+Math.abs(t[a+1])+Math.abs(t[a+2])),e=t[a+1]/(Math.abs(t[a])+Math.abs(t[a+1])+Math.abs(t[a+2]));if(t[a+2]<0){var s=(1-Math.abs(e))*(n>=0?1:-1),i=(1-Math.abs(n))*(e>=0?1:-1);n=s,e=i}return new Int8Array([Math[r](127.5*n+(n<0?-1:0)),Math[o](127.5*e+(e<0?-1:0))])}exports.compressNormals=function(t){for(var a,r,o,i,M=new Int8Array(t.length),h=0;h<t.length;h+=3)r=a=n(t,h,"floor","floor"),o=i=e(t,h,s(a)),(o=e(t,h,s(a=n(t,h,"ceil","floor"))))>i&&(r=a,i=o),(o=e(t,h,s(a=n(t,h,"floor","ceil"))))>i&&(r=a,i=o),(o=e(t,h,s(a=n(t,h,"ceil","ceil"))))>i&&(r=a,i=o),M[h]=r[0],M[h+1]=r[1];return M},exports.compressPoint3=function(t,a,r){void 0===r&&(r=t);var o=new Float32Array([a[3]!==a[0]?65535/(a[3]-a[0]):0,a[4]!==a[1]?65535/(a[4]-a[1]):0,a[5]!==a[2]?65535/(a[5]-a[2]):0]);return r[0]=Math.max(0,Math.min(65535,Math.floor((t[0]-a[0])*o[0]))),r[1]=Math.max(0,Math.min(65535,Math.floor((t[1]-a[1])*o[1]))),r[2]=Math.max(0,Math.min(65535,Math.floor((t[2]-a[2])*o[2]))),r},exports.compressPositions3=function(o,n,e){var s,i=new Uint16Array(o.length),M=new Float32Array([e[0]!==n[0]?65535/(e[0]-n[0]):0,e[1]!==n[1]?65535/(e[1]-n[1]):0,e[2]!==n[2]?65535/(e[2]-n[2]):0]);for(s=0;s<o.length;s+=3)i[s+0]=Math.floor((o[s+0]-n[0])*M[0]),i[s+1]=Math.floor((o[s+1]-n[1])*M[1]),i[s+2]=Math.floor((o[s+2]-n[2])*M[2]);return t.identityMat4(a),t.translationMat4v(n,a),t.identityMat4(r),t.scalingMat4v([(e[0]-n[0])/65535,(e[1]-n[1])/65535,(e[2]-n[2])/65535],r),{quantized:i,decompressMatrix:t.mulMat4(a,r,t.identityMat4())}},exports.compressUVs=o,exports.createPositions3DecompressMat4=function(o,n){n=n||t.createMat4();var e=o[3]-o[0],s=o[4]-o[1],i=o[5]-o[2],M=65535;return t.identityMat4(a),t.translationMat4v(o,a),t.identityMat4(r),t.scalingMat4v([e/M,s/M,i/M],r),t.mulMat4(a,r,n),n},exports.decompressAABB3=function(t,a,r){return void 0===r&&(r=t),r[0]=t[0]*a[0]+a[12],r[1]=t[1]*a[5]+a[13],r[2]=t[2]*a[10]+a[14],r[3]=t[3]*a[0]+a[12],r[4]=t[4]*a[5]+a[13],r[5]=t[5]*a[10]+a[14],r},exports.decompressNormal=function(t,a){var r=t[0],o=t[1];r=(2*r+1)/255,o=(2*o+1)/255;var n=1-Math.abs(r)-Math.abs(o);n<0&&(r=(1-Math.abs(o))*(r>=0?1:-1),o=(1-Math.abs(r))*(o>=0?1:-1));var e=Math.sqrt(r*r+o*o+n*n);return a[0]=r/e,a[1]=o/e,a[2]=n/e,a},exports.decompressNormals=function(t,a){for(var r=0,o=0,n=t.length;r<n;r+=2){var e=t[r+0],s=t[r+1];e=(2*e+1)/255,s=(2*s+1)/255;var i=1-Math.abs(e)-Math.abs(s);i<0&&(e=(1-Math.abs(s))*(e>=0?1:-1),s=(1-Math.abs(e))*(s>=0?1:-1));var M=Math.sqrt(e*e+s*s+i*i);a[o+0]=e/M,a[o+1]=s/M,a[o+2]=i/M,o+=3}return a},exports.decompressPoint3=function(t,a,r){return void 0===r&&(r=t),r[0]=t[0]*a[0]+a[12],r[1]=t[1]*a[5]+a[13],r[2]=t[2]*a[10]+a[14],r},exports.decompressPositions3=function(t,a,r){void 0===r&&(r=new Float32Array(t.length));for(var o=0,n=t.length;o<n;o+=3)r[o+0]=t[o+0]*a[0]+a[12],r[o+1]=t[o+1]*a[5]+a[13],r[o+2]=t[o+2]*a[10]+a[14];return r},exports.decompressUV=function(t,a,r){void 0===r&&(r=new Float32Array(2)),r[0]=t[0]*a[0]+a[6],r[1]=t[1]*a[4]+a[7]},exports.decompressUVs=function(t,a,r){void 0===r&&(r=new Float32Array(t.length));for(var o=0,n=t.length;o<n;o+=3)r[o+0]=t[o+0]*a[0]+a[6],r[o+1]=t[o+1]*a[4]+a[7];return r},exports.getPositions3MinMax=function(t,a,r){var o,n;for(a=a||new Float64Array(3),r=r||new Float64Array(3),o=0;o<3;o++)a[o]=Number.MAX_VALUE,r[o]=-Number.MAX_VALUE;for(o=0;o<t.length;o+=3)for(n=0;n<3;n++)a[n]=Math.min(a[n],t[o+n]),r[n]=Math.max(r[n],t[o+n]);return{min:a,max:r}},exports.getUVBounds=function(t){var a,r,o=new Float32Array(2),n=new Float32Array(2);for(a=0;a<2;a++)o[a]=Number.MAX_VALUE,n[a]=-Number.MAX_VALUE;for(a=0;a<t.length;a+=2)for(r=0;r<2;r++)o[r]=Math.min(o[r],t[a+r]),n[r]=Math.max(n[r],t[a+r]);return{min:o,max:n}},exports.octEncodeNormal=M,exports.octEncodeNormals=function(t){for(var a,r,o,n,i=t.length,h=new Int8Array(i),l=0;l<i;l+=3)r=a=M(t,l,"floor","floor"),o=n=e(t,l,s(a)),(o=e(t,l,s(a=M(t,l,"ceil","floor"))))>n&&(r=a,n=o),(o=e(t,l,s(a=M(t,l,"floor","ceil"))))>n&&(r=a,n=o),(o=e(t,l,s(a=M(t,l,"ceil","ceil"))))>n&&(r=a,n=o),h[l+0]=r[0],h[l+1]=r[1],h[l+2]=0;return h},exports.octEncodeVec3=i,exports.quantizePositions3=function(o,n,e){for(var s=o.length,i=new Uint16Array(s),M=n[0],h=n[1],l=n[2],c=n[3]-M,f=n[4]-h,u=n[5]-l,m=65525,v=m/c,b=m/f,d=m/u,p=function(t){return t>=0?t:0},x=0;x<s;x+=3)i[x+0]=Math.floor(p(o[x+0]-M)*v),i[x+1]=Math.floor(p(o[x+1]-h)*b),i[x+2]=Math.floor(p(o[x+2]-l)*d);return t.identityMat4(a),t.translationMat4v(n,a),t.identityMat4(r),t.scalingMat4v([c/m,f/m,u/m],r),t.mulMat4(a,r,e),i},exports.transformAndOctEncodeNormals=function(a,r,o,n,e){function M(t,a){return t[0]*a[0]+t[1]*a[1]+t[2]*a[2]}var h,l,c,f,u,m=new Float32Array([0,0,0,0]),v=new Float32Array([0,0,0,0]);for(u=0;u<o;u+=3)m[0]=r[u],m[1]=r[u+1],m[2]=r[u+2],t.transformVec3(a,m,v),t.normalizeVec3(v,v),l=h=i(v,"floor","floor"),c=f=M(v,s(h)),(c=M(v,s(h=i(v,"ceil","floor"))))>f&&(l=h,f=c),(c=M(v,s(h=i(v,"floor","ceil"))))>f&&(l=h,f=c),(c=M(v,s(h=i(v,"ceil","ceil"))))>f&&(l=h,f=c),n[e+u+0]=l[0],n[e+u+1]=l[1],n[e+u+2]=0;return e+o};
//# sourceMappingURL=index.js.map
