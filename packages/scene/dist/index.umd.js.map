{"version":3,"file":"index.umd.js","sources":["../../../node_modules/@loaders.gl/loader-utils/dist/esm/lib/env-utils/assert.js","../../../node_modules/@loaders.gl/loader-utils/dist/esm/lib/env-utils/globals.js","../../../node_modules/@loaders.gl/worker-utils/dist/esm/lib/env-utils/assert.js","../../../node_modules/@loaders.gl/worker-utils/dist/esm/lib/env-utils/globals.js","../../../node_modules/@babel/runtime/helpers/esm/typeof.js","../../../node_modules/@babel/runtime/helpers/esm/defineProperty.js","../../../node_modules/@babel/runtime/helpers/esm/toPropertyKey.js","../../../node_modules/@babel/runtime/helpers/esm/toPrimitive.js","../../../node_modules/@loaders.gl/worker-utils/dist/esm/lib/worker-farm/worker-job.js","../../../node_modules/@loaders.gl/worker-utils/dist/esm/lib/node/worker_threads-browser.js","../../../node_modules/@loaders.gl/worker-utils/dist/esm/lib/worker-utils/get-loadable-worker-url.js","../../../node_modules/@loaders.gl/worker-utils/dist/esm/lib/worker-utils/get-transfer-list.js","../../../node_modules/@loaders.gl/worker-utils/dist/esm/lib/worker-farm/worker-thread.js","../../../node_modules/@loaders.gl/worker-utils/dist/esm/lib/worker-farm/worker-pool.js","../../../node_modules/@loaders.gl/worker-utils/dist/esm/lib/worker-farm/worker-farm.js","../../../node_modules/@loaders.gl/worker-utils/dist/esm/lib/worker-api/get-worker-url.js","../../../node_modules/@loaders.gl/worker-utils/dist/esm/lib/worker-api/process-on-worker.js","../../../node_modules/@loaders.gl/worker-utils/dist/esm/lib/library-utils/library-utils.js","../../../node_modules/@loaders.gl/loader-utils/dist/esm/lib/worker-loader-utils/parse-with-worker.js","../../../node_modules/@loaders.gl/loader-utils/dist/esm/lib/binary-utils/array-buffer-utils.js","../../../node_modules/@loaders.gl/loader-utils/dist/esm/lib/path-utils/file-aliases.js","../../../node_modules/@loaders.gl/loader-utils/dist/esm/lib/binary-utils/memory-conversion-utils.js","../../../node_modules/@loaders.gl/textures/dist/esm/lib/utils/version.js","../../../node_modules/@loaders.gl/textures/dist/esm/lib/parsers/basis-module-loader.js","../../../node_modules/@loaders.gl/textures/dist/esm/ktx2-basis-writer.js","../../../node_modules/@loaders.gl/textures/dist/esm/lib/encoders/encode-ktx2-basis-texture.js","../../../node_modules/@loaders.gl/images/dist/esm/lib/category-api/image-type.js","../../../node_modules/@loaders.gl/images/dist/esm/lib/parsers/svg-utils.js","../../../node_modules/@loaders.gl/images/dist/esm/lib/parsers/parse-to-image.js","../../../node_modules/@loaders.gl/images/dist/esm/lib/parsers/parse-to-image-bitmap.js","../../../node_modules/@loaders.gl/images/dist/esm/lib/category-api/binary-image-api.js","../../../node_modules/@loaders.gl/images/dist/esm/image-loader.js","../../../node_modules/@loaders.gl/images/dist/esm/lib/utils/version.js","../../../node_modules/@loaders.gl/images/dist/esm/lib/parsers/parse-image.js","../../../node_modules/@loaders.gl/images/dist/esm/lib/parsers/parse-to-node-image.js","../../../node_modules/@loaders.gl/images/dist/esm/lib/category-api/parsed-image-api.js","../../constants/dist/index.es","../../boundaries/dist/index.es","../src/GeometryBucket.ts","../src/Geometry.ts","../src/getSceneObjectGeometry.ts","../src/SceneObject.ts","../src/TextureSet.ts","../src/Texture.ts","../src/Mesh.ts","../src/buildEdgeIndices.ts","../src/calculateUniquePositions.ts","../src/rebucketPositions.ts","../src/compressGeometryParams.ts","../../../node_modules/@loaders.gl/core/dist/esm/javascript-utils/is-type.js","../../../node_modules/@loaders.gl/core/dist/esm/lib/utils/mime-type-utils.js","../../../node_modules/@loaders.gl/core/dist/esm/lib/utils/resource-utils.js","../../../node_modules/@loaders.gl/core/dist/esm/lib/utils/response-utils.js","../../../node_modules/@loaders.gl/core/dist/esm/lib/fetch/fetch-file.js","../../../node_modules/@probe.gl/env/dist/esm/lib/is-browser.js","../../../node_modules/@probe.gl/env/dist/esm/lib/is-electron.js","../../../node_modules/@probe.gl/env/dist/esm/lib/globals.js","../../../node_modules/@probe.gl/env/dist/esm/utils/globals.js","../../../node_modules/@probe.gl/log/dist/esm/utils/local-storage.js","../../../node_modules/@probe.gl/log/dist/esm/utils/formatters.js","../../../node_modules/@probe.gl/log/dist/esm/utils/color.js","../../../node_modules/@probe.gl/log/dist/esm/utils/assert.js","../../../node_modules/@probe.gl/log/dist/esm/utils/hi-res-timestamp.js","../../../node_modules/@probe.gl/log/dist/esm/log.js","../../../node_modules/@probe.gl/log/dist/esm/utils/autobind.js","../../../node_modules/@loaders.gl/core/dist/esm/lib/loader-utils/loggers.js","../../../node_modules/@loaders.gl/core/dist/esm/lib/loader-utils/option-defaults.js","../../../node_modules/@loaders.gl/core/dist/esm/lib/loader-utils/option-utils.js","../../../node_modules/@loaders.gl/core/dist/esm/lib/loader-utils/normalize-loader.js","../../../node_modules/@loaders.gl/core/dist/esm/lib/api/register-loaders.js","../../../node_modules/@loaders.gl/core/dist/esm/lib/utils/log.js","../../../node_modules/@loaders.gl/core/dist/esm/lib/api/select-loader.js","../../../node_modules/@loaders.gl/loader-utils/dist/esm/lib/path-utils/path.js","../../../node_modules/@loaders.gl/core/dist/esm/iterators/make-iterator/make-string-iterator.js","../../../node_modules/@loaders.gl/core/dist/esm/iterators/make-iterator/make-array-buffer-iterator.js","../../../node_modules/@loaders.gl/core/dist/esm/iterators/make-iterator/make-blob-iterator.js","../../../node_modules/@loaders.gl/core/dist/esm/iterators/make-iterator/make-stream-iterator.js","../../../node_modules/@loaders.gl/core/dist/esm/lib/loader-utils/get-data.js","../../../node_modules/@loaders.gl/core/dist/esm/lib/api/parse.js","../../../node_modules/@loaders.gl/core/dist/esm/lib/loader-utils/loader-context.js","../../../node_modules/@loaders.gl/worker-utils/dist/esm/lib/worker-api/validate-worker-version.js","../../../node_modules/@loaders.gl/core/dist/esm/iterators/make-iterator/make-iterator.js","../../../node_modules/@loaders.gl/loader-utils/dist/esm/lib/iterators/async-iteration.js","../../../node_modules/@loaders.gl/core/dist/esm/lib/api/encode.js","../../../node_modules/@loaders.gl/loader-utils/dist/esm/lib/worker-loader-utils/encode-with-worker.js","../../../node_modules/@loaders.gl/core/dist/esm/lib/fetch/write-file.js","../src/SceneModel.ts","../../../node_modules/@loaders.gl/core/dist/esm/lib/api/load.js","../src/Scene.ts"],"sourcesContent":["\nexport function assert(condition, message) {\n  if (!condition) {\n    throw new Error(message || 'loader assertion failed.');\n  }\n}\n//# sourceMappingURL=assert.js.map","\n\nconst globals = {\n  self: typeof self !== 'undefined' && self,\n  window: typeof window !== 'undefined' && window,\n  global: typeof global !== 'undefined' && global,\n  document: typeof document !== 'undefined' && document\n};\nconst self_ = globals.self || globals.window || globals.global || {};\nconst window_ = globals.window || globals.self || globals.global || {};\nconst global_ = globals.global || globals.self || globals.window || {};\nconst document_ = globals.document || {};\nexport { self_ as self, window_ as window, global_ as global, document_ as document };\n\nexport const isBrowser =\nBoolean(typeof process !== 'object' || String(process) !== '[object process]' || process.browser);\n\nexport const isWorker = typeof importScripts === 'function';\n\nconst matches = typeof process !== 'undefined' && process.version && /v([0-9]*)/.exec(process.version);\nexport const nodeVersion = matches && parseFloat(matches[1]) || 0;\n//# sourceMappingURL=globals.js.map","\n\nexport function assert(condition, message) {\n  if (!condition) {\n    throw new Error(message || 'loaders.gl assertion failed.');\n  }\n}\n//# sourceMappingURL=assert.js.map","\n\nconst globals = {\n  self: typeof self !== 'undefined' && self,\n  window: typeof window !== 'undefined' && window,\n  global: typeof global !== 'undefined' && global,\n  document: typeof document !== 'undefined' && document\n};\nconst self_ = globals.self || globals.window || globals.global || {};\nconst window_ = globals.window || globals.self || globals.global || {};\nconst global_ = globals.global || globals.self || globals.window || {};\nconst document_ = globals.document || {};\nexport { self_ as self, window_ as window, global_ as global, document_ as document };\n\nexport const isBrowser =\ntypeof process !== 'object' || String(process) !== '[object process]' || process.browser;\n\nexport const isWorker = typeof importScripts === 'function';\n\nexport const isMobile = typeof window !== 'undefined' && typeof window.orientation !== 'undefined';\n\nconst matches = typeof process !== 'undefined' && process.version && /v([0-9]*)/.exec(process.version);\n\nexport const nodeVersion = matches && parseFloat(matches[1]) || 0;\n//# sourceMappingURL=globals.js.map","export default function _typeof(obj) {\n  \"@babel/helpers - typeof\";\n\n  return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (obj) {\n    return typeof obj;\n  } : function (obj) {\n    return obj && \"function\" == typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n  }, _typeof(obj);\n}","import toPropertyKey from \"./toPropertyKey.js\";\nexport default function _defineProperty(obj, key, value) {\n  key = toPropertyKey(key);\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n  return obj;\n}","import _typeof from \"./typeof.js\";\nimport toPrimitive from \"./toPrimitive.js\";\nexport default function _toPropertyKey(arg) {\n  var key = toPrimitive(arg, \"string\");\n  return _typeof(key) === \"symbol\" ? key : String(key);\n}","import _typeof from \"./typeof.js\";\nexport default function _toPrimitive(input, hint) {\n  if (_typeof(input) !== \"object\" || input === null) return input;\n  var prim = input[Symbol.toPrimitive];\n  if (prim !== undefined) {\n    var res = prim.call(input, hint || \"default\");\n    if (_typeof(res) !== \"object\") return res;\n    throw new TypeError(\"@@toPrimitive must return a primitive value.\");\n  }\n  return (hint === \"string\" ? String : Number)(input);\n}","import _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport { assert } from '../env-utils/assert';\n\nexport default class WorkerJob {\n\n  constructor(jobName, workerThread) {\n    _defineProperty(this, \"name\", void 0);\n    _defineProperty(this, \"workerThread\", void 0);\n    _defineProperty(this, \"isRunning\", true);\n    _defineProperty(this, \"result\", void 0);\n    _defineProperty(this, \"_resolve\", () => {});\n    _defineProperty(this, \"_reject\", () => {});\n    this.name = jobName;\n    this.workerThread = workerThread;\n    this.result = new Promise((resolve, reject) => {\n      this._resolve = resolve;\n      this._reject = reject;\n    });\n  }\n\n  postMessage(type, payload) {\n    this.workerThread.postMessage({\n      source: 'loaders.gl',\n      type,\n      payload\n    });\n  }\n\n  done(value) {\n    assert(this.isRunning);\n    this.isRunning = false;\n    this._resolve(value);\n  }\n\n  error(error) {\n    assert(this.isRunning);\n    this.isRunning = false;\n    this._reject(error);\n  }\n}\n//# sourceMappingURL=worker-job.js.map","\nexport class Worker {\n  terminate() {}\n}\nexport { Worker as NodeWorker };\nexport { Worker as NodeWorkerType };\nexport const parentPort = null;\n//# sourceMappingURL=worker_threads-browser.js.map","import { assert } from '../env-utils/assert';\nconst workerURLCache = new Map();\n\nexport function getLoadableWorkerURL(props) {\n  assert(props.source && !props.url || !props.source && props.url);\n\n  let workerURL = workerURLCache.get(props.source || props.url);\n  if (!workerURL) {\n    if (props.url) {\n      workerURL = getLoadableWorkerURLFromURL(props.url);\n      workerURLCache.set(props.url, workerURL);\n    }\n    if (props.source) {\n      workerURL = getLoadableWorkerURLFromSource(props.source);\n      workerURLCache.set(props.source, workerURL);\n    }\n  }\n  assert(workerURL);\n  return workerURL;\n}\n\nfunction getLoadableWorkerURLFromURL(url) {\n  if (!url.startsWith('http')) {\n    return url;\n  }\n\n  const workerSource = buildScriptSource(url);\n  return getLoadableWorkerURLFromSource(workerSource);\n}\n\nfunction getLoadableWorkerURLFromSource(workerSource) {\n  const blob = new Blob([workerSource], {\n    type: 'application/javascript'\n  });\n  return URL.createObjectURL(blob);\n}\n\nfunction buildScriptSource(workerUrl) {\n  return \"try {\\n  importScripts('\".concat(workerUrl, \"');\\n} catch (error) {\\n  console.error(error);\\n  throw error;\\n}\");\n}\n//# sourceMappingURL=get-loadable-worker-url.js.map","\n\nexport function getTransferList(object) {\n  let recursive = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : true;\n  let transfers = arguments.length > 2 ? arguments[2] : undefined;\n  const transfersSet = transfers || new Set();\n  if (!object) {\n  } else if (isTransferable(object)) {\n    transfersSet.add(object);\n  } else if (isTransferable(object.buffer)) {\n    transfersSet.add(object.buffer);\n  } else if (ArrayBuffer.isView(object)) {\n  } else if (recursive && typeof object === 'object') {\n    for (const key in object) {\n      getTransferList(object[key], recursive, transfersSet);\n    }\n  }\n\n  return transfers === undefined ? Array.from(transfersSet) : [];\n}\n\nfunction isTransferable(object) {\n  if (!object) {\n    return false;\n  }\n  if (object instanceof ArrayBuffer) {\n    return true;\n  }\n  if (typeof MessagePort !== 'undefined' && object instanceof MessagePort) {\n    return true;\n  }\n  if (typeof ImageBitmap !== 'undefined' && object instanceof ImageBitmap) {\n    return true;\n  }\n  if (typeof OffscreenCanvas !== 'undefined' && object instanceof OffscreenCanvas) {\n    return true;\n  }\n  return false;\n}\n\nexport function getTransferListForWriter(object) {\n  if (object === null) {\n    return {};\n  }\n  const clone = Object.assign({}, object);\n  Object.keys(clone).forEach(key => {\n    if (typeof object[key] === 'object' && !ArrayBuffer.isView(object[key]) && !(object[key] instanceof Array)) {\n      clone[key] = getTransferListForWriter(object[key]);\n    } else if (typeof clone[key] === 'function' || clone[key] instanceof RegExp) {\n      clone[key] = {};\n    } else {\n      clone[key] = object[key];\n    }\n  });\n  return clone;\n}\n//# sourceMappingURL=get-transfer-list.js.map","import _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\n\nimport { NodeWorker } from '../node/worker_threads';\nimport { isBrowser } from '../env-utils/globals';\nimport { assert } from '../env-utils/assert';\nimport { getLoadableWorkerURL } from '../worker-utils/get-loadable-worker-url';\nimport { getTransferList } from '../worker-utils/get-transfer-list';\nconst NOOP = () => {};\nexport default class WorkerThread {\n  static isSupported() {\n    return typeof Worker !== 'undefined' && isBrowser || typeof NodeWorker !== 'undefined' && !isBrowser;\n  }\n  constructor(props) {\n    _defineProperty(this, \"name\", void 0);\n    _defineProperty(this, \"source\", void 0);\n    _defineProperty(this, \"url\", void 0);\n    _defineProperty(this, \"terminated\", false);\n    _defineProperty(this, \"worker\", void 0);\n    _defineProperty(this, \"onMessage\", void 0);\n    _defineProperty(this, \"onError\", void 0);\n    _defineProperty(this, \"_loadableURL\", '');\n    const {\n      name,\n      source,\n      url\n    } = props;\n    assert(source || url);\n    this.name = name;\n    this.source = source;\n    this.url = url;\n    this.onMessage = NOOP;\n    this.onError = error => console.log(error);\n\n    this.worker = isBrowser ? this._createBrowserWorker() : this._createNodeWorker();\n  }\n\n  destroy() {\n    this.onMessage = NOOP;\n    this.onError = NOOP;\n    this.worker.terminate();\n    this.terminated = true;\n  }\n  get isRunning() {\n    return Boolean(this.onMessage);\n  }\n\n  postMessage(data, transferList) {\n    transferList = transferList || getTransferList(data);\n    this.worker.postMessage(data, transferList);\n  }\n\n  _getErrorFromErrorEvent(event) {\n    let message = 'Failed to load ';\n    message += \"worker \".concat(this.name, \" from \").concat(this.url, \". \");\n    if (event.message) {\n      message += \"\".concat(event.message, \" in \");\n    }\n    if (event.lineno) {\n      message += \":\".concat(event.lineno, \":\").concat(event.colno);\n    }\n    return new Error(message);\n  }\n\n  _createBrowserWorker() {\n    this._loadableURL = getLoadableWorkerURL({\n      source: this.source,\n      url: this.url\n    });\n    const worker = new Worker(this._loadableURL, {\n      name: this.name\n    });\n    worker.onmessage = event => {\n      if (!event.data) {\n        this.onError(new Error('No data received'));\n      } else {\n        this.onMessage(event.data);\n      }\n    };\n    worker.onerror = error => {\n      this.onError(this._getErrorFromErrorEvent(error));\n      this.terminated = true;\n    };\n    worker.onmessageerror = event => console.error(event);\n\n    return worker;\n  }\n\n  _createNodeWorker() {\n    let worker;\n    if (this.url) {\n      const absolute = this.url.includes(':/') || this.url.startsWith('/');\n      const url = absolute ? this.url : \"./\".concat(this.url);\n      worker = new NodeWorker(url, {\n        eval: false\n      });\n    } else if (this.source) {\n      worker = new NodeWorker(this.source, {\n        eval: true\n      });\n    } else {\n      throw new Error('no worker');\n    }\n    worker.on('message', data => {\n      this.onMessage(data);\n    });\n    worker.on('error', error => {\n      this.onError(error);\n    });\n    worker.on('exit', code => {\n    });\n    return worker;\n  }\n}\n//# sourceMappingURL=worker-thread.js.map","import _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport { isMobile } from '../env-utils/globals';\nimport WorkerThread from './worker-thread';\nimport WorkerJob from './worker-job';\n\nexport default class WorkerPool {\n\n  static isSupported() {\n    return WorkerThread.isSupported();\n  }\n\n  constructor(props) {\n    _defineProperty(this, \"name\", 'unnamed');\n    _defineProperty(this, \"source\", void 0);\n    _defineProperty(this, \"url\", void 0);\n    _defineProperty(this, \"maxConcurrency\", 1);\n    _defineProperty(this, \"maxMobileConcurrency\", 1);\n    _defineProperty(this, \"onDebug\", () => {});\n    _defineProperty(this, \"reuseWorkers\", true);\n    _defineProperty(this, \"props\", {});\n    _defineProperty(this, \"jobQueue\", []);\n    _defineProperty(this, \"idleQueue\", []);\n    _defineProperty(this, \"count\", 0);\n    _defineProperty(this, \"isDestroyed\", false);\n    this.source = props.source;\n    this.url = props.url;\n    this.setProps(props);\n  }\n\n  destroy() {\n    this.idleQueue.forEach(worker => worker.destroy());\n    this.isDestroyed = true;\n  }\n  setProps(props) {\n    this.props = {\n      ...this.props,\n      ...props\n    };\n    if (props.name !== undefined) {\n      this.name = props.name;\n    }\n    if (props.maxConcurrency !== undefined) {\n      this.maxConcurrency = props.maxConcurrency;\n    }\n    if (props.maxMobileConcurrency !== undefined) {\n      this.maxMobileConcurrency = props.maxMobileConcurrency;\n    }\n    if (props.reuseWorkers !== undefined) {\n      this.reuseWorkers = props.reuseWorkers;\n    }\n    if (props.onDebug !== undefined) {\n      this.onDebug = props.onDebug;\n    }\n  }\n  async startJob(name) {\n    let onMessage = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : (job, type, data) => job.done(data);\n    let onError = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : (job, error) => job.error(error);\n    const startPromise = new Promise(onStart => {\n      this.jobQueue.push({\n        name,\n        onMessage,\n        onError,\n        onStart\n      });\n      return this;\n    });\n    this._startQueuedJob();\n    return await startPromise;\n  }\n\n  async _startQueuedJob() {\n    if (!this.jobQueue.length) {\n      return;\n    }\n    const workerThread = this._getAvailableWorker();\n    if (!workerThread) {\n      return;\n    }\n\n    const queuedJob = this.jobQueue.shift();\n    if (queuedJob) {\n      this.onDebug({\n        message: 'Starting job',\n        name: queuedJob.name,\n        workerThread,\n        backlog: this.jobQueue.length\n      });\n\n      const job = new WorkerJob(queuedJob.name, workerThread);\n\n      workerThread.onMessage = data => queuedJob.onMessage(job, data.type, data.payload);\n      workerThread.onError = error => queuedJob.onError(job, error);\n\n      queuedJob.onStart(job);\n\n      try {\n        await job.result;\n      } finally {\n        this.returnWorkerToQueue(workerThread);\n      }\n    }\n  }\n\n  returnWorkerToQueue(worker) {\n    const shouldDestroyWorker = this.isDestroyed || !this.reuseWorkers || this.count > this._getMaxConcurrency();\n    if (shouldDestroyWorker) {\n      worker.destroy();\n      this.count--;\n    } else {\n      this.idleQueue.push(worker);\n    }\n    if (!this.isDestroyed) {\n      this._startQueuedJob();\n    }\n  }\n\n  _getAvailableWorker() {\n    if (this.idleQueue.length > 0) {\n      return this.idleQueue.shift() || null;\n    }\n\n    if (this.count < this._getMaxConcurrency()) {\n      this.count++;\n      const name = \"\".concat(this.name.toLowerCase(), \" (#\").concat(this.count, \" of \").concat(this.maxConcurrency, \")\");\n      return new WorkerThread({\n        name,\n        source: this.source,\n        url: this.url\n      });\n    }\n\n    return null;\n  }\n  _getMaxConcurrency() {\n    return isMobile ? this.maxMobileConcurrency : this.maxConcurrency;\n  }\n}\n//# sourceMappingURL=worker-pool.js.map","import _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport WorkerPool from './worker-pool';\nimport WorkerThread from './worker-thread';\n\nconst DEFAULT_PROPS = {\n  maxConcurrency: 3,\n  maxMobileConcurrency: 1,\n  reuseWorkers: true,\n  onDebug: () => {}\n};\n\nexport default class WorkerFarm {\n\n  static isSupported() {\n    return WorkerThread.isSupported();\n  }\n\n  static getWorkerFarm() {\n    let props = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n    WorkerFarm._workerFarm = WorkerFarm._workerFarm || new WorkerFarm({});\n    WorkerFarm._workerFarm.setProps(props);\n    return WorkerFarm._workerFarm;\n  }\n\n  constructor(props) {\n    _defineProperty(this, \"props\", void 0);\n    _defineProperty(this, \"workerPools\", new Map());\n    this.props = {\n      ...DEFAULT_PROPS\n    };\n    this.setProps(props);\n    this.workerPools = new Map();\n  }\n\n  destroy() {\n    for (const workerPool of this.workerPools.values()) {\n      workerPool.destroy();\n    }\n    this.workerPools = new Map();\n  }\n\n  setProps(props) {\n    this.props = {\n      ...this.props,\n      ...props\n    };\n    for (const workerPool of this.workerPools.values()) {\n      workerPool.setProps(this._getWorkerPoolProps());\n    }\n  }\n\n  getWorkerPool(options) {\n    const {\n      name,\n      source,\n      url\n    } = options;\n    let workerPool = this.workerPools.get(name);\n    if (!workerPool) {\n      workerPool = new WorkerPool({\n        name,\n        source,\n        url\n      });\n      workerPool.setProps(this._getWorkerPoolProps());\n      this.workerPools.set(name, workerPool);\n    }\n    return workerPool;\n  }\n  _getWorkerPoolProps() {\n    return {\n      maxConcurrency: this.props.maxConcurrency,\n      maxMobileConcurrency: this.props.maxMobileConcurrency,\n      reuseWorkers: this.props.reuseWorkers,\n      onDebug: this.props.onDebug\n    };\n  }\n}\n_defineProperty(WorkerFarm, \"_workerFarm\", void 0);\n//# sourceMappingURL=worker-farm.js.map","\n\nimport { assert } from '../env-utils/assert';\nimport { VERSION as __VERSION__ } from '../env-utils/version';\nconst NPM_TAG = 'latest';\nconst VERSION = typeof \"3.3.1\" !== 'undefined' ? \"3.3.1\" : NPM_TAG;\n\nexport function getWorkerName(worker) {\n  const warning = worker.version !== VERSION ? \" (worker-utils@\".concat(VERSION, \")\") : '';\n  return \"\".concat(worker.name, \"@\").concat(worker.version).concat(warning);\n}\n\nexport function getWorkerURL(worker) {\n  let options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n  const workerOptions = options[worker.id] || {};\n  const workerFile = \"\".concat(worker.id, \"-worker.js\");\n  let url = workerOptions.workerUrl;\n\n  if (!url && worker.id === 'compression') {\n    url = options.workerUrl;\n  }\n\n  if (options._workerType === 'test') {\n    url = \"modules/\".concat(worker.module, \"/dist/\").concat(workerFile);\n  }\n\n  if (!url) {\n    let version = worker.version;\n    if (version === 'latest') {\n      version = NPM_TAG;\n    }\n    const versionTag = version ? \"@\".concat(version) : '';\n    url = \"https://unpkg.com/@loaders.gl/\".concat(worker.module).concat(versionTag, \"/dist/\").concat(workerFile);\n  }\n  assert(url);\n\n  return url;\n}\n//# sourceMappingURL=get-worker-url.js.map","import WorkerFarm from '../worker-farm/worker-farm';\nimport { getWorkerURL, getWorkerName } from './get-worker-url';\nimport { getTransferListForWriter } from '../worker-utils/get-transfer-list';\nexport function canProcessOnWorker(worker, options) {\n  if (!WorkerFarm.isSupported()) {\n    return false;\n  }\n  return worker.worker && (options === null || options === void 0 ? void 0 : options.worker);\n}\n\nexport async function processOnWorker(worker, data) {\n  let options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n  let context = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : {};\n  const name = getWorkerName(worker);\n  const workerFarm = WorkerFarm.getWorkerFarm(options);\n  const {\n    source\n  } = options;\n  const workerPoolProps = {\n    name,\n    source\n  };\n  if (!source) {\n    workerPoolProps.url = getWorkerURL(worker, options);\n  }\n  const workerPool = workerFarm.getWorkerPool(workerPoolProps);\n  const jobName = options.jobName || worker.name;\n  const job = await workerPool.startJob(jobName,\n  onMessage.bind(null, context));\n\n  const transferableOptions = getTransferListForWriter(options);\n  job.postMessage('process', {\n    input: data,\n    options: transferableOptions\n  });\n  const result = await job.result;\n  return result.result;\n}\n\nasync function onMessage(context, job, type, payload) {\n  switch (type) {\n    case 'done':\n      job.done(payload);\n      break;\n    case 'error':\n      job.error(new Error(payload.error));\n      break;\n    case 'process':\n      const {\n        id,\n        input,\n        options\n      } = payload;\n      try {\n        if (!context.process) {\n          job.postMessage('error', {\n            id,\n            error: 'Worker not set up to process on main thread'\n          });\n          return;\n        }\n        const result = await context.process(input, options);\n        job.postMessage('done', {\n          id,\n          result\n        });\n      } catch (error) {\n        const message = error instanceof Error ? error.message : 'unknown error';\n        job.postMessage('error', {\n          id,\n          error: message\n        });\n      }\n      break;\n    default:\n      console.warn(\"process-on-worker: unknown message \".concat(type));\n  }\n}\n//# sourceMappingURL=process-on-worker.js.map","\nimport { global, isBrowser, isWorker } from '../env-utils/globals';\nimport * as node from '../node/require-utils.node';\nimport { assert } from '../env-utils/assert';\nimport { VERSION as __VERSION__ } from '../env-utils/version';\n\nconst LATEST = 'latest';\nconst VERSION = typeof \"3.3.1\" !== 'undefined' ? \"3.3.1\" : LATEST;\nconst loadLibraryPromises = {};\n\nexport async function loadLibrary(libraryUrl) {\n  let moduleName = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : null;\n  let options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n  if (moduleName) {\n    libraryUrl = getLibraryUrl(libraryUrl, moduleName, options);\n  }\n\n  loadLibraryPromises[libraryUrl] =\n  loadLibraryPromises[libraryUrl] || loadLibraryFromFile(libraryUrl);\n  return await loadLibraryPromises[libraryUrl];\n}\n\nexport function getLibraryUrl(library, moduleName, options) {\n  if (library.startsWith('http')) {\n    return library;\n  }\n\n  const modules = options.modules || {};\n  if (modules[library]) {\n    return modules[library];\n  }\n\n  if (!isBrowser) {\n    return \"modules/\".concat(moduleName, \"/dist/libs/\").concat(library);\n  }\n\n  if (options.CDN) {\n    assert(options.CDN.startsWith('http'));\n    return \"\".concat(options.CDN, \"/\").concat(moduleName, \"@\").concat(VERSION, \"/dist/libs/\").concat(library);\n  }\n\n  if (isWorker) {\n    return \"../src/libs/\".concat(library);\n  }\n  return \"modules/\".concat(moduleName, \"/src/libs/\").concat(library);\n}\nasync function loadLibraryFromFile(libraryUrl) {\n  if (libraryUrl.endsWith('wasm')) {\n    const response = await fetch(libraryUrl);\n    return await response.arrayBuffer();\n  }\n  if (!isBrowser) {\n    try {\n      return node && node.requireFromFile && (await node.requireFromFile(libraryUrl));\n    } catch {\n      return null;\n    }\n  }\n  if (isWorker) {\n    return importScripts(libraryUrl);\n  }\n\n  const response = await fetch(libraryUrl);\n  const scriptSource = await response.text();\n  return loadLibraryFromString(scriptSource, libraryUrl);\n}\n\nfunction loadLibraryFromString(scriptSource, id) {\n  if (!isBrowser) {\n    return node.requireFromString && node.requireFromString(scriptSource, id);\n  }\n  if (isWorker) {\n    eval.call(global, scriptSource);\n    return null;\n  }\n  const script = document.createElement('script');\n  script.id = id;\n  try {\n    script.appendChild(document.createTextNode(scriptSource));\n  } catch (e) {\n    script.text = scriptSource;\n  }\n  document.body.appendChild(script);\n  return null;\n}\n//# sourceMappingURL=library-utils.js.map","import { isBrowser } from '@loaders.gl/worker-utils';\nimport { WorkerFarm, getWorkerURL } from '@loaders.gl/worker-utils';\n\nexport function canParseWithWorker(loader, options) {\n  if (!WorkerFarm.isSupported()) {\n    return false;\n  }\n\n  if (!isBrowser && !(options !== null && options !== void 0 && options._nodeWorkers)) {\n    return false;\n  }\n  return loader.worker && (options === null || options === void 0 ? void 0 : options.worker);\n}\n\nexport async function parseWithWorker(loader, data, options, context, parseOnMainThread) {\n  const name = loader.id;\n  const url = getWorkerURL(loader, options);\n  const workerFarm = WorkerFarm.getWorkerFarm(options);\n  const workerPool = workerFarm.getWorkerPool({\n    name,\n    url\n  });\n\n  options = JSON.parse(JSON.stringify(options));\n  context = JSON.parse(JSON.stringify(context || {}));\n  const job = await workerPool.startJob('process-on-worker',\n  onMessage.bind(null, parseOnMainThread));\n\n  job.postMessage('process', {\n    input: data,\n    options,\n    context\n  });\n  const result = await job.result;\n  return await result.result;\n}\n\nasync function onMessage(parseOnMainThread, job, type, payload) {\n  switch (type) {\n    case 'done':\n      job.done(payload);\n      break;\n    case 'error':\n      job.error(new Error(payload.error));\n      break;\n    case 'process':\n      const {\n        id,\n        input,\n        options\n      } = payload;\n      try {\n        const result = await parseOnMainThread(input, options);\n        job.postMessage('done', {\n          id,\n          result\n        });\n      } catch (error) {\n        const message = error instanceof Error ? error.message : 'unknown error';\n        job.postMessage('error', {\n          id,\n          error: message\n        });\n      }\n      break;\n    default:\n      console.warn(\"parse-with-worker unknown message \".concat(type));\n  }\n}\n//# sourceMappingURL=parse-with-worker.js.map","\nexport function compareArrayBuffers(arrayBuffer1, arrayBuffer2, byteLength) {\n  byteLength = byteLength || arrayBuffer1.byteLength;\n  if (arrayBuffer1.byteLength < byteLength || arrayBuffer2.byteLength < byteLength) {\n    return false;\n  }\n  const array1 = new Uint8Array(arrayBuffer1);\n  const array2 = new Uint8Array(arrayBuffer2);\n  for (let i = 0; i < array1.length; ++i) {\n    if (array1[i] !== array2[i]) {\n      return false;\n    }\n  }\n  return true;\n}\n\nexport function concatenateArrayBuffers() {\n  for (var _len = arguments.length, sources = new Array(_len), _key = 0; _key < _len; _key++) {\n    sources[_key] = arguments[_key];\n  }\n  const sourceArrays = sources.map(source2 => source2 instanceof ArrayBuffer ? new Uint8Array(source2) : source2);\n\n  const byteLength = sourceArrays.reduce((length, typedArray) => length + typedArray.byteLength, 0);\n\n  const result = new Uint8Array(byteLength);\n\n  let offset = 0;\n  for (const sourceArray of sourceArrays) {\n    result.set(sourceArray, offset);\n    offset += sourceArray.byteLength;\n  }\n\n  return result.buffer;\n}\n\nexport function concatenateTypedArrays() {\n  for (var _len2 = arguments.length, typedArrays = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n    typedArrays[_key2] = arguments[_key2];\n  }\n  const arrays = typedArrays;\n  const TypedArrayConstructor = arrays && arrays.length > 1 && arrays[0].constructor || null;\n  if (!TypedArrayConstructor) {\n    throw new Error('\"concatenateTypedArrays\" - incorrect quantity of arguments or arguments have incompatible data types');\n  }\n  const sumLength = arrays.reduce((acc, value) => acc + value.length, 0);\n  const result = new TypedArrayConstructor(sumLength);\n  let offset = 0;\n  for (const array of arrays) {\n    result.set(array, offset);\n    offset += array.length;\n  }\n  return result;\n}\n\nexport function sliceArrayBuffer(arrayBuffer, byteOffset, byteLength) {\n  const subArray = byteLength !== undefined ? new Uint8Array(arrayBuffer).subarray(byteOffset, byteOffset + byteLength) : new Uint8Array(arrayBuffer).subarray(byteOffset);\n  const arrayCopy = new Uint8Array(subArray);\n  return arrayCopy.buffer;\n}\n//# sourceMappingURL=array-buffer-utils.js.map","\n\nlet pathPrefix = '';\nconst fileAliases = {};\n\nexport function setPathPrefix(prefix) {\n  pathPrefix = prefix;\n}\n\nexport function getPathPrefix() {\n  return pathPrefix;\n}\n\nexport function addAliases(aliases) {\n  Object.assign(fileAliases, aliases);\n}\n\nexport function resolvePath(filename) {\n  for (const alias in fileAliases) {\n    if (filename.startsWith(alias)) {\n      const replacement = fileAliases[alias];\n      filename = filename.replace(alias, replacement);\n    }\n  }\n  if (!filename.startsWith('http://') && !filename.startsWith('https://')) {\n    filename = \"\".concat(pathPrefix).concat(filename);\n  }\n  return filename;\n}\n//# sourceMappingURL=file-aliases.js.map","\n\nimport * as node from '../node/buffer';\n\nexport function isBuffer(value) {\n  return value && typeof value === 'object' && value.isBuffer;\n}\n\nexport function toBuffer(data) {\n  return node.toBuffer ? node.toBuffer(data) : data;\n}\n\nexport function toArrayBuffer(data) {\n  if (isBuffer(data)) {\n    return node.toArrayBuffer(data);\n  }\n  if (data instanceof ArrayBuffer) {\n    return data;\n  }\n\n  if (ArrayBuffer.isView(data)) {\n    if (data.byteOffset === 0 && data.byteLength === data.buffer.byteLength) {\n      return data.buffer;\n    }\n    return data.buffer.slice(data.byteOffset, data.byteOffset + data.byteLength);\n  }\n  if (typeof data === 'string') {\n    const text = data;\n    const uint8Array = new TextEncoder().encode(text);\n    return uint8Array.buffer;\n  }\n\n  if (data && typeof data === 'object' && data._toArrayBuffer) {\n    return data._toArrayBuffer();\n  }\n  throw new Error('toArrayBuffer');\n}\n//# sourceMappingURL=memory-conversion-utils.js.map","\nexport const VERSION = typeof \"3.3.1\" !== 'undefined' ? \"3.3.1\" : 'beta';\n//# sourceMappingURL=version.js.map","\nconst VERSION = typeof \"3.3.1\" !== 'undefined' ? \"3.3.1\" : 'beta';\n\nimport { loadLibrary } from '@loaders.gl/worker-utils';\nconst BASIS_CDN_ENCODER_WASM = \"https://unpkg.com/@loaders.gl/textures@\".concat(VERSION, \"/dist/libs/basis_encoder.wasm\");\nconst BASIS_CDN_ENCODER_JS = \"https://unpkg.com/@loaders.gl/textures@\".concat(VERSION, \"/dist/libs/basis_encoder.js\");\nlet loadBasisTranscoderPromise;\n\nexport async function loadBasisTrascoderModule(options) {\n  const modules = options.modules || {};\n  if (modules.basis) {\n    return modules.basis;\n  }\n  loadBasisTranscoderPromise = loadBasisTranscoderPromise || loadBasisTrascoder(options);\n  return await loadBasisTranscoderPromise;\n}\n\nasync function loadBasisTrascoder(options) {\n  let BASIS = null;\n  let wasmBinary = null;\n  [BASIS, wasmBinary] = await Promise.all([await loadLibrary('basis_transcoder.js', 'textures', options), await loadLibrary('basis_transcoder.wasm', 'textures', options)]);\n\n  BASIS = BASIS || globalThis.BASIS;\n  return await initializeBasisTrascoderModule(BASIS, wasmBinary);\n}\n\nfunction initializeBasisTrascoderModule(BasisModule, wasmBinary) {\n  const options = {};\n  if (wasmBinary) {\n    options.wasmBinary = wasmBinary;\n  }\n  return new Promise(resolve => {\n    BasisModule(options).then(module => {\n      const {\n        BasisFile,\n        initializeBasis\n      } = module;\n      initializeBasis();\n      resolve({\n        BasisFile\n      });\n    });\n  });\n}\nlet loadBasisEncoderPromise;\n\nexport async function loadBasisEncoderModule(options) {\n  const modules = options.modules || {};\n  if (modules.basisEncoder) {\n    return modules.basisEncoder;\n  }\n  loadBasisEncoderPromise = loadBasisEncoderPromise || loadBasisEncoder(options);\n  return await loadBasisEncoderPromise;\n}\n\nasync function loadBasisEncoder(options) {\n  let BASIS_ENCODER = null;\n  let wasmBinary = null;\n  [BASIS_ENCODER, wasmBinary] = await Promise.all([await loadLibrary(BASIS_CDN_ENCODER_JS, 'textures', options), await loadLibrary(BASIS_CDN_ENCODER_WASM, 'textures', options)]);\n\n  BASIS_ENCODER = BASIS_ENCODER || globalThis.BASIS;\n  return await initializeBasisEncoderModule(BASIS_ENCODER, wasmBinary);\n}\n\nfunction initializeBasisEncoderModule(BasisEncoderModule, wasmBinary) {\n  const options = {};\n  if (wasmBinary) {\n    options.wasmBinary = wasmBinary;\n  }\n  return new Promise(resolve => {\n    BasisEncoderModule(options).then(module => {\n      const {\n        BasisFile,\n        KTX2File,\n        initializeBasis,\n        BasisEncoder\n      } = module;\n      initializeBasis();\n      resolve({\n        BasisFile,\n        KTX2File,\n        BasisEncoder\n      });\n    });\n  });\n}\n//# sourceMappingURL=basis-module-loader.js.map","import { VERSION } from './lib/utils/version';\nimport { encodeKTX2BasisTexture } from './lib/encoders/encode-ktx2-basis-texture';\n\nexport const KTX2BasisWriter = {\n  name: 'Basis Universal Supercompressed GPU Texture',\n  id: 'ktx2-basis-writer',\n  module: 'textures',\n  version: VERSION,\n  extensions: ['ktx2'],\n  options: {\n    useSRGB: false,\n    qualityLevel: 10,\n    encodeUASTC: false,\n    mipmaps: false\n  },\n  encode: encodeKTX2BasisTexture\n};\n\nexport const _TypecheckKTX2TextureWriter = KTX2BasisWriter;\n//# sourceMappingURL=ktx2-basis-writer.js.map","import { loadBasisEncoderModule } from '../parsers/basis-module-loader';\n\nexport async function encodeKTX2BasisTexture(image) {\n  let options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n  const {\n    useSRGB = false,\n    qualityLevel = 10,\n    encodeUASTC = false,\n    mipmaps = false\n  } = options;\n  const {\n    BasisEncoder\n  } = await loadBasisEncoderModule(options);\n  const basisEncoder = new BasisEncoder();\n  try {\n    const basisFileData = new Uint8Array(image.width * image.height * 4);\n    basisEncoder.setCreateKTX2File(true);\n    basisEncoder.setKTX2UASTCSupercompression(true);\n    basisEncoder.setKTX2SRGBTransferFunc(true);\n    basisEncoder.setSliceSourceImage(0, image.data, image.width, image.height, false);\n    basisEncoder.setPerceptual(useSRGB);\n    basisEncoder.setMipSRGB(useSRGB);\n    basisEncoder.setQualityLevel(qualityLevel);\n    basisEncoder.setUASTC(encodeUASTC);\n    basisEncoder.setMipGen(mipmaps);\n    const numOutputBytes = basisEncoder.encode(basisFileData);\n    const actualKTX2FileData = basisFileData.subarray(0, numOutputBytes).buffer;\n    return actualKTX2FileData;\n  } catch (error) {\n    console.error('Basis Universal Supercompressed GPU Texture encoder Error: ', error);\n    throw error;\n  } finally {\n    basisEncoder.delete();\n  }\n}\n//# sourceMappingURL=encode-ktx2-basis-texture.js.map","import { isBrowser } from '@loaders.gl/loader-utils';\nconst {\n  _parseImageNode\n} = globalThis;\nconst IMAGE_SUPPORTED = typeof Image !== 'undefined';\nconst IMAGE_BITMAP_SUPPORTED = typeof ImageBitmap !== 'undefined';\nconst NODE_IMAGE_SUPPORTED = Boolean(_parseImageNode);\nconst DATA_SUPPORTED = isBrowser ? true : NODE_IMAGE_SUPPORTED;\n\nexport function isImageTypeSupported(type) {\n  switch (type) {\n    case 'auto':\n      return IMAGE_BITMAP_SUPPORTED || IMAGE_SUPPORTED || DATA_SUPPORTED;\n    case 'imagebitmap':\n      return IMAGE_BITMAP_SUPPORTED;\n    case 'image':\n      return IMAGE_SUPPORTED;\n    case 'data':\n      return DATA_SUPPORTED;\n    default:\n      throw new Error(\"@loaders.gl/images: image \".concat(type, \" not supported in this environment\"));\n  }\n}\n\nexport function getDefaultImageType() {\n  if (IMAGE_BITMAP_SUPPORTED) {\n    return 'imagebitmap';\n  }\n  if (IMAGE_SUPPORTED) {\n    return 'image';\n  }\n  if (DATA_SUPPORTED) {\n    return 'data';\n  }\n\n  throw new Error('Install \\'@loaders.gl/polyfills\\' to parse images under Node.js');\n}\n//# sourceMappingURL=image-type.js.map","\n\nconst SVG_DATA_URL_PATTERN = /^data:image\\/svg\\+xml/;\nconst SVG_URL_PATTERN = /\\.svg((\\?|#).*)?$/;\nexport function isSVG(url) {\n  return url && (SVG_DATA_URL_PATTERN.test(url) || SVG_URL_PATTERN.test(url));\n}\nexport function getBlobOrSVGDataUrl(arrayBuffer, url) {\n  if (isSVG(url)) {\n    const textDecoder = new TextDecoder();\n    let xmlText = textDecoder.decode(arrayBuffer);\n    try {\n      if (typeof unescape === 'function' && typeof encodeURIComponent === 'function') {\n        xmlText = unescape(encodeURIComponent(xmlText));\n      }\n    } catch (error) {\n      throw new Error(error.message);\n    }\n    const src = \"data:image/svg+xml;base64,\".concat(btoa(xmlText));\n    return src;\n  }\n  return getBlob(arrayBuffer, url);\n}\nexport function getBlob(arrayBuffer, url) {\n  if (isSVG(url)) {\n    throw new Error('SVG cannot be parsed directly to imagebitmap');\n  }\n  return new Blob([new Uint8Array(arrayBuffer)]);\n}\n//# sourceMappingURL=svg-utils.js.map","import { getBlobOrSVGDataUrl } from './svg-utils';\n\nexport default async function parseToImage(arrayBuffer, options, url) {\n\n  const blobOrDataUrl = getBlobOrSVGDataUrl(arrayBuffer, url);\n  const URL = self.URL || self.webkitURL;\n  const objectUrl = typeof blobOrDataUrl !== 'string' && URL.createObjectURL(blobOrDataUrl);\n  try {\n    return await loadToImage(objectUrl || blobOrDataUrl, options);\n  } finally {\n    if (objectUrl) {\n      URL.revokeObjectURL(objectUrl);\n    }\n  }\n}\nexport async function loadToImage(url, options) {\n  const image = new Image();\n  image.src = url;\n\n  if (options.image && options.image.decode && image.decode) {\n    await image.decode();\n    return image;\n  }\n\n  return await new Promise((resolve, reject) => {\n    try {\n      image.onload = () => resolve(image);\n      image.onerror = err => reject(new Error(\"Could not load image \".concat(url, \": \").concat(err)));\n    } catch (error) {\n      reject(error);\n    }\n  });\n}\n//# sourceMappingURL=parse-to-image.js.map","import { isSVG, getBlob } from './svg-utils';\nimport parseToImage from './parse-to-image';\nconst EMPTY_OBJECT = {};\nlet imagebitmapOptionsSupported = true;\n\nexport default async function parseToImageBitmap(arrayBuffer, options, url) {\n  let blob;\n\n  if (isSVG(url)) {\n    const image = await parseToImage(arrayBuffer, options, url);\n    blob = image;\n  } else {\n    blob = getBlob(arrayBuffer, url);\n  }\n  const imagebitmapOptions = options && options.imagebitmap;\n  return await safeCreateImageBitmap(blob, imagebitmapOptions);\n}\n\nasync function safeCreateImageBitmap(blob) {\n  let imagebitmapOptions = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : null;\n  if (isEmptyObject(imagebitmapOptions) || !imagebitmapOptionsSupported) {\n    imagebitmapOptions = null;\n  }\n  if (imagebitmapOptions) {\n    try {\n      return await createImageBitmap(blob, imagebitmapOptions);\n    } catch (error) {\n      console.warn(error);\n      imagebitmapOptionsSupported = false;\n    }\n  }\n  return await createImageBitmap(blob);\n}\nfunction isEmptyObject(object) {\n  for (const key in object || EMPTY_OBJECT) {\n    return false;\n  }\n  return true;\n}\n//# sourceMappingURL=parse-to-image-bitmap.js.map","\n\nconst BIG_ENDIAN = false;\nconst LITTLE_ENDIAN = true;\n\nexport function getBinaryImageMetadata(binaryData) {\n  const dataView = toDataView(binaryData);\n  return getPngMetadata(dataView) || getJpegMetadata(dataView) || getGifMetadata(dataView) || getBmpMetadata(dataView);\n}\n\nfunction getPngMetadata(binaryData) {\n  const dataView = toDataView(binaryData);\n  const isPng = dataView.byteLength >= 24 && dataView.getUint32(0, BIG_ENDIAN) === 0x89504e47;\n  if (!isPng) {\n    return null;\n  }\n\n  return {\n    mimeType: 'image/png',\n    width: dataView.getUint32(16, BIG_ENDIAN),\n    height: dataView.getUint32(20, BIG_ENDIAN)\n  };\n}\n\nfunction getGifMetadata(binaryData) {\n  const dataView = toDataView(binaryData);\n  const isGif = dataView.byteLength >= 10 && dataView.getUint32(0, BIG_ENDIAN) === 0x47494638;\n  if (!isGif) {\n    return null;\n  }\n\n  return {\n    mimeType: 'image/gif',\n    width: dataView.getUint16(6, LITTLE_ENDIAN),\n    height: dataView.getUint16(8, LITTLE_ENDIAN)\n  };\n}\n\nexport function getBmpMetadata(binaryData) {\n  const dataView = toDataView(binaryData);\n  const isBmp = dataView.byteLength >= 14 && dataView.getUint16(0, BIG_ENDIAN) === 0x424d && dataView.getUint32(2, LITTLE_ENDIAN) === dataView.byteLength;\n  if (!isBmp) {\n    return null;\n  }\n\n  return {\n    mimeType: 'image/bmp',\n    width: dataView.getUint32(18, LITTLE_ENDIAN),\n    height: dataView.getUint32(22, LITTLE_ENDIAN)\n  };\n}\n\nfunction getJpegMetadata(binaryData) {\n  const dataView = toDataView(binaryData);\n  const isJpeg = dataView.byteLength >= 3 && dataView.getUint16(0, BIG_ENDIAN) === 0xffd8 && dataView.getUint8(2) === 0xff;\n  if (!isJpeg) {\n    return null;\n  }\n  const {\n    tableMarkers,\n    sofMarkers\n  } = getJpegMarkers();\n\n  let i = 2;\n  while (i + 9 < dataView.byteLength) {\n    const marker = dataView.getUint16(i, BIG_ENDIAN);\n\n    if (sofMarkers.has(marker)) {\n      return {\n        mimeType: 'image/jpeg',\n        height: dataView.getUint16(i + 5, BIG_ENDIAN),\n        width: dataView.getUint16(i + 7, BIG_ENDIAN)\n      };\n    }\n\n    if (!tableMarkers.has(marker)) {\n      return null;\n    }\n\n    i += 2;\n    i += dataView.getUint16(i, BIG_ENDIAN);\n  }\n  return null;\n}\nfunction getJpegMarkers() {\n  const tableMarkers = new Set([0xffdb, 0xffc4, 0xffcc, 0xffdd, 0xfffe]);\n  for (let i = 0xffe0; i < 0xfff0; ++i) {\n    tableMarkers.add(i);\n  }\n\n  const sofMarkers = new Set([0xffc0, 0xffc1, 0xffc2, 0xffc3, 0xffc5, 0xffc6, 0xffc7, 0xffc9, 0xffca, 0xffcb, 0xffcd, 0xffce, 0xffcf, 0xffde]);\n  return {\n    tableMarkers,\n    sofMarkers\n  };\n}\n\nfunction toDataView(data) {\n  if (data instanceof DataView) {\n    return data;\n  }\n  if (ArrayBuffer.isView(data)) {\n    return new DataView(data.buffer);\n  }\n\n  if (data instanceof ArrayBuffer) {\n    return new DataView(data);\n  }\n  throw new Error('toDataView');\n}\n//# sourceMappingURL=binary-image-api.js.map","import { VERSION } from './lib/utils/version';\nimport parseImage from './lib/parsers/parse-image';\nimport { getBinaryImageMetadata } from './lib/category-api/binary-image-api';\nconst EXTENSIONS = ['png', 'jpg', 'jpeg', 'gif', 'webp', 'bmp', 'ico', 'svg'];\nconst MIME_TYPES = ['image/png', 'image/jpeg', 'image/gif', 'image/webp', 'image/bmp', 'image/vnd.microsoft.icon', 'image/svg+xml'];\nconst DEFAULT_IMAGE_LOADER_OPTIONS = {\n  image: {\n    type: 'auto',\n    decode: true\n  }\n};\n\nexport const ImageLoader = {\n  id: 'image',\n  module: 'images',\n  name: 'Images',\n  version: VERSION,\n  mimeTypes: MIME_TYPES,\n  extensions: EXTENSIONS,\n  parse: parseImage,\n  tests: [arrayBuffer => Boolean(getBinaryImageMetadata(new DataView(arrayBuffer)))],\n  options: DEFAULT_IMAGE_LOADER_OPTIONS\n};\nexport const _typecheckImageLoader = ImageLoader;\n//# sourceMappingURL=image-loader.js.map","\nexport const VERSION = typeof \"3.3.1\" !== 'undefined' ? \"3.3.1\" : 'latest';\n//# sourceMappingURL=version.js.map","import { assert } from '@loaders.gl/loader-utils';\nimport { isImageTypeSupported, getDefaultImageType } from '../category-api/image-type';\nimport { getImageData } from '../category-api/parsed-image-api';\nimport parseToImage from './parse-to-image';\nimport parseToImageBitmap from './parse-to-image-bitmap';\nimport parseToNodeImage from './parse-to-node-image';\n\nexport default async function parseImage(arrayBuffer, options, context) {\n  options = options || {};\n  const imageOptions = options.image || {};\n\n  const imageType = imageOptions.type || 'auto';\n  const {\n    url\n  } = context || {};\n\n  const loadType = getLoadableImageType(imageType);\n  let image;\n  switch (loadType) {\n    case 'imagebitmap':\n      image = await parseToImageBitmap(arrayBuffer, options, url);\n      break;\n    case 'image':\n      image = await parseToImage(arrayBuffer, options, url);\n      break;\n    case 'data':\n      image = await parseToNodeImage(arrayBuffer, options);\n      break;\n    default:\n      assert(false);\n  }\n\n  if (imageType === 'data') {\n    image = getImageData(image);\n  }\n  return image;\n}\n\nfunction getLoadableImageType(type) {\n  switch (type) {\n    case 'auto':\n    case 'data':\n      return getDefaultImageType();\n    default:\n      isImageTypeSupported(type);\n      return type;\n  }\n}\n//# sourceMappingURL=parse-image.js.map","import { assert } from '@loaders.gl/loader-utils';\nimport { getBinaryImageMetadata } from '../category-api/binary-image-api';\n\nexport default async function parseToNodeImage(arrayBuffer, options) {\n  const {\n    mimeType\n  } = getBinaryImageMetadata(arrayBuffer) || {};\n\n  const _parseImageNode = globalThis._parseImageNode;\n  assert(_parseImageNode);\n\n  return await _parseImageNode(arrayBuffer, mimeType);\n}\n//# sourceMappingURL=parse-to-node-image.js.map","export function isImage(image) {\n  return Boolean(getImageTypeOrNull(image));\n}\nexport function deleteImage(image) {\n  switch (getImageType(image)) {\n    case 'imagebitmap':\n      image.close();\n      break;\n    default:\n  }\n}\n\nexport function getImageType(image) {\n  const format = getImageTypeOrNull(image);\n  if (!format) {\n    throw new Error('Not an image');\n  }\n  return format;\n}\nexport function getImageSize(image) {\n  return getImageData(image);\n}\nexport function getImageData(image) {\n  switch (getImageType(image)) {\n    case 'data':\n      return image;\n    case 'image':\n    case 'imagebitmap':\n      const canvas = document.createElement('canvas');\n      const context = canvas.getContext('2d');\n      if (!context) {\n        throw new Error('getImageData');\n      }\n      canvas.width = image.width;\n      canvas.height = image.height;\n      context.drawImage(image, 0, 0);\n      return context.getImageData(0, 0, image.width, image.height);\n    default:\n      throw new Error('getImageData');\n  }\n}\n\nfunction getImageTypeOrNull(image) {\n  if (typeof ImageBitmap !== 'undefined' && image instanceof ImageBitmap) {\n    return 'imagebitmap';\n  }\n  if (typeof Image !== 'undefined' && image instanceof Image) {\n    return 'image';\n  }\n  if (image && typeof image === 'object' && image.data && image.width && image.height) {\n    return 'data';\n  }\n  return null;\n}\n//# sourceMappingURL=parsed-image-api.js.map","var e=1e3,r=1001,a=1002,o=1003,p=1004,t=1004,v=1005,x=1005,b=1006,c=1007,d=1007,f=1008,g=1008,h=1009,i=1010,j=1011,k=1012,l=1013,m=1014,n=1015,q=1016,s=1017,u=1018,w=1020,y=1021,z=1022,A=1023,B=1024,C=1025,D=1026,E=1027,F=1028,G=1029,H=1030,I=1031,J=1033,K=33776,L=33777,M=33778,N=33779,O=35840,P=35841,Q=35842,R=35843,S=36196,T=37492,U=37496,V=37808,W=37809,X=37810,Y=37811,Z=37812,$=37813,_=37814,ee=37815,re=37816,ae=37817,oe=37818,pe=37819,te=37820,ve=37821,xe=36492,be=3e3,ce=3001,de=1e4,fe=10001,ge=10002,he=2e4,ie=20001,je=20002,ke=20003,le=20004,me=3e4,ne=300001,qe=4e5,se=400001,ue=400002,we=400003,ye=400004,ze=400005,Ae=5e5,Be=500001,Ce=500002,De=500003;export{y as AlphaFormat,i as ByteType,se as CentimetersUnit,r as ClampToEdgeWrapping,De as CustomProjectionType,D as DepthFormat,E as DepthStencilFormat,ne as FastRender,ye as FeetUnit,n as FloatType,Ce as FrustumProjectionType,de as GIFMediaType,q as HalfFloatType,ze as InchesUnit,l as IntType,fe as JPEGMediaType,be as LinearEncoding,b as LinearFilter,g as LinearMipMapLinearFilter,d as LinearMipMapNearestFilter,f as LinearMipmapLinearFilter,c as LinearMipmapNearestFilter,ie as LinesPrimitive,C as LuminanceAlphaFormat,B as LuminanceFormat,qe as MetersUnit,ue as MillimetersUnit,a as MirroredRepeatWrapping,o as NearestFilter,x as NearestMipMapLinearFilter,p as NearestMipMapNearestFilter,v as NearestMipmapLinearFilter,t as NearestMipmapNearestFilter,Be as OrthoProjectionType,ge as PNGMediaType,Ae as PerspectiveProjectionType,he as PointsPrimitive,me as QualityRender,A as RGBAFormat,J as RGBAIntegerFormat,pe as RGBA_ASTC_10x10_Format,re as RGBA_ASTC_10x5_Format,ae as RGBA_ASTC_10x6_Format,oe as RGBA_ASTC_10x8_Format,te as RGBA_ASTC_12x10_Format,ve as RGBA_ASTC_12x12_Format,V as RGBA_ASTC_4x4_Format,W as RGBA_ASTC_5x4_Format,X as RGBA_ASTC_5x5_Format,Y as RGBA_ASTC_6x5_Format,Z as RGBA_ASTC_6x6_Format,$ as RGBA_ASTC_8x5_Format,_ as RGBA_ASTC_8x6_Format,ee as RGBA_ASTC_8x8_Format,xe as RGBA_BPTC_Format,U as RGBA_ETC2_EAC_Format,R as RGBA_PVRTC_2BPPV1_Format,Q as RGBA_PVRTC_4BPPV1_Format,L as RGBA_S3TC_DXT1_Format,M as RGBA_S3TC_DXT3_Format,N as RGBA_S3TC_DXT5_Format,z as RGBFormat,S as RGB_ETC1_Format,T as RGB_ETC2_Format,P as RGB_PVRTC_2BPPV1_Format,O as RGB_PVRTC_4BPPV1_Format,K as RGB_S3TC_DXT1_Format,H as RGFormat,I as RGIntegerFormat,F as RedFormat,G as RedIntegerFormat,e as RepeatWrapping,j as ShortType,ke as SolidPrimitive,le as SurfacePrimitive,je as TrianglesPrimitive,h as UnsignedByteType,w as UnsignedInt248Type,m as UnsignedIntType,s as UnsignedShort4444Type,u as UnsignedShort5551Type,k as UnsignedShortType,we as YardsUnit,ce as sRGBEncoding};\n//# sourceMappingURL=index.es.map\n","import{createVec3 as t,createMat4 as n,subVec3 as r,lenVec3 as e,createVec2 as o,mulMat4 as i}from\"@xeokit/matrix\";import{newFloatArray as u,MAX_DOUBLE as f,MIN_DOUBLE as a}from\"@xeokit/math\";import{decompressPoint3 as s}from\"@xeokit/compression\";var c=t(),v=t(),l=n();function h(t){return new Float64Array(t||6)}function m(t){return new Int16Array(t||6)}function p(t){return u(t||4)}function x(t){return u(t||32)}function d(t){return u(t||16)}function V(t,n,r,e){return u([t,n,r,e])}function w(t,n,r){var e;void 0===r&&(r=n);var o,i,u,f=n.length,a=t[0],s=t[1],c=t[2],v=t[3],l=t[4],h=t[5],m=t[6],p=t[7],x=t[8],d=t[9],V=t[10],w=t[11],g=t[12],k=t[13],y=t[14],M=t[15];for(e=0;e<f;e+=4)r[e+0]=a*(o=n[e+0])+l*(i=n[e+1])+x*(u=n[e+2])+g,r[e+1]=s*o+h*i+d*u+k,r[e+2]=c*o+m*i+V*u+y,r[e+3]=v*o+p*i+w*u+M;return r}function g(t,n){return t[0]<=n[0]&&n[3]<=t[3]&&t[1]<=n[1]&&t[2]<=n[2]}function k(t,n){return t[0]<=n[0]&&n[3]<=t[3]&&t[1]<=n[1]&&n[4]<=t[4]&&t[2]<=n[2]&&n[5]<=t[5]}var y,M,b,A=(y=u(3),M=u(3),b=u(3),function(t){return y[0]=t[0],y[1]=t[1],y[2]=t[2],M[0]=t[3],M[1]=t[4],M[2]=t[5],r(M,y,b),Math.abs(e(b))}),q=function(){var t=u(3),n=u(3),o=u(3);return function(i,u){t[0]=i[0],t[1]=i[1],t[2]=i[2],n[0]=i[3],n[1]=i[4],n[2]=i[5];var f=r(n,t,o),a=u[0]-i[0],s=i[3]-u[0],c=u[1]-i[1],v=i[4]-u[1],l=u[2]-i[2],h=i[5]-u[2];return f[0]+=a>s?a:s,f[1]+=c>v?c:v,f[2]+=l>h?l:h,Math.abs(e(f))}}();function F(t){return(t[3]-t[0])*(t[4]-t[1])*(t[5]-t[2])}function I(n,r){return void 0===r&&(r=t()),r[0]=(n[0]+n[3])/2,r[1]=(n[1]+n[4])/2,r[2]=(n[2]+n[5])/2,r}function j(t,n){return void 0===n&&(n=o()),n[0]=(t[2]+t[0])/2,n[1]=(t[3]+t[1])/2,n}function z(t){return void 0===t&&(t=h()),t[0]=f,t[1]=f,t[2]=f,t[3]=a,t[4]=a,t[5]=a,t}function B(t){return void 0===t&&(t=m()),t[0]=65535,t[1]=65535,t[2]=65535,t[3]=-65535,t[4]=-65535,t[5]=-65535,t}function C(t,n){return void 0===t&&(t=h()),void 0===n&&(n=x()),n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=1,n[4]=t[3],n[5]=t[1],n[6]=t[2],n[7]=1,n[8]=t[3],n[9]=t[4],n[10]=t[2],n[11]=1,n[12]=t[0],n[13]=t[4],n[14]=t[2],n[15]=1,n[16]=t[0],n[17]=t[1],n[18]=t[5],n[19]=1,n[20]=t[3],n[21]=t[1],n[22]=t[5],n[23]=1,n[24]=t[3],n[25]=t[4],n[26]=t[5],n[27]=1,n[28]=t[0],n[29]=t[4],n[30]=t[5],n[31]=1,n}function D(t,n){return t[0]>n[0]&&(t[0]=n[0]),t[1]>n[1]&&(t[1]=n[1]),t[2]>n[2]&&(t[2]=n[2]),t[3]<n[3]&&(t[3]=n[3]),t[4]<n[4]&&(t[4]=n[4]),t[5]<n[5]&&(t[5]=n[5]),t}function E(t,n){return t[0]>n[0]&&(t[0]=n[0]),t[1]>n[1]&&(t[1]=n[1]),t[3]<n[3]&&(t[3]=n[3]),t[4]<n[4]&&(t[4]=n[4]),t}function G(t,n){return t[0]>n[0]&&(t[0]=n[0]),t[1]>n[1]&&(t[1]=n[1]),t[2]>n[2]&&(t[2]=n[2]),t[3]<n[0]&&(t[3]=n[0]),t[4]<n[1]&&(t[4]=n[1]),t[5]<n[2]&&(t[5]=n[2]),t}function H(t,n){return t[0]>n[0]&&(t[0]=n[0]),t[1]>n[1]&&(t[1]=n[1]),t[3]<n[0]&&(t[3]=n[0]),t[4]<n[1]&&(t[4]=n[1]),t}function J(t,n){for(var r,e,o,i=0,u=n.length;i<u;i+=3)e=n[i+1],o=n[i+2],t[0]>(r=n[i])&&(t[0]=r),t[1]>e&&(t[1]=e),t[2]>o&&(t[2]=o),t[3]<r&&(t[3]=r),t[4]<e&&(t[4]=e),t[5]<o&&(t[5]=o);return t}function K(t,n){return void 0===n&&(n=x()),n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=1,n[4]=t[3],n[5]=t[1],n[6]=t[2],n[7]=1,n[8]=t[3],n[9]=t[4],n[10]=t[2],n[11]=1,n[12]=t[0],n[13]=t[4],n[14]=t[2],n[15]=1,n[16]=t[0],n[17]=t[1],n[18]=t[5],n[19]=1,n[20]=t[3],n[21]=t[1],n[22]=t[5],n[23]=1,n[24]=t[3],n[25]=t[4],n[26]=t[5],n[27]=1,n[28]=t[0],n[29]=t[4],n[30]=t[5],n[31]=1,n}var L,N=(L=u(3),function(t,n,r){n=n||h();for(var e,o,i,u=f,c=f,v=f,l=a,m=a,p=a,x=0,d=t.length;x<d;x+=3)r?(L[0]=t[x+0],L[1]=t[x+1],L[2]=t[x+2],s(L,r,L),e=L[0],o=L[1],i=L[2]):(e=t[x+0],o=t[x+1],i=t[x+2]),e<u&&(u=e),o<c&&(c=o),i<v&&(v=i),e>l&&(l=e),o>m&&(m=o),i>p&&(p=i);return n[0]=u,n[1]=c,n[2]=v,n[3]=l,n[4]=m,n[5]=p,n});function O(t,n){void 0===n&&(n=h());for(var r,e,o,i=f,u=f,s=f,c=a,v=a,l=a,m=0,p=t.length;m<p;m+=4)(r=t[m+0])<i&&(i=r),(e=t[m+1])<u&&(u=e),(o=t[m+2])<s&&(s=o),r>c&&(c=r),e>v&&(v=e),o>l&&(l=o);return n[0]=i,n[1]=u,n[2]=s,n[3]=c,n[4]=v,n[5]=l,n}function P(t,n){void 0===n&&(n=h());for(var r,e,o,i=f,u=f,s=f,c=a,v=a,l=a,m=0,p=t.length;m<p;m++)(r=t[m][0])<i&&(i=r),(e=t[m][1])<u&&(u=e),(o=t[m][2])<s&&(s=o),r>c&&(c=r),e>v&&(v=e),o>l&&(l=o);return n[0]=i,n[1]=u,n[2]=s,n[3]=c,n[4]=v,n[5]=l,n}function Q(n,r){void 0===r&&(r=t());for(var e=0,o=0,i=0,u=0,f=n.length;u<f;u+=3)e+=n[u+0],o+=n[u+1],i+=n[u+2];var a=n.length/3;return r[0]=e/a,r[1]=o/a,r[2]=i/a,r}var R=/*#__PURE__*/function(){function n(){this.testVertex=void 0,this.offset=void 0,this.normal=void 0,this.normal=t(),this.offset=0,this.testVertex=t()}return n.prototype.set=function(t,n,r,e){var o=1/Math.sqrt(t*t+n*n+r*r);this.normal[0]=t*o,this.normal[1]=n*o,this.normal[2]=r*o,this.offset=e*o,this.testVertex[0]=this.normal[0]>=0?1:0,this.testVertex[1]=this.normal[1]>=0?1:0,this.testVertex[2]=this.normal[2]>=0?1:0},n}(),S=1,T=2,U=3,W=function(){this.planes=void 0,this.planes=[new R,new R,new R,new R,new R,new R]};function X(t,n,r){var e=i(n,t,l),o=e[0],u=e[1],f=e[2],a=e[3],s=e[4],c=e[5],v=e[6],h=e[7],m=e[8],p=e[9],x=e[10],d=e[11],V=e[12],w=e[13],g=e[14],k=e[15];return(r=r||new W).planes[0].set(a-o,h-s,d-m,k-V),r.planes[1].set(a+o,h+s,d+m,k+V),r.planes[2].set(a-u,h-c,d-p,k-w),r.planes[3].set(a+u,h+c,d+p,k+w),r.planes[4].set(a-f,h-v,d-x,k-g),r.planes[5].set(a+f,h+v,d+x,k+g),r}function Y(t,n){var r=1,e=c,o=v;e[0]=n[0],e[1]=n[1],e[2]=n[2],o[0]=n[3],o[1]=n[4],o[2]=n[5];for(var i=[e,o],u=0;u<6;++u){var f=t.planes[u];if(f.normal[0]*i[f.testVertex[0]][0]+f.normal[1]*i[f.testVertex[1]][1]+f.normal[2]*i[f.testVertex[2]][2]+f.offset<0)return 3;f.normal[0]*i[1-f.testVertex[0]][0]+f.normal[1]*i[1-f.testVertex[1]][1]+f.normal[2]*i[1-f.testVertex[2]][2]+f.offset<0&&(r=2)}return r}function Z(t,n){return 2}function $(t,n,r){return!0}function _(t,n,r,e){return!0}function tt(t,n,r){return!0}function nt(t,n){return!0}function rt(t,n){return!0}function et(t,n,r){return!1}function ot(t,n,r){return!1}function it(t,n){for(var r=t[0],e=t[1],o=t[2],i=t[3],u=t[4],f=t[5],a=0,s=n.length;a<s;a+=3){var c=n[a];if(r<=c&&c<=i){var v=n[a+1];if(e<=v&&v<=u){var l=n[a+2];if(o<=l&&l<=f)return!0}}}return!1}function ut(t,n){return t[0]<=n[0]&&n[0]<=t[3]&&t[1]<=n[1]&&n[1]<=t[4]&&t[2]<=n[2]&&n[2]<=t[5]}function ft(t,n){return t[0]<=n[0]&&n[0]<=t[3]&&t[1]<=n[1]&&n[1]<=t[4]}export{C as AABB3ToOBB3,K as ABB3ToOBB3,W as Frustum3,R as FrustumPlane3,S as INSIDE,T as INTERSECT,O as OBB3ToAABB3,U as OUTSIDE,z as collapseAABB3,B as collapseAABB3Int16,g as containsAABB2,ft as containsAABB2Point2,k as containsAABB3,ut as containsAABB3Point3,p as createAABB2,h as createAABB3,m as createAABB3Int16,d as createOBB2,x as createOBB3,V as createSphere3,E as expandAABB2,H as expandAABB2Point2,D as expandAABB3,G as expandAABB3Point3,J as expandAABB3Points3,j as getAABB2Center,F as getAABB3Area,I as getAABB3Center,A as getAABB3Diag,q as getAABB3DiagPoint,Q as getPositions3Center,ot as intersectAABB3Lines3,it as intersectAABB3Positions3,et as intersectAABB3Triangles3,Z as intersectAABB3s,Y as intersectFrustum3AABB3,tt as intersectFrustum3Lines3,rt as intersectFrustum3Point3,nt as intersectFrustum3Positions3,_ as intersectFrustum3Triangle3,$ as intersectFrustum3Triangles3,P as points3ToAABB3,N as positions3ToAABB3,X as setFrustum3,w as transformOBB3};\n//# sourceMappingURL=index.es.map\n","import type {IntArrayParam} from \"@xeokit/math\";\nimport type {GeometryBucketParams} from \"./GeometryBucketParams\";\n\n/**\n * A geometry bucket within {@link @xeokit/scene!Geometry.geometryBuckets | Geometry.geometryBuckets}.\n *\n * See usage in:\n *\n * * [@xeokit/scene](/docs/modules/_xeokit_scene.html)\n * * [@xeokit/viewer](/docs/modules/_xeokit_viewer.html)\n */\nexport class GeometryBucket {\n\n    /**\n     * GeometryBucket's 3D vertex positions, quantized as 16-bit integers.\n     *\n     * Internally, the Viewer dequantizes these with {@link @xeokit/scene!Geometry.positionsDecompressMatrix}.\n     *\n     * Vertex positions are required for all primitive types.\n     */\n    positionsCompressed: IntArrayParam;\n\n    /**\n     * GeometryBucket's UV coordinates, quantized as 16-bit integers.\n     *\n     * Internally, the Viewer de-quantizes these with {@link @xeokit/scene!Geometry.uvsDecompressMatrix}.\n     */\n    uvsCompressed?: IntArrayParam;\n\n    /**\n     * GeometryBucket's vertex RGB colors, quantized as 8-bit integers.\n     */\n    colorsCompressed?: IntArrayParam;\n\n    /**\n     * GeometryBucket's primitive indices.\n     *\n     * This is either an array of 8-bit, 16-bit or 32-bit values.\n     */\n    indices?: IntArrayParam;\n\n    /**\n     * GeometryBucket's edge indices.\n     *\n     * This is either an array of 8-bit, 16-bit or 32-bit values.\n     */\n    edgeIndices?: IntArrayParam;\n\n    constructor(geometryBucketParams: GeometryBucketParams) {\n        this.positionsCompressed = geometryBucketParams.positionsCompressed;\n        this.uvsCompressed = geometryBucketParams.uvsCompressed;\n        this.colorsCompressed = geometryBucketParams.colorsCompressed;\n        this.indices = geometryBucketParams.indices;\n        this.edgeIndices = geometryBucketParams.edgeIndices;\n    }\n}","import type {FloatArrayParam} from \"@xeokit/math\";\nimport {GeometryBucket} from \"./GeometryBucket\";\nimport type {GeometryCompressedParams} from \"./GeometryCompressedParams\";\nimport type {RendererGeometry} from \"./RendererGeometry\";\n\n/**\n * A geometry in a {@link SceneModel}.\n *\n * * Stored in {@link @xeokit/scene!SceneModel.geometries | SceneModel.geometries}\n * * Created with {@link @xeokit/scene!SceneModel.createGeometry | SceneModel.createGeometry}\n * and {@link @xeokit/scene!SceneModel.createGeometryCompressed | SceneModel.createGeometryCompressed}\n * * Referenced by {@link @xeokit/scene!SceneObject.geometry}\n *\n * See {@link \"@xeokit/scene\"} for usage.\n */\nexport class Geometry {\n\n    /**\n     * ID for the geometry.\n     */\n    id: string;\n\n    /**\n     * Primitive type.\n     *\n     * Possible values are {@link SolidPrimitive}, {@link SurfacePrimitive}, {@link LinesPrimitive}, {@link PointsPrimitive}\n     * and {@link TrianglesPrimitive}.\n     */\n    primitive: number;\n\n    /**\n     * Matrix to decompress {@link @xeokit/scene!GeometryBucketParams.positionsCompressed}.\n     */\n    positionsDecompressMatrix: FloatArrayParam;\n\n    /**\n     * Axis-aligned, non-quantized 3D boundary of the geometry's vertex positions.\n     */\n    aabb?: FloatArrayParam;\n\n    /**\n     * 4x4 matrix to de-quantize the geometry's UV coordinates, when UVs are provided.\n     */\n    uvsDecompressMatrix?: FloatArrayParam;\n\n    /**\n     * The geometry arrays, organized into buckets for optimal memory use.\n     *\n     * The bucketing strategy aims to reduce memory consumed by indices. There are three buckets, each with an indices array that\n     * requires a different number of bits for its values. The first bucket's indices contain 8-bit values in range [0...255],\n     * the second contains 16-bit values in range ````[256..65535]````, and the third contains 32-bit values in\n     * range ````[65536...2147483647]````. With this strategy, we avoid wasting storage bits on the 8-bit and 16-bit values.\n     *\n     * The buckets also partition the geometry positions and UVs, so that the indices are indexing positions and UVs\n     * that are local to their bucket. This further optimizes memory use, by reducing the values of large indices to small\n     * locally-offset values, which can reduce the number of bits they need.\n     */\n    geometryBuckets: GeometryBucket[];\n\n    /**\n     * Interface through which this Geometry can load any user-updated geometry arrays into the renderer.\n     *\n     * @internal\n     */\n    rendererGeometry: RendererGeometry | null;\n\n    constructor(params: GeometryCompressedParams) {\n        this.geometryBuckets = [];\n        for (let i = 0, len = params.geometryBuckets.length; i < len; i++) {\n            this.geometryBuckets[i] = new GeometryBucket(params.geometryBuckets[i]);\n        }\n        this.id = params.id;\n        this.positionsDecompressMatrix = params.positionsDecompressMatrix;\n        this.primitive = params.primitive;\n    }\n}","import type {SceneObject} from \"./SceneObject\";\nimport type {Mesh} from \"./Mesh\";\nimport {decompressPositions3} from \"@xeokit/compression\";\nimport {transformPositions3} from \"@xeokit/matrix\";\nimport type {FloatArrayParam} from \"@xeokit/math\";\nimport type {Geometry} from \"./Geometry\";\nimport type {GeometryBucket} from \"./GeometryBucket\";\nimport {LinesPrimitive, TrianglesPrimitive} from \"@xeokit/constants\";\n\n/**\n * The {@link getSceneObjectGeometry} passes an instance of GeometryView to its callback\n * for each {@link GeometryBucket} it visits. The GeometryView provides the SceneObject, Mesh, Geometry and\n * GeometryBucket at the current state of iteration, along with accessors through which the caller can\n * get various resources that the GeometryView lazy-computes on-demand, such as decompressed vertex positions, World-space\n * vertex positons, and decompressed vertex UV coordinates.\n */\nexport interface GeometryView {\n\n    /**\n     * The current {@link SceneObject}.\n     */\n    object: SceneObject;\n\n    /**\n     * The current {@link Mesh}.\n     */\n    mesh: Mesh;\n\n    /**\n     * The current {@link Mesh | Mesh's} position in {@link SceneModel.meshes | SceneObject.meshes}.\n     */\n    meshIndex: number;\n\n    /**\n     * The current {@link Geometry}.\n     */\n    geometry: Geometry;\n\n    /**\n     * The current {@link GeometryBucket}.\n     */\n    geometryBucket: GeometryBucket;\n\n    /**\n     * The current {@link GeometryBucket | GeometryBucket's} position in {@link Geometry.geometryBuckets | Geometry.geometryBuckets }.\n     */\n    geometryBucketIndex: number;\n\n    /**\n     * The total number of {@link GeometryBucket | GeometryBuckets} within the current {@link SceneObject}..\n     */\n    readonly totalGeometryBuckets: number;\n\n    /**\n     * The number of primitives in the current {@link GeometryBucket}.\n     */\n    readonly numPrimitives: number;\n\n    /**\n     * The current 3D vertex positions, dequantized, as 32-bit floats.\n     */\n    readonly positionsDecompressed: FloatArrayParam;\n\n    /**\n     * The current 3D World-space vertex positions, dequantized and world-transformed, as 64-bit floats.\n     */\n    readonly positionsWorld: FloatArrayParam;\n\n    /**\n     * The current vertex UV coordinates, if any, dequantized to 32-bit floats.\n     */\n    readonly uvsDecompressed: FloatArrayParam;\n}\n\nclass GeometryViewImpl {\n\n    object: SceneObject | null;\n    mesh: Mesh | null;\n    meshIndex: number;\n    geometry: Geometry | null;\n    geometryBucket: GeometryBucket | null;\n    geometryBucketIndex: number;\n    #positionsDecompressed: Float32Array | null;\n    #positionsWorld: Float64Array | null;\n\n    constructor() {\n        this.object = null;\n        this.mesh = null;\n        this.meshIndex = 0;\n        this.geometry = null;\n        this.geometryBucket = null;\n        this.geometryBucketIndex = 0;\n        this.#positionsDecompressed = null;\n        this.#positionsWorld = null;\n    }\n\n    get totalGeometryBuckets() {\n        let totalGeometryBuckets = 0;\n        if (this.object) {\n            for (let i = 0, len = this.object.meshes.length; i < len; i++) {\n                totalGeometryBuckets += this.object.meshes[i].geometry.geometryBuckets.length;\n            }\n        }\n        return totalGeometryBuckets;\n    }\n\n    get numPrimitives() {\n        const primitiveType = (<Geometry>this.geometry).primitive;\n        const elementsPerPrimitiveType = (primitiveType === TrianglesPrimitive ? 3 : (primitiveType === LinesPrimitive ? 2 : 1));\n        return (<FloatArrayParam>(<GeometryBucket>this.geometryBucket).indices).length / elementsPerPrimitiveType;\n    }\n\n    get positionsDecompressed(): FloatArrayParam {\n        if (!this.#positionsDecompressed) {\n            this.#positionsDecompressed = new Float32Array((<GeometryBucket>this.geometryBucket).positionsCompressed.length);\n            decompressPositions3((<GeometryBucket>this.geometryBucket).positionsCompressed, (<Geometry>this.geometry).positionsDecompressMatrix, this.#positionsDecompressed);\n        }\n        return this.#positionsDecompressed;\n    }\n\n    get positionsWorld(): FloatArrayParam {\n        if (!this.#positionsWorld) {\n            const positionsDecompressed = this.positionsDecompressed;\n            this.#positionsWorld = new Float64Array(positionsDecompressed.length);\n            transformPositions3(positionsDecompressed, (<Mesh>this.mesh).matrix, this.#positionsWorld);\n        }\n        return this.#positionsWorld;\n    }\n\n    get uvsDecompressed(): FloatArrayParam | null{\n        return null;\n    }\n\n    reset() {\n        this.#positionsDecompressed = null;\n        this.#positionsWorld = null;\n    }\n}\n\nconst geometryView = new GeometryViewImpl();\n\n/**\n * Gets the uncompressed, World-space geometry of each {@link GeometryBucket} in each\n * {@link Geometry} in each {@link Mesh} in a {@link SceneObject}.\n *\n * If the callback returns ````true````, then this method immediately stops iterating and also returns ````true````.\n *\n * @param sceneObject\n * @param withEachGeometry\n */\nexport function getSceneObjectGeometry(sceneObject: SceneObject, withEachGeometry: (geometryView: GeometryView) => boolean): boolean {\n    geometryView.reset();\n    geometryView.object = sceneObject;\n    for (let i = 0, len = sceneObject.meshes.length; i < len; i++) {\n        const mesh = sceneObject.meshes[i];\n        geometryView.mesh = mesh;\n        geometryView.meshIndex = i;\n        const geometry = mesh.geometry;\n        geometryView.geometry = geometry;\n        for (let j = 0, lenj = geometry.geometryBuckets.length; j < lenj; j++) {\n            geometryView.geometryBucket = geometry.geometryBuckets[j];\n            geometryView.geometryBucketIndex = j;\n            if (withEachGeometry(<GeometryView>geometryView)) {\n                return true;\n            }\n        }\n    }\n    return false;\n}\n","import type {Mesh} from \"./Mesh\";\nimport type {FloatArrayParam} from \"@xeokit/math\";\nimport type {RendererObject} from \"./RendererObject\";\nimport type {Scene} from \"./Scene\";\nimport type {SceneModel} from \"./SceneModel\";\nimport {collapseAABB3, createAABB3, expandAABB3Points3} from \"@xeokit/boundaries\";\nimport {getSceneObjectGeometry} from \"./getSceneObjectGeometry\";\n\n/**\n * An object in a {@link @xeokit/scene!SceneModel}.\n *\n * * Stored in {@link @xeokit/scene!SceneModel.objects | SceneModel.objects} and {@link @xeokit/scene!Scene.objects | Scene.objects}\n * * Created with {@link @xeokit/scene!SceneModel.createObject | SceneModel.createObject}\n *\n * See {@link \"@xeokit/scene\"} for usage.\n */\nexport class SceneObject {\n\n    /**\n     * The {@link SceneModel} that contains this SceneObject.\n     */\n    public readonly model: SceneModel;\n\n    /**\n     * Unique ID of this SceneObject.\n     *\n     * SceneObjects are stored by ID in {@link Scene.objects | Scene.objects} and {@link SceneModel.objects | SceneModel.objects}.\n     */\n    public readonly id: string;\n\n    /**\n     * The {@link Mesh | Meshes} belonging to this SceneObject.\n     */\n    public readonly meshes: Mesh[];\n\n    /**\n     * Optional layer ID for this SceneObject.\n     */\n    public readonly layerId?: string;\n\n    /**\n     *  Internal interface through which a {@link SceneObject} can load property updates into a renderer.\n     *\n     *  This is defined while the owner {@link SceneModel} has been added to a {@link @xeokit/viewer!Viewer | Viewer}.\n     *\n     * @internal\n     */\n    rendererObject: RendererObject | null;\n\n    #aabb: FloatArrayParam;\n    #aabbDirty: boolean;\n\n    /**\n     * @private\n     */\n    constructor(cfg: {\n        model: SceneModel;\n        meshes: Mesh[];\n        id: string;\n        layerId?: string;\n    }) {\n        this.id = cfg.id;\n        this.layerId = cfg.layerId;\n        this.meshes = cfg.meshes;\n        this.#aabb = createAABB3();\n        this.#aabbDirty = true;\n        this.rendererObject = null;\n    }\n\n    /**\n     * Gets the axis-aligned 3D World-space boundary of this SceneObject.\n     */\n    get aabb(): FloatArrayParam {\n        if (this.#aabbDirty) {\n            collapseAABB3(this.#aabb);\n            getSceneObjectGeometry(this, (geometryView) => {\n                expandAABB3Points3(this.#aabb, geometryView.positionsWorld);\n                return false;\n            });\n            this.#aabbDirty = false;\n        }\n        return this.#aabb;\n    }\n\n    /**\n     * @private\n     */\n    setAABBDirty() {\n        this.#aabbDirty = true;\n    }\n}\n","import type {Texture} from \"./Texture\";\nimport type {TextureSetParams} from \"./TextureSetParams\";\nimport type {RendererTextureSet} from \"./RendererTextureSet\";\n\n/**\n * A set of {@link Texture | Textures} in a {@link SceneModel}.\n *\n * * Stored in {@link @xeokit/scene!SceneModel.textureSets | SceneModel.textureSets}\n * * Created with {@link @xeokit/scene!SceneModel.createTextureSet | SceneModel.createTextureSet}\n * * Referenced by {@link Mesh.textureSet | Mesh.textureSet}\n *\n * See {@link \"@xeokit/scene\"} for usage.\n */\nexport class TextureSet {\n\n    /**\n     * The ID of this TextureSet.\n     */\n    id: string;\n\n    /**\n     * The color {@link Texture} in this set.\n     */\n    colorTexture?: Texture;\n\n    /**\n     * The metallic-roughness {@link Texture} in this set.\n     */\n    metallicRoughnessTexture?: Texture;\n\n    /**\n     * The occlusion {@link Texture} in this set.\n     */\n    occlusionTexture?: Texture;\n\n    /**\n     * The emissive {@link Texture} in this set.\n     */\n    emissiveTexture?: Texture;\n\n    /**\n     *  Internal interface through which a TextureSet can load property updates into a renderer.\n     *\n     *  This is defined while the owner {@link SceneModel} has been added to a {@link @xeokit/viewer!Viewer | Viewer}.\n     *\n     * @internal\n     */\n    rendererTextureSet: RendererTextureSet | null;\n\n    /**\n     * @private\n     */\n    constructor(textureSetParams: TextureSetParams,\n                textures: {\n                    emissiveTexture?: Texture;\n                    occlusionTexture?: Texture;\n                    metallicRoughnessTexture?: Texture;\n                    colorTexture?: Texture;\n                }) {\n\n        this.id = textureSetParams.id;\n        this.colorTexture = textures.colorTexture;\n        this.metallicRoughnessTexture = textures.metallicRoughnessTexture;\n        this.occlusionTexture = textures.occlusionTexture;\n        this.emissiveTexture = textures.emissiveTexture;\n        this.rendererTextureSet = null;\n    }\n}","import {\n    ClampToEdgeWrapping,\n    GIFMediaType,\n    JPEGMediaType,\n    LinearEncoding,\n    LinearFilter,\n    LinearMipmapLinearFilter,\n    LinearMipMapLinearFilter,\n    LinearMipMapNearestFilter,\n    MirroredRepeatWrapping,\n    NearestFilter,\n    NearestMipMapLinearFilter,\n    NearestMipMapNearestFilter,\n    PNGMediaType,\n    RepeatWrapping,\n    sRGBEncoding\n} from \"@xeokit/constants\";\nimport type {FloatArrayParam} from \"@xeokit/math\";\nimport type {RendererTexture} from \"./RendererTexture\";\nimport type {TextureParams} from \"./TextureParams\";\nimport {createVec4} from \"@xeokit/matrix\";\n\n/**\n * A texture in a {@link SceneModel}.\n *\n * * Stored in {@link @xeokit/scene!SceneModel.textures | SceneModel.textures}\n * * Created with {@link @xeokit/scene!SceneModel.createTexture | SceneModel.createTexture}\n * * Referenced by {@link TextureSet.colorTexture | TextureSet.colorTexture},\n * {@link TextureSet.metallicRoughnessTexture | TextureSet.metallicRoughnessTexture},\n * {@link TextureSet.occlusionTexture | TextureSet.occlusionTexture} and {@link TextureSet.emissiveTexture | TextureSet.emissiveTexture}\n *\n * See {@link \"@xeokit/scene\"} for usage.\n */\nexport class Texture {\n\n    /**\n     *  Internal interface through which this {@link Texture} can load property updates into a renderer.\n     *\n     *  This is defined when the owner {@link SceneModel} has been added to a {@link @xeokit/viewer!Viewer | Viewer}.\n     *\n     * @internal\n     */\n    rendererTexture: RendererTexture | null;\n\n    /**\n     * ID for the texture.\n     */\n    id: string;\n\n    /**\n     * Path to an image file.\n     */\n    src?: string;\n\n    /**\n     * Image file data.\n     */\n    imageData?: any;\n\n    /**\n     * Transcoded texture data.\n     */\n    buffers?: ArrayBuffer[];\n\n    /**\n     * HTMLImage containing the texture image.\n     */\n    image?: HTMLImageElement;\n\n    /**\n     * Pixel height of the texture.\n     */\n    height: number;\n\n    /**\n     * Pixel width of the texture.\n     */\n    width: number;\n\n    /**\n     * True if the texture is compressed.\n     */\n    compressed: boolean;\n\n    /**\n     * Media type of this Texture.\n     *\n     * Supported values are {@link GIFMediaType}, {@link PNGMediaType} and {@link JPEGMediaType}.\n     *\n     * Ignored for compressed textures.\n     */\n    mediaType?: number;\n\n    /**\n     * How the texture is sampled when a texel covers more than one pixel.\n     *\n     * Supported values are {@link LinearFilter} and {@link NearestFilter}.\n     */\n    magFilter: number;\n\n    /**\n     * How the texture is sampled when a texel covers less than one pixel. Supported values\n     * are {@link LinearMipmapLinearFilter}, {@link LinearMipMapNearestFilter},\n     * {@link NearestMipMapNearestFilter}, {@link NearestMipMapLinearFilter}\n     * and {@link LinearMipMapLinearFilter}.\n     *\n     * Ignored for compressed textures.\n     */\n    minFilter: number;\n\n    /**\n     * S wrapping mode.\n     *\n     * Supported values are {@link ClampToEdgeWrapping}, {@link MirroredRepeatWrapping} and {@link RepeatWrapping}.\n     *\n     * Ignored for compressed textures.\n     */\n    wrapS: number;\n\n    /**\n     * T wrapping mode.\n     *\n     * Supported values are {@link ClampToEdgeWrapping}, {@link MirroredRepeatWrapping} and {@link RepeatWrapping}.\n     *\n     * Ignored for compressed textures.\n     */\n    wrapT: number;\n\n    /**\n     * R wrapping mode.\n     *\n     * Supported values are {@link ClampToEdgeWrapping}, {@link MirroredRepeatWrapping} and {@link RepeatWrapping}.\n     *\n     * Ignored for compressed textures.\n     */\n    wrapR: number;\n\n    /**\n     * Flips this Texture's source data along its vertical axis when ````true````.\n     */\n    flipY: boolean;\n\n    /**\n     * Texture encoding format.\n     *\n     * Supported values are {@link LinearEncoding} and {@link sRGBEncoding}.\n     */\n    encoding: number;\n\n    /**\n     * RGBA color to preload the texture with.\n     */\n    preloadColor: FloatArrayParam;\n\n    /**\n     * @private\n     */\n    channel: number;\n\n    /**\n     * @private\n     */\n    constructor(params: TextureParams) {\n        this.id = params.id;\n        this.imageData = params.imageData;\n        this.src = params.src;\n        this.mediaType = params.mediaType;\n        this.minFilter = params.minFilter || LinearMipMapNearestFilter;\n        this.magFilter = params.magFilter || LinearMipMapNearestFilter;\n        this.wrapS = params.wrapS || RepeatWrapping;\n        this.wrapT = params.wrapT || RepeatWrapping;\n        this.wrapR = params.wrapR || RepeatWrapping\n        this.encoding = params.encoding || LinearEncoding;\n        this.preloadColor = createVec4(params.preloadColor || [1, 1, 1, 1]);\n        this.channel = 0;\n        this.rendererTexture = null;\n    }\n}\n\n","import type {FloatArrayParam} from \"@xeokit/math\";\nimport {createMat4, createVec3, identityMat4} from \"@xeokit/matrix\";\nimport type {RendererMesh} from \"./RendererMesh\";\nimport type {Geometry} from \"./Geometry\";\nimport type {TextureSet} from \"./TextureSet\";\nimport type {SceneObject} from \"./SceneObject\";\n\n/**\n * A mesh in a {@link SceneModel}.\n *\n * * Stored in {@link @xeokit/scene!SceneModel.meshes | SceneModel.meshes}\n * * Created with {@link @xeokit/scene!SceneModel.createMesh | SceneModel.createMesh}\n * * Referenced by {@link @xeokit/scene!SceneModel.meshes | SceneObject.meshes}\n *\n * See {@link \"@xeokit/scene\"} for usage.\n */\nexport class Mesh {\n\n    /**\n     * Unique ID of this Mesh.\n     *\n     * Mesh is stored by this ID in {@link @xeokit/scene!SceneModel.meshes}.\n     */\n    id: string;\n\n    /**\n     * {@link @xeokit/scene!Geometry} used by this Mesh.\n     */\n    geometry: Geometry;\n\n    /**\n     * {@link @xeokit/scene!TextureSet} used by this Mesh.\n     */\n    textureSet?: TextureSet;\n\n    /**\n     *  Internal interface through which a {@link Mesh} can load property updates into a renderer.\n     *\n     *  This is defined when the owner {@link @xeokit/scene!SceneModel} has been added to a {@link @xeokit/viewer!Viewer | Viewer}.\n     *\n     * @internal\n     */\n    rendererMesh: RendererMesh | null;\n\n    /**\n     * The {@link @xeokit/scene!SceneObject} that uses this Mesh.\n     */\n    object: SceneObject | null;\n\n    #color: FloatArrayParam;\n    #matrix: FloatArrayParam;\n    #metallic: number;\n    #roughness: number;\n    #opacity: number;\n\n    /**\n     * @private\n     */\n    constructor(meshParams: {\n        id: string;\n        geometry: Geometry;\n        textureSet?: TextureSet;\n        matrix?: FloatArrayParam;\n        color?: FloatArrayParam;\n        opacity?: number;\n        roughness?: number;\n        metallic?: number;\n    }) {\n        this.id = meshParams.id;\n        this.#matrix = meshParams.matrix ? createMat4(meshParams.matrix) : identityMat4();\n        this.geometry = meshParams.geometry;\n        this.textureSet = meshParams.textureSet;\n        this.rendererMesh = null;\n\n        this.color = meshParams.color || createVec3([1, 1, 1]);\n        this.metallic = (meshParams.metallic !== null && meshParams.metallic !== undefined) ? meshParams.metallic : 0;\n        this.roughness = (meshParams.roughness !== null && meshParams.roughness !== undefined) ? meshParams.roughness : 1;\n        this.opacity = (meshParams.opacity !== undefined && meshParams.opacity !== null) ? meshParams.opacity : 1.0;\n    }\n\n    /**\n     * Gets the RGB color for this Mesh.\n     *\n     * Each element of the color is in range ````[0..1]````.\n     */\n    get color(): FloatArrayParam {\n        return this.#color;\n    }\n\n    /**\n     * Sets the RGB color for this Mesh.\n     *\n     * Each element of the color is in range ````[0..1]````.\n     */\n    set color(value: FloatArrayParam) {\n        let color = this.#color;\n        if (!color) {\n            color = this.#color = new Float32Array(4);\n            color[3] = 1;\n        }\n        if (value) {\n            color[0] = value[0];\n            color[1] = value[1];\n            color[2] = value[2];\n        } else {\n            color[0] = 1;\n            color[1] = 1;\n            color[2] = 1;\n        }\n        if (this.rendererMesh) {\n            this.rendererMesh.setColor(this.#color);\n        }\n    }\n\n    /**\n     * Gets this Mesh's local modeling transform matrix.\n     *\n     * Default value is ````[1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1]````.\n     *\n     * @type {FloatArrayParam}\n     */\n    get matrix(): FloatArrayParam {\n        return this.#matrix;\n    }\n\n    /**\n     * Updates this Mesh's local modeling transform matrix.\n     *\n     * Default value is ````[1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1]````.\n     *\n     * @type {FloatArrayParam}\n     */\n    set matrix(matrix: FloatArrayParam) {\n        if (matrix) {\n            // @ts-ignore\n            this.#matrix.set(matrix);\n        } else {\n            identityMat4(this.#matrix);\n        }\n        if (this.rendererMesh) {\n            this.rendererMesh.setMatrix(this.#matrix);\n        }\n        if (this.object) {\n            this.object.setAABBDirty();\n        }\n    }\n\n    /**\n     * Gets this Mesh's metallic factor.\n     *\n     * This is in the range ````[0..1]```` and indicates how metallic this Mesh is.\n     *\n     * ````1```` is metal, ````0```` is non-metal.\n     *\n     * Default value is ````1.0````.\n     */\n    get metallic(): number {\n        return this.#metallic;\n    }\n\n    /**\n     * Sets this Mesh's metallic factor.\n     *\n     * This is in the range ````[0..1]```` and indicates how metallic this Mesh is.\n     *\n     * ````1```` is metal, ````0```` is non-metal.\n     *\n     * Default value is ````1.0````.\n     */\n    set metallic(value: number) {\n        value = (value !== undefined && value !== null) ? value : 1.0;\n        if (this.#metallic === value) {\n            return;\n        }\n        this.#metallic = value;\n        if (this.rendererMesh) {\n            this.rendererMesh.setMetallic(this.#metallic);\n        }\n    }\n\n    /**\n     * Gets this Mesh's roughness factor.\n     *\n     * This factor is in the range ````[0..1]````, where ````0```` is fully smooth,````1```` is fully rough.\n     *\n     * Default value is ````1.0````.\n     */\n    get roughness(): number {\n        return this.#roughness;\n    }\n\n    /**\n     * Sets this Mesh's roughness factor.\n     *\n     * This factor is in the range ````[0..1]````, where ````0```` is fully smooth,````1```` is fully rough.\n     *\n     * Default value is ````1.0````.\n     */\n    set roughness(value: number) {\n        value = (value !== undefined && value !== null) ? value : 1.0;\n        if (this.#roughness === value) {\n            return;\n        }\n        this.#roughness = value;\n        if (this.rendererMesh) {\n            this.rendererMesh.setRoughness(this.#roughness);\n        }\n    }\n\n    /**\n     * Gets the opacity factor for this Mesh.\n     *\n     * This is a factor in range ````[0..1]````.\n     */\n    get opacity(): number {\n        return this.#opacity;\n    }\n\n    /**\n     * Sets the opacity factor for this Mesh.\n     *\n     * This is a factor in range ````[0..1]````.\n     */\n    set opacity(opacity: number) {\n        opacity = (opacity !== undefined && opacity !== null) ? opacity : 1.0;\n        if (this.#opacity === opacity) {\n            return;\n        }\n        this.#opacity = opacity;\n        if (this.rendererMesh) {\n            //       this.rendererMesh.setOpacity(this.#opacity);\n        }\n    }\n}\n","import {DEGTORAD, FloatArrayParam, IntArrayParam} from \"@xeokit/math\";\nimport {createVec3, cross3Vec3, dotVec3, normalizeVec3, subVec3} from \"@xeokit/matrix\";\nimport {decompressPoint3} from \"@xeokit/compression\";\n\nconst uniquePositions: number[] = [];\nconst indicesLookup: number[] = [];\nconst indicesReverseLookup: number[] = [];\nconst weldedIndices: number[] = [];\n\n// TODO: Optimize with caching, but need to cater to both compressed and uncompressed positions\n\nconst faces: { normal: number[]; }[] = [];\nlet numFaces = 0;\nconst compa = new Uint16Array(3);\nconst compb = new Uint16Array(3);\nconst compc = new Uint16Array(3);\nconst a = createVec3();\nconst b = createVec3();\nconst c = createVec3();\nconst cb = createVec3();\nconst ab = createVec3();\nconst cross = createVec3();\nconst normal = createVec3();\n\nfunction weldVertices(positions: FloatArrayParam, indices: IntArrayParam) {\n    const positionsMap = {}; // Hashmap for looking up vertices by position coordinates (and making sure they are unique)\n    let vx;\n    let vy;\n    let vz;\n    let key;\n    const precisionPoints = 4; // number of decimal points, e.g. 4 for epsilon of 0.0001\n    const precision = Math.pow(10, precisionPoints);\n    let i;\n    let len;\n    let lenUniquePositions = 0;\n    for (i = 0, len = positions.length; i < len; i += 3) {\n        vx = positions[i];\n        vy = positions[i + 1];\n        vz = positions[i + 2];\n        key = Math.round(vx * precision) + '_' + Math.round(vy * precision) + '_' + Math.round(vz * precision);\n        // @ts-ignore\n        if (positionsMap[key] === undefined) {\n            // @ts-ignore\n            positionsMap[key] = lenUniquePositions / 3;\n            uniquePositions[lenUniquePositions++] = vx;\n            uniquePositions[lenUniquePositions++] = vy;\n            uniquePositions[lenUniquePositions++] = vz;\n        }\n        // @ts-ignore\n        indicesLookup[i / 3] = positionsMap[key];\n    }\n    for (i = 0, len = indices.length; i < len; i++) {\n        weldedIndices[i] = indicesLookup[indices[i]];\n        indicesReverseLookup[weldedIndices[i]] = indices[i];\n    }\n}\n\nfunction buildFaces(numIndices: number, positionsDecompressMatrix: FloatArrayParam) {\n    numFaces = 0;\n    for (let i = 0, len = numIndices; i < len; i += 3) {\n        const ia = ((weldedIndices[i]) * 3);\n        const ib = ((weldedIndices[i + 1]) * 3);\n        const ic = ((weldedIndices[i + 2]) * 3);\n        if (positionsDecompressMatrix) {\n            compa[0] = uniquePositions[ia];\n            compa[1] = uniquePositions[ia + 1];\n            compa[2] = uniquePositions[ia + 2];\n            compb[0] = uniquePositions[ib];\n            compb[1] = uniquePositions[ib + 1];\n            compb[2] = uniquePositions[ib + 2];\n            compc[0] = uniquePositions[ic];\n            compc[1] = uniquePositions[ic + 1];\n            compc[2] = uniquePositions[ic + 2];\n            // Decode\n            decompressPoint3(compa, positionsDecompressMatrix, a);\n            decompressPoint3(compb, positionsDecompressMatrix, b);\n            decompressPoint3(compc, positionsDecompressMatrix, c);\n        } else {\n            a[0] = uniquePositions[ia];\n            a[1] = uniquePositions[ia + 1];\n            a[2] = uniquePositions[ia + 2];\n            b[0] = uniquePositions[ib];\n            b[1] = uniquePositions[ib + 1];\n            b[2] = uniquePositions[ib + 2];\n            c[0] = uniquePositions[ic];\n            c[1] = uniquePositions[ic + 1];\n            c[2] = uniquePositions[ic + 2];\n        }\n        subVec3(c, b, cb);\n        subVec3(a, b, ab);\n        cross3Vec3(cb, ab, cross);\n        normalizeVec3(cross, normal);\n        // @ts-ignore\n        const face = faces[numFaces] || (faces[numFaces] = {normal: createVec3()});\n        face.normal[0] = normal[0];\n        face.normal[1] = normal[1];\n        face.normal[2] = normal[2];\n        numFaces++;\n    }\n}\n\n\n/**\n * Builds edge connectivity indices from a 3D triangle mesh given as vertex positions and triangle indices\n * @private\n */\nexport function buildEdgeIndices(\n    positions: FloatArrayParam,\n    indices: IntArrayParam,\n    positionsDecompressMatrix: FloatArrayParam,\n    edgeThreshold: number): IntArrayParam {\n\n    weldVertices(positions, indices);\n    buildFaces(indices.length, positionsDecompressMatrix);\n\n    const edgeIndices = [];\n    const thresholdDot = Math.cos(DEGTORAD * edgeThreshold);\n    const edges = {};\n\n    let edge1;\n    let edge2;\n    let index1;\n    let index2;\n    let key;\n    let largeIndex = false;\n    let edge;\n    let normal1;\n    let normal2;\n    let dot;\n    let ia;\n    let ib;\n\n    for (let i = 0, len = indices.length; i < len; i += 3) {\n        const faceIndex = i / 3;\n        for (let j = 0; j < 3; j++) {\n            edge1 = weldedIndices[i + j];\n            edge2 = weldedIndices[i + ((j + 1) % 3)];\n            index1 = Math.min(edge1, edge2);\n            index2 = Math.max(edge1, edge2);\n            key = index1 + \",\" + index2;\n            // @ts-ignore\n            if (edges[key] === undefined) {\n                // @ts-ignore\n                edges[key] = {\n                    index1: index1,\n                    index2: index2,\n                    face1: faceIndex,\n                    face2: undefined\n                };\n            } else {\n                // @ts-ignore\n                edges[key].face2 = faceIndex;\n            }\n        }\n    }\n\n    for (key in edges) {\n        // @ts-ignore\n        edge = edges[key];\n        // an edge is only rendered if the angle (in degrees) between the face normals of the adjoining faces exceeds this value. default = 1 degree.\n        if (edge.face2 !== undefined) {\n            normal1 = faces[edge.face1].normal;\n            normal2 = faces[edge.face2].normal;\n            dot = dotVec3(normal1, normal2);\n            if (dot > thresholdDot) {\n                continue;\n            }\n        }\n        ia = indicesReverseLookup[edge.index1];\n        ib = indicesReverseLookup[edge.index2];\n        if (!largeIndex && ia > 65535 || ib > 65535) {\n            largeIndex = true;\n        }\n        edgeIndices.push(ia);\n        edgeIndices.push(ib);\n    }\n\n    return (largeIndex) ? new Uint32Array(edgeIndices) : new Uint16Array(edgeIndices);\n}","/**\n * @author https://github.com/tmarti, with support from https://tribia.com/\n * @license MIT\n *\n * This file takes a geometry given by { positions, indices }, and returns\n * equivalent { positions, indices } arrays but which only contain unique\n * positions.\n *\n * The time is O(N logN) with the number of positions due to a pre-sorting\n * step, but is much more GC-friendly and actually faster than the classic O(N)\n * approach based in keeping a hash-based LUT to identify unique positions.\n */\n\nlet comparePositions: any = null;\n\n\n/**\n * This function obtains unique positions in the provided object\n * .positions array and calculates an index mapping, which is then\n * applied to the provided object .indices and .edgeindices.\n *\n * The input object items are not modified, and instead new set\n * of positions, indices and edgeIndices with the applied optimization\n * are returned.\n *\n * The algorithm, instead of being based in a hash-like LUT for\n * identifying unique positions, is based in pre-sorting the input\n * positions...\n *\n * (it's possible to define a _\"consistent ordering\"_ for the positions\n *  as positions are quantized and thus not suffer from float number\n *  comparison artifacts)\n *\n * ... so same positions are adjacent in the sorted array, and then\n * it's easy to scan linearly the sorted array. During the linear run,\n * we will know that we found a different position because the comparison\n * function will return != 0 between current and previous element.\n *\n * During this linear traversal of the array, a `unique counter` is used\n * in order to calculate the mapping between original indices and unique\n * indices.\n *\n * @param {*} mesh The input mesh to process, with `positions`, `indices` and `edgeIndices` keys.\n * @private\n * @returns An array with 3 elements: 0 => the uniquified positions; 1 and 2 => the remapped edges and edgeIndices arrays\n */\nexport function uniquifyPositions(mesh: any): [Uint16Array, Uint32Array, Uint32Array | undefined] {\n\n    let positionsCompressed = mesh.positionsCompressed;\n    let indices = mesh.indices;\n    let edgeIndices = mesh.edgeIndices;\n\n    setMaxNumberOfPositions(positionsCompressed.length / 3);\n\n    let seq = seqInit.slice(0, positionsCompressed.length / 3);\n    let remappings = seqInit.slice(0, positionsCompressed.length / 3);\n\n    comparePositions = positionsCompressed;\n\n    seq.sort(compareVertex);\n\n    let uniqueIdx = 0\n\n    remappings[seq[0]] = 0;\n\n    for (let i = 1, len = seq.length; i < len; i++) {\n        if (0 != compareVertex(seq[i], seq[i - 1])) {\n            uniqueIdx++;\n        }\n\n        remappings[seq[i]] = uniqueIdx;\n    }\n\n    const numUniquePositions = uniqueIdx + 1;\n\n    const uniquePositionsCompressed = new Uint16Array(numUniquePositions * 3);\n\n    uniqueIdx = 0\n\n    uniquePositionsCompressed [uniqueIdx * 3 + 0] = positionsCompressed [seq[0] * 3 + 0];\n    uniquePositionsCompressed [uniqueIdx * 3 + 1] = positionsCompressed [seq[0] * 3 + 1];\n    uniquePositionsCompressed [uniqueIdx * 3 + 2] = positionsCompressed [seq[0] * 3 + 2];\n\n    for (let i = 1, len = seq.length; i < len; i++) {\n        if (0 !== compareVertex(seq[i], seq[i - 1])) {\n            uniqueIdx++;\n\n            uniquePositionsCompressed [uniqueIdx * 3 + 0] = positionsCompressed [seq[i] * 3 + 0];\n            uniquePositionsCompressed [uniqueIdx * 3 + 1] = positionsCompressed [seq[i] * 3 + 1];\n            uniquePositionsCompressed [uniqueIdx * 3 + 2] = positionsCompressed [seq[i] * 3 + 2];\n        }\n\n        remappings[seq[i]] = uniqueIdx;\n    }\n\n    comparePositions = null;\n\n    let uniqueIndices = new Uint32Array(indices.length);\n\n    for (let i = 0, len = indices.length; i < len; i++) {\n        uniqueIndices[i] = remappings [indices[i]];\n    }\n\n    let uniqueEdgeIndices;\n\n    if (edgeIndices) {\n        uniqueEdgeIndices = new Uint32Array(edgeIndices.length);\n        for (let i = 0, len = edgeIndices.length; i < len; i++) {\n            uniqueEdgeIndices[i] = remappings [edgeIndices[i]];\n        }\n    }\n    return [\n        uniquePositionsCompressed,\n        uniqueIndices,\n        uniqueEdgeIndices\n    ];\n}\n\n\nfunction compareVertex(a: any, b: any) {\n    let res;\n\n    for (let i = 0; i < 3; i++) {\n        if (0 != (res = comparePositions[a * 3 + i] - comparePositions[b * 3 + i])) {\n            return res;\n        }\n    }\n\n    return 0;\n}\n\nlet seqInit: any = null;\n\nfunction setMaxNumberOfPositions(maxPositions: any) {\n    if (seqInit !== null && seqInit.length >= maxPositions) {\n        return;\n    }\n\n    seqInit = new Uint32Array(maxPositions);\n\n    for (let i = 0; i < maxPositions; i++) {\n        seqInit[i] = i;\n    }\n}\n\n","/**\n * @author https://github.com/tmarti, with support from https://tribia.com/\n * @license MIT\n **/\nimport type {IntArrayParam} from \"@xeokit/math\";\n\n\nconst MAX_RE_BUCKET_FAN_OUT = 8;\n\nlet bucketsForIndices: any = null;\n\nexport function rebucketPositions(\n    mesh: {\n        positionsCompressed: IntArrayParam,\n        indices: IntArrayParam,\n        edgeIndices?: IntArrayParam,\n    },\n    bitsPerBucket: any,\n    checkResult = false): {\n    positionsCompressed: IntArrayParam,\n    indices: IntArrayParam,\n    edgeIndices?: IntArrayParam\n}[] {\n\n    const positionsCompressed = (mesh.positionsCompressed || []);\n    const indices = preSortIndices(mesh.indices || [], bitsPerBucket);\n    const edgeIndices: any = [];//preSortEdgeIndices(mesh.edgeIndices || []);\n\n    /**\n     * Code adapted from https://stackoverflow.com/questions/22697936/binary-search-in-javascript\n     */\n    function edgeSearch(el0: any, el1: any) {\n        if (el0 > el1) {\n            let tmp = el0;\n            el0 = el1;\n            el1 = tmp;\n        }\n\n        function compare_fn(a: any, b: any) {\n            if (a != el0) {\n                return el0 - a;\n            }\n\n            if (b != el1) {\n                return el1 - b;\n            }\n\n            return 0;\n        }\n\n        var m = 0;\n        var n = (edgeIndices.length >> 1) - 1;\n        while (m <= n) {\n            var k = (n + m) >> 1;\n            var cmp = compare_fn(edgeIndices[k * 2], edgeIndices[k * 2 + 1]);\n            if (cmp > 0) {\n                m = k + 1;\n            } else if (cmp < 0) {\n                n = k - 1;\n            } else {\n                return k;\n                /**\n                 * Flat array of compressed integer vertex colors.\n                 *\n                 * Alternative to {@link @xeokit/scene!GeometryParams.colorsCompressed}.\n                 *\n                 * Ignored when {@link @xeokit/scene!GeometryParams.id} is defined.\n                 */\n            }\n        }\n        return -m - 1;\n    }\n\n    // console.log (edgeIndices);\n\n    // throw (e);\n\n    // console.log (`${mesh.edgeIndices.length / 2} edge indices`);\n    // console.log (`${edgeIndices.length / 2} edge indices sorted`);\n\n    const alreadyOutputEdgeIndices = new Int32Array(edgeIndices.length / 2);\n    alreadyOutputEdgeIndices.fill(0);\n\n    const numPositions = positionsCompressed.length / 3;\n\n    if (numPositions > ((1 << bitsPerBucket) * MAX_RE_BUCKET_FAN_OUT)) {\n        return [mesh];\n    }\n\n    const bucketIndicesRemap = new Int32Array(numPositions);\n    bucketIndicesRemap.fill(-1);\n\n    const buckets: any = [];\n\n    function addEmptyBucket() {\n        bucketIndicesRemap.fill(-1);\n\n        let newBucket: any = {\n            positionsCompressed: [],\n            indices: [],\n            edgeIndices: [],\n            maxNumPositions: (1 << bitsPerBucket) - bitsPerBucket,\n            numPositions: 0,\n            bucketNumber: buckets.length\n        };\n\n        buckets.push(newBucket);\n\n        return newBucket;\n    }\n\n    let currentBucket = addEmptyBucket();\n\n    // let currentBucket = 0;\n\n    let retVal = 0;\n\n    for (let i = 0, len = indices.length; i < len; i += 3) {\n        let additonalPositionsInBucket = 0;\n\n        const ii0 = indices[i];\n        const ii1 = indices[i + 1];\n        const ii2 = indices[i + 2];\n\n        if (bucketIndicesRemap[ii0] == -1) {\n            additonalPositionsInBucket++;\n        }\n\n        if (bucketIndicesRemap[ii1] == -1) {\n            additonalPositionsInBucket++;\n        }\n\n        if (bucketIndicesRemap[ii2] == -1) {\n            additonalPositionsInBucket++;\n        }\n\n        if ((additonalPositionsInBucket + currentBucket.numPositions) > currentBucket.maxNumPositions) {\n            currentBucket = addEmptyBucket();\n        }\n\n        if (currentBucket.bucketNumber > MAX_RE_BUCKET_FAN_OUT) {\n            return [mesh];\n        }\n\n        if (bucketIndicesRemap[ii0] == -1) {\n            bucketIndicesRemap[ii0] = currentBucket.numPositions++;\n            currentBucket.positionsCompressed.push(positionsCompressed[ii0 * 3]);\n            currentBucket.positionsCompressed.push(positionsCompressed[ii0 * 3 + 1]);\n            currentBucket.positionsCompressed.push(positionsCompressed[ii0 * 3 + 2]);\n        }\n\n        if (bucketIndicesRemap[ii1] == -1) {\n            bucketIndicesRemap[ii1] = currentBucket.numPositions++;\n            currentBucket.positionsCompressed.push(positionsCompressed[ii1 * 3]);\n            currentBucket.positionsCompressed.push(positionsCompressed[ii1 * 3 + 1]);\n            currentBucket.positionsCompressed.push(positionsCompressed[ii1 * 3 + 2]);\n        }\n\n        if (bucketIndicesRemap[ii2] == -1) {\n            bucketIndicesRemap[ii2] = currentBucket.numPositions++;\n            currentBucket.positionsCompressed.push(positionsCompressed[ii2 * 3]);\n            currentBucket.positionsCompressed.push(positionsCompressed[ii2 * 3 + 1]);\n            currentBucket.positionsCompressed.push(positionsCompressed[ii2 * 3 + 2]);\n        }\n\n        currentBucket.indices.push(bucketIndicesRemap[ii0]);\n        currentBucket.indices.push(bucketIndicesRemap[ii1]);\n        currentBucket.indices.push(bucketIndicesRemap[ii2]);\n\n        // Check possible edge1\n        let edgeIndex;\n\n        if ((edgeIndex = edgeSearch(ii0, ii1)) >= 0) {\n            if (alreadyOutputEdgeIndices[edgeIndex] == 0) {\n                alreadyOutputEdgeIndices[edgeIndex] = 1;\n\n                currentBucket.edgeIndices.push(bucketIndicesRemap[edgeIndices[edgeIndex * 2]]);\n                currentBucket.edgeIndices.push(bucketIndicesRemap[edgeIndices[edgeIndex * 2 + 1]]);\n            }\n        }\n\n        if ((edgeIndex = edgeSearch(ii0, ii2)) >= 0) {\n            if (alreadyOutputEdgeIndices[edgeIndex] == 0) {\n                alreadyOutputEdgeIndices[edgeIndex] = 1;\n\n                currentBucket.edgeIndices.push(bucketIndicesRemap[edgeIndices[edgeIndex * 2]]);\n                currentBucket.edgeIndices.push(bucketIndicesRemap[edgeIndices[edgeIndex * 2 + 1]]);\n            }\n        }\n\n        if ((edgeIndex = edgeSearch(ii1, ii2)) >= 0) {\n            if (alreadyOutputEdgeIndices[edgeIndex] == 0) {\n                alreadyOutputEdgeIndices[edgeIndex] = 1;\n\n                currentBucket.edgeIndices.push(bucketIndicesRemap[edgeIndices[edgeIndex * 2]]);\n                currentBucket.edgeIndices.push(bucketIndicesRemap[edgeIndices[edgeIndex * 2 + 1]]);\n            }\n        }\n    }\n\n    const prevBytesPerIndex = bitsPerBucket / 8 * 2;\n    const newBytesPerIndex = bitsPerBucket / 8;\n\n    const originalSize = positionsCompressed.length * 2 + (indices.length + edgeIndices.length) * prevBytesPerIndex;\n\n    let newSize = 0;\n    let newPositions = -positionsCompressed.length / 3;\n\n    buckets.forEach((bucket: any) => {\n        newSize += bucket.positionsCompressed.length * 2 + (bucket.indices.length + bucket.edgeIndices.length) * newBytesPerIndex;\n        newPositions += bucket.positionsCompressed.length / 3;\n    });\n\n    if (newSize > originalSize) {\n        return [mesh];\n    }\n\n    // console.log (\"added positions \" + newPositions + \", buckets: \" + buckets.length);\n\n    if (checkResult) {\n        doCheckResult(buckets, mesh);\n    }\n\n    // return [ mesh ];\n\n    return buckets;\n}\n\nfunction compareBuckets(a: any, b: any) {\n    let aa = a * 3;\n    let bb = b * 3;\n    let aa1, aa2, aa3, bb1, bb2, bb3;\n    const minBucketA = Math.min(\n        aa1 = bucketsForIndices[aa],\n        aa2 = bucketsForIndices[aa + 1],\n        aa3 = bucketsForIndices[aa + 2]\n    );\n    const minBucketB = Math.min(\n        bb1 = bucketsForIndices[bb],\n        bb2 = bucketsForIndices[bb + 1],\n        bb3 = bucketsForIndices[bb + 2]\n    );\n    if (minBucketA != minBucketB) {\n        return minBucketA - minBucketB;\n    }\n    const maxBucketA = Math.max(\n        aa1,\n        aa2,\n        aa3,\n    );\n    const maxBucketB = Math.max(\n        bb1,\n        bb2,\n        bb3,\n    );\n    if (maxBucketA != maxBucketB) {\n        return maxBucketA - maxBucketB;\n    }\n    return 0;\n}\n\nfunction preSortIndices(indices: any, bitsPerBucket: any) {\n    let seq = new Int32Array(indices.length / 3);\n    for (let i = 0, len = seq.length; i < len; i++) {\n        seq[i] = i;\n    }\n    bucketsForIndices = new Int32Array(indices.length);\n    for (let i = 0, len = indices.length; i < len; i++) {\n        bucketsForIndices[i] = indices[i] >> bitsPerBucket;\n    }\n    seq.sort(compareBuckets);\n    const sortedIndices = new Int32Array(indices.length);\n    for (let i = 0, len = seq.length; i < len; i++) {\n        sortedIndices[i * 3 + 0] = indices[seq[i] * 3 + 0];\n        sortedIndices[i * 3 + 1] = indices[seq[i] * 3 + 1];\n        sortedIndices[i * 3 + 2] = indices[seq[i] * 3 + 2];\n    }\n    return sortedIndices;\n}\n\nlet compareEdgeIndices: any = null;\n\nfunction compareIndices(a: any, b: any) {\n    let retVal = compareEdgeIndices[a * 2] - compareEdgeIndices[b * 2];\n    if (retVal != 0) {\n        return retVal;\n    }\n    return compareEdgeIndices[a * 2 + 1] - compareEdgeIndices[b * 2 + 1];\n}\n\nfunction preSortEdgeIndices(edgeIndices: any): any {\n    if ((edgeIndices || []).length == 0) {\n        return [];\n    }\n    let seq = new Int32Array(edgeIndices.length / 2);\n    for (let i = 0, len = seq.length; i < len; i++) {\n        seq[i] = i;\n    }\n    for (let i = 0, j = 0, len = edgeIndices.length; i < len; i += 2) {\n        if (edgeIndices[i] > edgeIndices[i + 1]) {\n            let tmp = edgeIndices[i];\n            edgeIndices[i] = edgeIndices[i + 1];\n            edgeIndices[i + 1] = tmp;\n        }\n    }\n    compareEdgeIndices = new Int32Array(edgeIndices);\n    seq.sort(compareIndices);\n    const sortedEdgeIndices = new Int32Array(edgeIndices.length);\n    for (let i = 0, len = seq.length; i < len; i++) {\n        sortedEdgeIndices[i * 2 + 0] = edgeIndices[seq[i] * 2 + 0];\n        sortedEdgeIndices[i * 2 + 1] = edgeIndices[seq[i] * 2 + 1];\n    }\n    return sortedEdgeIndices;\n}\n\n\nfunction unbucket(buckets: any) {\n    let positionsCompressed: any = [];\n    let indices: any = [];\n    let edgeIndices: any = [];\n\n    let positionsBase = 0;\n\n    buckets.forEach((bucket: any) => {\n        bucket.positionsCompressed.forEach((coord: any) => {\n            positionsCompressed.push(coord);\n        });\n\n        bucket.indices.forEach((index: any) => {\n            indices.push(index + positionsBase);\n        });\n\n        bucket.edgeIndices.forEach((edgeIndex: any) => {\n            edgeIndices.push(edgeIndex + positionsBase);\n        });\n\n        positionsBase += positionsCompressed.length / 3;\n    });\n\n    return {\n        positionsCompressed,\n        indices,\n        edgeIndices\n    };\n}\n\nfunction doCheckResult(buckets: any, mesh: any) {\n    const meshDict: any = {};\n    const edgesDict: any = {};\n\n    let edgeIndicesCount = 0;\n\n    buckets.forEach((bucket: any) => {\n        let indices = bucket.indices;\n        let edgeIndices = bucket.edgeIndices;\n        let positionsCompressed = bucket.positionsCompressed;\n\n        for (var i = 0, len = indices.length; i < len; i += 3) {\n            var key = positionsCompressed[indices[i] * 3] + \"_\" + positionsCompressed[indices[i] * 3 + 1] + \"_\" + positionsCompressed[indices[i] * 3 + 2] + \"/\" +\n                positionsCompressed[indices[i + 1] * 3] + \"_\" + positionsCompressed[indices[i + 1] * 3 + 1] + \"_\" + positionsCompressed[indices[i + 1] * 3 + 2] + \"/\" +\n                positionsCompressed[indices[i + 2] * 3] + \"_\" + positionsCompressed[indices[i + 2] * 3 + 1] + \"_\" + positionsCompressed[indices[i + 2] * 3 + 2];\n\n            meshDict[key] = true;\n        }\n\n        edgeIndicesCount += bucket.edgeIndices.length / 2;\n\n        for (var i = 0, len = edgeIndices.length; i < len; i += 2) {\n            var key = positionsCompressed[edgeIndices[i] * 3] + \"_\" + positionsCompressed[edgeIndices[i] * 3 + 1] + \"_\" + positionsCompressed[edgeIndices[i] * 3 + 2] + \"/\" +\n                positionsCompressed[edgeIndices[i + 1] * 3] + \"_\" + positionsCompressed[edgeIndices[i + 1] * 3 + 1] + \"_\" + positionsCompressed[edgeIndices[i + 1] * 3 + 2] + \"/\";\n\n            edgesDict[key] = true;\n        }\n    });\n\n    {\n        let indices = mesh.indices;\n        let edgeIndices = mesh.edgeIndices;\n        let positionsCompressed = mesh.positionsCompressed;\n\n        for (var i = 0, len = indices.length; i < len; i += 3) {\n            var key = positionsCompressed[indices[i] * 3] + \"_\" + positionsCompressed[indices[i] * 3 + 1] + \"_\" + positionsCompressed[indices[i] * 3 + 2] + \"/\" +\n                positionsCompressed[indices[i + 1] * 3] + \"_\" + positionsCompressed[indices[i + 1] * 3 + 1] + \"_\" + positionsCompressed[indices[i + 1] * 3 + 2] + \"/\" +\n                positionsCompressed[indices[i + 2] * 3] + \"_\" + positionsCompressed[indices[i + 2] * 3 + 1] + \"_\" + positionsCompressed[indices[i + 2] * 3 + 2];\n\n            if (!(key in meshDict)) {\n                console.log(\"Not found \" + key);\n                throw \"Ohhhh!\";\n            }\n        }\n\n        //  for (var i = 0, len = edgeIndices.length; i < len; i+=2)\n        //  {\n        //      var key = positionsCompressed[edgeIndices[i]*3] + \"_\" + positionsCompressed[edgeIndices[i]*3+1] + \"_\" + positionsCompressed[edgeIndices[i]*3+2] + \"/\" +\n        //                positionsCompressed[edgeIndices[i+1]*3] + \"_\" + positionsCompressed[edgeIndices[i+1]*3+1] + \"_\" + positionsCompressed[edgeIndices[i+1]*3+2] + \"/\";\n\n        //      if (!(key in edgesDict)) {\n        //          var key2 = edgeIndices[i] + \"_\" + edgeIndices[i+1];\n\n        //          console.log (\"   - Not found \" + key);\n        //          console.log (\"   - Not found \" + key2);\n        //         //  throw \"Ohhhh2!\";\n        //      }\n        //  }\n    }\n}\n\n","import {createMat4} from \"@xeokit/matrix\";\nimport {collapseAABB3, expandAABB3Points3} from \"@xeokit/boundaries\";\nimport {SolidPrimitive, SurfacePrimitive, TrianglesPrimitive} from \"@xeokit/constants\";\nimport {quantizePositions3} from \"@xeokit/compression\";\n\nimport {buildEdgeIndices} from \"./buildEdgeIndices\";\nimport {uniquifyPositions} from \"./calculateUniquePositions\";\nimport {rebucketPositions} from \"./rebucketPositions\";\nimport type {GeometryParams} from \"./GeometryParams\";\nimport type {GeometryCompressedParams} from \"./GeometryCompressedParams\";\nimport type {IntArrayParam} from \"@xeokit/math\";\n\n/**\n * Compresses a {@link @xeokit/scene!GeometryParams | GeometryParams} into a {@link @xeokit/scene!GeometryCompressedParams | GeometryCompressedParams}.\n *\n * See {@link @xeokit/scene} for usage examples.\n *\n * @param geometryParams Uncompressed geometry params.\n * @returns Compressed geometry params.\n */\nexport function compressGeometryParams(geometryParams: GeometryParams): GeometryCompressedParams {\n    const positionsDecompressMatrix = createMat4();\n    const aabb = collapseAABB3();\n    expandAABB3Points3(aabb, geometryParams.positions);\n    const positionsCompressed = quantizePositions3(geometryParams.positions, aabb, positionsDecompressMatrix);\n    const edgeIndices = (geometryParams.primitive === SolidPrimitive || geometryParams.primitive === SurfacePrimitive || geometryParams.primitive === TrianglesPrimitive) && geometryParams.indices\n        ? buildEdgeIndices(positionsCompressed, geometryParams.indices, positionsDecompressMatrix, 10)\n        : null;\n    let uniquePositionsCompressed: IntArrayParam;\n    let uniqueIndices: Uint32Array;\n    let uniqueEdgeIndices: Uint32Array | undefined;\n    [\n        uniquePositionsCompressed,\n        uniqueIndices,\n        uniqueEdgeIndices\n    ] = uniquifyPositions({\n        positionsCompressed,\n        uvs: geometryParams.uvs,\n        indices: geometryParams.indices,\n        edgeIndices: edgeIndices\n    });\n    const numUniquePositions = uniquePositionsCompressed.length / 3;\n    const geometryBuckets = <{\n        positionsCompressed: IntArrayParam,\n        indices: IntArrayParam,\n        edgeIndices: IntArrayParam\n    }[]>rebucketPositions({\n        positionsCompressed: uniquePositionsCompressed,\n        indices: uniqueIndices,\n        edgeIndices: uniqueEdgeIndices,\n    }, (numUniquePositions > (1 << 16)) ? 16 : 8);\n    return { // Assume that closed triangle mesh is decomposed into open surfaces\n        id: geometryParams.id,\n        primitive: (geometryParams.primitive === SolidPrimitive && geometryBuckets.length > 1) ? TrianglesPrimitive : geometryParams.primitive,\n        aabb,\n        positionsDecompressMatrix,\n        uvsDecompressMatrix: undefined,\n        geometryBuckets\n    };\n}","\n\nconst isBoolean = x => typeof x === 'boolean';\nconst isFunction = x => typeof x === 'function';\nexport const isObject = x => x !== null && typeof x === 'object';\nexport const isPureObject = x => isObject(x) && x.constructor === {}.constructor;\nexport const isPromise = x => isObject(x) && isFunction(x.then);\nexport const isIterable = x => x && typeof x[Symbol.iterator] === 'function';\nexport const isAsyncIterable = x => x && typeof x[Symbol.asyncIterator] === 'function';\nexport const isIterator = x => x && isFunction(x.next);\nexport const isResponse = x => typeof Response !== 'undefined' && x instanceof Response || x && x.arrayBuffer && x.text && x.json;\nexport const isFile = x => typeof File !== 'undefined' && x instanceof File;\nexport const isBlob = x => typeof Blob !== 'undefined' && x instanceof Blob;\n\nexport const isBuffer = x => x && typeof x === 'object' && x.isBuffer;\nexport const isWritableDOMStream = x => isObject(x) && isFunction(x.abort) && isFunction(x.getWriter);\nexport const isReadableDOMStream = x => typeof ReadableStream !== 'undefined' && x instanceof ReadableStream || isObject(x) && isFunction(x.tee) && isFunction(x.cancel) && isFunction(x.getReader);\n\nexport const isWritableNodeStream = x => isObject(x) && isFunction(x.end) && isFunction(x.write) && isBoolean(x.writable);\nexport const isReadableNodeStream = x => isObject(x) && isFunction(x.read) && isFunction(x.pipe) && isBoolean(x.readable);\nexport const isReadableStream = x => isReadableDOMStream(x) || isReadableNodeStream(x);\nexport const isWritableStream = x => isWritableDOMStream(x) || isWritableNodeStream(x);\n//# sourceMappingURL=is-type.js.map","\n\nconst DATA_URL_PATTERN = /^data:([-\\w.]+\\/[-\\w.+]+)(;|,)/;\nconst MIME_TYPE_PATTERN = /^([-\\w.]+\\/[-\\w.+]+)/;\n\nexport function parseMIMEType(mimeString) {\n  const matches = MIME_TYPE_PATTERN.exec(mimeString);\n  if (matches) {\n    return matches[1];\n  }\n  return mimeString;\n}\n\nexport function parseMIMETypeFromURL(url) {\n  const matches = DATA_URL_PATTERN.exec(url);\n  if (matches) {\n    return matches[1];\n  }\n  return '';\n}\n//# sourceMappingURL=mime-type-utils.js.map","import { isResponse, isBlob } from '../../javascript-utils/is-type';\nimport { parseMIMEType, parseMIMETypeFromURL } from './mime-type-utils';\nconst QUERY_STRING_PATTERN = /\\?.*/;\n\nexport function getResourceUrlAndType(resource) {\n  if (isResponse(resource)) {\n    const url = stripQueryString(resource.url || '');\n    const contentTypeHeader = resource.headers.get('content-type') || '';\n    return {\n      url,\n      type: parseMIMEType(contentTypeHeader) || parseMIMETypeFromURL(url)\n    };\n  }\n\n  if (isBlob(resource)) {\n    return {\n      url: stripQueryString(resource.name || ''),\n      type: resource.type || ''\n    };\n  }\n  if (typeof resource === 'string') {\n    return {\n      url: stripQueryString(resource),\n      type: parseMIMETypeFromURL(resource)\n    };\n  }\n\n  return {\n    url: '',\n    type: ''\n  };\n}\n\nexport function getResourceContentLength(resource) {\n  if (isResponse(resource)) {\n    return resource.headers['content-length'] || -1;\n  }\n  if (isBlob(resource)) {\n    return resource.size;\n  }\n  if (typeof resource === 'string') {\n    return resource.length;\n  }\n  if (resource instanceof ArrayBuffer) {\n    return resource.byteLength;\n  }\n  if (ArrayBuffer.isView(resource)) {\n    return resource.byteLength;\n  }\n  return -1;\n}\nfunction stripQueryString(url) {\n  return url.replace(QUERY_STRING_PATTERN, '');\n}\n//# sourceMappingURL=resource-utils.js.map","import { isResponse } from '../../javascript-utils/is-type';\nimport { getResourceContentLength, getResourceUrlAndType } from './resource-utils';\n\nexport async function makeResponse(resource) {\n  if (isResponse(resource)) {\n    return resource;\n  }\n\n  const headers = {};\n  const contentLength = getResourceContentLength(resource);\n  if (contentLength >= 0) {\n    headers['content-length'] = String(contentLength);\n  }\n\n  const {\n    url,\n    type\n  } = getResourceUrlAndType(resource);\n  if (type) {\n    headers['content-type'] = type;\n  }\n\n  const initialDataUrl = await getInitialDataUrl(resource);\n  if (initialDataUrl) {\n    headers['x-first-bytes'] = initialDataUrl;\n  }\n\n  if (typeof resource === 'string') {\n    resource = new TextEncoder().encode(resource);\n  }\n\n  const response = new Response(resource, {\n    headers\n  });\n  Object.defineProperty(response, 'url', {\n    value: url\n  });\n  return response;\n}\n\nexport async function checkResponse(response) {\n  if (!response.ok) {\n    const message = await getResponseError(response);\n    throw new Error(message);\n  }\n}\n\nexport function checkResponseSync(response) {\n  if (!response.ok) {\n    let message = \"\".concat(response.status, \" \").concat(response.statusText);\n    message = message.length > 60 ? \"\".concat(message.slice(0, 60), \"...\") : message;\n    throw new Error(message);\n  }\n}\n\nasync function getResponseError(response) {\n  let message = \"Failed to fetch resource \".concat(response.url, \" (\").concat(response.status, \"): \");\n  try {\n    const contentType = response.headers.get('Content-Type');\n    let text = response.statusText;\n    if (contentType.includes('application/json')) {\n      text += \" \".concat(await response.text());\n    }\n    message += text;\n    message = message.length > 60 ? \"\".concat(message.slice(0, 60), \"...\") : message;\n  } catch (error) {\n  }\n  return message;\n}\nasync function getInitialDataUrl(resource) {\n  const INITIAL_DATA_LENGTH = 5;\n  if (typeof resource === 'string') {\n    return \"data:,\".concat(resource.slice(0, INITIAL_DATA_LENGTH));\n  }\n  if (resource instanceof Blob) {\n    const blobSlice = resource.slice(0, 5);\n    return await new Promise(resolve => {\n      const reader = new FileReader();\n      reader.onload = event => {\n        var _event$target;\n        return resolve(event === null || event === void 0 ? void 0 : (_event$target = event.target) === null || _event$target === void 0 ? void 0 : _event$target.result);\n      };\n      reader.readAsDataURL(blobSlice);\n    });\n  }\n  if (resource instanceof ArrayBuffer) {\n    const slice = resource.slice(0, INITIAL_DATA_LENGTH);\n    const base64 = arrayBufferToBase64(slice);\n    return \"data:base64,\".concat(base64);\n  }\n  return null;\n}\n\nfunction arrayBufferToBase64(buffer) {\n  let binary = '';\n  const bytes = new Uint8Array(buffer);\n  for (let i = 0; i < bytes.byteLength; i++) {\n    binary += String.fromCharCode(bytes[i]);\n  }\n  return btoa(binary);\n}\n//# sourceMappingURL=response-utils.js.map","import { resolvePath } from '@loaders.gl/loader-utils';\nimport { makeResponse } from '../utils/response-utils';\n\nexport async function fetchFile(url, options) {\n  if (typeof url === 'string') {\n    url = resolvePath(url);\n    let fetchOptions = options;\n    if (options !== null && options !== void 0 && options.fetch && typeof (options === null || options === void 0 ? void 0 : options.fetch) !== 'function') {\n      fetchOptions = options.fetch;\n    }\n    return await fetch(url, fetchOptions);\n  }\n  return await makeResponse(url);\n}\n//# sourceMappingURL=fetch-file.js.map","import isElectron from './is-electron';\nexport default function isBrowser() {\n  const isNode = typeof process === 'object' && String(process) === '[object process]' && !process.browser;\n  return !isNode || isElectron();\n}\nexport function isBrowserMainThread() {\n  return isBrowser() && typeof document !== 'undefined';\n}\n//# sourceMappingURL=is-browser.js.map","export default function isElectron(mockUserAgent) {\n  if (typeof window !== 'undefined' && typeof window.process === 'object' && window.process.type === 'renderer') {\n    return true;\n  }\n\n  if (typeof process !== 'undefined' && typeof process.versions === 'object' && Boolean(process.versions['electron'])) {\n    return true;\n  }\n\n  const realUserAgent = typeof navigator === 'object' && typeof navigator.userAgent === 'string' && navigator.userAgent;\n  const userAgent = mockUserAgent || realUserAgent;\n\n  if (userAgent && userAgent.indexOf('Electron') >= 0) {\n    return true;\n  }\n\n  return false;\n}\n//# sourceMappingURL=is-electron.js.map","const globals = {\n  self: typeof self !== 'undefined' && self,\n  window: typeof window !== 'undefined' && window,\n  global: typeof global !== 'undefined' && global,\n  document: typeof document !== 'undefined' && document,\n  process: typeof process === 'object' && process\n};\nconst global_ = globalThis;\nconst self_ = globals.self || globals.window || globals.global;\nconst window_ = globals.window || globals.self || globals.global;\nconst document_ = globals.document || {};\nconst process_ = globals.process || {};\nconst console_ = console;\nexport { self_ as self, window_ as window, global_ as global, document_ as document, process_ as process, console_ as console };\n//# sourceMappingURL=globals.js.map","import checkIfBrowser from '../lib/is-browser';\nexport { self, window, global, document, process, console } from '../lib/globals';\nexport const VERSION = typeof __VERSION__ !== 'undefined' ? __VERSION__ : 'untranspiled source';\nexport const isBrowser = checkIfBrowser();\n//# sourceMappingURL=globals.js.map","import _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\n\nfunction getStorage(type) {\n  try {\n    const storage = window[type];\n    const x = '__storage_test__';\n    storage.setItem(x, x);\n    storage.removeItem(x);\n    return storage;\n  } catch (e) {\n    return null;\n  }\n}\n\nexport class LocalStorage {\n  constructor(id, defaultConfig) {\n    let type = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 'sessionStorage';\n\n    _defineProperty(this, \"storage\", void 0);\n\n    _defineProperty(this, \"id\", void 0);\n\n    _defineProperty(this, \"config\", void 0);\n\n    this.storage = getStorage(type);\n    this.id = id;\n    this.config = defaultConfig;\n\n    this._loadConfiguration();\n  }\n\n  getConfiguration() {\n    return this.config;\n  }\n\n  setConfiguration(configuration) {\n    Object.assign(this.config, configuration);\n\n    if (this.storage) {\n      const serialized = JSON.stringify(this.config);\n      this.storage.setItem(this.id, serialized);\n    }\n  }\n\n  _loadConfiguration() {\n    let configuration = {};\n\n    if (this.storage) {\n      const serializedConfiguration = this.storage.getItem(this.id);\n      configuration = serializedConfiguration ? JSON.parse(serializedConfiguration) : {};\n    }\n\n    Object.assign(this.config, configuration);\n    return this;\n  }\n\n}\n//# sourceMappingURL=local-storage.js.map","export function formatTime(ms) {\n  let formatted;\n\n  if (ms < 10) {\n    formatted = \"\".concat(ms.toFixed(2), \"ms\");\n  } else if (ms < 100) {\n    formatted = \"\".concat(ms.toFixed(1), \"ms\");\n  } else if (ms < 1000) {\n    formatted = \"\".concat(ms.toFixed(0), \"ms\");\n  } else {\n    formatted = \"\".concat((ms / 1000).toFixed(2), \"s\");\n  }\n\n  return formatted;\n}\nexport function leftPad(string) {\n  let length = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 8;\n  const padLength = Math.max(length - string.length, 0);\n  return \"\".concat(' '.repeat(padLength)).concat(string);\n}\nexport function rightPad(string) {\n  let length = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 8;\n  const padLength = Math.max(length - string.length, 0);\n  return \"\".concat(string).concat(' '.repeat(padLength));\n}\nexport function formatValue(v) {\n  let opts = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n  const EPSILON = 1e-16;\n  const {\n    isInteger = false\n  } = opts;\n\n  if (Array.isArray(v) || ArrayBuffer.isView(v)) {\n    return formatArrayValue(v, opts);\n  }\n\n  if (!Number.isFinite(v)) {\n    return String(v);\n  }\n\n  if (Math.abs(v) < EPSILON) {\n    return isInteger ? '0' : '0.';\n  }\n\n  if (isInteger) {\n    return v.toFixed(0);\n  }\n\n  if (Math.abs(v) > 100 && Math.abs(v) < 10000) {\n    return v.toFixed(0);\n  }\n\n  const string = v.toPrecision(2);\n  const decimal = string.indexOf('.0');\n  return decimal === string.length - 2 ? string.slice(0, -1) : string;\n}\n\nfunction formatArrayValue(v, opts) {\n  const {\n    maxElts = 16,\n    size = 1\n  } = opts;\n  let string = '[';\n\n  for (let i = 0; i < v.length && i < maxElts; ++i) {\n    if (i > 0) {\n      string += \",\".concat(i % size === 0 ? ' ' : '');\n    }\n\n    string += formatValue(v[i], opts);\n  }\n\n  const terminator = v.length > maxElts ? '...' : ']';\n  return \"\".concat(string).concat(terminator);\n}\n\nexport function formatImage(image, message, scale) {\n  let maxWidth = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : 600;\n  const imageUrl = image.src.replace(/\\(/g, '%28').replace(/\\)/g, '%29');\n\n  if (image.width > maxWidth) {\n    scale = Math.min(scale, maxWidth / image.width);\n  }\n\n  const width = image.width * scale;\n  const height = image.height * scale;\n  const style = ['font-size:1px;', \"padding:\".concat(Math.floor(height / 2), \"px \").concat(Math.floor(width / 2), \"px;\"), \"line-height:\".concat(height, \"px;\"), \"background:url(\".concat(imageUrl, \");\"), \"background-size:\".concat(width, \"px \").concat(height, \"px;\"), 'color:transparent;'].join('');\n  return [\"\".concat(message, \" %c+\"), style];\n}\n//# sourceMappingURL=formatters.js.map","import { isBrowser } from '@probe.gl/env';\nexport let COLOR;\n\n(function (COLOR) {\n  COLOR[COLOR[\"BLACK\"] = 30] = \"BLACK\";\n  COLOR[COLOR[\"RED\"] = 31] = \"RED\";\n  COLOR[COLOR[\"GREEN\"] = 32] = \"GREEN\";\n  COLOR[COLOR[\"YELLOW\"] = 33] = \"YELLOW\";\n  COLOR[COLOR[\"BLUE\"] = 34] = \"BLUE\";\n  COLOR[COLOR[\"MAGENTA\"] = 35] = \"MAGENTA\";\n  COLOR[COLOR[\"CYAN\"] = 36] = \"CYAN\";\n  COLOR[COLOR[\"WHITE\"] = 37] = \"WHITE\";\n  COLOR[COLOR[\"BRIGHT_BLACK\"] = 90] = \"BRIGHT_BLACK\";\n  COLOR[COLOR[\"BRIGHT_RED\"] = 91] = \"BRIGHT_RED\";\n  COLOR[COLOR[\"BRIGHT_GREEN\"] = 92] = \"BRIGHT_GREEN\";\n  COLOR[COLOR[\"BRIGHT_YELLOW\"] = 93] = \"BRIGHT_YELLOW\";\n  COLOR[COLOR[\"BRIGHT_BLUE\"] = 94] = \"BRIGHT_BLUE\";\n  COLOR[COLOR[\"BRIGHT_MAGENTA\"] = 95] = \"BRIGHT_MAGENTA\";\n  COLOR[COLOR[\"BRIGHT_CYAN\"] = 96] = \"BRIGHT_CYAN\";\n  COLOR[COLOR[\"BRIGHT_WHITE\"] = 97] = \"BRIGHT_WHITE\";\n})(COLOR || (COLOR = {}));\n\nfunction getColor(color) {\n  return typeof color === 'string' ? COLOR[color.toUpperCase()] || COLOR.WHITE : color;\n}\n\nexport function addColor(string, color, background) {\n  if (!isBrowser && typeof string === 'string') {\n    if (color) {\n      color = getColor(color);\n      string = \"\\x1B[\".concat(color, \"m\").concat(string, \"\\x1B[39m\");\n    }\n\n    if (background) {\n      color = getColor(background);\n      string = \"\\x1B[\".concat(background + 10, \"m\").concat(string, \"\\x1B[49m\");\n    }\n  }\n\n  return string;\n}\n//# sourceMappingURL=color.js.map","export default function assert(condition, message) {\n  if (!condition) {\n    throw new Error(message || 'Assertion failed');\n  }\n}\n//# sourceMappingURL=assert.js.map","import { window, process, isBrowser } from '@probe.gl/env';\nexport function getHiResTimestamp() {\n  let timestamp;\n\n  if (isBrowser && 'performance' in window) {\n    var _window$performance, _window$performance$n;\n\n    timestamp = window === null || window === void 0 ? void 0 : (_window$performance = window.performance) === null || _window$performance === void 0 ? void 0 : (_window$performance$n = _window$performance.now) === null || _window$performance$n === void 0 ? void 0 : _window$performance$n.call(_window$performance);\n  } else if ('hrtime' in process) {\n    var _process$hrtime;\n\n    const timeParts = process === null || process === void 0 ? void 0 : (_process$hrtime = process.hrtime) === null || _process$hrtime === void 0 ? void 0 : _process$hrtime.call(process);\n    timestamp = timeParts[0] * 1000 + timeParts[1] / 1e6;\n  } else {\n    timestamp = Date.now();\n  }\n\n  return timestamp;\n}\n//# sourceMappingURL=hi-res-timestamp.js.map","import _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport { VERSION, isBrowser } from '@probe.gl/env';\nimport { LocalStorage } from './utils/local-storage';\nimport { formatImage, formatTime, leftPad } from './utils/formatters';\nimport { addColor } from './utils/color';\nimport { autobind } from './utils/autobind';\nimport assert from './utils/assert';\nimport { getHiResTimestamp } from './utils/hi-res-timestamp';\nconst originalConsole = {\n  debug: isBrowser ? console.debug || console.log : console.log,\n  log: console.log,\n  info: console.info,\n  warn: console.warn,\n  error: console.error\n};\nconst DEFAULT_SETTINGS = {\n  enabled: true,\n  level: 0\n};\n\nfunction noop() {}\n\nconst cache = {};\nconst ONCE = {\n  once: true\n};\nexport class Log {\n  constructor() {\n    let {\n      id\n    } = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {\n      id: ''\n    };\n\n    _defineProperty(this, \"id\", void 0);\n\n    _defineProperty(this, \"VERSION\", VERSION);\n\n    _defineProperty(this, \"_startTs\", getHiResTimestamp());\n\n    _defineProperty(this, \"_deltaTs\", getHiResTimestamp());\n\n    _defineProperty(this, \"_storage\", void 0);\n\n    _defineProperty(this, \"userData\", {});\n\n    _defineProperty(this, \"LOG_THROTTLE_TIMEOUT\", 0);\n\n    this.id = id;\n    this.userData = {};\n    this._storage = new LocalStorage(\"__probe-\".concat(this.id, \"__\"), DEFAULT_SETTINGS);\n    this.timeStamp(\"\".concat(this.id, \" started\"));\n    autobind(this);\n    Object.seal(this);\n  }\n\n  set level(newLevel) {\n    this.setLevel(newLevel);\n  }\n\n  get level() {\n    return this.getLevel();\n  }\n\n  isEnabled() {\n    return this._storage.config.enabled;\n  }\n\n  getLevel() {\n    return this._storage.config.level;\n  }\n\n  getTotal() {\n    return Number((getHiResTimestamp() - this._startTs).toPrecision(10));\n  }\n\n  getDelta() {\n    return Number((getHiResTimestamp() - this._deltaTs).toPrecision(10));\n  }\n\n  set priority(newPriority) {\n    this.level = newPriority;\n  }\n\n  get priority() {\n    return this.level;\n  }\n\n  getPriority() {\n    return this.level;\n  }\n\n  enable() {\n    let enabled = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : true;\n\n    this._storage.setConfiguration({\n      enabled\n    });\n\n    return this;\n  }\n\n  setLevel(level) {\n    this._storage.setConfiguration({\n      level\n    });\n\n    return this;\n  }\n\n  get(setting) {\n    return this._storage.config[setting];\n  }\n\n  set(setting, value) {\n    this._storage.setConfiguration({\n      [setting]: value\n    });\n  }\n\n  settings() {\n    if (console.table) {\n      console.table(this._storage.config);\n    } else {\n      console.log(this._storage.config);\n    }\n  }\n\n  assert(condition, message) {\n    assert(condition, message);\n  }\n\n  warn(message) {\n    return this._getLogFunction(0, message, originalConsole.warn, arguments, ONCE);\n  }\n\n  error(message) {\n    return this._getLogFunction(0, message, originalConsole.error, arguments);\n  }\n\n  deprecated(oldUsage, newUsage) {\n    return this.warn(\"`\".concat(oldUsage, \"` is deprecated and will be removed in a later version. Use `\").concat(newUsage, \"` instead\"));\n  }\n\n  removed(oldUsage, newUsage) {\n    return this.error(\"`\".concat(oldUsage, \"` has been removed. Use `\").concat(newUsage, \"` instead\"));\n  }\n\n  probe(logLevel, message) {\n    return this._getLogFunction(logLevel, message, originalConsole.log, arguments, {\n      time: true,\n      once: true\n    });\n  }\n\n  log(logLevel, message) {\n    return this._getLogFunction(logLevel, message, originalConsole.debug, arguments);\n  }\n\n  info(logLevel, message) {\n    return this._getLogFunction(logLevel, message, console.info, arguments);\n  }\n\n  once(logLevel, message) {\n    for (var _len = arguments.length, args = new Array(_len > 2 ? _len - 2 : 0), _key = 2; _key < _len; _key++) {\n      args[_key - 2] = arguments[_key];\n    }\n\n    return this._getLogFunction(logLevel, message, originalConsole.debug || originalConsole.info, arguments, ONCE);\n  }\n\n  table(logLevel, table, columns) {\n    if (table) {\n      return this._getLogFunction(logLevel, table, console.table || noop, columns && [columns], {\n        tag: getTableHeader(table)\n      });\n    }\n\n    return noop;\n  }\n\n  image(_ref) {\n    let {\n      logLevel,\n      priority,\n      image,\n      message = '',\n      scale = 1\n    } = _ref;\n\n    if (!this._shouldLog(logLevel || priority)) {\n      return noop;\n    }\n\n    return isBrowser ? logImageInBrowser({\n      image,\n      message,\n      scale\n    }) : logImageInNode({\n      image,\n      message,\n      scale\n    });\n  }\n\n  time(logLevel, message) {\n    return this._getLogFunction(logLevel, message, console.time ? console.time : console.info);\n  }\n\n  timeEnd(logLevel, message) {\n    return this._getLogFunction(logLevel, message, console.timeEnd ? console.timeEnd : console.info);\n  }\n\n  timeStamp(logLevel, message) {\n    return this._getLogFunction(logLevel, message, console.timeStamp || noop);\n  }\n\n  group(logLevel, message) {\n    let opts = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {\n      collapsed: false\n    };\n    const options = normalizeArguments({\n      logLevel,\n      message,\n      opts\n    });\n    const {\n      collapsed\n    } = opts;\n    options.method = (collapsed ? console.groupCollapsed : console.group) || console.info;\n    return this._getLogFunction(options);\n  }\n\n  groupCollapsed(logLevel, message) {\n    let opts = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n    return this.group(logLevel, message, Object.assign({}, opts, {\n      collapsed: true\n    }));\n  }\n\n  groupEnd(logLevel) {\n    return this._getLogFunction(logLevel, '', console.groupEnd || noop);\n  }\n\n  withGroup(logLevel, message, func) {\n    this.group(logLevel, message)();\n\n    try {\n      func();\n    } finally {\n      this.groupEnd(logLevel)();\n    }\n  }\n\n  trace() {\n    if (console.trace) {\n      console.trace();\n    }\n  }\n\n  _shouldLog(logLevel) {\n    return this.isEnabled() && this.getLevel() >= normalizeLogLevel(logLevel);\n  }\n\n  _getLogFunction(logLevel, message, method, args, opts) {\n    if (this._shouldLog(logLevel)) {\n      opts = normalizeArguments({\n        logLevel,\n        message,\n        args,\n        opts\n      });\n      method = method || opts.method;\n      assert(method);\n      opts.total = this.getTotal();\n      opts.delta = this.getDelta();\n      this._deltaTs = getHiResTimestamp();\n      const tag = opts.tag || opts.message;\n\n      if (opts.once) {\n        if (!cache[tag]) {\n          cache[tag] = getHiResTimestamp();\n        } else {\n          return noop;\n        }\n      }\n\n      message = decorateMessage(this.id, opts.message, opts);\n      return method.bind(console, message, ...opts.args);\n    }\n\n    return noop;\n  }\n\n}\n\n_defineProperty(Log, \"VERSION\", VERSION);\n\nfunction normalizeLogLevel(logLevel) {\n  if (!logLevel) {\n    return 0;\n  }\n\n  let resolvedLevel;\n\n  switch (typeof logLevel) {\n    case 'number':\n      resolvedLevel = logLevel;\n      break;\n\n    case 'object':\n      resolvedLevel = logLevel.logLevel || logLevel.priority || 0;\n      break;\n\n    default:\n      return 0;\n  }\n\n  assert(Number.isFinite(resolvedLevel) && resolvedLevel >= 0);\n  return resolvedLevel;\n}\n\nexport function normalizeArguments(opts) {\n  const {\n    logLevel,\n    message\n  } = opts;\n  opts.logLevel = normalizeLogLevel(logLevel);\n  const args = opts.args ? Array.from(opts.args) : [];\n\n  while (args.length && args.shift() !== message) {}\n\n  switch (typeof logLevel) {\n    case 'string':\n    case 'function':\n      if (message !== undefined) {\n        args.unshift(message);\n      }\n\n      opts.message = logLevel;\n      break;\n\n    case 'object':\n      Object.assign(opts, logLevel);\n      break;\n\n    default:\n  }\n\n  if (typeof opts.message === 'function') {\n    opts.message = opts.message();\n  }\n\n  const messageType = typeof opts.message;\n  assert(messageType === 'string' || messageType === 'object');\n  return Object.assign(opts, {\n    args\n  }, opts.opts);\n}\n\nfunction decorateMessage(id, message, opts) {\n  if (typeof message === 'string') {\n    const time = opts.time ? leftPad(formatTime(opts.total)) : '';\n    message = opts.time ? \"\".concat(id, \": \").concat(time, \"  \").concat(message) : \"\".concat(id, \": \").concat(message);\n    message = addColor(message, opts.color, opts.background);\n  }\n\n  return message;\n}\n\nfunction logImageInNode(_ref2) {\n  let {\n    image,\n    message = '',\n    scale = 1\n  } = _ref2;\n  console.warn('removed');\n  return noop;\n}\n\nfunction logImageInBrowser(_ref3) {\n  let {\n    image,\n    message = '',\n    scale = 1\n  } = _ref3;\n\n  if (typeof image === 'string') {\n    const img = new Image();\n\n    img.onload = () => {\n      const args = formatImage(img, message, scale);\n      console.log(...args);\n    };\n\n    img.src = image;\n    return noop;\n  }\n\n  const element = image.nodeName || '';\n\n  if (element.toLowerCase() === 'img') {\n    console.log(...formatImage(image, message, scale));\n    return noop;\n  }\n\n  if (element.toLowerCase() === 'canvas') {\n    const img = new Image();\n\n    img.onload = () => console.log(...formatImage(img, message, scale));\n\n    img.src = image.toDataURL();\n    return noop;\n  }\n\n  return noop;\n}\n\nfunction getTableHeader(table) {\n  for (const key in table) {\n    for (const title in table[key]) {\n      return title || 'untitled';\n    }\n  }\n\n  return 'empty';\n}\n//# sourceMappingURL=log.js.map","export function autobind(obj) {\n  let predefined = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : ['constructor'];\n  const proto = Object.getPrototypeOf(obj);\n  const propNames = Object.getOwnPropertyNames(proto);\n\n  for (const key of propNames) {\n    if (typeof obj[key] === 'function') {\n      if (!predefined.find(name => key === name)) {\n        obj[key] = obj[key].bind(obj);\n      }\n    }\n  }\n}\n//# sourceMappingURL=autobind.js.map","import _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport { Log } from '@probe.gl/log';\nexport const probeLog = new Log({\n  id: 'loaders.gl'\n});\n\nexport class NullLog {\n  log() {\n    return () => {};\n  }\n  info() {\n    return () => {};\n  }\n  warn() {\n    return () => {};\n  }\n  error() {\n    return () => {};\n  }\n}\n\nexport class ConsoleLog {\n  constructor() {\n    _defineProperty(this, \"console\", void 0);\n    this.console = console;\n  }\n\n  log() {\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n    return this.console.log.bind(this.console, ...args);\n  }\n  info() {\n    for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n      args[_key2] = arguments[_key2];\n    }\n    return this.console.info.bind(this.console, ...args);\n  }\n  warn() {\n    for (var _len3 = arguments.length, args = new Array(_len3), _key3 = 0; _key3 < _len3; _key3++) {\n      args[_key3] = arguments[_key3];\n    }\n    return this.console.warn.bind(this.console, ...args);\n  }\n  error() {\n    for (var _len4 = arguments.length, args = new Array(_len4), _key4 = 0; _key4 < _len4; _key4++) {\n      args[_key4] = arguments[_key4];\n    }\n    return this.console.error.bind(this.console, ...args);\n  }\n}\n//# sourceMappingURL=loggers.js.map","import { isBrowser } from '@loaders.gl/loader-utils';\nimport { ConsoleLog } from './loggers';\nexport const DEFAULT_LOADER_OPTIONS = {\n  fetch: null,\n  mimeType: undefined,\n  nothrow: false,\n  log: new ConsoleLog(),\n\n  CDN: 'https://unpkg.com/@loaders.gl',\n  worker: true,\n  maxConcurrency: 3,\n  maxMobileConcurrency: 1,\n  reuseWorkers: isBrowser,\n  _nodeWorkers: false,\n  _workerType: '',\n\n  limit: 0,\n  _limitMB: 0,\n  batchSize: 'auto',\n  batchDebounceMs: 0,\n  metadata: false,\n  transforms: []\n};\nexport const REMOVED_LOADER_OPTIONS = {\n  throws: 'nothrow',\n  dataType: '(no longer used)',\n  uri: 'baseUri',\n  method: 'fetch.method',\n  headers: 'fetch.headers',\n  body: 'fetch.body',\n  mode: 'fetch.mode',\n  credentials: 'fetch.credentials',\n  cache: 'fetch.cache',\n  redirect: 'fetch.redirect',\n  referrer: 'fetch.referrer',\n  referrerPolicy: 'fetch.referrerPolicy',\n  integrity: 'fetch.integrity',\n  keepalive: 'fetch.keepalive',\n  signal: 'fetch.signal'\n};\n//# sourceMappingURL=option-defaults.js.map","import { isPureObject, isObject } from '../../javascript-utils/is-type';\nimport { fetchFile } from '../fetch/fetch-file';\nimport { probeLog, NullLog } from './loggers';\nimport { DEFAULT_LOADER_OPTIONS, REMOVED_LOADER_OPTIONS } from './option-defaults';\n\nexport function getGlobalLoaderState() {\n  globalThis.loaders = globalThis.loaders || {};\n  const {\n    loaders\n  } = globalThis;\n\n  loaders._state = loaders._state || {};\n  return loaders._state;\n}\n\nexport const getGlobalLoaderOptions = () => {\n  const state = getGlobalLoaderState();\n  state.globalOptions = state.globalOptions || {\n    ...DEFAULT_LOADER_OPTIONS\n  };\n  return state.globalOptions;\n};\n\nexport function setGlobalOptions(options) {\n  const state = getGlobalLoaderState();\n  const globalOptions = getGlobalLoaderOptions();\n  state.globalOptions = normalizeOptionsInternal(globalOptions, options);\n}\n\nexport function normalizeOptions(options, loader, loaders, url) {\n  loaders = loaders || [];\n  loaders = Array.isArray(loaders) ? loaders : [loaders];\n  validateOptions(options, loaders);\n  return normalizeOptionsInternal(loader, options, url);\n}\n\nexport function getFetchFunction(options, context) {\n  const globalOptions = getGlobalLoaderOptions();\n  const fetchOptions = options || globalOptions;\n\n  if (typeof fetchOptions.fetch === 'function') {\n    return fetchOptions.fetch;\n  }\n\n  if (isObject(fetchOptions.fetch)) {\n    return url => fetchFile(url, fetchOptions);\n  }\n\n  if (context !== null && context !== void 0 && context.fetch) {\n    return context === null || context === void 0 ? void 0 : context.fetch;\n  }\n\n  return fetchFile;\n}\n\nfunction validateOptions(options, loaders) {\n  validateOptionsObject(options, null, DEFAULT_LOADER_OPTIONS, REMOVED_LOADER_OPTIONS, loaders);\n  for (const loader of loaders) {\n    const idOptions = options && options[loader.id] || {};\n\n    const loaderOptions = loader.options && loader.options[loader.id] || {};\n    const deprecatedOptions = loader.deprecatedOptions && loader.deprecatedOptions[loader.id] || {};\n\n    validateOptionsObject(idOptions, loader.id, loaderOptions, deprecatedOptions, loaders);\n  }\n}\n\nfunction validateOptionsObject(options, id, defaultOptions, deprecatedOptions, loaders) {\n  const loaderName = id || 'Top level';\n  const prefix = id ? \"\".concat(id, \".\") : '';\n  for (const key in options) {\n    const isSubOptions = !id && isObject(options[key]);\n    const isBaseUriOption = key === 'baseUri' && !id;\n    const isWorkerUrlOption = key === 'workerUrl' && id;\n    if (!(key in defaultOptions) && !isBaseUriOption && !isWorkerUrlOption) {\n      if (key in deprecatedOptions) {\n        probeLog.warn(\"\".concat(loaderName, \" loader option '\").concat(prefix).concat(key, \"' no longer supported, use '\").concat(deprecatedOptions[key], \"'\"))();\n      } else if (!isSubOptions) {\n        const suggestion = findSimilarOption(key, loaders);\n        probeLog.warn(\"\".concat(loaderName, \" loader option '\").concat(prefix).concat(key, \"' not recognized. \").concat(suggestion))();\n      }\n    }\n  }\n}\nfunction findSimilarOption(optionKey, loaders) {\n  const lowerCaseOptionKey = optionKey.toLowerCase();\n  let bestSuggestion = '';\n  for (const loader of loaders) {\n    for (const key in loader.options) {\n      if (optionKey === key) {\n        return \"Did you mean '\".concat(loader.id, \".\").concat(key, \"'?\");\n      }\n      const lowerCaseKey = key.toLowerCase();\n      const isPartialMatch = lowerCaseOptionKey.startsWith(lowerCaseKey) || lowerCaseKey.startsWith(lowerCaseOptionKey);\n      if (isPartialMatch) {\n        bestSuggestion = bestSuggestion || \"Did you mean '\".concat(loader.id, \".\").concat(key, \"'?\");\n      }\n    }\n  }\n  return bestSuggestion;\n}\nfunction normalizeOptionsInternal(loader, options, url) {\n  const loaderDefaultOptions = loader.options || {};\n  const mergedOptions = {\n    ...loaderDefaultOptions\n  };\n  addUrlOptions(mergedOptions, url);\n\n  if (mergedOptions.log === null) {\n    mergedOptions.log = new NullLog();\n  }\n  mergeNestedFields(mergedOptions, getGlobalLoaderOptions());\n  mergeNestedFields(mergedOptions, options);\n  return mergedOptions;\n}\n\nfunction mergeNestedFields(mergedOptions, options) {\n  for (const key in options) {\n    if (key in options) {\n      const value = options[key];\n      if (isPureObject(value) && isPureObject(mergedOptions[key])) {\n        mergedOptions[key] = {\n          ...mergedOptions[key],\n          ...options[key]\n        };\n      } else {\n        mergedOptions[key] = options[key];\n      }\n    }\n  }\n}\n\nfunction addUrlOptions(options, url) {\n  if (url && !('baseUri' in options)) {\n    options.baseUri = url;\n  }\n}\n//# sourceMappingURL=option-utils.js.map","import { assert } from '@loaders.gl/loader-utils';\nexport function isLoaderObject(loader) {\n  var _loader;\n  if (!loader) {\n    return false;\n  }\n  if (Array.isArray(loader)) {\n    loader = loader[0];\n  }\n  const hasExtensions = Array.isArray((_loader = loader) === null || _loader === void 0 ? void 0 : _loader.extensions);\n\n  return hasExtensions;\n}\nexport function normalizeLoader(loader) {\n  var _loader2, _loader3;\n  assert(loader, 'null loader');\n  assert(isLoaderObject(loader), 'invalid loader');\n\n  let options;\n  if (Array.isArray(loader)) {\n    options = loader[1];\n    loader = loader[0];\n    loader = {\n      ...loader,\n      options: {\n        ...loader.options,\n        ...options\n      }\n    };\n  }\n\n  if ((_loader2 = loader) !== null && _loader2 !== void 0 && _loader2.parseTextSync || (_loader3 = loader) !== null && _loader3 !== void 0 && _loader3.parseText) {\n    loader.text = true;\n  }\n  if (!loader.text) {\n    loader.binary = true;\n  }\n  return loader;\n}\n//# sourceMappingURL=normalize-loader.js.map","import { normalizeLoader } from '../loader-utils/normalize-loader';\nimport { getGlobalLoaderState } from '../loader-utils/option-utils';\n\nconst getGlobalLoaderRegistry = () => {\n  const state = getGlobalLoaderState();\n  state.loaderRegistry = state.loaderRegistry || [];\n  return state.loaderRegistry;\n};\n\nexport function registerLoaders(loaders) {\n  const loaderRegistry = getGlobalLoaderRegistry();\n  loaders = Array.isArray(loaders) ? loaders : [loaders];\n  for (const loader of loaders) {\n    const normalizedLoader = normalizeLoader(loader);\n    if (!loaderRegistry.find(registeredLoader => normalizedLoader === registeredLoader)) {\n      loaderRegistry.unshift(normalizedLoader);\n    }\n  }\n}\nexport function getRegisteredLoaders() {\n  return getGlobalLoaderRegistry();\n}\n\nexport function _unregisterLoaders() {\n  const state = getGlobalLoaderState();\n  state.loaderRegistry = [];\n}\n//# sourceMappingURL=register-loaders.js.map","\nimport { Log } from '@probe.gl/log';\nexport const log = new Log({\n  id: 'loaders.gl'\n});\n//# sourceMappingURL=log.js.map","import { compareArrayBuffers, path } from '@loaders.gl/loader-utils';\nimport { normalizeLoader } from '../loader-utils/normalize-loader';\nimport { log } from '../utils/log';\nimport { getResourceUrlAndType } from '../utils/resource-utils';\nimport { getRegisteredLoaders } from './register-loaders';\nimport { isBlob } from '../../javascript-utils/is-type';\nconst EXT_PATTERN = /\\.([^.]+)$/;\n\nexport async function selectLoader(data) {\n  let loaders = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : [];\n  let options = arguments.length > 2 ? arguments[2] : undefined;\n  let context = arguments.length > 3 ? arguments[3] : undefined;\n  if (!validHTTPResponse(data)) {\n    return null;\n  }\n\n  let loader = selectLoaderSync(data, loaders, {\n    ...options,\n    nothrow: true\n  }, context);\n  if (loader) {\n    return loader;\n  }\n\n  if (isBlob(data)) {\n    data = await data.slice(0, 10).arrayBuffer();\n    loader = selectLoaderSync(data, loaders, options, context);\n  }\n\n  if (!loader && !(options !== null && options !== void 0 && options.nothrow)) {\n    throw new Error(getNoValidLoaderMessage(data));\n  }\n  return loader;\n}\n\nexport function selectLoaderSync(data) {\n  let loaders = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : [];\n  let options = arguments.length > 2 ? arguments[2] : undefined;\n  let context = arguments.length > 3 ? arguments[3] : undefined;\n  if (!validHTTPResponse(data)) {\n    return null;\n  }\n\n  if (loaders && !Array.isArray(loaders)) {\n    return normalizeLoader(loaders);\n  }\n\n  let candidateLoaders = [];\n  if (loaders) {\n    candidateLoaders = candidateLoaders.concat(loaders);\n  }\n  if (!(options !== null && options !== void 0 && options.ignoreRegisteredLoaders)) {\n    candidateLoaders.push(...getRegisteredLoaders());\n  }\n\n  normalizeLoaders(candidateLoaders);\n  const loader = selectLoaderInternal(data, candidateLoaders, options, context);\n\n  if (!loader && !(options !== null && options !== void 0 && options.nothrow)) {\n    throw new Error(getNoValidLoaderMessage(data));\n  }\n  return loader;\n}\n\nfunction selectLoaderInternal(data, loaders, options, context) {\n  const {\n    url,\n    type\n  } = getResourceUrlAndType(data);\n  const testUrl = url || (context === null || context === void 0 ? void 0 : context.url);\n  let loader = null;\n  let reason = '';\n\n  if (options !== null && options !== void 0 && options.mimeType) {\n    loader = findLoaderByMIMEType(loaders, options === null || options === void 0 ? void 0 : options.mimeType);\n    reason = \"match forced by supplied MIME type \".concat(options === null || options === void 0 ? void 0 : options.mimeType);\n  }\n\n  loader = loader || findLoaderByUrl(loaders, testUrl);\n  reason = reason || (loader ? \"matched url \".concat(testUrl) : '');\n\n  loader = loader || findLoaderByMIMEType(loaders, type);\n  reason = reason || (loader ? \"matched MIME type \".concat(type) : '');\n\n  loader = loader || findLoaderByInitialBytes(loaders, data);\n  reason = reason || (loader ? \"matched initial data \".concat(getFirstCharacters(data)) : '');\n\n  loader = loader || findLoaderByMIMEType(loaders, options === null || options === void 0 ? void 0 : options.fallbackMimeType);\n  reason = reason || (loader ? \"matched fallback MIME type \".concat(type) : '');\n  if (reason) {\n    var _loader;\n    log.log(1, \"selectLoader selected \".concat((_loader = loader) === null || _loader === void 0 ? void 0 : _loader.name, \": \").concat(reason, \".\"));\n  }\n  return loader;\n}\n\nfunction validHTTPResponse(data) {\n  if (data instanceof Response) {\n    if (data.status === 204) {\n      return false;\n    }\n  }\n  return true;\n}\n\nfunction getNoValidLoaderMessage(data) {\n  const {\n    url,\n    type\n  } = getResourceUrlAndType(data);\n  let message = 'No valid loader found (';\n  message += url ? \"\".concat(path.filename(url), \", \") : 'no url provided, ';\n  message += \"MIME type: \".concat(type ? \"\\\"\".concat(type, \"\\\"\") : 'not provided', \", \");\n  const firstCharacters = data ? getFirstCharacters(data) : '';\n  message += firstCharacters ? \" first bytes: \\\"\".concat(firstCharacters, \"\\\"\") : 'first bytes: not available';\n  message += ')';\n  return message;\n}\nfunction normalizeLoaders(loaders) {\n  for (const loader of loaders) {\n    normalizeLoader(loader);\n  }\n}\n\nfunction findLoaderByUrl(loaders, url) {\n  const match = url && EXT_PATTERN.exec(url);\n  const extension = match && match[1];\n  return extension ? findLoaderByExtension(loaders, extension) : null;\n}\nfunction findLoaderByExtension(loaders, extension) {\n  extension = extension.toLowerCase();\n  for (const loader of loaders) {\n    for (const loaderExtension of loader.extensions) {\n      if (loaderExtension.toLowerCase() === extension) {\n        return loader;\n      }\n    }\n  }\n  return null;\n}\nfunction findLoaderByMIMEType(loaders, mimeType) {\n  for (const loader of loaders) {\n    if (loader.mimeTypes && loader.mimeTypes.includes(mimeType)) {\n      return loader;\n    }\n\n    if (mimeType === \"application/x.\".concat(loader.id)) {\n      return loader;\n    }\n  }\n  return null;\n}\nfunction findLoaderByInitialBytes(loaders, data) {\n  if (!data) {\n    return null;\n  }\n  for (const loader of loaders) {\n    if (typeof data === 'string') {\n      if (testDataAgainstText(data, loader)) {\n        return loader;\n      }\n    } else if (ArrayBuffer.isView(data)) {\n      if (testDataAgainstBinary(data.buffer, data.byteOffset, loader)) {\n        return loader;\n      }\n    } else if (data instanceof ArrayBuffer) {\n      const byteOffset = 0;\n      if (testDataAgainstBinary(data, byteOffset, loader)) {\n        return loader;\n      }\n    }\n  }\n\n  return null;\n}\nfunction testDataAgainstText(data, loader) {\n  if (loader.testText) {\n    return loader.testText(data);\n  }\n  const tests = Array.isArray(loader.tests) ? loader.tests : [loader.tests];\n  return tests.some(test => data.startsWith(test));\n}\nfunction testDataAgainstBinary(data, byteOffset, loader) {\n  const tests = Array.isArray(loader.tests) ? loader.tests : [loader.tests];\n  return tests.some(test => testBinary(data, byteOffset, loader, test));\n}\nfunction testBinary(data, byteOffset, loader, test) {\n  if (test instanceof ArrayBuffer) {\n    return compareArrayBuffers(test, data, test.byteLength);\n  }\n  switch (typeof test) {\n    case 'function':\n      return test(data, loader);\n    case 'string':\n      const magic = getMagicString(data, byteOffset, test.length);\n      return test === magic;\n    default:\n      return false;\n  }\n}\nfunction getFirstCharacters(data) {\n  let length = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 5;\n  if (typeof data === 'string') {\n    return data.slice(0, length);\n  } else if (ArrayBuffer.isView(data)) {\n    return getMagicString(data.buffer, data.byteOffset, length);\n  } else if (data instanceof ArrayBuffer) {\n    const byteOffset = 0;\n    return getMagicString(data, byteOffset, length);\n  }\n  return '';\n}\nfunction getMagicString(arrayBuffer, byteOffset, length) {\n  if (arrayBuffer.byteLength < byteOffset + length) {\n    return '';\n  }\n  const dataView = new DataView(arrayBuffer);\n  let magic = '';\n  for (let i = 0; i < length; i++) {\n    magic += String.fromCharCode(dataView.getUint8(byteOffset + i));\n  }\n  return magic;\n}\n//# sourceMappingURL=select-loader.js.map","\n\nexport function filename(url) {\n  const slashIndex = url && url.lastIndexOf('/');\n  return slashIndex >= 0 ? url.substr(slashIndex + 1) : '';\n}\n\nexport function dirname(url) {\n  const slashIndex = url && url.lastIndexOf('/');\n  return slashIndex >= 0 ? url.substr(0, slashIndex) : '';\n}\n\nexport function join() {\n  for (var _len = arguments.length, parts = new Array(_len), _key = 0; _key < _len; _key++) {\n    parts[_key] = arguments[_key];\n  }\n  const separator = '/';\n  parts = parts.map((part, index) => {\n    if (index) {\n      part = part.replace(new RegExp(\"^\".concat(separator)), '');\n    }\n    if (index !== parts.length - 1) {\n      part = part.replace(new RegExp(\"\".concat(separator, \"$\")), '');\n    }\n    return part;\n  });\n  return parts.join(separator);\n}\n//# sourceMappingURL=path.js.map","const DEFAULT_CHUNK_SIZE = 256 * 1024;\n\nexport function* makeStringIterator(string, options) {\n  const chunkSize = (options === null || options === void 0 ? void 0 : options.chunkSize) || DEFAULT_CHUNK_SIZE;\n  let offset = 0;\n  const textEncoder = new TextEncoder();\n  while (offset < string.length) {\n    const chunkLength = Math.min(string.length - offset, chunkSize);\n    const chunk = string.slice(offset, offset + chunkLength);\n    offset += chunkLength;\n\n    yield textEncoder.encode(chunk);\n  }\n}\n//# sourceMappingURL=make-string-iterator.js.map","const DEFAULT_CHUNK_SIZE = 256 * 1024;\n\nexport function* makeArrayBufferIterator(arrayBuffer) {\n  let options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n  const {\n    chunkSize = DEFAULT_CHUNK_SIZE\n  } = options;\n  let byteOffset = 0;\n  while (byteOffset < arrayBuffer.byteLength) {\n    const chunkByteLength = Math.min(arrayBuffer.byteLength - byteOffset, chunkSize);\n    const chunk = new ArrayBuffer(chunkByteLength);\n\n    const sourceArray = new Uint8Array(arrayBuffer, byteOffset, chunkByteLength);\n    const chunkArray = new Uint8Array(chunk);\n    chunkArray.set(sourceArray);\n\n    byteOffset += chunkByteLength;\n    yield chunk;\n  }\n}\n//# sourceMappingURL=make-array-buffer-iterator.js.map","const DEFAULT_CHUNK_SIZE = 1024 * 1024;\n\nexport async function* makeBlobIterator(blob, options) {\n  const chunkSize = (options === null || options === void 0 ? void 0 : options.chunkSize) || DEFAULT_CHUNK_SIZE;\n  let offset = 0;\n  while (offset < blob.size) {\n    const end = offset + chunkSize;\n    const chunk = await blob.slice(offset, end).arrayBuffer();\n    offset = end;\n    yield chunk;\n  }\n}\n//# sourceMappingURL=make-blob-iterator.js.map","import { isBrowser, toArrayBuffer } from '@loaders.gl/loader-utils';\nexport function makeStreamIterator(stream, options) {\n  return isBrowser ? makeBrowserStreamIterator(stream, options) : makeNodeStreamIterator(stream, options);\n}\n\nasync function* makeBrowserStreamIterator(stream, options) {\n\n  const reader = stream.getReader();\n  let nextBatchPromise;\n  try {\n    while (true) {\n      const currentBatchPromise = nextBatchPromise || reader.read();\n      if (options !== null && options !== void 0 && options._streamReadAhead) {\n        nextBatchPromise = reader.read();\n      }\n      const {\n        done,\n        value\n      } = await currentBatchPromise;\n      if (done) {\n        return;\n      }\n      yield toArrayBuffer(value);\n    }\n  } catch (error) {\n    reader.releaseLock();\n  }\n}\n\nasync function* makeNodeStreamIterator(stream, options) {\n  for await (const chunk of stream) {\n    yield toArrayBuffer(chunk);\n  }\n}\n//# sourceMappingURL=make-stream-iterator.js.map","import { concatenateArrayBuffersAsync } from '@loaders.gl/loader-utils';\nimport { isResponse, isReadableStream, isAsyncIterable, isIterable, isIterator, isBlob, isBuffer } from '../../javascript-utils/is-type';\nimport { makeIterator } from '../../iterators/make-iterator/make-iterator';\nimport { checkResponse, makeResponse } from '../utils/response-utils';\nconst ERR_DATA = 'Cannot convert supplied data type';\n\nexport function getArrayBufferOrStringFromDataSync(data, loader, options) {\n  if (loader.text && typeof data === 'string') {\n    return data;\n  }\n  if (isBuffer(data)) {\n    data = data.buffer;\n  }\n  if (data instanceof ArrayBuffer) {\n    const arrayBuffer = data;\n    if (loader.text && !loader.binary) {\n      const textDecoder = new TextDecoder('utf8');\n      return textDecoder.decode(arrayBuffer);\n    }\n    return arrayBuffer;\n  }\n\n  if (ArrayBuffer.isView(data)) {\n    if (loader.text && !loader.binary) {\n      const textDecoder = new TextDecoder('utf8');\n      return textDecoder.decode(data);\n    }\n    let arrayBuffer = data.buffer;\n\n    const byteLength = data.byteLength || data.length;\n    if (data.byteOffset !== 0 || byteLength !== arrayBuffer.byteLength) {\n      arrayBuffer = arrayBuffer.slice(data.byteOffset, data.byteOffset + byteLength);\n    }\n    return arrayBuffer;\n  }\n  throw new Error(ERR_DATA);\n}\n\nexport async function getArrayBufferOrStringFromData(data, loader, options) {\n  const isArrayBuffer = data instanceof ArrayBuffer || ArrayBuffer.isView(data);\n  if (typeof data === 'string' || isArrayBuffer) {\n    return getArrayBufferOrStringFromDataSync(data, loader, options);\n  }\n\n  if (isBlob(data)) {\n    data = await makeResponse(data);\n  }\n  if (isResponse(data)) {\n    const response = data;\n    await checkResponse(response);\n    return loader.binary ? await response.arrayBuffer() : await response.text();\n  }\n  if (isReadableStream(data)) {\n    data = makeIterator(data, options);\n  }\n  if (isIterable(data) || isAsyncIterable(data)) {\n    return concatenateArrayBuffersAsync(data);\n  }\n  throw new Error(ERR_DATA);\n}\nexport async function getAsyncIterableFromData(data, options) {\n  if (isIterator(data)) {\n    return data;\n  }\n  if (isResponse(data)) {\n    const response = data;\n    await checkResponse(response);\n    const body = await response.body;\n    return makeIterator(body, options);\n  }\n  if (isBlob(data) || isReadableStream(data)) {\n    return makeIterator(data, options);\n  }\n  if (isAsyncIterable(data)) {\n    return data[Symbol.asyncIterator]();\n  }\n  return getIterableFromData(data);\n}\nexport async function getReadableStream(data) {\n  if (isReadableStream(data)) {\n    return data;\n  }\n  if (isResponse(data)) {\n    return data.body;\n  }\n  const response = await makeResponse(data);\n  return response.body;\n}\n\nfunction getIterableFromData(data) {\n  if (ArrayBuffer.isView(data)) {\n    return function* oneChunk() {\n      yield data.buffer;\n    }();\n  }\n  if (data instanceof ArrayBuffer) {\n    return function* oneChunk() {\n      yield data;\n    }();\n  }\n  if (isIterator(data)) {\n    return data;\n  }\n  if (isIterable(data)) {\n    return data[Symbol.iterator]();\n  }\n  throw new Error(ERR_DATA);\n}\n//# sourceMappingURL=get-data.js.map","import { assert, validateWorkerVersion } from '@loaders.gl/worker-utils';\nimport { parseWithWorker, canParseWithWorker } from '@loaders.gl/loader-utils';\nimport { isLoaderObject } from '../loader-utils/normalize-loader';\nimport { isResponse } from '../../javascript-utils/is-type';\nimport { normalizeOptions } from '../loader-utils/option-utils';\nimport { getArrayBufferOrStringFromData } from '../loader-utils/get-data';\nimport { getLoaderContext, getLoadersFromContext } from '../loader-utils/loader-context';\nimport { getResourceUrlAndType } from '../utils/resource-utils';\nimport { selectLoader } from './select-loader';\n\nexport async function parse(data, loaders, options, context) {\n  assert(!context || typeof context === 'object');\n\n  if (loaders && !Array.isArray(loaders) && !isLoaderObject(loaders)) {\n    context = undefined;\n    options = loaders;\n    loaders = undefined;\n  }\n  data = await data;\n  options = options || {};\n\n  const {\n    url\n  } = getResourceUrlAndType(data);\n\n  const typedLoaders = loaders;\n  const candidateLoaders = getLoadersFromContext(typedLoaders, context);\n  const loader = await selectLoader(data, candidateLoaders, options);\n  if (!loader) {\n    return null;\n  }\n\n  options = normalizeOptions(options, loader, candidateLoaders, url);\n\n  context = getLoaderContext({\n    url,\n    parse,\n    loaders: candidateLoaders\n  }, options, context);\n  return await parseWithLoader(loader, data, options, context);\n}\n\nasync function parseWithLoader(loader, data, options, context) {\n  validateWorkerVersion(loader);\n  if (isResponse(data)) {\n    const response = data;\n    const {\n      ok,\n      redirected,\n      status,\n      statusText,\n      type,\n      url\n    } = response;\n    const headers = Object.fromEntries(response.headers.entries());\n    context.response = {\n      headers,\n      ok,\n      redirected,\n      status,\n      statusText,\n      type,\n      url\n    };\n  }\n  data = await getArrayBufferOrStringFromData(data, loader, options);\n\n  if (loader.parseTextSync && typeof data === 'string') {\n    options.dataType = 'text';\n    return loader.parseTextSync(data, options, context, loader);\n  }\n\n  if (canParseWithWorker(loader, options)) {\n    return await parseWithWorker(loader, data, options, context, parse);\n  }\n\n  if (loader.parseText && typeof data === 'string') {\n    return await loader.parseText(data, options, context, loader);\n  }\n  if (loader.parse) {\n    return await loader.parse(data, options, context, loader);\n  }\n\n  assert(!loader.parseSync);\n\n  throw new Error(\"\".concat(loader.id, \" loader - no parser found and worker is disabled\"));\n}\n//# sourceMappingURL=parse.js.map","import { getFetchFunction } from './option-utils';\n\nexport function getLoaderContext(context, options) {\n  let previousContext = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : null;\n  if (previousContext) {\n    return previousContext;\n  }\n  const resolvedContext = {\n    fetch: getFetchFunction(options, context),\n    ...context\n  };\n\n  if (!Array.isArray(resolvedContext.loaders)) {\n    resolvedContext.loaders = null;\n  }\n  return resolvedContext;\n}\n\nexport function getLoadersFromContext(loaders, context) {\n  if (!context && loaders && !Array.isArray(loaders)) {\n    return loaders;\n  }\n\n  let candidateLoaders;\n  if (loaders) {\n    candidateLoaders = Array.isArray(loaders) ? loaders : [loaders];\n  }\n  if (context && context.loaders) {\n    const contextLoaders = Array.isArray(context.loaders) ? context.loaders : [context.loaders];\n    candidateLoaders = candidateLoaders ? [...candidateLoaders, ...contextLoaders] : contextLoaders;\n  }\n  return candidateLoaders && candidateLoaders.length ? candidateLoaders : null;\n}\n//# sourceMappingURL=loader-context.js.map","import { assert } from '../env-utils/assert';\nimport { VERSION } from '../env-utils/version';\n\nexport function validateWorkerVersion(worker) {\n  let coreVersion = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : VERSION;\n  assert(worker, 'no worker provided');\n  const workerVersion = worker.version;\n  if (!coreVersion || !workerVersion) {\n    return false;\n  }\n\n  return true;\n}\n\nfunction parseVersion(version) {\n  const parts = version.split('.').map(Number);\n  return {\n    major: parts[0],\n    minor: parts[1]\n  };\n}\n//# sourceMappingURL=validate-worker-version.js.map","import { makeStringIterator } from './make-string-iterator';\nimport { makeArrayBufferIterator } from './make-array-buffer-iterator';\nimport { makeBlobIterator } from './make-blob-iterator';\nimport { makeStreamIterator } from './make-stream-iterator';\nimport { isBlob, isReadableStream, isResponse } from '../../javascript-utils/is-type';\n\nexport function makeIterator(data, options) {\n  if (typeof data === 'string') {\n    return makeStringIterator(data, options);\n  }\n  if (data instanceof ArrayBuffer) {\n    return makeArrayBufferIterator(data, options);\n  }\n  if (isBlob(data)) {\n    return makeBlobIterator(data, options);\n  }\n  if (isReadableStream(data)) {\n    return makeStreamIterator(data, options);\n  }\n  if (isResponse(data)) {\n    const response = data;\n    return makeStreamIterator(response.body, options);\n  }\n  throw new Error('makeIterator');\n}\n//# sourceMappingURL=make-iterator.js.map","import { concatenateArrayBuffers } from '../binary-utils/array-buffer-utils';\n\nexport async function forEach(iterator, visitor) {\n  while (true) {\n    const {\n      done,\n      value\n    } = await iterator.next();\n    if (done) {\n      iterator.return();\n      return;\n    }\n    const cancel = visitor(value);\n    if (cancel) {\n      return;\n    }\n  }\n}\n\nexport async function concatenateArrayBuffersAsync(asyncIterator) {\n  const arrayBuffers = [];\n  for await (const chunk of asyncIterator) {\n    arrayBuffers.push(chunk);\n  }\n  return concatenateArrayBuffers(...arrayBuffers);\n}\nexport async function concatenateStringsAsync(asyncIterator) {\n  const strings = [];\n  for await (const chunk of asyncIterator) {\n    strings.push(chunk);\n  }\n  return strings.join('');\n}\n//# sourceMappingURL=async-iteration.js.map","import { canEncodeWithWorker } from '@loaders.gl/loader-utils';\nimport { processOnWorker } from '@loaders.gl/worker-utils';\nimport { concatenateArrayBuffers, resolvePath } from '@loaders.gl/loader-utils';\nimport { isBrowser } from '@loaders.gl/loader-utils';\nimport { writeFile } from '../fetch/write-file';\nimport { fetchFile } from '../fetch/fetch-file';\nimport { getLoaderOptions } from './loader-options';\n\nexport async function encode(data, writer, options) {\n  const globalOptions = getLoaderOptions();\n  options = {\n    ...globalOptions,\n    ...options\n  };\n  if (canEncodeWithWorker(writer, options)) {\n    return await processOnWorker(writer, data, options);\n  }\n\n  if (writer.encode) {\n    return await writer.encode(data, options);\n  }\n  if (writer.encodeSync) {\n    return writer.encodeSync(data, options);\n  }\n  if (writer.encodeText) {\n    return new TextEncoder().encode(await writer.encodeText(data, options));\n  }\n  if (writer.encodeInBatches) {\n    const batches = encodeInBatches(data, writer, options);\n\n    const chunks = [];\n    for await (const batch of batches) {\n      chunks.push(batch);\n    }\n    return concatenateArrayBuffers(...chunks);\n  }\n  if (!isBrowser && writer.encodeURLtoURL) {\n    const tmpInputFilename = getTemporaryFilename('input');\n    await writeFile(tmpInputFilename, data);\n    const tmpOutputFilename = getTemporaryFilename('output');\n    const outputFilename = await encodeURLtoURL(tmpInputFilename, tmpOutputFilename, writer, options);\n    const response = await fetchFile(outputFilename);\n    return response.arrayBuffer();\n  }\n  throw new Error('Writer could not encode data');\n}\n\nexport function encodeSync(data, writer, options) {\n  if (writer.encodeSync) {\n    return writer.encodeSync(data, options);\n  }\n  throw new Error('Writer could not synchronously encode data');\n}\n\nexport async function encodeText(data, writer, options) {\n  if (writer.text && writer.encodeText) {\n    return await writer.encodeText(data, options);\n  }\n  if (writer.text && (writer.encode || writer.encodeInBatches)) {\n    const arrayBuffer = await encode(data, writer, options);\n    return new TextDecoder().decode(arrayBuffer);\n  }\n  throw new Error('Writer could not encode data as text');\n}\n\nexport function encodeInBatches(data, writer, options) {\n  if (writer.encodeInBatches) {\n    const dataIterator = getIterator(data);\n    return writer.encodeInBatches(dataIterator, options);\n  }\n  throw new Error('Writer could not encode data in batches');\n}\n\nexport async function encodeURLtoURL(inputUrl, outputUrl, writer, options) {\n  inputUrl = resolvePath(inputUrl);\n  outputUrl = resolvePath(outputUrl);\n  if (isBrowser || !writer.encodeURLtoURL) {\n    throw new Error();\n  }\n  const outputFilename = await writer.encodeURLtoURL(inputUrl, outputUrl, options);\n  return outputFilename;\n}\n\nfunction getIterator(data) {\n  const dataIterator = [{\n    table: data,\n    start: 0,\n    end: data.length\n  }];\n  return dataIterator;\n}\n\nfunction getTemporaryFilename(filename) {\n  return \"/tmp/\".concat(filename);\n}\n//# sourceMappingURL=encode.js.map","import { WorkerFarm } from '@loaders.gl/worker-utils';\nimport { isBrowser } from '../env-utils/globals';\n\nexport function canEncodeWithWorker(writer, options) {\n  if (!WorkerFarm.isSupported()) {\n    return false;\n  }\n\n  if (!isBrowser && !(options !== null && options !== void 0 && options._nodeWorkers)) {\n    return false;\n  }\n  return writer.worker && (options === null || options === void 0 ? void 0 : options.worker);\n}\n//# sourceMappingURL=encode-with-worker.js.map","\nimport { isBrowser, assert, resolvePath } from '@loaders.gl/loader-utils';\nimport { fs, toBuffer } from '@loaders.gl/loader-utils';\nexport async function writeFile(filePath, arrayBufferOrString, options) {\n  filePath = resolvePath(filePath);\n  if (!isBrowser) {\n    await fs.writeFile(filePath, toBuffer(arrayBufferOrString), {\n      flag: 'w'\n    });\n  }\n  assert(false);\n}\nexport function writeFileSync(filePath, arrayBufferOrString, options) {\n  filePath = resolvePath(filePath);\n  if (!isBrowser) {\n    fs.writeFileSync(filePath, toBuffer(arrayBufferOrString), {\n      flag: 'w'\n    });\n  }\n  assert(false);\n}\n//# sourceMappingURL=write-file.js.map","import {KTX2BasisWriter} from \"@loaders.gl/textures\";\nimport {ImageLoader} from '@loaders.gl/images';\nimport {EventDispatcher} from \"strongly-typed-events\";\nimport {Component, EventEmitter, SDKError} from \"@xeokit/core\";\nimport {\n    LinesPrimitive,\n    PointsPrimitive,\n    SolidPrimitive,\n    SurfacePrimitive,\n    TrianglesPrimitive\n} from \"@xeokit/constants\";\nimport {createAABB3} from \"@xeokit/boundaries\";\n\nimport {Geometry} from \"./Geometry\";\nimport {SceneObject} from \"./SceneObject\";\nimport {TextureSet} from \"./TextureSet\";\nimport {Texture} from \"./Texture\";\nimport {Mesh} from \"./Mesh\";\nimport type {RendererModel} from \"./RendererModel\";\nimport type {TransformParams} from \"./TransformParams\";\nimport type {TextureSetParams} from \"./TextureSetParams\";\nimport type {GeometryParams} from \"./GeometryParams\";\nimport type {GeometryCompressedParams} from \"./GeometryCompressedParams\";\nimport type {MeshParams} from \"./MeshParams\";\nimport type {SceneObjectParams} from \"./SceneObjectParams\";\nimport type {TextureParams} from \"./TextureParams\";\nimport {compressGeometryParams} from \"./compressGeometryParams\";\nimport {encode, load} from \"@loaders.gl/core\";\nimport type {SceneModelParams} from \"./SceneModelParams\";\nimport type {Scene} from \"./Scene\";\n\n// XKT texture types\n\nconst COLOR_TEXTURE = 0;\nconst METALLIC_ROUGHNESS_TEXTURE = 1;\nconst NORMALS_TEXTURE = 2;\nconst EMISSIVE_TEXTURE = 3;\nconst OCCLUSION_TEXTURE = 4;\n\n// KTX2 encoding options for each texture type\n\nconst TEXTURE_ENCODING_OPTIONS: {\n    [key: string]: any\n} = {}\n\nTEXTURE_ENCODING_OPTIONS[COLOR_TEXTURE] = {\n    useSRGB: true,\n    qualityLevel: 50,\n    encodeUASTC: true,\n    mipmaps: true\n};\n\nTEXTURE_ENCODING_OPTIONS[EMISSIVE_TEXTURE] = {\n    useSRGB: true,\n    encodeUASTC: true,\n    qualityLevel: 10,\n    mipmaps: false\n};\n\nTEXTURE_ENCODING_OPTIONS[METALLIC_ROUGHNESS_TEXTURE] = {\n    useSRGB: false,\n    encodeUASTC: true,\n    qualityLevel: 50,\n    mipmaps: true // Needed for GGX roughness shading\n};\n\nTEXTURE_ENCODING_OPTIONS[NORMALS_TEXTURE] = {\n    useSRGB: false,\n    encodeUASTC: true,\n    qualityLevel: 10,\n    mipmaps: false\n};\n\nTEXTURE_ENCODING_OPTIONS[OCCLUSION_TEXTURE] = {\n    useSRGB: false,\n    encodeUASTC: true,\n    qualityLevel: 10,\n    mipmaps: false\n};\n\n/**\n * xeokit Geometry and Materials Model.\n *\n * * A representation of a model's geometry and materials within a {@link Scene}.\n * * Contains {@link SceneObject | SceneObjects}, {@link Mesh | Meshes}, {@link Geometry | Geometries} and {@link Texture | Textures}.\n * * Compresses textures using [Basis](/docs/pages/GLOSSARY.html#basis)\n * * Compresses geometry using [bucketing](/docs/pages/GLOSSARY.html#geometry-bucketing) and [quantization](/docs/pages/GLOSSARY.html#geometry-quantization)\n * * Viewable in the Browser with {@link @xeokit/viewer!Viewer}\n * * Importable from various model file formats, using {@link @xeokit/gltf!loadGLTF}, {@link @xeokit/las!loadLAS}, {@link @xeokit/cityjson!loadCityJSON}, {@link @xeokit/xkt!loadXKT} (etc)\n * * Exportable to XKT format using {@link @xeokit/xkt!saveXKT}\n * * Programmatically buildable using builder methods\n *\n * See {@link \"@xeokit/scene\"} for usage.\n */\nexport class SceneModel extends Component {\n\n    /**\n     * The {@link Scene} that contains this SceneModel.\n     */\n    public readonly scene: Scene;\n\n    /**\n     * Unique ID of this SceneModel.\n     *\n     * SceneModel are stored against this ID in {@link Scene.models}.\n     */\n    declare public readonly id: string;\n\n    /**\n     * If we want to view this SceneModel with a {@link @xeokit/viewer}, an\n     * optional ID of a {@link @xeokit/viewer!ViewLayer | ViewLayer} to view it in.\n     */\n    public readonly layerId?: string;\n\n    /**\n     * Indicates if this SceneModel has already been built.\n     *\n     * * Set ````true```` by {@link SceneModel.build | SceneModel.build}.\n     * * Subscribe to updates using {@link SceneModel.onBuilt | SceneModel.onBuilt} and {@link Scene.onModelCreated | Scene.onModelCreated}.\n     * * Don't create anything more in this SceneModel once it's built.\n     */\n    public built: boolean;\n\n    /**\n     * Indicates if this SceneModel has been destroyed.\n     *\n     * * Set ````true```` by {@link SceneModel.destroy | SceneModel.destroy}.\n     * * Don't create anything more in this SceneModel once it's destroyed.\n     */\n    declare readonly destroyed: boolean;\n\n    /**\n     * The edge threshold for automatic [edge primitive generation](/docs/pages/GLOSSARY.html#geometry-edge-generation).\n     */\n    public readonly edgeThreshold: number;\n\n    /**\n     * {@link @xeokit/scene!Geometry | Geometries} within this SceneModel, each mapped to {@link @xeokit/scene!Geometry.id | Geometry.id}.\n     *\n     * * Created by {@link SceneModel.createGeometry | SceneModel.createGeometry}.\n     */\n    public readonly geometries: { [key: string]: Geometry };\n\n    /**\n     * {@link Texture | Textures} within this SceneModel, each mapped to {@link Texture.id | Texture.id}.\n     *\n     * * Created by {@link SceneModel.createTexture | SceneModel.createTexture}.\n     * * Compressed asynchronously in {@link SceneModel.build | SceneModel.build}.\n     */\n    public readonly textures: { [key: string]: Texture };\n\n    /**\n     * {@link TextureSet | TextureSets} within this SceneModel, each mapped to {@link TextureSet.id | TextureSet.id}.\n     *\n     * * Created by {@link SceneModel.createTextureSet | SceneModel.createTextureSet}.\n     */\n    public readonly textureSets: { [key: string]: TextureSet };\n\n    /**\n     * {@link Mesh | Meshes} within this SceneModel, each mapped to {@link Mesh.id | Mesh.id}.\n     *\n     * * Created by {@link SceneModel.createMesh | SceneModel.createMesh}.\n     */\n    public readonly meshes: { [key: string]: Mesh };\n\n    /**\n     * {@link SceneObject | SceneObjects} within this SceneModel, each mapped to {@link SceneObject.id | SceneObject.id}.\n     *\n     * * Created by {@link SceneModel.createObject | SceneModel.createObject}.\n     */\n    readonly objects: { [key: string]: SceneObject };\n\n    /**\n     * The axis-aligned 3D World-space boundary of this SceneModel.\n     *\n     * * Created by {@link SceneModel.build | SceneModel.build}.\n     */\n    public readonly aabb: Float64Array;\n\n    /**\n     * Emits an event when this {@link @xeokit/scene!SceneModel | SceneModel} has been built.\n     *\n     * * Triggered by {@link SceneModel.build | SceneModel.build}.\n     *\n     * @event onBuilt\n     */\n    public readonly onBuilt: EventEmitter<SceneModel, null>;\n\n    /**\n     * Emits an event when this {@link @xeokit/scene!SceneModel | SceneModel} has been destroyed.\n     *\n     * * Triggered by {@link SceneModel.destroy | SceneModel.destroy}.\n     *\n     * @event\n     */\n    declare public readonly onDestroyed: EventEmitter<SceneModel, null>;\n\n    /**\n     *  Internal interface through which a SceneModel can load property updates into a renderer.\n     *\n     * @internal\n     */\n    public rendererModel: RendererModel | null;\n\n\n    #texturesList: Texture[];\n    #numObjects: number;\n    #meshUsedByObject: { [key: string]: boolean };\n\n    /**\n     * @private\n     */\n    constructor(scene: Scene, sceneModelParams: SceneModelParams) {\n        super(scene, {\n            id: sceneModelParams.id\n        });\n\n        this.scene = scene;\n\n        this.onBuilt = new EventEmitter(new EventDispatcher<SceneModel, null>());\n        this.onDestroyed = new EventEmitter(new EventDispatcher<SceneModel, null>());\n\n        this.#numObjects = 0;\n        this.#meshUsedByObject = {};\n\n        this.id = sceneModelParams.id || \"default\";\n        this.layerId = sceneModelParams.layerId;\n        this.edgeThreshold = 10;\n        this.geometries = {};\n        this.textures = {};\n        this.#texturesList = [];\n        this.textureSets = {};\n        this.meshes = {};\n        this.objects = {};\n        this.aabb = createAABB3();\n        this.built = false;\n        this.rendererModel = null;\n\n        this.fromJSON(sceneModelParams);\n    }\n\n    /**\n     * Adds components to this SceneModel.\n     *\n     * See {@link \"@xeokit/scene\"} for usage.\n     *\n     * @param sceneModelParams\n     * @returns *void*\n     * * On success.\n     * @returns *{@link @xeokit/core!SDKError}*\n     * * If this SceneModel has already been built.\n     * * If this SceneModel has already been destroyed.\n     * * A duplicate component ({@link SceneObject}, {@link Mesh}, {@link Geometry}, {@link Texture} etc.) was already created within this SceneModel.\n     */\n    fromJSON(sceneModelParams: SceneModelParams): void | SDKError {\n        if (this.destroyed) {\n            return new SDKError(\"Failed to add components to SceneModel - SceneModel already destroyed\");\n        }\n        if (this.built) {\n            return new SDKError(\"Failed to add components to SceneModel - SceneModel already built\");\n        }\n        if (sceneModelParams.geometries) {\n            for (let i = 0, len = sceneModelParams.geometries.length; i < len; i++) {\n                this.createGeometry(sceneModelParams.geometries[i]);\n            }\n        }\n        if (sceneModelParams.textures) {\n            for (let i = 0, len = sceneModelParams.textures.length; i < len; i++) {\n                this.createTexture(sceneModelParams.textures[i]);\n            }\n        }\n        if (sceneModelParams.textureSets) {\n            for (let i = 0, len = sceneModelParams.textureSets.length; i < len; i++) {\n                this.createTextureSet(sceneModelParams.textureSets[i]);\n            }\n        }\n        if (sceneModelParams.meshes) {\n            for (let i = 0, len = sceneModelParams.meshes.length; i < len; i++) {\n                this.createMesh(sceneModelParams.meshes[i]);\n            }\n        }\n        if (sceneModelParams.objects) {\n            for (let i = 0, len = sceneModelParams.objects.length; i < len; i++) {\n                this.createObject(sceneModelParams.objects[i]);\n            }\n        }\n    }\n\n    /**\n     * Creates a new {@link Transform} within this SceneModel.\n     *\n     * * Stores the new {@link Transform} in {@link SceneModel.transforms | SceneModel.transforms}.\n     *\n     * ### Usage\n     *\n     * ````javascript\n     * const spinningTransform = sceneModel.createTransform({\n     *      id: \"spinningTransform\",\n     *      rotation: [0, 10, 0]\n     * });\n     *\n     * const spinningTransformAgain = sceneModel.transforms[\"spinningTransform\"];\n     * ````\n     *\n     * See {@link \"@xeokit/scene\"} for more usage info.\n     *\n     * @param transformParams Transform creation parameters.\n     * @returns *{Transform}*\n     * * On success\n     * @returns *{@link @xeokit/core!SDKError}*\n     * * If SceneModel has already been built or destroyed.\n     */\n    createTransform(transformParams: TransformParams): void | SDKError {\n        if (this.destroyed) {\n            return new SDKError(\"Failed to create Transform in SceneModel - SceneModel already destroyed\");\n        }\n        if (this.built) {\n            return new SDKError(\"Failed to create Transform in SceneModel - SceneModel already built\");\n        }\n        //...\n    }\n\n    /**\n     * Creates a new {@link Texture} within this SceneModel.\n     *\n     * * Stores the new {@link Texture} in {@link SceneModel.textures | SceneModel.textures}.\n     * * Textures are compressed asynchronously by {@link SceneModel.build | SceneModel.build}.\n     *\n     * ### Usage\n     *\n     * ````javascript\n     * const texture = sceneModel.createTexture({\n     *      id: \"myColorTexture\",\n     *      src: // Path to JPEG, PNG, KTX2,\n     *      image: // HTMLImageElement,\n     *      buffers: // ArrayBuffer[] containing KTX2 MIP levels\n     *      preloadColor: [1,0,0,1],\n     *      flipY: false,\n     *      encoding: LinearEncoding, // @xeokit/constants\n     *      magFilter: LinearFilter,\n     *      minFilter: LinearFilter,\n     *      wrapR: ClampToEdgeWrapping,\n     *      wrapS: ClampToEdgeWrapping,\n     *      wrapT: ClampToEdgeWrapping,\n     * });\n     *\n     * const textureAgain = sceneModel.textures[\"myColorTexture\"];\n     * ````\n     *\n     * See {@link \"@xeokit/scene\"} for more usage info.\n     *\n     * @param textureParams - Texture creation parameters.\n     * @returns *{@link Texture}*\n     * * On success.\n     * @returns *{@link @xeokit/core!SDKError}*\n     * * If SceneModel has already been built or destroyed.\n     * * Invalid TextureParams were given.\n     * * Texture with given ID already exists in this Scene.\n     */\n    createTexture(textureParams: TextureParams): Texture | SDKError {\n        if (this.destroyed) {\n            return new SDKError(\"Failed to create Texture in SceneModel - SceneModel already destroyed\");\n        }\n        if (this.built) {\n            return new SDKError(\"Failed to create Texture in SceneModel - SceneModel already built\");\n        }\n        if (!textureParams.imageData && !textureParams.src && !textureParams.buffers) {\n            return new SDKError(\"Failed to create Texture in SceneModel - Parameter expected: textureParams.imageData, textureParams.src or textureParams.buffers\");\n        }\n        if (this.textures[textureParams.id]) {\n            return new SDKError(`Failed to create Texture in SceneModel - Texture already exists with this ID: ${textureParams.id}`);\n        }\n        if (textureParams.src) {\n            const fileExt = textureParams.src.split('.').pop();\n            // if (fileExt !== \"jpg\" && fileExt !== \"jpeg\" && fileExt !== \"png\") {\n            //     console.error(`Model does not support image files with extension '${fileExt}' - won't create texture '${textureParams.id}`);\n            //     return;\n            // }\n        }\n        const texture = new Texture(textureParams);\n        this.textures[textureParams.id] = texture;\n        this.#texturesList.push(texture);\n        return texture;\n    }\n\n    /**\n     * Creates a new {@link TextureSet} within this SceneModel.\n     *\n     * * Stores the new {@link TextureSet} in {@link SceneModel.textureSets | SceneModel.textureSets}.\n     *\n     * ### Usage\n     *\n     * ````javascript\n     * const textureSet = sceneModel.createTextureSet({\n     *      id: \"myTextureSet\",\n     *      colorTextureId: \"myColorTexture\"\n     * });\n     *\n     * const textureSetAgain = sceneModel.textureSets[\"myTextureSet\"];\n     * ````\n     *\n     * See {@link \"@xeokit/scene\"} for more usage info.\n     *\n     * @param textureSetParams TextureSet creation parameters.\n     *\n     * @returns *{@link TextureSet}*\n     * * On success.\n     * @returns *{@link @xeokit/core!SDKError}*\n     * * If SceneModel has already been built or destroyed.\n     * * Invalid TextureSetParams were given.\n     * * TextureSet with given ID already exists in this SceneModel.\n     * * One or more of the given Textures could not be found in this SceneModel.\n     */\n    createTextureSet(textureSetParams: TextureSetParams): TextureSet | SDKError {\n        if (this.destroyed) {\n            return new SDKError(\"Failed to create TextureSet in SceneModel - SceneModel already destroyed\");\n        }\n        if (this.built) {\n            return new SDKError(\"Failed to create TextureSet in SceneModel - SceneModel already built\");\n        }\n        if (this.textureSets[textureSetParams.id]) {\n            return new SDKError(`Failed to create TextureSet in SceneModel - TextureSet already exists with this ID: ${textureSetParams.id}`);\n        }\n        let colorTexture;\n        if (textureSetParams.colorTextureId !== undefined && textureSetParams.colorTextureId !== null) {\n            colorTexture = this.textures[textureSetParams.colorTextureId];\n            if (!colorTexture) {\n                return new SDKError(`Failed to create TextureSet in SceneModel - Texture not found: ${textureSetParams.colorTextureId} - ensure that you create it first with createTexture()`);\n            }\n            colorTexture.channel = COLOR_TEXTURE;\n        }\n        let metallicRoughnessTexture;\n        if (textureSetParams.metallicRoughnessTextureId !== undefined && textureSetParams.metallicRoughnessTextureId !== null) {\n            metallicRoughnessTexture = this.textures[textureSetParams.metallicRoughnessTextureId];\n            if (!metallicRoughnessTexture) {\n                return new SDKError(`Failed to create TextureSet in SceneModel - Texture not found: ${textureSetParams.metallicRoughnessTextureId} - ensure that you create it first with createTexture()`);\n            }\n            metallicRoughnessTexture.channel = METALLIC_ROUGHNESS_TEXTURE;\n        }\n        let normalsTexture;\n        if (textureSetParams.normalsTextureId !== undefined && textureSetParams.normalsTextureId !== null) {\n            normalsTexture = this.textures[textureSetParams.normalsTextureId];\n            if (!normalsTexture) {\n                return new SDKError(`Failed to create TextureSet in SceneModel - Texture not found: ${textureSetParams.normalsTextureId} - ensure that you create it first with createTexture()`);\n            }\n            normalsTexture.channel = NORMALS_TEXTURE;\n        }\n        let emissiveTexture;\n        if (textureSetParams.emissiveTextureId !== undefined && textureSetParams.emissiveTextureId !== null) {\n            emissiveTexture = this.textures[textureSetParams.emissiveTextureId];\n            if (!emissiveTexture) {\n                return new SDKError(`Failed to create TextureSet in SceneModel - Texture not found: ${textureSetParams.emissiveTextureId} - ensure that you create it first with createTexture()`);\n            }\n            emissiveTexture.channel = EMISSIVE_TEXTURE;\n        }\n        let occlusionTexture;\n        if (textureSetParams.occlusionTextureId !== undefined && textureSetParams.occlusionTextureId !== null) {\n            occlusionTexture = this.textures[textureSetParams.occlusionTextureId];\n            if (!occlusionTexture) {\n                return new SDKError(`Failed to create TextureSet in SceneModel - Texture not found: ${textureSetParams.occlusionTextureId} - ensure that you create it first with createTexture()`);\n            }\n            occlusionTexture.channel = OCCLUSION_TEXTURE;\n        }\n        const textureSet = new TextureSet(textureSetParams, {\n            emissiveTexture,\n            occlusionTexture,\n            metallicRoughnessTexture,\n            colorTexture\n        });\n        this.textureSets[textureSetParams.id] = textureSet;\n        return textureSet;\n    }\n\n    /**\n     * Creates a new {@link @xeokit/scene!Geometry} within this SceneModel, from non-compressed geometry parameters.\n     *\n     * * Stores the new {@link Geometry} in {@link SceneModel.geometries | SceneModel.geometries}.\n     *\n     * ### Usage\n     *\n     * ````javascript\n     * const boxGeometry = sceneModel.createGeometry({\n     *      id: \"boxGeometry\",\n     *      primitive: TrianglesPrimitive, // @xeokit/constants\n     *      positions: [\n     *          1, 1, 1, -1, 1, 1, -1, -1, 1, 1, -1, 1, // v0-v1-v2-v3 front\n     *          1, 1, 1, 1, -1, 1, 1, -1, -1, 1, 1, -1, // v0-v3-v4-v1 right\n     *          1, 1, 1, 1, 1, -1, -1, 1, -1, -1, 1, 1, // v0-v1-v6-v1 top\n     *          -1, 1, 1, -1, 1, -1, -1, -1, -1, -1, -1, 1, // v1-v6-v7-v2 left\n     *          -1, -1, -1, 1, -1, -1, 1, -1, 1, -1, -1, 1,// v7-v4-v3-v2 bottom\n     *          1, -1, -1, -1, -1, -1, -1, 1, -1, 1, 1, -1 // v4-v7-v6-v1 back\n     *      ],\n     *      indices: [\n     *          0, 1, 2, 0, 2, 3, 4, 5, 6, 4, 6, 7, 8, 9, 10, 8, 10, 11, 12, 13, 14, 12, 14, 15,\n     *          16, 17, 18, 16, 18, 19, 20, 21, 22, 20, 22, 23\n     *      ]\n     *  });\n     *\n     * if (boxGeometry instanceof SDKError) {\n     *     console.log(boxGeometry.message);\n     * } else {\n     *      const boxGeometryAgain = sceneModel.geometries[\"boxGeometry\"];\n     * }\n     * ````\n     *\n     * See {@link \"@xeokit/scene\"} for more usage info.\n     *\n     * @param geometryParams Non-compressed geometry parameters.\n     * @returns *{Geometry}*\n     *  * On success.\n     * @returns *{@link @xeokit/core!SDKError}*\n     * * If this SceneModel has already been destroyed.\n     * * If this SceneModel has already been built.\n     * * Invalid GeometryParams were given.\n     * * Geometry of given ID already exists in this SceneModel.\n     * * Unsupported primitive type given.\n     * * Mandatory vertex positions were not given. Vertex positions are mandatory for all primitive types.\n     * * Mandatory indices were not given for primitive type that is not {@link PointsPrimitive}. Indices are mandatory for all primitive types except PointsPrimitive.\n     * * Indices out of range of vertex positions.\n     * * Indices out of range of vertex UVs.\n     * * Mismatch between given quantities of vertex positions and UVs.\n     */\n    createGeometry(geometryParams: GeometryParams): Geometry | SDKError {\n        if (this.destroyed) {\n            return new SDKError(\"Failed to create Geometry in SceneModel - SceneModel already destroyed\");\n        }\n        if (this.built) {\n            return new SDKError(\"Failed to create Geometry in SceneModel - SceneModel already built\");\n        }\n        if (!geometryParams) {\n            return new SDKError(\"Failed to create Geometry in SceneModel - Parameters expected: geometryParams\");\n        }\n        if (geometryParams.id === null || geometryParams.id === undefined) {\n            return new SDKError(\"Failed to create Geometry in SceneModel - Parameter expected: geometryParams.id\");\n        }\n        const geometryId = geometryParams.id;\n        if (this.geometries[geometryId]) {\n            return new SDKError(`Failed to create Geometry in SceneModel - Geometry with this ID already created: ${geometryId}`);\n        }\n        const primitive = geometryParams.primitive;\n        if (primitive !== PointsPrimitive && primitive !== LinesPrimitive && primitive !== TrianglesPrimitive && primitive !== SolidPrimitive && primitive !== SurfacePrimitive) {\n            return new SDKError(`Failed to create Geometry in SceneModel - Unsupported value for geometryParams.primitive: '${primitive}' - supported values are PointsPrimitive, LinesPrimitive, TrianglesPrimitive, SolidPrimitive and SurfacePrimitive`);\n        }\n        if (!geometryParams.positions) {\n            return new SDKError(\"Failed to create Geometry in SceneModel - Param expected: geometryParams.positions\");\n        }\n        if (!geometryParams.indices && primitive !== PointsPrimitive) {\n            return new SDKError(`Failed to create Geometry in SceneModel - Param expected: geometryParams.indices (required for primitive type)`);\n        }\n        if (geometryParams.uvs) {\n            if (geometryParams.uvs.length / 2 !== geometryParams.positions.length / 3) {\n                return new SDKError(\"Failed to create Geometry in SceneModel - mismatch between given quantities of vertex positions and UVs\");\n            }\n        }\n        if (geometryParams.indices) {\n            const lastPositionsIdx = geometryParams.positions.length / 3;\n            for (let i = 0, len = geometryParams.indices.length; i < len; i++) {\n                const idx = geometryParams.indices[i];\n                if (idx < 0 || idx >= lastPositionsIdx) {\n                    return new SDKError(\"Failed to create Geometry in SceneModel - indices out of range of vertex positions\");\n                }\n                if (geometryParams.uvs) {\n                    const lastUVsIdx = geometryParams.uvs.length / 2;\n                    if (idx < 0 || idx >= lastUVsIdx) {\n                        return new SDKError(\"Failed to create Geometry in SceneModel - indices out of range of vertex UVs\");\n                    }\n                }\n            }\n        }\n        const geometry = new Geometry(<GeometryCompressedParams>compressGeometryParams(geometryParams));\n        this.geometries[geometryId] = geometry;\n        return geometry;\n    }\n\n    /**\n     * Creates a new {@link @xeokit/scene!Geometry} within this SceneModel, from pre-compressed geometry parameters.\n     *\n     * * Stores the new {@link Geometry} in {@link SceneModel.geometries | SceneModel.geometries}.\n     * * Use {@link @xeokit/compression!compressGeometryParams} to pre-compress {@link @xeokit/scene!GeometryParams|GeometryParams} into {@link @xeokit/scene!GeometryCompressedParams|GeometryCompressedParams}.\n     *\n     * ### Usage\n     *\n     * ````javascript\n     * const boxGeometry = sceneModel.createGeometryCompressed({\n     *      id: \"boxGeometry\",\n     *      primitive: TrianglesPrimitive, // @xeokit/constants\n     *      positionsDecompressMatrix: [\n     *          0.00003052270125906143, 0, 0, 0,\n     *          0, 0.00003052270125906143, 0, 0,\n     *          0, 0, 0.00003052270125906143, 0,\n     *          -1, -1, -1, 1\n     *      ],\n     *      geometryBuckets: [\n     *          {\n     *              positionsCompressed: [\n     *                  65525, 65525, 65525, 0, 65525, 65525, 0, 0,\n     *                  65525, 65525, 0, 65525, 65525, 0, 0, 65525,\n     *                  65525, 0, 0, 65525, 0, 0, 0, 0\n     *              ],\n     *              indices: [\n     *                  0, 1, 2, 0, 2, 3, 0, 3, 4, 0, 4, 5, 0, 5, 6,\n     *                  0, 6, 1, 1, 6, 7, 1, 7, 2, 7, 4, 3, 7, 3, 2,\n     *                  4, 7, 6, 4, 6, 5\n     *              ]\n     *          }\n     *      ]\n     * });\n     *\n     * if (boxGeometry instanceof SDKError) {\n     *     console.log(boxGeometry.message);\n     * } else {\n     *      const boxGeometryAgain = sceneModel.geometries[\"boxGeometry\"];\n     * }\n     * ````\n     *\n     * See {@link \"@xeokit/scene\"} for more usage info.\n     *\n     * @param geometryCompressedParams Pre-compressed geometry parameters.\n     * @returns *{Geometry}*\n     * * On success.\n     * @returns *{@link @xeokit/core!SDKError}*\n     * * If this SceneModel has already been destroyed.\n     * * If this SceneModel has already been built.\n     * * Invalid GeometryParams were given.\n     * * Geometry of given ID already exists in this SceneModel.\n     * * Unsupported primitive type given.\n     * * Mandatory vertex positions were not given. Vertex positions are mandatory for all primitive types.\n     * * Mandatory indices were not given for primitive type that is not {@link PointsPrimitive}. Indices are mandatory for all primitive types except PointsPrimitive.\n     * * Indices out of range of vertex positions.\n     * * Indices out of range of vertex UVs.\n     * * Mismatch between given quantities of vertex positions and UVs.\n     */\n    createGeometryCompressed(geometryCompressedParams: GeometryCompressedParams): Geometry | SDKError {\n        if (this.destroyed) {\n            return new SDKError(\"Failed to add compressed Geometry to SceneModel - SceneModel already destroyed\");\n        }\n        if (this.built) {\n            return new SDKError(\"Failed to add compressed Geometry to SceneModel - SceneModel already built\");\n        }\n        if (!geometryCompressedParams) {\n            return new SDKError(\"Failed to add compressed Geometry to SceneModel - Parameters expected: geometryCompressedParams\");\n        }\n        const geometryId = geometryCompressedParams.id;\n        if (this.geometries[geometryId]) {\n            return new SDKError(`Failed to add compressed Geometry to SceneModel - Geometry with this ID already created: ${geometryId}`);\n        }\n        const primitive = geometryCompressedParams.primitive;\n        if (primitive !== PointsPrimitive && primitive !== LinesPrimitive && primitive !== TrianglesPrimitive && primitive !== SolidPrimitive && primitive !== SurfacePrimitive) {\n            return new SDKError(`Failed to add compressed Geometry to SceneModel - Unsupported value for geometryCompressedParams.primitive: '${primitive}' - supported values are PointsPrimitive, LinesPrimitive, TrianglesPrimitive, SolidPrimitive and SurfacePrimitive`);\n        }\n        const geometry = new Geometry(geometryCompressedParams);\n        this.geometries[geometryId] = geometry;\n        return geometry;\n    }\n\n    /**\n     * Creates a new {@link Mesh} within this SceneModel.\n     *\n     * * Stores the new {@link Mesh} in {@link SceneModel.meshes | SceneModel.meshes}.\n     * * A {@link Mesh} can be owned by one {@link SceneObject}, which can own multiple {@link Mesh}es.\n     *\n     * ### Usage\n     *\n     * ````javascript\n     * const redBoxMesh = sceneModel.createMesh({\n     *      id: \"redBoxMesh\",\n     *      geometryId: \"boxGeometry\",\n     *      textureSetId: \"myTextureSet\",\n     *      position: [-4, -6, -4],\n     *      scale: [1, 3, 1],\n     *      rotation: [0, 0, 0],\n     *      color: [1, 0.3, 0.3]\n     * });\n     *\n     * if (redBoxMesh instanceof SDKError) {\n     *      console.log(redBoxMesh.message);\n     * } else {\n     *      const redBoxMeshAgain = sceneModel.meshes[\"redBoxMesh\"];\n     * }\n     * ````\n     *\n     * See {@link \"@xeokit/scene\"} for more usage info.\n     *\n     * @param meshParams Pre-compressed mesh parameters.\n     * @returns *{Mesh}*\n     *  * On success.\n     * @returns *{@link @xeokit/core!SDKError}*\n     * * If this SceneModel has already been destroyed.\n     * * If this SceneModel has already been built.\n     * * Invalid MeshParams were given.\n     * * Mesh of given ID already exists in this SceneModel.\n     * * Specified Geometry could not be found in this SceneModel.\n     * * Specified TextureSet could not be found in this SceneModel.\n     */\n    createMesh(meshParams: MeshParams): Mesh | SDKError {\n        if (this.destroyed) {\n            return new SDKError(\"Failed to create Mesh in SceneModel - SceneModel already destroyed\");\n        }\n        if (this.built) {\n            return new SDKError(\"Failed to create Mesh in SceneModel - SceneModel already built\");\n        }\n        if (this.meshes[meshParams.id]) {\n            return new SDKError(`Failed to create Mesh in SceneModel - Mesh already exists with this ID: ${meshParams.id}`);\n        }\n        const geometry = this.geometries[meshParams.geometryId];\n        if (!geometry) {\n            return new SDKError(`Failed to create Mesh in SceneModel - Geometry not found: ${meshParams.geometryId}`);\n        }\n        const textureSet = meshParams.textureSetId ? this.textureSets[meshParams.textureSetId] : undefined;\n        if (meshParams.textureSetId && !textureSet) {\n            return new SDKError(`Failed to create Mesh in SceneModel - TextureSet not found: ${meshParams.textureSetId}`);\n        }\n\n        // geometry.numInstances++;\n        // let matrix = meshParams.matrix;\n        // if (!matrix) {\n        //     const position = meshParams.position;\n        //     const scale = meshParams.scale;\n        //     const rotation = meshParams.rotation;\n        //     if (position || scale || rotation) {\n        //         matrix = identityMat4();\n        //         const quaternion = eulerToQuat(rotation || [0, 0, 0], \"XYZ\", identityQuat());\n        //         composeMat4(position || [0, 0, 0], quaternion, scale || [1, 1, 1], matrix)\n        //     } else {\n        //         matrix = identityMat4();\n        //     }\n        // }\n        // const meshIndex = this.meshesList.length;\n\n        const mesh = new Mesh({\n            id: meshParams.id,\n            geometry,\n            textureSet,\n            matrix: meshParams.matrix,\n            color: meshParams.color,\n            opacity: meshParams.opacity,\n            roughness: meshParams.roughness,\n            metallic: meshParams.metallic\n        });\n        this.meshes[meshParams.id] = mesh;\n        return mesh;\n    }\n\n    /**\n     * Creates a new {@link SceneObject}.\n     *\n     * * Stores the new {@link SceneObject} in {@link SceneModel.objects | SceneModel.objects} and {@link Scene.objects | Scene.objects}.\n     * * Fires an event via {@link Scene.onObjectCreated | Scene.onObjectCreated}.\n     * * Each {@link Mesh} is allowed to belong to one SceneObject.\n     * * SceneObject IDs must be unique within the SceneModel's {@link Scene}.\n     *\n     * ### Usage\n     *\n     * ````javascript\n     * const redBoxObject = sceneModel.createObject({\n     *     id: \"redBoxObject\",\n     *     meshIds: [\"redBoxMesh\"]\n     * });\n     *\n     * if (redBoxObject instanceof SDKError) {\n     *      console.log(redBoxObject.message);\n     * } else {\n     *      const redBoxObjectAgain = sceneModel.objects[\"redBoxObject\"];\n     *      const redBoxObjectOnceMore = scene.objects[\"redBoxObject\"];\n     * }\n     * ````\n     *\n     * See {@link \"@xeokit/scene\"} for more usage info.\n     *\n     * @param objectParams SceneObject parameters.\n     * @returns *{SceneObject}*\n     * * On success.\n     * @returns *{@link @xeokit/core!SDKError}*\n     * * If this SceneModel has already been destroyed.\n     * * If this SceneModel has already been built.\n     * * Invalid ObjectParams were given.\n     * * SceneObject of given ID already exists in this SceneModel's Scene. Note that SceneObject IDs must be unique within the Scene.\n     * * No Meshes were specified.\n     * * One or more of the specified Meshes already belong to another SceneObject in this SceneModel.\n     * * Specified Meshes could not be found in this SceneModel.\n     */\n    createObject(objectParams: SceneObjectParams): SceneObject | SDKError {\n        if (this.destroyed) {\n            return new SDKError(\"Failed to create SceneObject - SceneModel already destroyed\");\n        }\n        if (this.built) {\n            return new SDKError(\"Failed to create SceneObject SceneModel already built\");\n        }\n        if (objectParams.meshIds.length === 0) {\n            return new SDKError(\"Failed to create SceneObject - no meshes specified\");\n        }\n        if (this.scene.objects[objectParams.id]) {\n            return new SDKError(`Failed to create SceneObject - SceneObject already exists in Scene: ${objectParams.id}`);\n        }\n        const meshIds = objectParams.meshIds;\n        const meshes = [];\n        for (let meshIdIdx = 0, meshIdLen = meshIds.length; meshIdIdx < meshIdLen; meshIdIdx++) {\n            const meshId = meshIds[meshIdIdx];\n            const mesh = this.meshes[meshId];\n            if (!mesh) {\n                return new SDKError(`Failed to create SceneObject - Mesh not found: ${meshId}`);\n            }\n            if (this.#meshUsedByObject[meshId]) {\n                return new SDKError(`Failed to create SceneObject - Mesh ${meshId} already belongs to another SceneObject`);\n            }\n            meshes.push(mesh);\n            this.#meshUsedByObject[mesh.id] = true;\n        }\n        const sceneObject = new SceneObject({\n            id: objectParams.id,\n            layerId: objectParams.layerId || this.layerId,\n            model: this,\n            meshes\n        });\n        for (let i = 0, len = meshes.length; i < len; i++) {\n            const mesh = meshes[i];\n            mesh.object = sceneObject;\n        }\n        this.#numObjects++;\n        this.objects[objectParams.id] = sceneObject;\n        return sceneObject;\n    }\n\n    /**\n     * Finalizes this SceneModel, readying it for use.\n     *\n     * * Fires an event via {@link SceneModel.onBuilt | SceneModel.onBuilt} and {@link Scene.onModelCreated | SceneModel.onCreated}, to indicate to subscribers that\n     * the SceneModel is complete and ready to use.\n     * * Sets {@link SceneModel.built | SceneModel.built} ````true````.\n     * * You can only call this method once on a SceneModel.\n     * * The SceneModel must have at least one {@link SceneObject}.\n     * * Once built, no more components can be created in a SceneModel.\n     *\n     * ### Usage\n     *\n     * ````javascript\n     * sceneMode.onBuilt.subscribe(()=>{\n     *     // Our SceneModel is built and ready to use\n     * });\n     *\n     * myScene.onModelCreated.subscribe((sceneModel)=>{\n     *     // Another way to subscribe to SceneModel readiness\n     * });\n     *\n     * mySceneModel.build().then((result) => { // Asynchronous (texture compression etc).\n     *      if (result instanceof SDKError) {\n     *          console.log(result.message);\n     *      }  else {\n     *          // Now we can do things with our SceneModel\n     *      }\n     * }).catch(sdkError) {// SDKError\n     *     console.log(sdkError.message);\n     * };\n     * ````\n     *\n     * See {@link \"@xeokit/scene\"} for more usage info.\n     *\n     * @throws *{@link @xeokit/core!SDKError}*\n     * * If SceneModel has already been built or destroyed.\n     * * If no SceneObjects were created in this SceneModel.\n     */\n    async build(): Promise<SceneModel> {\n        return new Promise<SceneModel>((resolve) => {\n            if (this.destroyed) {\n                throw new SDKError(\"Failed to build SceneModel - SceneModel already destroyed\");\n            }\n            if (this.built) {\n                throw new SDKError(\"Failed to build SceneModel - SceneModel already built\");\n            }\n            this.#removeUnusedTextures();\n            this.#compressTextures().then(() => {\n                this.built = true;\n                this.onBuilt.dispatch(this, null);\n                resolve(this);\n            }).catch((e) => {\n                throw e;\n            });\n        });\n    }\n\n    #removeUnusedTextures() {\n        // let texturesList = [];\n        // const textures = {};\n        // for (let i = 0, leni = this.texturesList.length; i < leni; i++) {\n        //     const texture = this.texturesList[i];\n        //     if (texture.channel !== null) {\n        //         texture.textureIndex = texturesList.length;\n        //         texturesList.push(texture);\n        //         textures[texture.id] = texture;\n        //     }\n        // }\n        // this.texturesList = texturesList;\n        // this.textures = textures;\n    }\n\n    #compressTextures(): Promise<any> {\n        let countTextures = this.#texturesList.length;\n        return new Promise<void>((resolve) => {\n            if (countTextures === 0) {\n                resolve();\n                return;\n            }\n            for (let i = 0, leni = this.#texturesList.length; i < leni; i++) {\n                const texture = this.#texturesList[i];\n                const encodingOptions = TEXTURE_ENCODING_OPTIONS[texture.channel] || {};\n                if (texture.src) {  // Texture created with SceneModel#createTexture({ src: ... })\n                    const src = texture.src;\n                    const fileExt = src.split('.').pop();\n                    switch (fileExt) {\n                        case \"jpeg\":\n                        case \"jpg\":\n                        case \"png\":\n\n                            load(src, ImageLoader, {\n                                image: {\n                                    type: \"data\"\n                                }\n                            }).then((imageData) => {\n                                if (texture.compressed) {\n                                    encode(imageData, KTX2BasisWriter, encodingOptions).then((encodedData) => {\n                                        const encodedImageData = new Uint8Array(encodedData);\n                                        texture.imageData = encodedImageData;\n                                        if (--countTextures <= 0) {\n                                            resolve();\n                                        }\n                                    }).catch((err) => {\n                                        return new SDKError(`Failed to compress texture: ${err}`);\n                                    });\n                                } else {\n                                    texture.imageData = new Uint8Array(1);\n                                    if (--countTextures <= 0) {\n                                        resolve();\n                                    }\n                                }\n                            }).catch((err) => {\n                                return new SDKError(`Failed to load texture image: ${err}`);\n                            });\n                            break;\n                        default:\n                            if (--countTextures <= 0) {\n                                resolve();\n                            }\n                            break;\n                    }\n                }\n                if (texture.imageData) {// Texture created with SceneModel#createTexture({ imageData: ... })\n                    if (texture.compressed) {\n                        encode(texture.imageData, KTX2BasisWriter, encodingOptions)\n                            .then((encodedImageData) => {\n                                texture.imageData = new Uint8Array(encodedImageData);\n                                if (--countTextures <= 0) {\n                                    resolve();\n                                }\n                            }).catch((err) => {\n                            return new SDKError(`Failed to compress texture: ${err}`);\n                        });\n                    } else {\n                        texture.imageData = new Uint8Array(1);\n                        if (--countTextures <= 0) {\n                            resolve();\n                        }\n                    }\n                }\n            }\n        });\n    }\n}\n","import { isBlob } from '../../javascript-utils/is-type';\nimport { isLoaderObject } from '../loader-utils/normalize-loader';\nimport { getFetchFunction } from '../loader-utils/option-utils';\nimport { parse } from './parse';\n\nexport async function load(url, loaders, options, context) {\n  if (!Array.isArray(loaders) && !isLoaderObject(loaders)) {\n    context = undefined;\n    options = loaders;\n    loaders = undefined;\n  }\n\n  const fetch = getFetchFunction(options);\n\n  let data = url;\n  if (typeof url === 'string') {\n    data = await fetch(url);\n  }\n\n  if (isBlob(url)) {\n    data = await fetch(url);\n  }\n\n  return await parse(data, loaders, options);\n}\n//# sourceMappingURL=load.js.map","import {Component, EventEmitter, SDKError} from \"@xeokit/core\";\nimport {FloatArrayParam, MAX_DOUBLE, MIN_DOUBLE} from \"@xeokit/math\";\nimport {EventDispatcher} from \"strongly-typed-events\";\nimport {SceneModel} from \"./SceneModel\";\nimport type {SceneObject} from \"./SceneObject\";\nimport type {SceneModelParams} from \"./SceneModelParams\";\nimport {createAABB3} from \"@xeokit/boundaries\";\n\n/**\n * A scene representation.\n *\n * A Scene is a container of {@link SceneModel | SceneModels} and {@link SceneObject | SceneObjects}.\n */\nexport class Scene extends Component {\n\n    /**\n     * The {@link @xeokit/scene!SceneModel | SceneModels} belonging to this Scene, each keyed to\n     * its {@link @xeokit/scene!SceneModel.id | SceneModel.id}.\n     */\n    public readonly models: { [key: string]: SceneModel };\n\n    /**\n     * The {@link SceneObject | SceneObjects} in this Scene, mapped to {@link SceneObject.id | SceneObject.id}.\n     */\n    public readonly objects: { [key: string]: SceneObject };\n\n    /**\n     * Emits an event each time a {@link SceneModel} is created in this Scene.\n     *\n     * @event\n     */\n    public readonly onModelCreated: EventEmitter<Scene, SceneModel>;\n\n    /**\n     * Emits an event each time a {@link SceneModel} is destroyed in this Scene.\n     *\n     * @event\n     */\n    public readonly onModelDestroyed: EventEmitter<Scene, SceneModel>;\n\n    #onModelBuilts: { [key: string]: any };\n    #onModelDestroys: { [key: string]: any };\n    #center: Float64Array;\n    #aabbDirty: boolean;\n    #aabb: Float64Array;\n\n    /**\n     * Creates a new Scene.\n     *\n     * See {@link \"@xeokit/scene\"} for usage.\n     */\n    constructor() {\n\n        super(null, {});\n\n        this.#aabb = createAABB3();\n        this.#aabbDirty = true;\n\n        this.models = {};\n        this.objects = {};\n\n        this.#onModelBuilts = {};\n        this.#onModelDestroys = {};\n        this.onModelCreated = new EventEmitter(new EventDispatcher<Scene, SceneModel>());\n        this.onModelDestroyed = new EventEmitter(new EventDispatcher<Scene, SceneModel>());\n    }\n\n    /**\n     * Gets the collective World-space 3D center of all the {@link SceneModel | SceneModels} in this Scene.\n     */\n    get center(): Float64Array {\n        if (this.#aabbDirty) {\n            const aabb = this.aabb; // Lazy-build\n            this.#center[0] = (aabb[0] + aabb[3]) / 2;\n            this.#center[1] = (aabb[1] + aabb[4]) / 2;\n            this.#center[2] = (aabb[2] + aabb[5]) / 2;\n        }\n        return this.#center;\n    }\n\n    /**\n     * Gets the collective World-space 3D [axis-aligned boundary](/docs/pages/GLOSSARY.html#aabb) of all the {@link SceneModel | SceneModels} in this Scene.\n     *\n     * The boundary will be of the form ````[xMin, yMin, zMin, xMax, yMax, zMax]````.\n     */\n    get aabb(): FloatArrayParam {\n        if (this.#aabbDirty) {\n            let xmin = MAX_DOUBLE;\n            let ymin = MAX_DOUBLE;\n            let zmin = MAX_DOUBLE;\n            let xmax = MIN_DOUBLE;\n            let ymax = MIN_DOUBLE;\n            let zmax = MIN_DOUBLE;\n            let aabb;\n            const objects = this.objects;\n            let valid = false;\n            for (const objectId in objects) {\n                if (objects.hasOwnProperty(objectId)) {\n                    const object = objects[objectId];\n                    // if (object.collidable === false) {\n                    //     continue;\n                    // }\n                    aabb = object.aabb;\n                    if (aabb[0] < xmin) {\n                        xmin = aabb[0];\n                    }\n                    if (aabb[1] < ymin) {\n                        ymin = aabb[1];\n                    }\n                    if (aabb[2] < zmin) {\n                        zmin = aabb[2];\n                    }\n                    if (aabb[3] > xmax) {\n                        xmax = aabb[3];\n                    }\n                    if (aabb[4] > ymax) {\n                        ymax = aabb[4];\n                    }\n                    if (aabb[5] > zmax) {\n                        zmax = aabb[5];\n                    }\n                    valid = true;\n                }\n            }\n            if (!valid) {\n                xmin = -100;\n                ymin = -100;\n                zmin = -100;\n                xmax = 100;\n                ymax = 100;\n                zmax = 100;\n            }\n            this.#aabb[0] = xmin;\n            this.#aabb[1] = ymin;\n            this.#aabb[2] = zmin;\n            this.#aabb[3] = xmax;\n            this.#aabb[4] = ymax;\n            this.#aabb[5] = zmax;\n            this.#aabbDirty = false;\n        }\n        return this.#aabb;\n    }\n\n    /**\n     * Creates a new {@link @xeokit/scene!SceneModel} in this Scene.\n     *\n     * Remember to call {@link SceneModel.build | SceneModel.build} when you've finished building or loading the SceneModel. That will\n     * fire events via {@link Scene.onModelCreated | Scene.onModelCreated} and {@link SceneModel.onBuilt | SceneModel.onBuilt}, to\n     * indicate to any subscribers that the SceneModel is built and ready for use.\n     *\n     * See {@link \"@xeokit/scene\"} for more details on usage.\n     *\n     * @param  sceneModelParams Creation parameters for the new {@link @xeokit/scene!SceneModel}.\n     * @returns *{@link SceneModel}*\n     * * On success.\n     * @returns *{@link @xeokit/core!SDKError}*\n     * * This Scene has already been destroyed.\n     * * A SceneModel with the given ID already exists in this Scene.\n     */\n    createModel(sceneModelParams: SceneModelParams): SceneModel | SDKError {\n        if (this.destroyed) {\n            return new SDKError(\"Scene already destroyed\");\n        }\n        const id = sceneModelParams.id;\n        if (this.models[id]) {\n            return new SDKError(`SceneModel already created in this Scene: ${id}`);\n        }\n        const sceneModel = new SceneModel(this, sceneModelParams);\n        this.models[id] = sceneModel;\n        sceneModel.onDestroyed.one(() => { // SceneModel#destroy() called\n            delete this.models[sceneModel.id];\n            this.#deregisterObjects(sceneModel);\n            this.onModelDestroyed.dispatch(this, sceneModel);\n        });\n        sceneModel.onBuilt.one(() => { // SceneModel#build() called\n            this.#registerObjects(sceneModel);\n            this.onModelCreated.dispatch(this, sceneModel);\n        });\n        return sceneModel;\n    }\n\n    /**\n     * @private\n     */\n    setAABBDirty() {\n        if (!this.#aabbDirty) {\n            this.#aabbDirty = true;\n            //this.events.fire(\"aabb\", true);\n        }\n    }\n\n    /**\n     * Destroys all contained {@link SceneModel | SceneModels}.\n     *\n     * * Fires {@link Scene.onModelDestroyed | Scene.onModelDestroyed} and {@link SceneModel.onDestroyed | SceneModel.onDestroyed}\n     * for each existing SceneModel in this Scene.\n     *\n     * See {@link \"@xeokit/scene\"} for usage.\n     * @returns *void*\n     * * On success.\n     * @returns *{@link @xeokit/core!SDKError}*\n     * * This Scene has already been destroyed.\n     */\n    clear(): void | SDKError {\n        if (this.destroyed) {\n            return new SDKError(\"Scene already destroyed\");\n        }\n        for (let id in this.models) {\n            this.models[id].destroy();\n        }\n    }\n\n    /**\n     * Destroys this Scene and all contained {@link SceneModel | SceneModels}.\n     *\n     * * Fires {@link Scene.onModelDestroyed | Scene.onModelDestroyed} and {@link SceneModel.onDestroyed | SceneModel.onDestroyed}\n     * for each existing SceneModels in this Data.\n     * * Unsubscribes all subscribers to {@link Scene.onModelCreated | Scene.onModelCreated}, {@link Scene.onModelDestroyed | Scene.onModelDestroyed}, {@link SceneModel.onDestroyed | SceneModel.onDestroyed}\n     *\n     * See {@link \"@xeokit/scene\"} for usage.\n     *\n     * @returns *void*\n     * * On success.\n     * @returns *{@link @xeokit/core!SDKError}*\n     * * This Scene has already been destroyed.\n     */\n    destroy(): void | SDKError {\n        this.clear();\n        this.onModelCreated.clear();\n        this.onModelDestroyed.clear();\n        super.destroy();\n    }\n\n    #registerObjects(model: SceneModel) {\n        const objects = model.objects;\n        for (let id in objects) {\n            const object = objects[id];\n            this.objects[object.id] = <SceneObject>object;\n        }\n        this.#aabbDirty = true;\n    }\n\n    #deregisterObjects(model: SceneModel) {\n        const objects = model.objects;\n        for (let id in objects) {\n            const object = objects[id];\n            delete this.objects[object.id];\n        }\n        this.#aabbDirty = true;\n    }\n}"],"names":["assert","condition","message","Error","isBrowser","Boolean","process","String","browser","version","exec","globals","self","window","global","document","global_","isWorker","importScripts","isMobile","orientation","_typeof","obj","Symbol","iterator","constructor","prototype","_defineProperty","key","value","arg","input","hint","prim","toPrimitive","undefined","res","call","TypeError","toPropertyKey","Object","defineProperty","enumerable","configurable","writable","WorkerJob","jobName","workerThread","this","name","result","Promise","resolve","reject","_resolve","_reject","postMessage","type","payload","source","done","isRunning","error","Worker","terminate","workerURLCache","Map","getLoadableWorkerURLFromSource","workerSource","blob","Blob","URL","createObjectURL","getTransferList","object","recursive","arguments","length","transfers","transfersSet","Set","isTransferable","add","buffer","ArrayBuffer","isView","Array","from","MessagePort","ImageBitmap","OffscreenCanvas","getTransferListForWriter","clone","assign","keys","forEach","RegExp","NOOP","WorkerThread","static","NodeWorker","props","url","onMessage","onError","console","log","worker","_createBrowserWorker","_createNodeWorker","destroy","terminated","data","transferList","_getErrorFromErrorEvent","event","concat","lineno","colno","_loadableURL","workerURL","get","startsWith","set","getLoadableWorkerURL","onmessage","onerror","onmessageerror","includes","eval","on","code","WorkerPool","isSupported","setProps","idleQueue","isDestroyed","maxConcurrency","maxMobileConcurrency","reuseWorkers","onDebug","async","job","startPromise","onStart","jobQueue","push","_startQueuedJob","_getAvailableWorker","queuedJob","shift","backlog","returnWorkerToQueue","count","_getMaxConcurrency","toLowerCase","DEFAULT_PROPS","WorkerFarm","_workerFarm","workerPools","workerPool","values","_getWorkerPoolProps","getWorkerPool","options","NPM_TAG","VERSION","getWorkerURL","workerOptions","id","workerFile","workerUrl","_workerType","module","versionTag","processOnWorker","context","warning","getWorkerName","workerFarm","getWorkerFarm","workerPoolProps","startJob","bind","transferableOptions","warn","loadLibraryPromises","loadLibrary","libraryUrl","moduleName","library","modules","CDN","getLibraryUrl","endsWith","response","fetch","arrayBuffer","node","node.requireFromFile","scriptSource","script","createElement","appendChild","createTextNode","e","text","body","loadLibraryFromString","loadLibraryFromFile","parseWithWorker","loader","parseOnMainThread","JSON","parse","stringify","concatenateArrayBuffers","_len","sources","_key","sourceArrays","map","source2","Uint8Array","byteLength","reduce","typedArray","offset","sourceArray","pathPrefix","fileAliases","resolvePath","filename","alias","replace","toArrayBuffer","isBuffer","node.toArrayBuffer","byteOffset","slice","TextEncoder","encode","_toArrayBuffer","BASIS_CDN_ENCODER_WASM","BASIS_CDN_ENCODER_JS","loadBasisEncoderPromise","KTX2BasisWriter","extensions","useSRGB","qualityLevel","encodeUASTC","mipmaps","image","BasisEncoder","basisEncoder","BASIS_ENCODER","wasmBinary","all","globalThis","BASIS","BasisEncoderModule","then","BasisFile","KTX2File","initializeBasis","initializeBasisEncoderModule","loadBasisEncoder","loadBasisEncoderModule","basisFileData","width","height","setCreateKTX2File","setKTX2UASTCSupercompression","setKTX2SRGBTransferFunc","setSliceSourceImage","setPerceptual","setMipSRGB","setQualityLevel","setUASTC","setMipGen","numOutputBytes","subarray","delete","_parseImageNode","IMAGE_SUPPORTED","Image","IMAGE_BITMAP_SUPPORTED","NODE_IMAGE_SUPPORTED","DATA_SUPPORTED","SVG_DATA_URL_PATTERN","SVG_URL_PATTERN","isSVG","test","getBlob","parseToImage","blobOrDataUrl","xmlText","TextDecoder","decode","unescape","encodeURIComponent","btoa","getBlobOrSVGDataUrl","webkitURL","objectUrl","src","onload","err","loadToImage","revokeObjectURL","EMPTY_OBJECT","imagebitmapOptionsSupported","BIG_ENDIAN","LITTLE_ENDIAN","getBinaryImageMetadata","binaryData","dataView","toDataView","getUint32","mimeType","getPngMetadata","getUint16","getUint8","tableMarkers","sofMarkers","i","getJpegMarkers","marker","has","getJpegMetadata","getGifMetadata","getBmpMetadata","DataView","ImageLoader","mimeTypes","imageType","getDefaultImageType","isImageTypeSupported","getLoadableImageType","imagebitmapOptions","imagebitmap","isEmptyObject","createImageBitmap","safeCreateImageBitmap","parseToImageBitmap","parseToNodeImage","format","getImageTypeOrNull","getImageType","canvas","getContext","drawImage","getImageData","tests","he","ie","je","ke","le","h","t","Float64Array","z","f","MAX_DOUBLE","a","J","n","r","o","u","matrix","createVec3","createMat4","newFloatArray","GeometryBucket","geometryBucketParams","positionsCompressed","uvsCompressed","colorsCompressed","indices","edgeIndices","Geometry","params","primitive","positionsDecompressMatrix","aabb","uvsDecompressMatrix","geometryBuckets","rendererGeometry","len","_positionsDecompressed","_classPrivateFieldLooseKey","_positionsWorld","geometryView","GeometryViewImpl","mesh","meshIndex","geometry","geometryBucket","geometryBucketIndex","_classPrivateFieldLooseBase","reset","_createClass","totalGeometryBuckets","meshes","primitiveType","TrianglesPrimitive","LinesPrimitive","Float32Array","decompressPositions3","positionsDecompressed","transformPositions3","getSceneObjectGeometry","sceneObject","withEachGeometry","j","lenj","_aabb","_aabbDirty","SceneObject","cfg","model","layerId","rendererObject","createAABB3","setAABBDirty","_this","collapseAABB3","expandAABB3Points3","positionsWorld","TextureSet","textureSetParams","textures","colorTexture","metallicRoughnessTexture","occlusionTexture","emissiveTexture","rendererTextureSet","Texture","rendererTexture","imageData","buffers","compressed","mediaType","magFilter","minFilter","wrapS","wrapT","wrapR","flipY","encoding","preloadColor","channel","RepeatWrapping","createVec4","_color","_matrix","_metallic","_roughness","_opacity","Mesh","meshParams","textureSet","rendererMesh","identityMat4","color","metallic","roughness","opacity","setColor","setMatrix","setMetallic","setRoughness","uniquePositions","indicesLookup","indicesReverseLookup","weldedIndices","faces","numFaces","compa","Uint16Array","compb","compc","b","c","cb","ab","cross","normal","comparePositions","compareVertex","seqInit","bucketsForIndices","compareBuckets","aa1","aa2","aa3","bb1","bb2","bb3","aa","bb","minBucketA","Math","min","minBucketB","maxBucketA","max","maxBucketB","compressGeometryParams","geometryParams","positions","uniquePositionsCompressed","quantizePositions3","SolidPrimitive","SurfacePrimitive","edgeThreshold","vx","vy","vz","positionsMap","precision","pow","lenUniquePositions","round","weldVertices","numIndices","ia","ib","ic","decompressPoint3","subVec3","cross3Vec3","normalizeVec3","face","buildFaces","edge1","edge2","index1","index2","edge","thresholdDot","cos","DEGTORAD","edges","largeIndex","faceIndex","face1","face2","dotVec3","Uint32Array","buildEdgeIndices","_uniquifyPositions","maxPositions","setMaxNumberOfPositions","seq","remappings","sort","uniqueIdx","uniqueEdgeIndices","uniqueIndices","uniquifyPositions","uvs","bitsPerBucket","checkResult","Int32Array","sortedIndices","preSortIndices","edgeSearch","el0","el1","tmp","compare_fn","m","k","cmp","alreadyOutputEdgeIndices","fill","numPositions","bucketIndicesRemap","buckets","addEmptyBucket","newBucket","maxNumPositions","bucketNumber","currentBucket","additonalPositionsInBucket","ii0","ii1","ii2","edgeIndex","newBytesPerIndex","originalSize","newSize","bucket","meshDict","doCheckResult","rebucketPositions","isFunction","x","isObject","isPureObject","isIterable","isAsyncIterable","asyncIterator","isResponse","Response","json","isBlob","isReadableStream","ReadableStream","tee","cancel","getReader","isReadableDOMStream","read","pipe","isBoolean","readable","isReadableNodeStream","DATA_URL_PATTERN","MIME_TYPE_PATTERN","parseMIMEType","mimeString","matches","parseMIMETypeFromURL","QUERY_STRING_PATTERN","getResourceUrlAndType","resource","stripQueryString","headers","makeResponse","contentLength","size","getResourceContentLength","initialDataUrl","blobSlice","reader","FileReader","_event$target","target","readAsDataURL","base64","binary","bytes","fromCharCode","arrayBufferToBase64","getInitialDataUrl","fetchFile","fetchOptions","mockUserAgent","versions","realUserAgent","navigator","userAgent","indexOf","isElectron","window_","process_","__VERSION__","LocalStorage","defaultConfig","storage","setItem","removeItem","getStorage","config","_loadConfiguration","getConfiguration","setConfiguration","configuration","serialized","serializedConfiguration","getItem","formatImage","scale","maxWidth","imageUrl","style","floor","join","COLOR","getColor","toUpperCase","WHITE","getHiResTimestamp","timestamp","_window$performance","_window$performance$n","performance","now","_process$hrtime","timeParts","hrtime","Date","originalConsole","debug","info","DEFAULT_SETTINGS","enabled","level","noop","cache","ONCE","once","Log","userData","_storage","timeStamp","predefined","proto","getPrototypeOf","propNames","getOwnPropertyNames","find","autobind","seal","newLevel","setLevel","getLevel","isEnabled","getTotal","Number","_startTs","toPrecision","getDelta","_deltaTs","priority","newPriority","getPriority","enable","setting","settings","table","_getLogFunction","deprecated","oldUsage","newUsage","removed","probe","logLevel","time","args","columns","tag","getTableHeader","_ref","_shouldLog","_ref3","img","element","nodeName","toDataURL","logImageInBrowser","timeEnd","group","opts","collapsed","normalizeArguments","method","groupCollapsed","groupEnd","withGroup","func","trace","normalizeLogLevel","total","delta","string","padLength","repeat","leftPad","ms","formatted","toFixed","formatTime","background","decorateMessage","resolvedLevel","isFinite","unshift","messageType","title","probeLog","NullLog","DEFAULT_LOADER_OPTIONS","nothrow","_len2","_key2","_len3","_key3","_len4","_key4","_nodeWorkers","limit","_limitMB","batchSize","batchDebounceMs","metadata","transforms","REMOVED_LOADER_OPTIONS","throws","dataType","uri","mode","credentials","redirect","referrer","referrerPolicy","integrity","keepalive","signal","getGlobalLoaderState","loaders","_state","getGlobalLoaderOptions","state","globalOptions","getFetchFunction","validateOptionsObject","defaultOptions","deprecatedOptions","loaderName","prefix","isSubOptions","suggestion","findSimilarOption","optionKey","lowerCaseOptionKey","bestSuggestion","lowerCaseKey","mergeNestedFields","mergedOptions","isLoaderObject","_loader","isArray","normalizeLoader","_loader2","_loader3","parseTextSync","parseText","getGlobalLoaderRegistry","loaderRegistry","EXT_PATTERN","selectLoaderSync","validHTTPResponse","candidateLoaders","ignoreRegisteredLoaders","normalizeLoaders","testUrl","reason","findLoaderByMIMEType","match","extension","loaderExtension","findLoaderByExtension","findLoaderByUrl","testDataAgainstText","testDataAgainstBinary","findLoaderByInitialBytes","getFirstCharacters","fallbackMimeType","selectLoaderInternal","getNoValidLoaderMessage","status","slashIndex","lastIndexOf","substr","path.filename","firstCharacters","testText","some","arrayBuffer1","arrayBuffer2","array1","array2","compareArrayBuffers","getMagicString","testBinary","magic","DEFAULT_CHUNK_SIZE","makeStreamIterator","stream","nextBatchPromise","currentBatchPromise","_streamReadAhead","releaseLock","makeBrowserStreamIterator","chunk","makeNodeStreamIterator","ERR_DATA","contextLoaders","getLoadersFromContext","selectLoader","previousContext","resolvedContext","getLoaderContext","validateOptions","baseUri","addUrlOptions","normalizeOptionsInternal","normalizeOptions","ok","redirected","statusText","fromEntries","entries","isArrayBuffer","getArrayBufferOrStringFromDataSync","contentType","getResponseError","checkResponse","chunkSize","textEncoder","chunkLength","makeStringIterator","chunkByteLength","makeArrayBufferIterator","end","makeBlobIterator","makeIterator","arrayBuffers","concatenateArrayBuffersAsync","getArrayBufferOrStringFromData","canParseWithWorker","parseSync","parseWithLoader","writer","canEncodeWithWorker","getLoaderOptions","encodeSync","encodeText","encodeInBatches","batches","dataIterator","start","getIterator","chunks","batch","encodeURLtoURL","tmpInputFilename","getTemporaryFilename","filePath","arrayBufferOrString","fs.writeFile","flag","writeFile","tmpOutputFilename","outputFilename","inputUrl","outputUrl","TEXTURE_ENCODING_OPTIONS","_texturesList","_numObjects","_meshUsedByObject","_removeUnusedTextures","_compressTextures","SceneModel","_Component","scene","sceneModelParams","_assertThisInitialized","_compressTextures2","_removeUnusedTextures2","built","geometries","textureSets","objects","onBuilt","rendererModel","EventEmitter","EventDispatcher","onDestroyed","fromJSON","_inheritsLoose","_proto","destroyed","SDKError","createGeometry","createTexture","createTextureSet","createMesh","createObject","createTransform","transformParams","textureParams","split","pop","texture","normalsTexture","colorTextureId","metallicRoughnessTextureId","normalsTextureId","emissiveTextureId","occlusionTextureId","geometryId","PointsPrimitive","lastPositionsIdx","idx","createGeometryCompressed","geometryCompressedParams","textureSetId","objectParams","meshIds","meshIdIdx","meshIdLen","meshId","build","_this2","dispatch","Component","_this3","countTextures","_loop","encodingOptions","load","encodedData","encodedImageData","leni","_onModelBuilts","_onModelDestroys","_center","_registerObjects","_deregisterObjects","Scene","_deregisterObjects2","_registerObjects2","models","onModelCreated","onModelDestroyed","createModel","sceneModel","one","clear","xmin","ymin","zmin","xmax","MIN_DOUBLE","ymax","zmax","valid","objectId","hasOwnProperty"],"mappings":"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"}